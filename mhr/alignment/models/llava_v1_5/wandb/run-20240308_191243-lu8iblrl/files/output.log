  0%|          | 0/1464 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:135: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/1464 [00:24<10:07:54, 24.93s/it]

  0%|          | 2/1464 [00:46<9:19:24, 22.96s/it]
{'loss': 0.6931, 'learning_rate': 9.09090909090909e-08, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'policy_logps/rejected': -433.8616638183594, 'policy_logps/chosen': -412.6845397949219, 'referece_logps/rejected': -433.8616638183594, 'referece_logps/chosen': -412.6845397949219, 'logits/rejected': 0.053385090082883835, 'logits/chosen': 0.06789463758468628, 'epoch': 0.0}


  0%|          | 4/1464 [01:29<8:51:07, 21.83s/it]

  0%|          | 5/1464 [01:50<8:43:21, 21.52s/it]
{'loss': 0.6927, 'learning_rate': 2.2727272727272726e-07, 'rewards/chosen': 0.016684817150235176, 'rewards/rejected': -0.022086046636104584, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.03877086192369461, 'policy_logps/rejected': -378.9921875, 'policy_logps/chosen': -390.1740417480469, 'referece_logps/rejected': -378.77130126953125, 'referece_logps/chosen': -390.3409118652344, 'logits/rejected': 0.17784342169761658, 'logits/chosen': 0.12504541873931885, 'epoch': 0.01}


  0%|          | 7/1464 [02:31<8:33:13, 21.14s/it]

  1%|          | 8/1464 [02:53<8:34:32, 21.20s/it]

  1%|          | 9/1464 [03:13<8:30:32, 21.05s/it]
{'loss': 0.6866, 'learning_rate': 4.090909090909091e-07, 'rewards/chosen': 0.04034776985645294, 'rewards/rejected': -0.015900421887636185, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.05624818056821823, 'policy_logps/rejected': -330.2970275878906, 'policy_logps/chosen': -337.2193298339844, 'referece_logps/rejected': -330.1380615234375, 'referece_logps/chosen': -337.6227722167969, 'logits/rejected': -0.017793305218219757, 'logits/chosen': -0.007920615375041962, 'epoch': 0.02}


  1%|          | 11/1464 [03:55<8:28:11, 20.99s/it]
{'loss': 0.6906, 'learning_rate': 5e-07, 'rewards/chosen': -0.003478908445686102, 'rewards/rejected': 0.005820467136800289, 'rewards/accuracies': 0.5, 'rewards/margins': -0.009299373254179955, 'policy_logps/rejected': -373.5782470703125, 'policy_logps/chosen': -403.5559387207031, 'referece_logps/rejected': -373.63641357421875, 'referece_logps/chosen': -403.5211181640625, 'logits/rejected': -0.41825640201568604, 'logits/chosen': -0.49826228618621826, 'epoch': 0.02}


  1%|          | 13/1464 [04:37<8:24:17, 20.85s/it]

  1%|          | 14/1464 [04:57<8:23:12, 20.82s/it]
{'loss': 0.6958, 'learning_rate': 6.363636363636363e-07, 'rewards/chosen': 0.004589510150253773, 'rewards/rejected': -0.006342506501823664, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.010932015255093575, 'policy_logps/rejected': -283.0108337402344, 'policy_logps/chosen': -358.7978820800781, 'referece_logps/rejected': -282.9474182128906, 'referece_logps/chosen': -358.8437805175781, 'logits/rejected': -0.22924691438674927, 'logits/chosen': -0.25147950649261475, 'epoch': 0.03}


  1%|          | 16/1464 [05:39<8:24:06, 20.89s/it]
{'loss': 0.6926, 'learning_rate': 7.272727272727272e-07, 'rewards/chosen': 0.0019364343024790287, 'rewards/rejected': 0.00988464429974556, 'rewards/accuracies': 0.375, 'rewards/margins': -0.007948207668960094, 'policy_logps/rejected': -370.2599182128906, 'policy_logps/chosen': -430.23760986328125, 'referece_logps/rejected': -370.3587646484375, 'referece_logps/chosen': -430.25701904296875, 'logits/rejected': -0.17578980326652527, 'logits/chosen': -0.19106623530387878, 'epoch': 0.03}


  1%|          | 18/1464 [06:21<8:21:42, 20.82s/it]

  1%|▏         | 19/1464 [06:42<8:20:32, 20.78s/it]

  1%|▏         | 20/1464 [07:01<8:11:41, 20.43s/it]
{'loss': 0.6906, 'learning_rate': 9.09090909090909e-07, 'rewards/chosen': 0.012572813779115677, 'rewards/rejected': -0.0072640422731637955, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.019836856052279472, 'policy_logps/rejected': -391.4999694824219, 'policy_logps/chosen': -332.6802978515625, 'referece_logps/rejected': -391.42730712890625, 'referece_logps/chosen': -332.8060302734375, 'logits/rejected': -0.7774660587310791, 'logits/chosen': -0.663838267326355, 'epoch': 0.04}


  2%|▏         | 22/1464 [07:43<8:18:10, 20.73s/it]
{'loss': 0.6926, 'learning_rate': 1e-06, 'rewards/chosen': 0.006763173267245293, 'rewards/rejected': -0.029851531609892845, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.036614708602428436, 'policy_logps/rejected': -399.9308166503906, 'policy_logps/chosen': -343.92236328125, 'referece_logps/rejected': -399.63232421875, 'referece_logps/chosen': -343.989990234375, 'logits/rejected': -0.40698158740997314, 'logits/chosen': -0.3720608651638031, 'epoch': 0.05}


  2%|▏         | 24/1464 [08:25<8:19:27, 20.81s/it]
{'loss': 0.6947, 'learning_rate': 1.0909090909090908e-06, 'rewards/chosen': 0.011274146847426891, 'rewards/rejected': 0.002397822681814432, 'rewards/accuracies': 0.5, 'rewards/margins': 0.008876324631273746, 'policy_logps/rejected': -426.1974792480469, 'policy_logps/chosen': -490.0078125, 'referece_logps/rejected': -426.221435546875, 'referece_logps/chosen': -490.12054443359375, 'logits/rejected': -0.09484270215034485, 'logits/chosen': -0.23041298985481262, 'epoch': 0.05}

  2%|▏         | 25/1464 [08:46<8:20:05, 20.85s/it]


  2%|▏         | 27/1464 [09:28<8:19:57, 20.87s/it]
{'loss': 0.6835, 'learning_rate': 1.2272727272727272e-06, 'rewards/chosen': -0.008510876446962357, 'rewards/rejected': -0.0317508727312088, 'rewards/accuracies': 0.625, 'rewards/margins': 0.023239994421601295, 'policy_logps/rejected': -450.71392822265625, 'policy_logps/chosen': -355.5180969238281, 'referece_logps/rejected': -450.3964538574219, 'referece_logps/chosen': -355.4330139160156, 'logits/rejected': -0.7269454598426819, 'logits/chosen': -0.6977279186248779, 'epoch': 0.06}


  2%|▏         | 29/1464 [10:09<8:18:23, 20.84s/it]
{'loss': 0.6936, 'learning_rate': 1.318181818181818e-06, 'rewards/chosen': 0.008586405776441097, 'rewards/rejected': -0.01900787279009819, 'rewards/accuracies': 0.75, 'rewards/margins': 0.027594279497861862, 'policy_logps/rejected': -432.1042175292969, 'policy_logps/chosen': -360.5582275390625, 'referece_logps/rejected': -431.9140930175781, 'referece_logps/chosen': -360.64410400390625, 'logits/rejected': -0.055861473083496094, 'logits/chosen': -0.060173407196998596, 'epoch': 0.06}

  2%|▏         | 30/1464 [10:30<8:17:41, 20.82s/it]


  2%|▏         | 32/1464 [11:12<8:17:27, 20.84s/it]
{'loss': 0.6948, 'learning_rate': 1.4545454545454544e-06, 'rewards/chosen': -0.008359814062714577, 'rewards/rejected': -0.0020540235564112663, 'rewards/accuracies': 0.5, 'rewards/margins': -0.006305789574980736, 'policy_logps/rejected': -470.6397399902344, 'policy_logps/chosen': -354.5506591796875, 'referece_logps/rejected': -470.61920166015625, 'referece_logps/chosen': -354.467041015625, 'logits/rejected': -0.3014144003391266, 'logits/chosen': -0.1668044626712799, 'epoch': 0.07}


  2%|▏         | 34/1464 [11:54<8:16:06, 20.82s/it]
{'loss': 0.6873, 'learning_rate': 1.5454545454545454e-06, 'rewards/chosen': 0.004207896534353495, 'rewards/rejected': -0.04033174365758896, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.044539641588926315, 'policy_logps/rejected': -416.63043212890625, 'policy_logps/chosen': -445.7887878417969, 'referece_logps/rejected': -416.2270812988281, 'referece_logps/chosen': -445.83087158203125, 'logits/rejected': -0.483223557472229, 'logits/chosen': -0.5612077116966248, 'epoch': 0.07}


  2%|▏         | 36/1464 [12:35<8:16:59, 20.88s/it]
{'loss': 0.6802, 'learning_rate': 1.6363636363636365e-06, 'rewards/chosen': 0.020049475133419037, 'rewards/rejected': -0.0232817642390728, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.043331246823072433, 'policy_logps/rejected': -386.14215087890625, 'policy_logps/chosen': -354.1997375488281, 'referece_logps/rejected': -385.9093322753906, 'referece_logps/chosen': -354.40020751953125, 'logits/rejected': -0.6827501058578491, 'logits/chosen': -0.5259873270988464, 'epoch': 0.07}


  3%|▎         | 38/1464 [13:17<8:17:25, 20.93s/it]
{'loss': 0.6981, 'learning_rate': 1.7272727272727273e-06, 'rewards/chosen': -0.009741879999637604, 'rewards/rejected': -0.016491128131747246, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.006749247666448355, 'policy_logps/rejected': -394.7204895019531, 'policy_logps/chosen': -363.7887268066406, 'referece_logps/rejected': -394.55560302734375, 'referece_logps/chosen': -363.69134521484375, 'logits/rejected': -0.7389354109764099, 'logits/chosen': -0.7640188336372375, 'epoch': 0.08}


  3%|▎         | 40/1464 [13:59<8:17:41, 20.97s/it]
{'loss': 0.6958, 'learning_rate': 1.818181818181818e-06, 'rewards/chosen': -0.01489109918475151, 'rewards/rejected': 0.016567517071962357, 'rewards/accuracies': 0.375, 'rewards/margins': -0.03145861625671387, 'policy_logps/rejected': -431.38458251953125, 'policy_logps/chosen': -385.88018798828125, 'referece_logps/rejected': -431.5502624511719, 'referece_logps/chosen': -385.73126220703125, 'logits/rejected': -0.828352689743042, 'logits/chosen': -0.9349023699760437, 'epoch': 0.08}


  3%|▎         | 42/1464 [14:41<8:17:38, 21.00s/it]

  3%|▎         | 43/1464 [15:02<8:15:30, 20.92s/it]

  3%|▎         | 44/1464 [15:22<8:05:07, 20.50s/it]
{'loss': 0.6885, 'learning_rate': 2e-06, 'rewards/chosen': -0.007162952795624733, 'rewards/rejected': -0.012176132760941982, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.005013179965317249, 'policy_logps/rejected': -399.3833312988281, 'policy_logps/chosen': -386.71417236328125, 'referece_logps/rejected': -399.2615051269531, 'referece_logps/chosen': -386.64251708984375, 'logits/rejected': -0.42371422052383423, 'logits/chosen': -0.41163167357444763, 'epoch': 0.09}


  3%|▎         | 46/1464 [16:03<8:08:42, 20.68s/it]

  3%|▎         | 47/1464 [16:24<8:07:58, 20.66s/it]
{'loss': 0.6939, 'learning_rate': 1.999977974084128e-06, 'rewards/chosen': -0.0061408039182424545, 'rewards/rejected': -0.018558122217655182, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.012417318299412727, 'policy_logps/rejected': -541.7896728515625, 'policy_logps/chosen': -377.7117919921875, 'referece_logps/rejected': -541.6040649414062, 'referece_logps/chosen': -377.6504211425781, 'logits/rejected': -1.09270441532135, 'logits/chosen': -1.149175763130188, 'epoch': 0.1}


  3%|▎         | 49/1464 [17:06<8:11:06, 20.82s/it]
{'loss': 0.6972, 'learning_rate': 1.9999388172996495e-06, 'rewards/chosen': -0.00015516229905188084, 'rewards/rejected': 0.01904292218387127, 'rewards/accuracies': 0.375, 'rewards/margins': -0.019198086112737656, 'policy_logps/rejected': -368.0889892578125, 'policy_logps/chosen': -336.06304931640625, 'referece_logps/rejected': -368.2794189453125, 'referece_logps/chosen': -336.0615234375, 'logits/rejected': -0.5338196754455566, 'logits/chosen': -0.510080873966217, 'epoch': 0.1}

  3%|▎         | 50/1464 [17:27<8:10:25, 20.81s/it]


  4%|▎         | 52/1464 [18:08<8:07:05, 20.70s/it]
{'loss': 0.697, 'learning_rate': 1.9998433747786726e-06, 'rewards/chosen': -0.008125495165586472, 'rewards/rejected': 0.007356070913374424, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.01548156701028347, 'policy_logps/rejected': -441.8957824707031, 'policy_logps/chosen': -432.8612976074219, 'referece_logps/rejected': -441.9693298339844, 'referece_logps/chosen': -432.77996826171875, 'logits/rejected': -0.09505458176136017, 'logits/chosen': -0.17485183477401733, 'epoch': 0.11}


  4%|▎         | 54/1464 [18:50<8:08:10, 20.77s/it]

  4%|▍         | 55/1464 [19:11<8:08:27, 20.80s/it]
