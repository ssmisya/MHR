  0%|          | 0/1464 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:145: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
0
0
{'loss': 0.6931, 'learning_rate': 4.545454545454545e-08, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'policy_logps/rejected': -299.92828369140625, 'policy_logps/chosen': -301.01531982421875, 'referece_logps/rejected': -299.92828369140625, 'referece_logps/chosen': -301.01531982421875, 'logits/rejected': -0.37190359830856323, 'logits/chosen': -0.4063689410686493, 'epoch': 0.0}
1
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/1464 [00:24<10:05:28, 24.83s/it]

  0%|          | 2/1464 [00:46<9:14:37, 22.76s/it]
{'loss': 0.6931, 'learning_rate': 9.09090909090909e-08, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'policy_logps/rejected': -433.8616638183594, 'policy_logps/chosen': -412.6845397949219, 'referece_logps/rejected': -433.8616638183594, 'referece_logps/chosen': -412.6845397949219, 'logits/rejected': 0.053385090082883835, 'logits/chosen': 0.06789463758468628, 'epoch': 0.0}
2

  0%|          | 3/1464 [01:08<9:05:05, 22.39s/it]
{'loss': 0.6916, 'learning_rate': 1.3636363636363635e-07, 'rewards/chosen': 0.006368065252900124, 'rewards/rejected': 0.008246326819062233, 'rewards/accuracies': 0.625, 'rewards/margins': -0.0018782613333314657, 'policy_logps/rejected': -414.828857421875, 'policy_logps/chosen': -409.9031677246094, 'referece_logps/rejected': -414.91131591796875, 'referece_logps/chosen': -409.96685791015625, 'logits/rejected': 0.17316782474517822, 'logits/chosen': 0.15144599974155426, 'epoch': 0.01}
3
3
{'loss': 0.6918, 'learning_rate': 1.818181818181818e-07, 'rewards/chosen': 0.0013200761750340462, 'rewards/rejected': 0.01663350872695446, 'rewards/accuracies': 0.5625, 'rewards/margins': -0.015313435345888138, 'policy_logps/rejected': -416.7308349609375, 'policy_logps/chosen': -366.878173828125, 'referece_logps/rejected': -416.8971862792969, 'referece_logps/chosen': -366.89141845703125, 'logits/rejected': -0.9410399794578552, 'logits/chosen': -1.088100552558899, 'epoch': 0.01}

  0%|          | 4/1464 [01:29<8:51:54, 21.86s/it]

  0%|          | 5/1464 [01:50<8:43:27, 21.53s/it]
{'loss': 0.6904, 'learning_rate': 2.2727272727272726e-07, 'rewards/chosen': -0.0074825286865234375, 'rewards/rejected': 0.008350849151611328, 'rewards/accuracies': 0.3125, 'rewards/margins': -0.015833379700779915, 'policy_logps/rejected': -378.7978820800781, 'policy_logps/chosen': -390.1603088378906, 'referece_logps/rejected': -378.8813781738281, 'referece_logps/chosen': -390.08544921875, 'logits/rejected': 0.17902620136737823, 'logits/chosen': 0.1257736086845398, 'epoch': 0.01}
5
5
{'loss': 0.6974, 'learning_rate': 2.727272727272727e-07, 'rewards/chosen': 0.005240487400442362, 'rewards/rejected': 0.018980028107762337, 'rewards/accuracies': 0.3125, 'rewards/margins': -0.013739538379013538, 'policy_logps/rejected': -357.14971923828125, 'policy_logps/chosen': -315.9847412109375, 'referece_logps/rejected': -357.3395080566406, 'referece_logps/chosen': -316.0371398925781, 'logits/rejected': -0.7731051445007324, 'logits/chosen': -0.9217522144317627, 'epoch': 0.01}

  0%|          | 6/1464 [02:10<8:37:20, 21.29s/it]

  0%|          | 7/1464 [02:31<8:34:30, 21.19s/it]
{'loss': 0.6916, 'learning_rate': 3.1818181818181815e-07, 'rewards/chosen': -0.011331940069794655, 'rewards/rejected': -0.0058098784647881985, 'rewards/accuracies': 0.375, 'rewards/margins': -0.005522062070667744, 'policy_logps/rejected': -298.199951171875, 'policy_logps/chosen': -327.7619323730469, 'referece_logps/rejected': -298.141845703125, 'referece_logps/chosen': -327.6485900878906, 'logits/rejected': -0.2237757444381714, 'logits/chosen': -0.27009424567222595, 'epoch': 0.01}
7

  1%|          | 8/1464 [02:53<8:34:49, 21.22s/it]
{'loss': 0.6936, 'learning_rate': 3.636363636363636e-07, 'rewards/chosen': -0.01746387593448162, 'rewards/rejected': 0.010583116672933102, 'rewards/accuracies': 0.375, 'rewards/margins': -0.028046991676092148, 'policy_logps/rejected': -413.5446472167969, 'policy_logps/chosen': -440.8821105957031, 'referece_logps/rejected': -413.6504821777344, 'referece_logps/chosen': -440.7074890136719, 'logits/rejected': -0.49856531620025635, 'logits/chosen': -0.4752858877182007, 'epoch': 0.02}
8

  1%|          | 9/1464 [03:13<8:31:36, 21.10s/it]
{'loss': 0.6978, 'learning_rate': 4.090909090909091e-07, 'rewards/chosen': -0.0009614953305572271, 'rewards/rejected': 0.006282234098762274, 'rewards/accuracies': 0.5, 'rewards/margins': -0.007243728265166283, 'policy_logps/rejected': -330.0703125, 'policy_logps/chosen': -337.3511962890625, 'referece_logps/rejected': -330.1331787109375, 'referece_logps/chosen': -337.3415832519531, 'logits/rejected': -0.021441608667373657, 'logits/chosen': -0.010954231023788452, 'epoch': 0.02}
9

  1%|          | 10/1464 [03:34<8:29:31, 21.03s/it]
{'loss': 0.7005, 'learning_rate': 4.545454545454545e-07, 'rewards/chosen': 0.015085839666426182, 'rewards/rejected': -0.011682606302201748, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.02676844596862793, 'policy_logps/rejected': -404.89154052734375, 'policy_logps/chosen': -410.4603576660156, 'referece_logps/rejected': -404.77471923828125, 'referece_logps/chosen': -410.6112365722656, 'logits/rejected': -1.071964979171753, 'logits/chosen': -1.0368907451629639, 'epoch': 0.02}
10

  1%|          | 11/1464 [03:55<8:28:02, 20.98s/it]
{'loss': 0.7005, 'learning_rate': 5e-07, 'rewards/chosen': -0.02144622802734375, 'rewards/rejected': 0.01777486875653267, 'rewards/accuracies': 0.3125, 'rewards/margins': -0.03922110050916672, 'policy_logps/rejected': -373.5613098144531, 'policy_logps/chosen': -403.6907043457031, 'referece_logps/rejected': -373.7391052246094, 'referece_logps/chosen': -403.4762268066406, 'logits/rejected': -0.4161006808280945, 'logits/chosen': -0.4971391260623932, 'epoch': 0.02}
11

  1%|          | 12/1464 [04:16<8:26:47, 20.94s/it]
{'loss': 0.6955, 'learning_rate': 5.454545454545454e-07, 'rewards/chosen': -0.0005040164105594158, 'rewards/rejected': -0.0033004761207848787, 'rewards/accuracies': 0.5, 'rewards/margins': 0.0027964594773948193, 'policy_logps/rejected': -329.562255859375, 'policy_logps/chosen': -320.0408935546875, 'referece_logps/rejected': -329.52923583984375, 'referece_logps/chosen': -320.035888671875, 'logits/rejected': -0.42436546087265015, 'logits/chosen': -0.5984132289886475, 'epoch': 0.02}
12

  1%|          | 13/1464 [04:37<8:24:31, 20.86s/it]
{'loss': 0.6918, 'learning_rate': 5.909090909090909e-07, 'rewards/chosen': 0.004657173994928598, 'rewards/rejected': 0.011539269238710403, 'rewards/accuracies': 0.3125, 'rewards/margins': -0.006882094778120518, 'policy_logps/rejected': -346.59832763671875, 'policy_logps/chosen': -325.8793029785156, 'referece_logps/rejected': -346.7137451171875, 'referece_logps/chosen': -325.9258728027344, 'logits/rejected': -0.18228602409362793, 'logits/chosen': -0.23421019315719604, 'epoch': 0.03}
13

  1%|          | 14/1464 [04:57<8:21:32, 20.75s/it]
{'loss': 0.6939, 'learning_rate': 6.363636363636363e-07, 'rewards/chosen': -0.003548525972291827, 'rewards/rejected': -0.009616327472031116, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.006067801266908646, 'policy_logps/rejected': -282.939453125, 'policy_logps/chosen': -358.86883544921875, 'referece_logps/rejected': -282.84332275390625, 'referece_logps/chosen': -358.8333740234375, 'logits/rejected': -0.22598958015441895, 'logits/chosen': -0.247908353805542, 'epoch': 0.03}
14
14
{'loss': 0.6962, 'learning_rate': 6.818181818181817e-07, 'rewards/chosen': 0.011676214635372162, 'rewards/rejected': 0.010249614715576172, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.0014266017824411392, 'policy_logps/rejected': -421.76239013671875, 'policy_logps/chosen': -428.78546142578125, 'referece_logps/rejected': -421.8648681640625, 'referece_logps/chosen': -428.9022216796875, 'logits/rejected': -0.33412525057792664, 'logits/chosen': -0.31806686520576477, 'epoch': 0.03}

  1%|          | 15/1464 [05:18<8:22:40, 20.82s/it]

  1%|          | 16/1464 [05:39<8:23:03, 20.84s/it]
{'loss': 0.6899, 'learning_rate': 7.272727272727272e-07, 'rewards/chosen': -0.00843343697488308, 'rewards/rejected': 0.013949490152299404, 'rewards/accuracies': 0.375, 'rewards/margins': -0.02238292619585991, 'policy_logps/rejected': -370.11065673828125, 'policy_logps/chosen': -430.36407470703125, 'referece_logps/rejected': -370.2501525878906, 'referece_logps/chosen': -430.27972412109375, 'logits/rejected': -0.17558154463768005, 'logits/chosen': -0.19193994998931885, 'epoch': 0.03}
16

  1%|          | 17/1464 [06:00<8:23:37, 20.88s/it]
{'loss': 0.6901, 'learning_rate': 7.727272727272727e-07, 'rewards/chosen': -0.005055666901171207, 'rewards/rejected': -0.0024857516400516033, 'rewards/accuracies': 0.375, 'rewards/margins': -0.002569914096966386, 'policy_logps/rejected': -314.0452880859375, 'policy_logps/chosen': -324.6147155761719, 'referece_logps/rejected': -314.0204162597656, 'referece_logps/chosen': -324.564208984375, 'logits/rejected': -0.2262669801712036, 'logits/chosen': -0.2651920020580292, 'epoch': 0.03}
17

  1%|          | 18/1464 [06:21<8:23:39, 20.90s/it]
{'loss': 0.6905, 'learning_rate': 8.181818181818182e-07, 'rewards/chosen': -0.010665226727724075, 'rewards/rejected': -0.005427837371826172, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.005237387493252754, 'policy_logps/rejected': -354.81719970703125, 'policy_logps/chosen': -458.58251953125, 'referece_logps/rejected': -354.762939453125, 'referece_logps/chosen': -458.4758605957031, 'logits/rejected': -0.8820130825042725, 'logits/chosen': -0.9994086027145386, 'epoch': 0.04}
18

  1%|▏         | 19/1464 [06:42<8:23:32, 20.91s/it]
{'loss': 0.6977, 'learning_rate': 8.636363636363636e-07, 'rewards/chosen': 0.012572621926665306, 'rewards/rejected': -0.005682897754013538, 'rewards/accuracies': 0.75, 'rewards/margins': 0.01825551874935627, 'policy_logps/rejected': -266.1751708984375, 'policy_logps/chosen': -289.407470703125, 'referece_logps/rejected': -266.11834716796875, 'referece_logps/chosen': -289.533203125, 'logits/rejected': -0.5135456323623657, 'logits/chosen': -0.4834645092487335, 'epoch': 0.04}
19

  1%|▏         | 20/1464 [07:02<8:14:00, 20.53s/it]
{'loss': 0.6979, 'learning_rate': 9.09090909090909e-07, 'rewards/chosen': 0.010554314590990543, 'rewards/rejected': 0.011566733941435814, 'rewards/accuracies': 0.375, 'rewards/margins': -0.0010124194668605924, 'policy_logps/rejected': -391.37396240234375, 'policy_logps/chosen': -332.74298095703125, 'referece_logps/rejected': -391.4896240234375, 'referece_logps/chosen': -332.8485107421875, 'logits/rejected': -0.7778257727622986, 'logits/chosen': -0.6634194850921631, 'epoch': 0.04}
20

  1%|▏         | 21/1464 [07:23<8:16:31, 20.65s/it]
{'loss': 0.6837, 'learning_rate': 9.545454545454546e-07, 'rewards/chosen': 0.022530842572450638, 'rewards/rejected': 1.611746847629547e-05, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.022514723241329193, 'policy_logps/rejected': -435.13916015625, 'policy_logps/chosen': -435.46063232421875, 'referece_logps/rejected': -435.1393127441406, 'referece_logps/chosen': -435.6859130859375, 'logits/rejected': -0.3270815908908844, 'logits/chosen': -0.27567750215530396, 'epoch': 0.04}
21

  2%|▏         | 22/1464 [07:44<8:18:47, 20.75s/it]
{'loss': 0.6871, 'learning_rate': 1e-06, 'rewards/chosen': 0.012624694034457207, 'rewards/rejected': -0.004113626666367054, 'rewards/accuracies': 0.625, 'rewards/margins': 0.016738319769501686, 'policy_logps/rejected': -399.79150390625, 'policy_logps/chosen': -344.0410461425781, 'referece_logps/rejected': -399.75030517578125, 'referece_logps/chosen': -344.16729736328125, 'logits/rejected': -0.4071812033653259, 'logits/chosen': -0.37244346737861633, 'epoch': 0.05}
22
22
{'loss': 0.6874, 'learning_rate': 1.0454545454545454e-06, 'rewards/chosen': 0.01323404349386692, 'rewards/rejected': -0.00802478939294815, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.021258829161524773, 'policy_logps/rejected': -363.60760498046875, 'policy_logps/chosen': -541.39794921875, 'referece_logps/rejected': -363.5273132324219, 'referece_logps/chosen': -541.5302734375, 'logits/rejected': -0.5196849703788757, 'logits/chosen': -0.6750808358192444, 'epoch': 0.05}

  2%|▏         | 23/1464 [08:04<8:19:40, 20.81s/it]

  2%|▏         | 24/1464 [08:25<8:20:33, 20.86s/it]
{'loss': 0.6945, 'learning_rate': 1.0909090909090908e-06, 'rewards/chosen': 0.0030555729754269123, 'rewards/rejected': -0.004285048693418503, 'rewards/accuracies': 0.625, 'rewards/margins': 0.0073406207375228405, 'policy_logps/rejected': -426.4300842285156, 'policy_logps/chosen': -490.1673889160156, 'referece_logps/rejected': -426.3872375488281, 'referece_logps/chosen': -490.19793701171875, 'logits/rejected': -0.09376455098390579, 'logits/chosen': -0.22854402661323547, 'epoch': 0.05}
24

  2%|▏         | 25/1464 [08:46<8:21:09, 20.90s/it]
{'loss': 0.6892, 'learning_rate': 1.1363636363636364e-06, 'rewards/chosen': 0.008468818850815296, 'rewards/rejected': -0.008187343366444111, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.016656162217259407, 'policy_logps/rejected': -363.3367004394531, 'policy_logps/chosen': -340.6695861816406, 'referece_logps/rejected': -363.25482177734375, 'referece_logps/chosen': -340.7542724609375, 'logits/rejected': -0.13030752539634705, 'logits/chosen': -0.19781872630119324, 'epoch': 0.05}
25

  2%|▏         | 26/1464 [09:07<8:19:38, 20.85s/it]
{'loss': 0.6897, 'learning_rate': 1.1818181818181818e-06, 'rewards/chosen': 0.00839071162045002, 'rewards/rejected': 0.015642883256077766, 'rewards/accuracies': 0.5, 'rewards/margins': -0.007252171169966459, 'policy_logps/rejected': -401.57366943359375, 'policy_logps/chosen': -481.5265808105469, 'referece_logps/rejected': -401.7300720214844, 'referece_logps/chosen': -481.6104736328125, 'logits/rejected': -0.6147109270095825, 'logits/chosen': -0.6146734952926636, 'epoch': 0.05}
26

  2%|▏         | 27/1464 [09:28<8:20:06, 20.88s/it]
{'loss': 0.6924, 'learning_rate': 1.2272727272727272e-06, 'rewards/chosen': -0.004694652743637562, 'rewards/rejected': 0.017025470733642578, 'rewards/accuracies': 0.5, 'rewards/margins': -0.021720120683312416, 'policy_logps/rejected': -450.48931884765625, 'policy_logps/chosen': -355.3952331542969, 'referece_logps/rejected': -450.65960693359375, 'referece_logps/chosen': -355.3482666015625, 'logits/rejected': -0.7279000878334045, 'logits/chosen': -0.698630154132843, 'epoch': 0.06}
27

  2%|▏         | 28/1464 [09:49<8:21:17, 20.95s/it]
{'loss': 0.6938, 'learning_rate': 1.2727272727272726e-06, 'rewards/chosen': 0.006001378409564495, 'rewards/rejected': 0.009039497002959251, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.0030381185933947563, 'policy_logps/rejected': -438.6462707519531, 'policy_logps/chosen': -360.6087951660156, 'referece_logps/rejected': -438.73663330078125, 'referece_logps/chosen': -360.6688537597656, 'logits/rejected': -0.7319045662879944, 'logits/chosen': -0.7374063730239868, 'epoch': 0.06}
28

  2%|▏         | 29/1464 [10:10<8:21:16, 20.96s/it]
{'loss': 0.6972, 'learning_rate': 1.318181818181818e-06, 'rewards/chosen': -0.01643810234963894, 'rewards/rejected': 0.007761669810861349, 'rewards/accuracies': 0.5, 'rewards/margins': -0.024199772626161575, 'policy_logps/rejected': -431.7966613769531, 'policy_logps/chosen': -360.72943115234375, 'referece_logps/rejected': -431.8742370605469, 'referece_logps/chosen': -360.5650634765625, 'logits/rejected': -0.056913331151008606, 'logits/chosen': -0.06151434779167175, 'epoch': 0.06}
29

  2%|▏         | 30/1464 [10:31<8:21:45, 20.99s/it]
{'loss': 0.6969, 'learning_rate': 1.3636363636363634e-06, 'rewards/chosen': -0.014197014272212982, 'rewards/rejected': 0.012562990188598633, 'rewards/accuracies': 0.25, 'rewards/margins': -0.026760004460811615, 'policy_logps/rejected': -358.251953125, 'policy_logps/chosen': -384.0253601074219, 'referece_logps/rejected': -358.3775634765625, 'referece_logps/chosen': -383.8834228515625, 'logits/rejected': -0.45137014985084534, 'logits/chosen': -0.49433812499046326, 'epoch': 0.06}
30

  2%|▏         | 31/1464 [10:52<8:21:40, 21.01s/it]
{'loss': 0.6935, 'learning_rate': 1.409090909090909e-06, 'rewards/chosen': 0.011022758670151234, 'rewards/rejected': -0.0049304966814816, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.01595325767993927, 'policy_logps/rejected': -362.96044921875, 'policy_logps/chosen': -425.86444091796875, 'referece_logps/rejected': -362.9111022949219, 'referece_logps/chosen': -425.9746398925781, 'logits/rejected': -0.3796684443950653, 'logits/chosen': -0.33421647548675537, 'epoch': 0.06}
31

  2%|▏         | 32/1464 [11:13<8:21:03, 20.99s/it]
{'loss': 0.6875, 'learning_rate': 1.4545454545454544e-06, 'rewards/chosen': -0.011705780401825905, 'rewards/rejected': 0.004885387606918812, 'rewards/accuracies': 0.375, 'rewards/margins': -0.016591167077422142, 'policy_logps/rejected': -470.48858642578125, 'policy_logps/chosen': -354.5122985839844, 'referece_logps/rejected': -470.5374450683594, 'referece_logps/chosen': -354.3952331542969, 'logits/rejected': -0.29960575699806213, 'logits/chosen': -0.16418802738189697, 'epoch': 0.07}
32

  2%|▏         | 33/1464 [11:34<8:19:23, 20.94s/it]
{'loss': 0.6896, 'learning_rate': 1.5e-06, 'rewards/chosen': -0.00400962820276618, 'rewards/rejected': 0.0037308689206838608, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.0077404966577887535, 'policy_logps/rejected': -437.6370849609375, 'policy_logps/chosen': -380.7842712402344, 'referece_logps/rejected': -437.67437744140625, 'referece_logps/chosen': -380.7441711425781, 'logits/rejected': -0.2791629433631897, 'logits/chosen': -0.282375305891037, 'epoch': 0.07}
33
33
{'loss': 0.6936, 'learning_rate': 1.5454545454545454e-06, 'rewards/chosen': 0.01714792288839817, 'rewards/rejected': 0.004269028548151255, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.012878893874585629, 'policy_logps/rejected': -416.3828430175781, 'policy_logps/chosen': -445.7073059082031, 'referece_logps/rejected': -416.4255676269531, 'referece_logps/chosen': -445.8788146972656, 'logits/rejected': -0.48327457904815674, 'logits/chosen': -0.5620023608207703, 'epoch': 0.07}

  2%|▏         | 34/1464 [11:55<8:16:15, 20.82s/it]

  2%|▏         | 35/1464 [12:16<8:17:35, 20.89s/it]
{'loss': 0.6938, 'learning_rate': 1.5909090909090908e-06, 'rewards/chosen': 0.0016979221254587173, 'rewards/rejected': -0.01295166090130806, 'rewards/accuracies': 0.625, 'rewards/margins': 0.014649583026766777, 'policy_logps/rejected': -491.42376708984375, 'policy_logps/chosen': -452.796142578125, 'referece_logps/rejected': -491.29425048828125, 'referece_logps/chosen': -452.81317138671875, 'logits/rejected': -0.2997093200683594, 'logits/chosen': -0.2624136209487915, 'epoch': 0.07}
35
35
{'loss': 0.6982, 'learning_rate': 1.6363636363636365e-06, 'rewards/chosen': -0.005548954010009766, 'rewards/rejected': -0.0076622976921498775, 'rewards/accuracies': 0.75, 'rewards/margins': 0.002113341586664319, 'policy_logps/rejected': -386.0302734375, 'policy_logps/chosen': -354.2615661621094, 'referece_logps/rejected': -385.95367431640625, 'referece_logps/chosen': -354.2060852050781, 'logits/rejected': -0.6833317875862122, 'logits/chosen': -0.5262658596038818, 'epoch': 0.07}

  2%|▏         | 36/1464 [12:37<8:18:10, 20.93s/it]

  3%|▎         | 37/1464 [12:58<8:18:47, 20.97s/it]
{'loss': 0.6936, 'learning_rate': 1.6818181818181819e-06, 'rewards/chosen': 0.015749454498291016, 'rewards/rejected': 0.004500579554587603, 'rewards/accuracies': 0.5, 'rewards/margins': 0.01124887727200985, 'policy_logps/rejected': -448.5142822265625, 'policy_logps/chosen': -440.1050109863281, 'referece_logps/rejected': -448.55926513671875, 'referece_logps/chosen': -440.262451171875, 'logits/rejected': -0.43025141954421997, 'logits/chosen': -0.5310930013656616, 'epoch': 0.08}
37

  3%|▎         | 38/1464 [13:19<8:17:17, 20.92s/it]
{'loss': 0.6956, 'learning_rate': 1.7272727272727273e-06, 'rewards/chosen': -0.0009221542859449983, 'rewards/rejected': 0.013357925228774548, 'rewards/accuracies': 0.5, 'rewards/margins': -0.014280080795288086, 'policy_logps/rejected': -394.48828125, 'policy_logps/chosen': -363.79388427734375, 'referece_logps/rejected': -394.6218566894531, 'referece_logps/chosen': -363.78466796875, 'logits/rejected': -0.7404611706733704, 'logits/chosen': -0.7647294998168945, 'epoch': 0.08}
38

  3%|▎         | 39/1464 [13:40<8:17:27, 20.95s/it]
{'loss': 0.689, 'learning_rate': 1.7727272727272727e-06, 'rewards/chosen': -0.0008858665823936462, 'rewards/rejected': -0.004142378456890583, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.003256511641666293, 'policy_logps/rejected': -408.7874450683594, 'policy_logps/chosen': -421.82196044921875, 'referece_logps/rejected': -408.74603271484375, 'referece_logps/chosen': -421.8131103515625, 'logits/rejected': -0.2949332594871521, 'logits/chosen': -0.40533918142318726, 'epoch': 0.08}
39

  3%|▎         | 40/1464 [14:01<8:16:49, 20.93s/it]
{'loss': 0.6916, 'learning_rate': 1.818181818181818e-06, 'rewards/chosen': 0.000149440485984087, 'rewards/rejected': -0.000978612108156085, 'rewards/accuracies': 0.375, 'rewards/margins': 0.0011280530598014593, 'policy_logps/rejected': -431.5564270019531, 'policy_logps/chosen': -385.8801574707031, 'referece_logps/rejected': -431.546630859375, 'referece_logps/chosen': -385.88165283203125, 'logits/rejected': -0.8242350816726685, 'logits/chosen': -0.9307423233985901, 'epoch': 0.08}
40

  3%|▎         | 41/1464 [14:22<8:18:00, 21.00s/it]
{'loss': 0.6915, 'learning_rate': 1.8636363636363635e-06, 'rewards/chosen': 0.02710142359137535, 'rewards/rejected': -0.01146087609231472, 'rewards/accuracies': 0.75, 'rewards/margins': 0.03856230154633522, 'policy_logps/rejected': -411.2171630859375, 'policy_logps/chosen': -364.3843078613281, 'referece_logps/rejected': -411.1025390625, 'referece_logps/chosen': -364.65533447265625, 'logits/rejected': -0.12635411322116852, 'logits/chosen': -0.1965745985507965, 'epoch': 0.08}
41

  3%|▎         | 42/1464 [14:43<8:18:01, 21.01s/it]
{'loss': 0.6978, 'learning_rate': 1.909090909090909e-06, 'rewards/chosen': -0.008026361465454102, 'rewards/rejected': 0.006975030526518822, 'rewards/accuracies': 0.375, 'rewards/margins': -0.015001392923295498, 'policy_logps/rejected': -426.162109375, 'policy_logps/chosen': -406.26031494140625, 'referece_logps/rejected': -426.23187255859375, 'referece_logps/chosen': -406.1800537109375, 'logits/rejected': 0.31722432374954224, 'logits/chosen': 0.22569414973258972, 'epoch': 0.09}
42

  3%|▎         | 43/1464 [15:04<8:17:21, 21.00s/it]
{'loss': 0.6911, 'learning_rate': 1.9545454545454545e-06, 'rewards/chosen': -0.007918929681181908, 'rewards/rejected': -0.013344954699277878, 'rewards/accuracies': 0.5, 'rewards/margins': 0.005426026415079832, 'policy_logps/rejected': -328.10552978515625, 'policy_logps/chosen': -379.4586486816406, 'referece_logps/rejected': -327.9720764160156, 'referece_logps/chosen': -379.37945556640625, 'logits/rejected': -0.38123607635498047, 'logits/chosen': -0.38921990990638733, 'epoch': 0.09}
43
43
{'loss': 0.6853, 'learning_rate': 2e-06, 'rewards/chosen': 0.011876249685883522, 'rewards/rejected': -0.005787089467048645, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.01766333542764187, 'policy_logps/rejected': -399.4544982910156, 'policy_logps/chosen': -386.6406555175781, 'referece_logps/rejected': -399.3966064453125, 'referece_logps/chosen': -386.7593994140625, 'logits/rejected': -0.42387592792510986, 'logits/chosen': -0.41142868995666504, 'epoch': 0.09}

  3%|▎         | 44/1464 [15:23<8:05:19, 20.51s/it]

  3%|▎         | 45/1464 [15:44<8:08:35, 20.66s/it]
{'loss': 0.6987, 'learning_rate': 1.999997552668028e-06, 'rewards/chosen': 0.019436359405517578, 'rewards/rejected': -0.008449746295809746, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.027886103838682175, 'policy_logps/rejected': -437.0037536621094, 'policy_logps/chosen': -370.08441162109375, 'referece_logps/rejected': -436.91925048828125, 'referece_logps/chosen': -370.2787170410156, 'logits/rejected': -0.9687830209732056, 'logits/chosen': -1.1508303880691528, 'epoch': 0.09}
45

  3%|▎         | 46/1464 [16:05<8:09:05, 20.70s/it]
{'loss': 0.6918, 'learning_rate': 1.999990210684092e-06, 'rewards/chosen': -0.006514168344438076, 'rewards/rejected': -0.018634987995028496, 'rewards/accuracies': 0.5, 'rewards/margins': 0.012120820581912994, 'policy_logps/rejected': -328.6560974121094, 'policy_logps/chosen': -374.16131591796875, 'referece_logps/rejected': -328.4697570800781, 'referece_logps/chosen': -374.0961608886719, 'logits/rejected': -0.41949236392974854, 'logits/chosen': -0.46807825565338135, 'epoch': 0.09}
46

  3%|▎         | 47/1464 [16:26<8:09:06, 20.71s/it]
{'loss': 0.6967, 'learning_rate': 1.999977974084128e-06, 'rewards/chosen': 0.01886472851037979, 'rewards/rejected': -0.0166962631046772, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.03556098788976669, 'policy_logps/rejected': -541.669921875, 'policy_logps/chosen': -377.48358154296875, 'referece_logps/rejected': -541.5029296875, 'referece_logps/chosen': -377.6722106933594, 'logits/rejected': -1.0892759561538696, 'logits/chosen': -1.1448487043380737, 'epoch': 0.1}
47

  3%|▎         | 48/1464 [16:47<8:11:51, 20.84s/it]
{'loss': 0.6958, 'learning_rate': 1.99996084292803e-06, 'rewards/chosen': -0.006925629917532206, 'rewards/rejected': 0.023222066462039948, 'rewards/accuracies': 0.375, 'rewards/margins': -0.030147697776556015, 'policy_logps/rejected': -290.8072814941406, 'policy_logps/chosen': -373.6556396484375, 'referece_logps/rejected': -291.0395202636719, 'referece_logps/chosen': -373.5863952636719, 'logits/rejected': -0.44337189197540283, 'logits/chosen': -0.4556289613246918, 'epoch': 0.1}
48

  3%|▎         | 49/1464 [17:08<8:11:05, 20.82s/it]
{'loss': 0.6896, 'learning_rate': 1.9999388172996495e-06, 'rewards/chosen': 0.013377143070101738, 'rewards/rejected': -0.002382993698120117, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.015760136768221855, 'policy_logps/rejected': -368.231201171875, 'policy_logps/chosen': -335.9858093261719, 'referece_logps/rejected': -368.2073974609375, 'referece_logps/chosen': -336.1195983886719, 'logits/rejected': -0.537469744682312, 'logits/chosen': -0.5140292644500732, 'epoch': 0.1}
49

  3%|▎         | 50/1464 [17:28<8:11:47, 20.87s/it]
{'loss': 0.6878, 'learning_rate': 1.999911897306794e-06, 'rewards/chosen': 0.002926444634795189, 'rewards/rejected': -0.006068420596420765, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.00899486429989338, 'policy_logps/rejected': -393.3629455566406, 'policy_logps/chosen': -430.69439697265625, 'referece_logps/rejected': -393.3022766113281, 'referece_logps/chosen': -430.7236022949219, 'logits/rejected': -0.006699282675981522, 'logits/chosen': -0.13084928691387177, 'epoch': 0.1}
50

  3%|▎         | 51/1464 [17:49<8:11:50, 20.88s/it]
{'loss': 0.6908, 'learning_rate': 1.9998800830812287e-06, 'rewards/chosen': 0.006208895705640316, 'rewards/rejected': 0.018792057409882545, 'rewards/accuracies': 0.3125, 'rewards/margins': -0.01258315984159708, 'policy_logps/rejected': -402.7554626464844, 'policy_logps/chosen': -379.9862060546875, 'referece_logps/rejected': -402.94342041015625, 'referece_logps/chosen': -380.04827880859375, 'logits/rejected': -0.8013991117477417, 'logits/chosen': -0.5766043066978455, 'epoch': 0.1}
51

  4%|▎         | 52/1464 [18:10<8:09:41, 20.81s/it]
{'loss': 0.6862, 'learning_rate': 1.9998433747786726e-06, 'rewards/chosen': 0.006149673834443092, 'rewards/rejected': -0.01810441166162491, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.024254081770777702, 'policy_logps/rejected': -441.97723388671875, 'policy_logps/chosen': -432.9503479003906, 'referece_logps/rejected': -441.79620361328125, 'referece_logps/chosen': -433.0118408203125, 'logits/rejected': -0.09453132003545761, 'logits/chosen': -0.17508085072040558, 'epoch': 0.11}
52

  4%|▎         | 53/1464 [18:31<8:09:09, 20.80s/it]
{'loss': 0.6938, 'learning_rate': 1.999801772578801e-06, 'rewards/chosen': 0.006446266546845436, 'rewards/rejected': 0.016486598178744316, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.01004032976925373, 'policy_logps/rejected': -432.0797119140625, 'policy_logps/chosen': -402.23956298828125, 'referece_logps/rejected': -432.24456787109375, 'referece_logps/chosen': -402.30401611328125, 'logits/rejected': -0.5121382474899292, 'logits/chosen': -0.5992802977561951, 'epoch': 0.11}
53

  4%|▎         | 54/1464 [18:52<8:08:33, 20.79s/it]
{'loss': 0.6888, 'learning_rate': 1.999755276685243e-06, 'rewards/chosen': -0.003559446195140481, 'rewards/rejected': -0.004948711488395929, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.0013892645947635174, 'policy_logps/rejected': -375.478515625, 'policy_logps/chosen': -434.3516540527344, 'referece_logps/rejected': -375.4290466308594, 'referece_logps/chosen': -434.3160400390625, 'logits/rejected': -0.9906054139137268, 'logits/chosen': -0.9731354117393494, 'epoch': 0.11}
54

  4%|▍         | 55/1464 [19:13<8:09:57, 20.86s/it]
{'loss': 0.6812, 'learning_rate': 1.99970388732558e-06, 'rewards/chosen': 0.017076589167118073, 'rewards/rejected': -0.013028623536229134, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.030105212703347206, 'policy_logps/rejected': -392.429443359375, 'policy_logps/chosen': -434.1997375488281, 'referece_logps/rejected': -392.29913330078125, 'referece_logps/chosen': -434.3704833984375, 'logits/rejected': -0.6252284646034241, 'logits/chosen': -0.7477253079414368, 'epoch': 0.11}
55
batch_input_ids: tensor([[    1,   319, 13563,  ...,     0,     0,     0],
        [    1,   319, 13563,  ...,     0,     0,     0],
        [    1,   319, 13563,  ...,     0,     0,     0],
        ...,
        [    1,   319, 13563,  ...,     0,     0,     0],
        [    1,   319, 13563,  ...,     0,     0,     0],
        [    1,   319, 13563,  ...,     0,     0,     0]], device='cuda:0')
batch_labels: tensor([[-100, -100, -100,  ..., -100, -100, -100],
        [-100, -100, -100,  ..., -100, -100, -100],
        [-100, -100, -100,  ..., -100, -100, -100],
        ...,
        [-100, -100, -100,  ..., -100, -100, -100],
        [-100, -100, -100,  ..., -100, -100, -100],
        [-100, -100, -100,  ..., -100, -100, -100]], device='cuda:0')
batch_attention_mask: tensor([[ True,  True,  True,  ..., False, False, False],
        [ True,  True,  True,  ..., False, False, False],
        [ True,  True,  True,  ..., False, False, False],
        ...,
        [ True,  True,  True,  ..., False, False, False],
        [ True,  True,  True,  ..., False, False, False],
        [ True,  True,  True,  ..., False, False, False]], device='cuda:0')
image size:torch.Size([32, 3, 336, 336])
