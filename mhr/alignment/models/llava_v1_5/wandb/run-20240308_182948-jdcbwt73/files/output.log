  0%|          | 0/1464 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:135: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/1464 [00:24<10:05:09, 24.82s/it]

  0%|          | 2/1464 [00:46<9:17:42, 22.89s/it]
{'loss': 0.6931, 'learning_rate': 9.09090909090909e-08, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'policy_logps/rejected': -433.8616638183594, 'policy_logps/chosen': -412.6845397949219, 'referece_logps/rejected': -433.8616638183594, 'referece_logps/chosen': -412.6845397949219, 'logits/rejected': 0.053385090082883835, 'logits/chosen': 0.06789463758468628, 'epoch': 0.0}

  0%|          | 3/1464 [01:08<9:05:05, 22.39s/it]

  0%|          | 4/1464 [01:29<8:51:27, 21.84s/it]


  0%|          | 6/1464 [02:10<8:34:18, 21.17s/it]
{'loss': 0.6925, 'learning_rate': 2.727272727272727e-07, 'rewards/chosen': 0.014961433596909046, 'rewards/rejected': 0.022362137213349342, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.007400703616440296, 'policy_logps/rejected': -357.1881103515625, 'policy_logps/chosen': -315.80279541015625, 'referece_logps/rejected': -357.4117126464844, 'referece_logps/chosen': -315.952392578125, 'logits/rejected': -0.7748501896858215, 'logits/chosen': -0.9233206510543823, 'epoch': 0.01}

  0%|          | 7/1464 [02:31<8:30:09, 21.01s/it]

  1%|          | 8/1464 [02:52<8:31:19, 21.07s/it]

  1%|          | 9/1464 [03:13<8:28:06, 20.95s/it]

  1%|          | 10/1464 [03:33<8:27:21, 20.94s/it]

  1%|          | 11/1464 [03:54<8:27:07, 20.94s/it]

  1%|          | 12/1464 [04:15<8:26:53, 20.95s/it]

  1%|          | 13/1464 [04:36<8:22:50, 20.79s/it]

  1%|          | 14/1464 [04:57<8:23:07, 20.82s/it]

  1%|          | 15/1464 [05:18<8:24:25, 20.89s/it]

  1%|          | 16/1464 [05:39<8:24:17, 20.90s/it]

  1%|          | 17/1464 [05:59<8:22:38, 20.84s/it]

  1%|          | 18/1464 [06:20<8:20:50, 20.78s/it]


  1%|▏         | 20/1464 [07:00<8:10:37, 20.39s/it]
{'loss': 0.6972, 'learning_rate': 9.09090909090909e-07, 'rewards/chosen': 0.011015653610229492, 'rewards/rejected': -0.006642055697739124, 'rewards/accuracies': 0.625, 'rewards/margins': 0.017657708376646042, 'policy_logps/rejected': -391.52362060546875, 'policy_logps/chosen': -332.6759338378906, 'referece_logps/rejected': -391.4571838378906, 'referece_logps/chosen': -332.7861328125, 'logits/rejected': -0.779969334602356, 'logits/chosen': -0.6661187410354614, 'epoch': 0.04}

  1%|▏         | 21/1464 [07:21<8:14:27, 20.56s/it]

  2%|▏         | 22/1464 [07:42<8:17:05, 20.68s/it]

  2%|▏         | 23/1464 [08:03<8:18:56, 20.77s/it]

  2%|▏         | 24/1464 [08:24<8:20:08, 20.84s/it]

  2%|▏         | 25/1464 [08:45<8:20:39, 20.88s/it]

  2%|▏         | 26/1464 [09:06<8:17:39, 20.76s/it]

  2%|▏         | 27/1464 [09:27<8:19:34, 20.86s/it]

  2%|▏         | 28/1464 [09:48<8:19:52, 20.89s/it]

  2%|▏         | 29/1464 [10:08<8:18:16, 20.83s/it]

  2%|▏         | 30/1464 [10:29<8:19:15, 20.89s/it]

  2%|▏         | 31/1464 [10:50<8:17:50, 20.84s/it]

  2%|▏         | 32/1464 [11:11<8:17:57, 20.86s/it]

  2%|▏         | 33/1464 [11:32<8:15:25, 20.77s/it]

  2%|▏         | 34/1464 [11:52<8:15:45, 20.80s/it]

  2%|▏         | 35/1464 [12:14<8:17:14, 20.88s/it]

  2%|▏         | 36/1464 [12:34<8:17:25, 20.90s/it]

  3%|▎         | 37/1464 [12:55<8:15:43, 20.84s/it]

  3%|▎         | 38/1464 [13:16<8:13:33, 20.77s/it]

  3%|▎         | 39/1464 [13:36<8:12:46, 20.75s/it]

  3%|▎         | 40/1464 [13:57<8:11:43, 20.72s/it]

  3%|▎         | 41/1464 [14:18<8:13:28, 20.81s/it]

  3%|▎         | 42/1464 [14:39<8:14:20, 20.86s/it]

  3%|▎         | 43/1464 [15:00<8:12:50, 20.81s/it]


  3%|▎         | 45/1464 [15:40<8:07:30, 20.61s/it]

  3%|▎         | 46/1464 [16:01<8:09:28, 20.71s/it]

  3%|▎         | 47/1464 [16:22<8:07:53, 20.66s/it]

  3%|▎         | 48/1464 [16:43<8:09:19, 20.73s/it]

  3%|▎         | 49/1464 [17:04<8:10:12, 20.79s/it]

  3%|▎         | 50/1464 [17:25<8:10:16, 20.80s/it]

  3%|▎         | 51/1464 [17:45<8:08:43, 20.75s/it]

  4%|▎         | 52/1464 [18:06<8:05:51, 20.65s/it]

  4%|▎         | 53/1464 [18:27<8:07:33, 20.73s/it]

  4%|▎         | 54/1464 [18:47<8:08:09, 20.77s/it]

  4%|▍         | 55/1464 [19:08<8:09:29, 20.84s/it]
