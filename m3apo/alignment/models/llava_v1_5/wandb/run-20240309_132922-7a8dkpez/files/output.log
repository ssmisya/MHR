  0%|          | 0/1464 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:140: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/1464 [00:24<10:04:38, 24.80s/it]

  0%|          | 2/1464 [00:46<9:16:04, 22.82s/it]

  0%|          | 3/1464 [01:08<9:05:05, 22.39s/it]

  0%|          | 4/1464 [01:29<8:51:12, 21.83s/it]

  0%|          | 5/1464 [01:50<8:42:52, 21.50s/it]
{'loss': 0.6968, 'learning_rate': 2.2727272727272726e-07, 'rewards/chosen': -0.019548797979950905, 'rewards/rejected': 0.02198915369808674, 'rewards/accuracies': 0.375, 'rewards/margins': -0.04153795540332794, 'policy_logps/rejected': -378.62530517578125, 'policy_logps/chosen': -390.2362060546875, 'referece_logps/rejected': -378.84521484375, 'referece_logps/chosen': -390.0406799316406, 'logits/rejected': 0.17953428626060486, 'logits/chosen': 0.12658025324344635, 'epoch': 0.01}


  0%|          | 7/1464 [02:31<8:33:36, 21.15s/it]

  1%|          | 8/1464 [02:53<8:35:38, 21.25s/it]

  1%|          | 9/1464 [03:14<8:32:13, 21.12s/it]
{'loss': 0.6879, 'learning_rate': 4.090909090909091e-07, 'rewards/chosen': 0.01317443884909153, 'rewards/rejected': 0.0071228984743356705, 'rewards/accuracies': 0.5, 'rewards/margins': 0.006051540840417147, 'policy_logps/rejected': -330.15509033203125, 'policy_logps/chosen': -337.16748046875, 'referece_logps/rejected': -330.2263488769531, 'referece_logps/chosen': -337.2992248535156, 'logits/rejected': -0.017444901168346405, 'logits/chosen': -0.007393486797809601, 'epoch': 0.02}


  1%|          | 11/1464 [03:55<8:28:43, 21.01s/it]

  1%|          | 12/1464 [04:16<8:27:44, 20.98s/it]

  1%|          | 13/1464 [04:37<8:24:23, 20.86s/it]

  1%|          | 14/1464 [04:57<8:21:51, 20.77s/it]
{'loss': 0.6818, 'learning_rate': 6.363636363636363e-07, 'rewards/chosen': 0.03388075903058052, 'rewards/rejected': 0.002405548468232155, 'rewards/accuracies': 0.75, 'rewards/margins': 0.03147520869970322, 'policy_logps/rejected': -283.01580810546875, 'policy_logps/chosen': -358.75091552734375, 'referece_logps/rejected': -283.03985595703125, 'referece_logps/chosen': -359.0897216796875, 'logits/rejected': -0.22753609716892242, 'logits/chosen': -0.24853360652923584, 'epoch': 0.03}


  1%|          | 16/1464 [05:39<8:23:20, 20.86s/it]

  1%|          | 17/1464 [06:00<8:23:28, 20.88s/it]

  1%|          | 18/1464 [06:21<8:23:15, 20.88s/it]

  1%|▏         | 19/1464 [06:42<8:22:53, 20.88s/it]

  1%|▏         | 20/1464 [07:02<8:13:08, 20.49s/it]
{'loss': 0.6907, 'learning_rate': 9.09090909090909e-07, 'rewards/chosen': -0.005572747439146042, 'rewards/rejected': -0.0006697652861475945, 'rewards/accuracies': 0.5625, 'rewards/margins': -0.004902983549982309, 'policy_logps/rejected': -391.46441650390625, 'policy_logps/chosen': -332.779052734375, 'referece_logps/rejected': -391.457763671875, 'referece_logps/chosen': -332.72332763671875, 'logits/rejected': -0.7751968502998352, 'logits/chosen': -0.6616645455360413, 'epoch': 0.04}


  2%|▏         | 22/1464 [07:43<8:18:12, 20.73s/it]

  2%|▏         | 23/1464 [08:04<8:18:52, 20.77s/it]

  2%|▏         | 24/1464 [08:25<8:19:32, 20.81s/it]

  2%|▏         | 25/1464 [08:46<8:20:11, 20.86s/it]
{'loss': 0.6949, 'learning_rate': 1.1363636363636364e-06, 'rewards/chosen': -0.003508329391479492, 'rewards/rejected': -0.01313166692852974, 'rewards/accuracies': 0.625, 'rewards/margins': 0.009623336605727673, 'policy_logps/rejected': -363.3902893066406, 'policy_logps/chosen': -340.5108337402344, 'referece_logps/rejected': -363.2590026855469, 'referece_logps/chosen': -340.4757385253906, 'logits/rejected': -0.12912048399448395, 'logits/chosen': -0.19616276025772095, 'epoch': 0.05}


  2%|▏         | 27/1464 [09:28<8:18:48, 20.83s/it]
{'loss': 0.6879, 'learning_rate': 1.2272727272727272e-06, 'rewards/chosen': -0.0007254127413034439, 'rewards/rejected': 0.008741569705307484, 'rewards/accuracies': 0.4375, 'rewards/margins': -0.009466982446610928, 'policy_logps/rejected': -450.5242919921875, 'policy_logps/chosen': -355.4007263183594, 'referece_logps/rejected': -450.61175537109375, 'referece_logps/chosen': -355.39349365234375, 'logits/rejected': -0.727083146572113, 'logits/chosen': -0.6976603269577026, 'epoch': 0.06}


  2%|▏         | 29/1464 [10:10<8:19:35, 20.89s/it]

  2%|▏         | 30/1464 [10:31<8:19:41, 20.91s/it]

  2%|▏         | 31/1464 [10:52<8:19:40, 20.92s/it]

  2%|▏         | 32/1464 [11:13<8:19:28, 20.93s/it]

  2%|▏         | 33/1464 [11:33<8:17:51, 20.87s/it]

  2%|▏         | 34/1464 [11:54<8:15:25, 20.79s/it]
{'loss': 0.7029, 'learning_rate': 1.5454545454545454e-06, 'rewards/chosen': -0.0035791387781500816, 'rewards/rejected': -0.015074539929628372, 'rewards/accuracies': 0.5, 'rewards/margins': 0.01149540301412344, 'policy_logps/rejected': -416.5923156738281, 'policy_logps/chosen': -445.810302734375, 'referece_logps/rejected': -416.4416198730469, 'referece_logps/chosen': -445.7745056152344, 'logits/rejected': -0.4860975742340088, 'logits/chosen': -0.5643699765205383, 'epoch': 0.07}


  2%|▏         | 36/1464 [12:36<8:17:03, 20.88s/it]

  3%|▎         | 37/1464 [12:57<8:17:25, 20.91s/it]

  3%|▎         | 38/1464 [13:18<8:16:21, 20.88s/it]

  3%|▎         | 39/1464 [13:39<8:16:34, 20.91s/it]

  3%|▎         | 40/1464 [13:59<8:15:51, 20.89s/it]

  3%|▎         | 41/1464 [14:20<8:16:18, 20.93s/it]

  3%|▎         | 42/1464 [14:41<8:16:28, 20.95s/it]

  3%|▎         | 43/1464 [15:02<8:15:57, 20.94s/it]

  3%|▎         | 44/1464 [15:22<8:04:36, 20.48s/it]

  3%|▎         | 45/1464 [15:43<8:07:24, 20.61s/it]

  3%|▎         | 46/1464 [16:03<8:07:29, 20.63s/it]

  3%|▎         | 47/1464 [16:24<8:07:14, 20.63s/it]

  3%|▎         | 48/1464 [16:45<8:09:12, 20.73s/it]

  3%|▎         | 49/1464 [17:06<8:10:07, 20.78s/it]

  3%|▎         | 50/1464 [17:27<8:10:29, 20.81s/it]

  3%|▎         | 51/1464 [17:48<8:10:04, 20.81s/it]

  4%|▎         | 52/1464 [18:08<8:07:40, 20.72s/it]

  4%|▎         | 53/1464 [18:29<8:08:37, 20.78s/it]

  4%|▎         | 54/1464 [18:50<8:08:00, 20.77s/it]

  4%|▍         | 55/1464 [19:11<8:08:46, 20.81s/it]
