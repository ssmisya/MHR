  0%|          | 0/2685 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:179: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/2685 [00:24<18:00:47, 24.16s/it]
{'loss': 0.6931, 'learning_rate': 2.4691358024691355e-08, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'policy_logps/rejected': -300.2765808105469, 'policy_logps/chosen': -298.5439147949219, 'referece_logps/rejected': -300.2765808105469, 'referece_logps/chosen': -298.5439147949219, 'logits/rejected': -0.020652756094932556, 'logits/chosen': -0.11788778007030487, 'epoch': 0.0}
[2024-03-29 15:32:44,374] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  0%|          | 2/2685 [00:48<18:12:32, 24.43s/it]
[2024-03-29 15:33:08,436] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  0%|          | 3/2685 [01:12<18:04:32, 24.26s/it]

  0%|          | 4/2685 [01:27<15:21:57, 20.63s/it]

  0%|          | 5/2685 [01:50<15:53:04, 21.34s/it]

  0%|          | 6/2685 [02:07<14:53:59, 20.02s/it]

  0%|          | 7/2685 [02:28<14:56:32, 20.09s/it]

  0%|          | 8/2685 [02:48<14:53:26, 20.02s/it]


  0%|          | 10/2685 [03:22<13:42:35, 18.45s/it]
{'loss': 0.6976, 'learning_rate': 2.4691358024691354e-07, 'rewards/chosen': -0.00019941246137022972, 'rewards/rejected': -0.0012631425634026527, 'rewards/accuracies': 0.625, 'rewards/margins': 0.0010637296363711357, 'policy_logps/rejected': -222.01296997070312, 'policy_logps/chosen': -201.47560119628906, 'referece_logps/rejected': -222.00033569335938, 'referece_logps/chosen': -201.47360229492188, 'logits/rejected': -0.5436764359474182, 'logits/chosen': -0.5343648791313171, 'epoch': 0.01}

  0%|          | 11/2685 [03:45<14:32:39, 19.58s/it]

  0%|          | 12/2685 [04:04<14:28:43, 19.50s/it]


  1%|          | 14/2685 [04:44<14:42:32, 19.82s/it]
{'loss': 0.6865, 'learning_rate': 3.45679012345679e-07, 'rewards/chosen': 0.00737724406644702, 'rewards/rejected': -0.004017592407763004, 'rewards/accuracies': 0.625, 'rewards/margins': 0.011394834145903587, 'policy_logps/rejected': -231.13198852539062, 'policy_logps/chosen': -263.9859313964844, 'referece_logps/rejected': -231.09182739257812, 'referece_logps/chosen': -264.0597229003906, 'logits/rejected': -0.6479598879814148, 'logits/chosen': -0.6611508727073669, 'epoch': 0.02}

  1%|          | 15/2685 [05:02<14:12:50, 19.16s/it]

  1%|          | 16/2685 [05:24<14:54:41, 20.11s/it]

  1%|          | 17/2685 [05:43<14:45:49, 19.92s/it]

  1%|          | 18/2685 [06:03<14:38:41, 19.77s/it]

  1%|          | 19/2685 [06:21<14:20:49, 19.37s/it]
[2024-03-29 15:38:38,802] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  1%|          | 21/2685 [07:00<14:16:33, 19.29s/it]
[2024-03-29 15:38:56,480] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6917, 'learning_rate': 5.185185185185185e-07, 'rewards/chosen': -0.0021067631896585226, 'rewards/rejected': -0.019593093544244766, 'rewards/accuracies': 0.75, 'rewards/margins': 0.017486335709691048, 'policy_logps/rejected': -189.04006958007812, 'policy_logps/chosen': -198.40060424804688, 'referece_logps/rejected': -188.8441162109375, 'referece_logps/chosen': -198.3795623779297, 'logits/rejected': -0.7077773809432983, 'logits/chosen': -0.7616188526153564, 'epoch': 0.02}


  1%|          | 23/2685 [07:40<14:27:13, 19.55s/it]
{'loss': 0.6894, 'learning_rate': 5.679012345679012e-07, 'rewards/chosen': 0.00989065133035183, 'rewards/rejected': -0.02521057054400444, 'rewards/accuracies': 0.875, 'rewards/margins': 0.03510122373700142, 'policy_logps/rejected': -240.1916961669922, 'policy_logps/chosen': -248.75192260742188, 'referece_logps/rejected': -239.93960571289062, 'referece_logps/chosen': -248.85084533691406, 'logits/rejected': -0.7969690561294556, 'logits/chosen': -0.7867977619171143, 'epoch': 0.03}

  1%|          | 24/2685 [07:59<14:16:30, 19.31s/it]

  1%|          | 25/2685 [08:21<14:55:16, 20.19s/it]

  1%|          | 26/2685 [08:42<14:58:13, 20.27s/it]

  1%|          | 27/2685 [08:59<14:18:33, 19.38s/it]

  1%|          | 28/2685 [09:21<14:57:45, 20.27s/it]

  1%|          | 29/2685 [09:42<15:01:52, 20.37s/it]


  1%|          | 31/2685 [10:24<15:17:16, 20.74s/it]
{'loss': 0.6924, 'learning_rate': 7.65432098765432e-07, 'rewards/chosen': -0.014336394146084785, 'rewards/rejected': -0.008066178299486637, 'rewards/accuracies': 0.5, 'rewards/margins': -0.006270219571888447, 'policy_logps/rejected': -270.4510192871094, 'policy_logps/chosen': -245.6957244873047, 'referece_logps/rejected': -270.3703918457031, 'referece_logps/chosen': -245.55239868164062, 'logits/rejected': -0.2481730431318283, 'logits/chosen': -0.42688992619514465, 'epoch': 0.03}


  1%|          | 33/2685 [11:09<15:40:13, 21.27s/it]
{'loss': 0.695, 'learning_rate': 8.148148148148147e-07, 'rewards/chosen': 0.006127167027443647, 'rewards/rejected': -0.024864479899406433, 'rewards/accuracies': 0.625, 'rewards/margins': 0.030991651117801666, 'policy_logps/rejected': -231.31680297851562, 'policy_logps/chosen': -239.45489501953125, 'referece_logps/rejected': -231.0681610107422, 'referece_logps/chosen': -239.51617431640625, 'logits/rejected': -1.0459479093551636, 'logits/chosen': -1.0176280736923218, 'epoch': 0.04}

  1%|▏         | 34/2685 [11:31<16:01:20, 21.76s/it]
[2024-03-29 15:43:49,004] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 35/2685 [11:53<15:57:19, 21.68s/it]
[2024-03-29 15:44:11,536] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 36/2685 [12:15<16:08:17, 21.93s/it]

  1%|▏         | 37/2685 [12:36<15:53:16, 21.60s/it]


  1%|▏         | 39/2685 [13:17<15:17:54, 20.81s/it]
{'loss': 0.6946, 'learning_rate': 9.629629629629628e-07, 'rewards/chosen': 0.0017576210666447878, 'rewards/rejected': 0.013526154682040215, 'rewards/accuracies': 0.25, 'rewards/margins': -0.01176853571087122, 'policy_logps/rejected': -230.01998901367188, 'policy_logps/chosen': -206.7452392578125, 'referece_logps/rejected': -230.15524291992188, 'referece_logps/chosen': -206.76283264160156, 'logits/rejected': -0.5126116275787354, 'logits/chosen': -0.4733346700668335, 'epoch': 0.04}

  1%|▏         | 40/2685 [13:40<15:42:53, 21.39s/it]

  2%|▏         | 41/2685 [14:00<15:23:02, 20.95s/it]


  2%|▏         | 43/2685 [14:37<14:39:12, 19.97s/it]
[2024-03-29 15:46:33,066] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 44/2685 [14:57<14:40:15, 20.00s/it]
[2024-03-29 15:46:53,137] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6851, 'learning_rate': 1.0864197530864197e-06, 'rewards/chosen': -0.039446067065000534, 'rewards/rejected': -0.06735000759363174, 'rewards/accuracies': 0.625, 'rewards/margins': 0.027903936803340912, 'policy_logps/rejected': -381.4482116699219, 'policy_logps/chosen': -289.04180908203125, 'referece_logps/rejected': -380.7746887207031, 'referece_logps/chosen': -288.6473693847656, 'logits/rejected': -0.5328398942947388, 'logits/chosen': -0.5346450805664062, 'epoch': 0.05}
[2024-03-29 15:47:12,254] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  2%|▏         | 46/2685 [15:37<14:40:11, 20.01s/it]
{'loss': 0.6882, 'learning_rate': 1.1358024691358024e-06, 'rewards/chosen': -0.03315143659710884, 'rewards/rejected': -0.05826053395867348, 'rewards/accuracies': 0.625, 'rewards/margins': 0.025109101086854935, 'policy_logps/rejected': -411.2437438964844, 'policy_logps/chosen': -452.8231506347656, 'referece_logps/rejected': -410.66107177734375, 'referece_logps/chosen': -452.4916076660156, 'logits/rejected': -0.17076900601387024, 'logits/chosen': -0.1827230453491211, 'epoch': 0.05}

  2%|▏         | 47/2685 [16:00<15:24:21, 21.02s/it]


  2%|▏         | 49/2685 [16:43<15:39:21, 21.38s/it]
{'loss': 0.6779, 'learning_rate': 1.2098765432098765e-06, 'rewards/chosen': -0.02282238006591797, 'rewards/rejected': -0.07013645023107529, 'rewards/accuracies': 0.625, 'rewards/margins': 0.04731407016515732, 'policy_logps/rejected': -343.03265380859375, 'policy_logps/chosen': -323.8548583984375, 'referece_logps/rejected': -342.331298828125, 'referece_logps/chosen': -323.62664794921875, 'logits/rejected': -0.49299007654190063, 'logits/chosen': -0.5482845306396484, 'epoch': 0.05}

  2%|▏         | 50/2685 [17:06<16:02:45, 21.92s/it]

  2%|▏         | 51/2685 [17:29<16:17:08, 22.26s/it]

  2%|▏         | 52/2685 [17:52<16:22:45, 22.39s/it]
[2024-03-29 15:50:10,406] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 53/2685 [18:14<16:21:08, 22.37s/it]

  2%|▏         | 54/2685 [18:33<15:26:58, 21.14s/it]


  2%|▏         | 56/2685 [19:07<14:15:27, 19.52s/it]

  2%|▏         | 57/2685 [19:29<14:46:08, 20.23s/it]

  2%|▏         | 58/2685 [19:49<14:44:17, 20.20s/it]
{'loss': 0.6748, 'learning_rate': 1.4320987654320987e-06, 'rewards/chosen': 0.040136341005563736, 'rewards/rejected': -0.03261976316571236, 'rewards/accuracies': 0.75, 'rewards/margins': 0.07275610417127609, 'policy_logps/rejected': -299.2017822265625, 'policy_logps/chosen': -347.1735534667969, 'referece_logps/rejected': -298.8755798339844, 'referece_logps/chosen': -347.574951171875, 'logits/rejected': -1.0920485258102417, 'logits/chosen': -1.2004539966583252, 'epoch': 0.06}
[2024-03-29 15:52:08,176] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  2%|▏         | 60/2685 [20:29<14:30:09, 19.89s/it]
{'loss': 0.6662, 'learning_rate': 1.4814814814814812e-06, 'rewards/chosen': -0.04374408349394798, 'rewards/rejected': -0.10805686563253403, 'rewards/accuracies': 0.875, 'rewards/margins': 0.06431277096271515, 'policy_logps/rejected': -255.04847717285156, 'policy_logps/chosen': -250.47816467285156, 'referece_logps/rejected': -253.96792602539062, 'referece_logps/chosen': -250.0407257080078, 'logits/rejected': -0.8168105483055115, 'logits/chosen': -0.7315695285797119, 'epoch': 0.07}

  2%|▏         | 61/2685 [20:50<14:45:45, 20.25s/it]


  2%|▏         | 63/2685 [21:33<15:10:20, 20.83s/it]
[2024-03-29 15:53:29,259] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6718, 'learning_rate': 1.5555555555555556e-06, 'rewards/chosen': -0.1475197672843933, 'rewards/rejected': -0.19617822766304016, 'rewards/accuracies': 0.625, 'rewards/margins': 0.04865848273038864, 'policy_logps/rejected': -473.1565246582031, 'policy_logps/chosen': -471.8327941894531, 'referece_logps/rejected': -471.19476318359375, 'referece_logps/chosen': -470.3576354980469, 'logits/rejected': 0.11692936718463898, 'logits/chosen': 0.1090836226940155, 'epoch': 0.07}
[2024-03-29 15:53:50,929] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 64/2685 [21:55<15:20:58, 21.08s/it]

  2%|▏         | 65/2685 [22:13<14:42:23, 20.21s/it]

  2%|▏         | 66/2685 [22:35<15:02:19, 20.67s/it]

  2%|▏         | 67/2685 [22:54<14:49:20, 20.38s/it]

  3%|▎         | 68/2685 [23:14<14:44:05, 20.27s/it]

  3%|▎         | 69/2685 [23:31<13:55:55, 19.17s/it]

  3%|▎         | 70/2685 [23:50<13:49:57, 19.04s/it]
[2024-03-29 15:56:07,864] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  3%|▎         | 71/2685 [24:12<14:27:40, 19.92s/it]


  3%|▎         | 73/2685 [24:50<14:10:05, 19.53s/it]
{'loss': 0.6658, 'learning_rate': 1.8024691358024691e-06, 'rewards/chosen': -0.03366260603070259, 'rewards/rejected': -0.05631818622350693, 'rewards/accuracies': 0.625, 'rewards/margins': 0.022655582055449486, 'policy_logps/rejected': -325.02008056640625, 'policy_logps/chosen': -416.3309631347656, 'referece_logps/rejected': -324.4569091796875, 'referece_logps/chosen': -415.9942932128906, 'logits/rejected': -0.6011357307434082, 'logits/chosen': -0.6527858376502991, 'epoch': 0.08}


  3%|▎         | 75/2685 [25:32<14:38:08, 20.19s/it]
{'loss': 0.6574, 'learning_rate': 1.8518518518518519e-06, 'rewards/chosen': 4.7590117901563644e-05, 'rewards/rejected': -0.1871626079082489, 'rewards/accuracies': 1.0, 'rewards/margins': 0.18721018731594086, 'policy_logps/rejected': -316.7642822265625, 'policy_logps/chosen': -309.80035400390625, 'referece_logps/rejected': -314.8927001953125, 'referece_logps/chosen': -309.8008728027344, 'logits/rejected': 0.0023830514401197433, 'logits/chosen': -0.3370126485824585, 'epoch': 0.08}

  3%|▎         | 76/2685 [25:55<15:11:21, 20.96s/it]

  3%|▎         | 77/2685 [26:15<15:08:34, 20.90s/it]


  3%|▎         | 79/2685 [26:54<14:28:44, 20.00s/it]

  3%|▎         | 80/2685 [27:13<14:23:25, 19.89s/it]

  3%|▎         | 81/2685 [27:32<14:01:24, 19.39s/it]
{'loss': 0.6461, 'learning_rate': 2e-06, 'rewards/chosen': -0.05234060436487198, 'rewards/rejected': -0.14757271111011505, 'rewards/accuracies': 0.875, 'rewards/margins': 0.09523210674524307, 'policy_logps/rejected': -251.39593505859375, 'policy_logps/chosen': -331.6717529296875, 'referece_logps/rejected': -249.92019653320312, 'referece_logps/chosen': -331.1483154296875, 'logits/rejected': -0.6176214218139648, 'logits/chosen': -0.7362290620803833, 'epoch': 0.09}
[2024-03-29 15:59:49,137] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  3%|▎         | 83/2685 [28:17<15:12:07, 21.03s/it]

  3%|▎         | 84/2685 [28:37<15:01:41, 20.80s/it]
[2024-03-29 16:00:32,853] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  3%|▎         | 85/2685 [28:59<15:17:24, 21.17s/it]

  3%|▎         | 86/2685 [29:21<15:25:25, 21.36s/it]
[2024-03-29 16:01:16,704] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6365, 'learning_rate': 1.9999818060715825e-06, 'rewards/chosen': -0.21385669708251953, 'rewards/rejected': -0.4091644287109375, 'rewards/accuracies': 0.875, 'rewards/margins': 0.19530773162841797, 'policy_logps/rejected': -437.000244140625, 'policy_logps/chosen': -373.8921203613281, 'referece_logps/rejected': -432.9085693359375, 'referece_logps/chosen': -371.7535400390625, 'logits/rejected': 0.2340817153453827, 'logits/chosen': 0.2265194207429886, 'epoch': 0.1}
[2024-03-29 16:01:38,171] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  3%|▎         | 88/2685 [30:00<14:40:19, 20.34s/it]

  3%|▎         | 89/2685 [30:24<15:31:48, 21.54s/it]

  3%|▎         | 90/2685 [30:43<14:56:56, 20.74s/it]

  3%|▎         | 91/2685 [31:05<15:14:46, 21.16s/it]

  3%|▎         | 92/2685 [31:21<14:05:02, 19.55s/it]

  3%|▎         | 93/2685 [31:37<13:21:11, 18.55s/it]

  4%|▎         | 94/2685 [31:59<14:02:04, 19.50s/it]

  4%|▎         | 95/2685 [32:19<14:03:35, 19.54s/it]

  4%|▎         | 96/2685 [32:40<14:24:33, 20.04s/it]

  4%|▎         | 97/2685 [32:59<14:13:44, 19.79s/it]
[2024-03-29 16:04:55,178] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▎         | 98/2685 [33:21<14:46:37, 20.56s/it]

  4%|▎         | 99/2685 [33:45<15:26:00, 21.49s/it]

  4%|▎         | 100/2685 [34:06<15:15:11, 21.24s/it]

  4%|▍         | 101/2685 [34:27<15:19:33, 21.35s/it]

  4%|▍         | 102/2685 [34:47<14:56:04, 20.81s/it]
[2024-03-29 16:06:43,019] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 103/2685 [35:08<14:53:45, 20.77s/it]

  4%|▍         | 104/2685 [35:26<14:27:45, 20.17s/it]

  4%|▍         | 105/2685 [35:47<14:27:41, 20.18s/it]

  4%|▍         | 106/2685 [36:10<15:12:48, 21.24s/it]
[2024-03-29 16:08:06,358] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 107/2685 [36:34<15:42:13, 21.93s/it]

  4%|▍         | 108/2685 [36:53<15:06:30, 21.11s/it]
[2024-03-29 16:08:49,091] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 109/2685 [37:13<14:54:39, 20.84s/it]
[2024-03-29 16:09:09,304] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 110/2685 [37:32<14:31:14, 20.30s/it]
[2024-03-29 16:09:28,351] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 111/2685 [37:48<13:29:23, 18.87s/it]

  4%|▍         | 112/2685 [38:05<13:06:24, 18.34s/it]

  4%|▍         | 113/2685 [38:27<13:55:35, 19.49s/it]

  4%|▍         | 114/2685 [38:50<14:36:51, 20.46s/it]
[2024-03-29 16:10:45,891] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 115/2685 [39:12<14:52:44, 20.84s/it]

  4%|▍         | 116/2685 [39:33<14:59:41, 21.01s/it]

  4%|▍         | 117/2685 [39:55<15:18:56, 21.47s/it]

  4%|▍         | 118/2685 [40:19<15:40:27, 21.98s/it]

  4%|▍         | 119/2685 [40:39<15:13:19, 21.36s/it]

  4%|▍         | 120/2685 [40:58<14:49:10, 20.80s/it]

  5%|▍         | 121/2685 [41:20<15:05:42, 21.19s/it]

  5%|▍         | 122/2685 [41:41<15:03:36, 21.15s/it]

  5%|▍         | 123/2685 [42:02<14:53:13, 20.92s/it]

  5%|▍         | 124/2685 [42:18<13:54:30, 19.55s/it]

  5%|▍         | 125/2685 [42:38<14:06:39, 19.84s/it]

  5%|▍         | 126/2685 [42:56<13:42:53, 19.29s/it]

  5%|▍         | 127/2685 [43:18<14:05:24, 19.83s/it]

  5%|▍         | 128/2685 [43:37<13:57:38, 19.66s/it]

  5%|▍         | 129/2685 [43:58<14:15:31, 20.08s/it]

  5%|▍         | 130/2685 [44:18<14:19:22, 20.18s/it]

  5%|▍         | 131/2685 [44:36<13:46:52, 19.43s/it]

  5%|▍         | 132/2685 [44:57<14:11:24, 20.01s/it]

  5%|▍         | 133/2685 [45:13<13:17:43, 18.76s/it]

  5%|▍         | 134/2685 [45:36<14:11:05, 20.02s/it]

  5%|▌         | 135/2685 [45:58<14:30:26, 20.48s/it]

  5%|▌         | 136/2685 [46:22<15:16:22, 21.57s/it]

  5%|▌         | 137/2685 [46:44<15:30:06, 21.90s/it]

  5%|▌         | 138/2685 [47:03<14:44:03, 20.83s/it]

  5%|▌         | 139/2685 [47:21<14:14:18, 20.13s/it]

  5%|▌         | 140/2685 [47:39<13:44:24, 19.44s/it]

  5%|▌         | 141/2685 [47:59<13:55:01, 19.69s/it]

  5%|▌         | 142/2685 [48:22<14:26:12, 20.44s/it]

  5%|▌         | 143/2685 [48:41<14:10:46, 20.08s/it]

  5%|▌         | 144/2685 [49:01<14:12:18, 20.13s/it]

  5%|▌         | 145/2685 [49:18<13:37:36, 19.31s/it]

  5%|▌         | 146/2685 [49:42<14:30:36, 20.57s/it]

  5%|▌         | 147/2685 [50:02<14:25:21, 20.46s/it]

  6%|▌         | 148/2685 [50:23<14:25:12, 20.46s/it]

  6%|▌         | 149/2685 [50:44<14:31:18, 20.61s/it]
[2024-03-29 16:22:39,727] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 150/2685 [51:02<14:02:46, 19.95s/it]
{'loss': 0.556, 'learning_rate': 1.9965371381818598e-06, 'rewards/chosen': 0.44903069734573364, 'rewards/rejected': -0.29618191719055176, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7452126741409302, 'policy_logps/rejected': -303.860595703125, 'policy_logps/chosen': -183.1876678466797, 'referece_logps/rejected': -300.89874267578125, 'referece_logps/chosen': -187.67796325683594, 'logits/rejected': -0.7956593036651611, 'logits/chosen': -0.7005979418754578, 'epoch': 0.17}


  6%|▌         | 152/2685 [51:34<12:41:37, 18.04s/it]

  6%|▌         | 153/2685 [51:57<13:46:10, 19.58s/it]

  6%|▌         | 154/2685 [52:19<14:11:37, 20.19s/it]

  6%|▌         | 155/2685 [52:38<13:58:51, 19.89s/it]

  6%|▌         | 156/2685 [52:58<13:56:19, 19.84s/it]

  6%|▌         | 157/2685 [53:18<13:58:17, 19.90s/it]

  6%|▌         | 158/2685 [53:41<14:34:03, 20.75s/it]

  6%|▌         | 159/2685 [53:58<13:49:53, 19.71s/it]

  6%|▌         | 160/2685 [54:20<14:15:59, 20.34s/it]

  6%|▌         | 161/2685 [54:44<14:58:32, 21.36s/it]

  6%|▌         | 162/2685 [55:01<14:06:09, 20.12s/it]

  6%|▌         | 163/2685 [55:19<13:45:24, 19.64s/it]

  6%|▌         | 164/2685 [55:41<14:08:45, 20.20s/it]

  6%|▌         | 165/2685 [56:01<14:08:01, 20.19s/it]

  6%|▌         | 166/2685 [56:22<14:17:54, 20.43s/it]

  6%|▌         | 167/2685 [56:42<14:06:53, 20.18s/it]

  6%|▋         | 168/2685 [57:02<14:04:16, 20.13s/it]

  6%|▋         | 169/2685 [57:23<14:20:39, 20.52s/it]

  6%|▋         | 170/2685 [57:43<14:14:02, 20.37s/it]

  6%|▋         | 171/2685 [58:05<14:28:43, 20.73s/it]

  6%|▋         | 172/2685 [58:25<14:29:42, 20.76s/it]

  6%|▋         | 173/2685 [58:39<12:57:51, 18.58s/it]

  6%|▋         | 174/2685 [59:00<13:31:29, 19.39s/it]

  7%|▋         | 175/2685 [59:21<13:49:44, 19.83s/it]

  7%|▋         | 176/2685 [59:41<13:46:35, 19.77s/it]

  7%|▋         | 177/2685 [59:56<12:54:51, 18.54s/it]

  7%|▋         | 178/2685 [1:00:18<13:29:25, 19.37s/it]

  7%|▋         | 179/2685 [1:00:37<13:27:56, 19.34s/it]

  7%|▋         | 180/2685 [1:00:55<13:16:01, 19.07s/it]

  7%|▋         | 181/2685 [1:01:15<13:24:17, 19.27s/it]

  7%|▋         | 182/2685 [1:01:34<13:14:12, 19.04s/it]

  7%|▋         | 183/2685 [1:01:51<12:59:28, 18.69s/it]

  7%|▋         | 184/2685 [1:02:13<13:36:21, 19.58s/it]

  7%|▋         | 185/2685 [1:02:35<14:03:29, 20.24s/it]

  7%|▋         | 186/2685 [1:03:00<15:02:38, 21.67s/it]

  7%|▋         | 187/2685 [1:03:22<15:07:20, 21.79s/it]

  7%|▋         | 188/2685 [1:03:43<14:58:51, 21.60s/it]
{'loss': 0.5015, 'learning_rate': 1.9916794475458213e-06, 'rewards/chosen': 0.239418625831604, 'rewards/rejected': -0.7727958559989929, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0122145414352417, 'policy_logps/rejected': -282.5769348144531, 'policy_logps/chosen': -326.0340881347656, 'referece_logps/rejected': -274.8489990234375, 'referece_logps/chosen': -328.4283142089844, 'logits/rejected': -1.0906970500946045, 'logits/chosen': -1.2455527782440186, 'epoch': 0.21}


  7%|▋         | 190/2685 [1:04:17<13:22:49, 19.31s/it]

  7%|▋         | 191/2685 [1:04:42<14:23:22, 20.77s/it]

  7%|▋         | 192/2685 [1:05:03<14:31:02, 20.96s/it]
{'loss': 0.4167, 'learning_rate': 1.99104666947401e-06, 'rewards/chosen': -0.7710068225860596, 'rewards/rejected': -1.9004665613174438, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1294598579406738, 'policy_logps/rejected': -316.9374084472656, 'policy_logps/chosen': -282.9353332519531, 'referece_logps/rejected': -297.9327697753906, 'referece_logps/chosen': -275.22528076171875, 'logits/rejected': -0.804010272026062, 'logits/chosen': -0.7013604044914246, 'epoch': 0.21}


  7%|▋         | 194/2685 [1:05:48<15:02:08, 21.73s/it]
{'loss': 0.4096, 'learning_rate': 1.9907216245912e-06, 'rewards/chosen': -0.14646300673484802, 'rewards/rejected': -1.2229324579238892, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0764694213867188, 'policy_logps/rejected': -240.18336486816406, 'policy_logps/chosen': -168.12449645996094, 'referece_logps/rejected': -227.9540252685547, 'referece_logps/chosen': -166.6598663330078, 'logits/rejected': -0.6825249195098877, 'logits/chosen': -0.7457173466682434, 'epoch': 0.22}


  7%|▋         | 196/2685 [1:06:31<15:01:06, 21.72s/it]
{'loss': 0.3664, 'learning_rate': 1.990390811655836e-06, 'rewards/chosen': -1.2316807508468628, 'rewards/rejected': -3.2171571254730225, 'rewards/accuracies': 1.0, 'rewards/margins': 1.9854763746261597, 'policy_logps/rejected': -549.8674926757812, 'policy_logps/chosen': -423.1612243652344, 'referece_logps/rejected': -517.6959228515625, 'referece_logps/chosen': -410.8444519042969, 'logits/rejected': 0.4002912938594818, 'logits/chosen': 0.4106045365333557, 'epoch': 0.22}

  7%|▋         | 197/2685 [1:06:52<14:52:16, 21.52s/it]


  7%|▋         | 199/2685 [1:07:36<14:51:18, 21.51s/it]

  7%|▋         | 200/2685 [1:07:58<15:04:36, 21.84s/it]
{'loss': 0.4451, 'learning_rate': 1.9897118893650822e-06, 'rewards/chosen': -0.5740667581558228, 'rewards/rejected': -2.0236222743988037, 'rewards/accuracies': 0.875, 'rewards/margins': 1.449555516242981, 'policy_logps/rejected': -414.02362060546875, 'policy_logps/chosen': -374.97467041015625, 'referece_logps/rejected': -393.78741455078125, 'referece_logps/chosen': -369.2339782714844, 'logits/rejected': -0.9385246634483337, 'logits/chosen': -0.9208572506904602, 'epoch': 0.22}


  8%|▊         | 202/2685 [1:08:40<14:39:15, 21.25s/it]
{'loss': 0.5182, 'learning_rate': 1.989363783962427e-06, 'rewards/chosen': -1.1600514650344849, 'rewards/rejected': -1.6548211574554443, 'rewards/accuracies': 0.625, 'rewards/margins': 0.49476975202560425, 'policy_logps/rejected': -373.40325927734375, 'policy_logps/chosen': -280.36761474609375, 'referece_logps/rejected': -356.85504150390625, 'referece_logps/chosen': -268.76708984375, 'logits/rejected': -0.7506556510925293, 'logits/chosen': -0.8073704242706299, 'epoch': 0.23}

  8%|▊         | 203/2685 [1:09:03<14:57:05, 21.69s/it]

  8%|▊         | 204/2685 [1:09:25<14:59:28, 21.75s/it]

  8%|▊         | 205/2685 [1:09:43<14:10:57, 20.59s/it]

  8%|▊         | 206/2685 [1:10:03<14:07:05, 20.50s/it]


  8%|▊         | 208/2685 [1:10:39<13:17:15, 19.31s/it]

  8%|▊         | 209/2685 [1:11:02<13:58:56, 20.33s/it]

  8%|▊         | 210/2685 [1:11:22<13:59:13, 20.35s/it]

  8%|▊         | 211/2685 [1:11:44<14:08:15, 20.57s/it]
{'loss': 0.4845, 'learning_rate': 1.9877260578770603e-06, 'rewards/chosen': -0.6398205757141113, 'rewards/rejected': -1.8533774614334106, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2135570049285889, 'policy_logps/rejected': -375.8470153808594, 'policy_logps/chosen': -302.2664489746094, 'referece_logps/rejected': -357.313232421875, 'referece_logps/chosen': -295.8682556152344, 'logits/rejected': 0.0323110856115818, 'logits/chosen': 0.0054308511316776276, 'epoch': 0.24}


  8%|▊         | 213/2685 [1:12:27<14:27:46, 21.06s/it]

  8%|▊         | 214/2685 [1:12:49<14:36:45, 21.29s/it]

  8%|▊         | 215/2685 [1:13:08<14:12:14, 20.70s/it]

  8%|▊         | 216/2685 [1:13:26<13:44:52, 20.05s/it]
[2024-03-29 16:45:22,466] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 217/2685 [1:13:46<13:40:47, 19.95s/it]

  8%|▊         | 218/2685 [1:14:06<13:41:36, 19.98s/it]

  8%|▊         | 219/2685 [1:14:28<14:06:59, 20.61s/it]
{'loss': 0.4647, 'learning_rate': 1.986172535551382e-06, 'rewards/chosen': -0.07726795226335526, 'rewards/rejected': -1.7335922718048096, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6563243865966797, 'policy_logps/rejected': -251.170166015625, 'policy_logps/chosen': -254.7469482421875, 'referece_logps/rejected': -233.83425903320312, 'referece_logps/chosen': -253.97427368164062, 'logits/rejected': -0.258659690618515, 'logits/chosen': -0.3203461766242981, 'epoch': 0.24}
[2024-03-29 16:46:45,439] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 220/2685 [1:14:49<14:12:54, 20.76s/it]

  8%|▊         | 221/2685 [1:15:11<14:23:17, 21.02s/it]
[2024-03-29 16:47:27,293] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 222/2685 [1:15:31<14:13:06, 20.78s/it]


  8%|▊         | 224/2685 [1:16:14<14:31:30, 21.25s/it]
{'loss': 0.5698, 'learning_rate': 1.985154924659352e-06, 'rewards/chosen': -0.6867451071739197, 'rewards/rejected': -1.705728530883789, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0189833641052246, 'policy_logps/rejected': -392.948486328125, 'policy_logps/chosen': -403.9306640625, 'referece_logps/rejected': -375.89117431640625, 'referece_logps/chosen': -397.0632019042969, 'logits/rejected': -0.516793966293335, 'logits/chosen': -0.5562387108802795, 'epoch': 0.25}


  8%|▊         | 226/2685 [1:16:55<14:10:07, 20.74s/it]

  8%|▊         | 227/2685 [1:17:14<13:53:38, 20.35s/it]
[2024-03-29 16:49:10,423] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 228/2685 [1:17:32<13:22:44, 19.60s/it]
{'loss': 0.3713, 'learning_rate': 1.9843150237975342e-06, 'rewards/chosen': -0.5097929239273071, 'rewards/rejected': -1.8360247611999512, 'rewards/accuracies': 1.0, 'rewards/margins': 1.3262320756912231, 'policy_logps/rejected': -304.3404846191406, 'policy_logps/chosen': -268.0788879394531, 'referece_logps/rejected': -285.9802551269531, 'referece_logps/chosen': -262.98095703125, 'logits/rejected': -0.5965636372566223, 'logits/chosen': -0.6657446622848511, 'epoch': 0.25}

  9%|▊         | 229/2685 [1:17:47<12:25:18, 18.21s/it]


  9%|▊         | 231/2685 [1:18:26<12:55:00, 18.95s/it]
[2024-03-29 16:50:22,221] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▊         | 232/2685 [1:18:47<13:18:47, 19.54s/it]

  9%|▊         | 233/2685 [1:19:08<13:37:50, 20.01s/it]

  9%|▊         | 234/2685 [1:19:29<13:45:45, 20.21s/it]
{'loss': 0.4331, 'learning_rate': 1.9830121981793168e-06, 'rewards/chosen': -0.19624799489974976, 'rewards/rejected': -1.537188172340393, 'rewards/accuracies': 1.0, 'rewards/margins': 1.3409401178359985, 'policy_logps/rejected': -347.8102111816406, 'policy_logps/chosen': -310.7085876464844, 'referece_logps/rejected': -332.4383239746094, 'referece_logps/chosen': -308.74609375, 'logits/rejected': -0.9602124691009521, 'logits/chosen': -0.9933344125747681, 'epoch': 0.26}
[2024-03-29 16:51:45,918] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 235/2685 [1:19:50<13:54:47, 20.44s/it]


  9%|▉         | 237/2685 [1:20:33<14:15:34, 20.97s/it]
{'loss': 0.5057, 'learning_rate': 1.982341465382029e-06, 'rewards/chosen': -0.17508649826049805, 'rewards/rejected': -2.343153238296509, 'rewards/accuracies': 1.0, 'rewards/margins': 2.16806697845459, 'policy_logps/rejected': -438.71533203125, 'policy_logps/chosen': -355.6716613769531, 'referece_logps/rejected': -415.28375244140625, 'referece_logps/chosen': -353.9207763671875, 'logits/rejected': -0.5675094127655029, 'logits/chosen': -0.4925234317779541, 'epoch': 0.26}

  9%|▉         | 238/2685 [1:20:58<15:05:29, 22.20s/it]


  9%|▉         | 240/2685 [1:21:39<14:25:03, 21.23s/it]
{'loss': 0.4049, 'learning_rate': 1.9816578642515498e-06, 'rewards/chosen': -0.5256226658821106, 'rewards/rejected': -1.8655630350112915, 'rewards/accuracies': 1.0, 'rewards/margins': 1.3399403095245361, 'policy_logps/rejected': -310.3905334472656, 'policy_logps/chosen': -215.61376953125, 'referece_logps/rejected': -291.7348937988281, 'referece_logps/chosen': -210.3575439453125, 'logits/rejected': -0.8314179182052612, 'logits/chosen': -0.7652269601821899, 'epoch': 0.27}

  9%|▉         | 241/2685 [1:22:02<14:47:56, 21.80s/it]


  9%|▉         | 243/2685 [1:22:43<14:21:15, 21.16s/it]

  9%|▉         | 244/2685 [1:23:07<14:51:38, 21.92s/it]

  9%|▉         | 245/2685 [1:23:30<15:12:46, 22.45s/it]

  9%|▉         | 246/2685 [1:23:50<14:44:34, 21.76s/it]

  9%|▉         | 247/2685 [1:24:10<14:24:05, 21.27s/it]

  9%|▉         | 248/2685 [1:24:33<14:33:43, 21.51s/it]

  9%|▉         | 249/2685 [1:24:55<14:50:03, 21.92s/it]
{'loss': 0.3663, 'learning_rate': 1.9795299412524945e-06, 'rewards/chosen': -0.992339551448822, 'rewards/rejected': -2.0177526473999023, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0254132747650146, 'policy_logps/rejected': -442.9652099609375, 'policy_logps/chosen': -346.9832763671875, 'referece_logps/rejected': -422.7877197265625, 'referece_logps/chosen': -337.05987548828125, 'logits/rejected': -1.0545148849487305, 'logits/chosen': -1.1577272415161133, 'epoch': 0.28}


  9%|▉         | 251/2685 [1:25:39<14:41:04, 21.72s/it]

  9%|▉         | 252/2685 [1:25:59<14:19:50, 21.20s/it]

  9%|▉         | 253/2685 [1:26:15<13:15:01, 19.61s/it]

  9%|▉         | 254/2685 [1:26:33<13:02:44, 19.32s/it]

  9%|▉         | 255/2685 [1:26:53<13:07:55, 19.45s/it]
{'loss': 0.3961, 'learning_rate': 1.978047152917466e-06, 'rewards/chosen': -0.31647032499313354, 'rewards/rejected': -1.033026933670044, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7165566086769104, 'policy_logps/rejected': -227.15945434570312, 'policy_logps/chosen': -193.93765258789062, 'referece_logps/rejected': -216.8291778564453, 'referece_logps/chosen': -190.77296447753906, 'logits/rejected': -0.9445710778236389, 'logits/chosen': -1.046180009841919, 'epoch': 0.28}

 10%|▉         | 256/2685 [1:27:16<13:53:19, 20.58s/it]

 10%|▉         | 257/2685 [1:27:36<13:43:14, 20.34s/it]

 10%|▉         | 258/2685 [1:28:00<14:23:59, 21.36s/it]

 10%|▉         | 259/2685 [1:28:16<13:20:12, 19.79s/it]


 10%|▉         | 261/2685 [1:28:57<13:42:49, 20.37s/it]
{'loss': 0.4636, 'learning_rate': 1.976513116433534e-06, 'rewards/chosen': -0.66986483335495, 'rewards/rejected': -0.8630894422531128, 'rewards/accuracies': 0.625, 'rewards/margins': 0.19322460889816284, 'policy_logps/rejected': -229.6440887451172, 'policy_logps/chosen': -195.6207733154297, 'referece_logps/rejected': -221.01318359375, 'referece_logps/chosen': -188.92210388183594, 'logits/rejected': -0.6000810861587524, 'logits/chosen': -0.5673090815544128, 'epoch': 0.29}


 10%|▉         | 263/2685 [1:29:38<13:48:15, 20.52s/it]
{'loss': 0.4154, 'learning_rate': 1.9759903962771154e-06, 'rewards/chosen': -0.9352105259895325, 'rewards/rejected': -2.2844369411468506, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3492265939712524, 'policy_logps/rejected': -279.85198974609375, 'policy_logps/chosen': -260.39190673828125, 'referece_logps/rejected': -257.0075988769531, 'referece_logps/chosen': -251.039794921875, 'logits/rejected': -1.1015180349349976, 'logits/chosen': -0.9445723295211792, 'epoch': 0.29}


 10%|▉         | 265/2685 [1:30:21<14:15:11, 21.20s/it]

 10%|▉         | 266/2685 [1:30:42<14:09:44, 21.08s/it]

 10%|▉         | 267/2685 [1:31:05<14:33:46, 21.68s/it]
{'loss': 0.4173, 'learning_rate': 1.9749279121818236e-06, 'rewards/chosen': -1.0288702249526978, 'rewards/rejected': -2.22871470451355, 'rewards/accuracies': 0.75, 'rewards/margins': 1.199844479560852, 'policy_logps/rejected': -328.2415771484375, 'policy_logps/chosen': -293.2263488769531, 'referece_logps/rejected': -305.9544677734375, 'referece_logps/chosen': -282.9376525878906, 'logits/rejected': -0.1667097508907318, 'logits/chosen': -0.25025758147239685, 'epoch': 0.3}


 10%|█         | 269/2685 [1:31:40<13:06:53, 19.54s/it]

 10%|█         | 270/2685 [1:32:01<13:31:01, 20.15s/it]

 10%|█         | 271/2685 [1:32:23<13:52:42, 20.70s/it]

 10%|█         | 272/2685 [1:32:44<13:46:47, 20.56s/it]

 10%|█         | 273/2685 [1:33:06<14:04:13, 21.00s/it]

 10%|█         | 274/2685 [1:33:27<14:08:43, 21.12s/it]

 10%|█         | 275/2685 [1:33:45<13:31:18, 20.20s/it]

 10%|█         | 276/2685 [1:34:02<12:48:04, 19.13s/it]

 10%|█         | 277/2685 [1:34:20<12:33:20, 18.77s/it]

 10%|█         | 278/2685 [1:34:42<13:18:13, 19.90s/it]

 10%|█         | 279/2685 [1:35:01<13:08:17, 19.66s/it]
{'loss': 0.3868, 'learning_rate': 1.971604335300769e-06, 'rewards/chosen': -0.6267660856246948, 'rewards/rejected': -1.0476980209350586, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4209320545196533, 'policy_logps/rejected': -214.4366912841797, 'policy_logps/chosen': -207.75120544433594, 'referece_logps/rejected': -203.959716796875, 'referece_logps/chosen': -201.4835662841797, 'logits/rejected': -0.45526033639907837, 'logits/chosen': -0.3239440321922302, 'epoch': 0.31}

 10%|█         | 280/2685 [1:35:22<13:23:45, 20.05s/it]


 11%|█         | 282/2685 [1:35:55<12:12:13, 18.28s/it]
{'loss': 0.3259, 'learning_rate': 1.9707415942506726e-06, 'rewards/chosen': -0.25337088108062744, 'rewards/rejected': -1.1561989784240723, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9028281569480896, 'policy_logps/rejected': -318.247314453125, 'policy_logps/chosen': -208.33755493164062, 'referece_logps/rejected': -306.6853332519531, 'referece_logps/chosen': -205.80384826660156, 'logits/rejected': -0.4112032651901245, 'logits/chosen': -0.44113075733184814, 'epoch': 0.32}

 11%|█         | 283/2685 [1:36:17<12:55:17, 19.37s/it]


 11%|█         | 285/2685 [1:36:58<13:18:58, 19.97s/it]
[2024-03-29 17:08:54,188] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 286/2685 [1:37:16<12:56:22, 19.42s/it]
{'loss': 0.4399, 'learning_rate': 1.969571493794069e-06, 'rewards/chosen': -1.295947790145874, 'rewards/rejected': -2.116549491882324, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8206017017364502, 'policy_logps/rejected': -434.214111328125, 'policy_logps/chosen': -548.0704345703125, 'referece_logps/rejected': -413.048583984375, 'referece_logps/chosen': -535.1109619140625, 'logits/rejected': 0.2774796485900879, 'logits/chosen': 0.3338673710823059, 'epoch': 0.32}

 11%|█         | 287/2685 [1:37:33<12:24:15, 18.62s/it]

 11%|█         | 288/2685 [1:37:55<12:59:56, 19.52s/it]


 11%|█         | 290/2685 [1:38:34<13:05:28, 19.68s/it]
{'loss': 0.4321, 'learning_rate': 1.9683788137104436e-06, 'rewards/chosen': 0.09762629121541977, 'rewards/rejected': -2.2587814331054688, 'rewards/accuracies': 1.0, 'rewards/margins': 2.356407642364502, 'policy_logps/rejected': -325.2775573730469, 'policy_logps/chosen': -330.230712890625, 'referece_logps/rejected': -302.689697265625, 'referece_logps/chosen': -331.2069396972656, 'logits/rejected': -0.7658559679985046, 'logits/chosen': -0.8060760498046875, 'epoch': 0.32}

 11%|█         | 291/2685 [1:38:51<12:37:21, 18.98s/it]

 11%|█         | 292/2685 [1:39:14<13:15:14, 19.94s/it]

 11%|█         | 293/2685 [1:39:34<13:16:53, 19.99s/it]

 11%|█         | 294/2685 [1:39:53<13:05:05, 19.70s/it]

 11%|█         | 295/2685 [1:40:11<12:45:26, 19.22s/it]


 11%|█         | 297/2685 [1:40:52<13:13:12, 19.93s/it]
{'loss': 0.5025, 'learning_rate': 1.966237375176093e-06, 'rewards/chosen': -0.8508166670799255, 'rewards/rejected': -2.8999338150024414, 'rewards/accuracies': 0.75, 'rewards/margins': 2.04911732673645, 'policy_logps/rejected': -314.65936279296875, 'policy_logps/chosen': -342.692138671875, 'referece_logps/rejected': -285.6600036621094, 'referece_logps/chosen': -334.1839294433594, 'logits/rejected': -1.287967324256897, 'logits/chosen': -1.2623683214187622, 'epoch': 0.33}

 11%|█         | 298/2685 [1:41:13<13:22:56, 20.18s/it]


 11%|█         | 300/2685 [1:41:54<13:28:43, 20.35s/it]
{'loss': 0.4198, 'learning_rate': 1.96529851120177e-06, 'rewards/chosen': -1.2922108173370361, 'rewards/rejected': -3.1446495056152344, 'rewards/accuracies': 1.0, 'rewards/margins': 1.8524389266967773, 'policy_logps/rejected': -383.5376281738281, 'policy_logps/chosen': -306.8024597167969, 'referece_logps/rejected': -352.0910949707031, 'referece_logps/chosen': -293.88037109375, 'logits/rejected': -1.1576948165893555, 'logits/chosen': -1.0690205097198486, 'epoch': 0.34}


 11%|█         | 302/2685 [1:42:32<13:01:52, 19.69s/it]
{'loss': 0.3971, 'learning_rate': 1.9646655760771114e-06, 'rewards/chosen': -0.6532554626464844, 'rewards/rejected': -1.54119074344635, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8879352807998657, 'policy_logps/rejected': -302.3594665527344, 'policy_logps/chosen': -233.7412109375, 'referece_logps/rejected': -286.9476013183594, 'referece_logps/chosen': -227.20864868164062, 'logits/rejected': -1.232810616493225, 'logits/chosen': -1.1781460046768188, 'epoch': 0.34}


 11%|█▏        | 304/2685 [1:43:12<13:06:06, 19.81s/it]

 11%|█▏        | 305/2685 [1:43:33<13:15:17, 20.05s/it]

 11%|█▏        | 306/2685 [1:43:52<13:11:35, 19.96s/it]
{'loss': 0.3162, 'learning_rate': 1.9633828604883905e-06, 'rewards/chosen': -0.9009678363800049, 'rewards/rejected': -2.1412644386291504, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2402963638305664, 'policy_logps/rejected': -273.0639953613281, 'policy_logps/chosen': -243.990478515625, 'referece_logps/rejected': -251.65133666992188, 'referece_logps/chosen': -234.9807891845703, 'logits/rejected': -0.9666924476623535, 'logits/chosen': -0.818757951259613, 'epoch': 0.34}

 11%|█▏        | 307/2685 [1:44:09<12:35:37, 19.07s/it]


 12%|█▏        | 309/2685 [1:44:48<12:45:40, 19.34s/it]

 12%|█▏        | 310/2685 [1:45:08<12:53:02, 19.53s/it]

 12%|█▏        | 311/2685 [1:45:29<13:04:05, 19.82s/it]
{'loss': 0.2902, 'learning_rate': 1.9617479196246115e-06, 'rewards/chosen': -0.9337071776390076, 'rewards/rejected': -2.9983935356140137, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0646862983703613, 'policy_logps/rejected': -276.22186279296875, 'policy_logps/chosen': -221.79893493652344, 'referece_logps/rejected': -246.2379150390625, 'referece_logps/chosen': -212.4618377685547, 'logits/rejected': -0.6214367747306824, 'logits/chosen': -0.625908374786377, 'epoch': 0.35}
[2024-03-29 17:17:45,099] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 12%|█▏        | 313/2685 [1:46:09<13:05:37, 19.87s/it]
[2024-03-29 17:18:04,737] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.3314, 'learning_rate': 1.9610841410399665e-06, 'rewards/chosen': -0.6303642392158508, 'rewards/rejected': -1.9222406148910522, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2918765544891357, 'policy_logps/rejected': -329.4395751953125, 'policy_logps/chosen': -317.4916687011719, 'referece_logps/rejected': -310.2171630859375, 'referece_logps/chosen': -311.18804931640625, 'logits/rejected': -1.30161452293396, 'logits/chosen': -1.2845207452774048, 'epoch': 0.35}

 12%|█▏        | 314/2685 [1:46:30<13:23:21, 20.33s/it]


 12%|█▏        | 316/2685 [1:47:10<13:16:23, 20.17s/it]
{'loss': 0.3942, 'learning_rate': 1.9600779828152223e-06, 'rewards/chosen': -0.5540209412574768, 'rewards/rejected': -1.7116684913635254, 'rewards/accuracies': 0.625, 'rewards/margins': 1.1576474905014038, 'policy_logps/rejected': -462.5038757324219, 'policy_logps/chosen': -391.2386169433594, 'referece_logps/rejected': -445.3872375488281, 'referece_logps/chosen': -385.69842529296875, 'logits/rejected': -0.6879220008850098, 'logits/chosen': -0.8218865394592285, 'epoch': 0.35}

 12%|█▏        | 317/2685 [1:47:31<13:21:19, 20.30s/it]

 12%|█▏        | 318/2685 [1:47:45<12:05:25, 18.39s/it]

 12%|█▏        | 319/2685 [1:48:06<12:32:13, 19.08s/it]

 12%|█▏        | 320/2685 [1:48:24<12:18:03, 18.72s/it]

 12%|█▏        | 321/2685 [1:48:46<13:02:31, 19.86s/it]

 12%|█▏        | 322/2685 [1:49:03<12:32:42, 19.11s/it]
[2024-03-29 17:21:21,514] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 12%|█▏        | 324/2685 [1:49:43<12:35:46, 19.21s/it]
{'loss': 0.3993, 'learning_rate': 1.957333444499832e-06, 'rewards/chosen': -1.0528233051300049, 'rewards/rejected': -2.352436065673828, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2996126413345337, 'policy_logps/rejected': -189.22091674804688, 'policy_logps/chosen': -199.40802001953125, 'referece_logps/rejected': -165.69659423828125, 'referece_logps/chosen': -188.87979125976562, 'logits/rejected': -0.5864359140396118, 'logits/chosen': -0.6251242160797119, 'epoch': 0.36}
[2024-03-29 17:21:59,736] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 325/2685 [1:50:04<12:54:10, 19.68s/it]
[2024-03-29 17:22:20,379] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 12%|█▏        | 327/2685 [1:50:43<12:49:14, 19.57s/it]

 12%|█▏        | 328/2685 [1:51:03<12:51:36, 19.64s/it]
{'loss': 0.3358, 'learning_rate': 1.9559277172969374e-06, 'rewards/chosen': -0.9453811645507812, 'rewards/rejected': -2.3160746097564697, 'rewards/accuracies': 1.0, 'rewards/margins': 1.370693325996399, 'policy_logps/rejected': -324.8491516113281, 'policy_logps/chosen': -274.41693115234375, 'referece_logps/rejected': -301.68841552734375, 'referece_logps/chosen': -264.963134765625, 'logits/rejected': -0.04455788433551788, 'logits/chosen': -0.037446245551109314, 'epoch': 0.37}

 12%|█▏        | 329/2685 [1:51:26<13:37:58, 20.83s/it]
[2024-03-29 17:23:43,988] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 330/2685 [1:51:48<13:46:07, 21.05s/it]

 12%|█▏        | 331/2685 [1:52:07<13:26:29, 20.56s/it]

 12%|█▏        | 332/2685 [1:52:28<13:31:36, 20.70s/it]


 12%|█▏        | 334/2685 [1:53:07<13:08:15, 20.12s/it]
{'loss': 0.3317, 'learning_rate': 1.953777395825997e-06, 'rewards/chosen': -0.4451102018356323, 'rewards/rejected': -2.449979782104492, 'rewards/accuracies': 0.75, 'rewards/margins': 2.0048696994781494, 'policy_logps/rejected': -404.6792297363281, 'policy_logps/chosen': -339.9030456542969, 'referece_logps/rejected': -380.179443359375, 'referece_logps/chosen': -335.45196533203125, 'logits/rejected': -0.3334929049015045, 'logits/chosen': -0.37783998250961304, 'epoch': 0.37}


 13%|█▎        | 336/2685 [1:53:45<12:40:00, 19.41s/it]
{'loss': 0.414, 'learning_rate': 1.9530495104846456e-06, 'rewards/chosen': -1.5173622369766235, 'rewards/rejected': -2.700188636779785, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1828265190124512, 'policy_logps/rejected': -492.3050231933594, 'policy_logps/chosen': -485.2044677734375, 'referece_logps/rejected': -465.3031005859375, 'referece_logps/chosen': -470.03082275390625, 'logits/rejected': 0.04187777638435364, 'logits/chosen': 0.12513108551502228, 'epoch': 0.38}
[2024-03-29 17:26:03,911] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 13%|█▎        | 338/2685 [1:54:29<13:27:53, 20.65s/it]
[2024-03-29 17:26:24,856] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 339/2685 [1:54:49<13:27:01, 20.64s/it]
{'loss': 0.3528, 'learning_rate': 1.9519472799505217e-06, 'rewards/chosen': -0.20876824855804443, 'rewards/rejected': -2.2288739681243896, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0201058387756348, 'policy_logps/rejected': -399.6380615234375, 'policy_logps/chosen': -377.8055419921875, 'referece_logps/rejected': -377.349365234375, 'referece_logps/chosen': -375.71783447265625, 'logits/rejected': 0.03296428173780441, 'logits/chosen': -0.08523277938365936, 'epoch': 0.38}

 13%|█▎        | 340/2685 [1:55:08<12:58:05, 19.91s/it]


 13%|█▎        | 342/2685 [1:55:49<13:18:08, 20.44s/it]
[2024-03-29 17:27:45,251] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 343/2685 [1:56:05<12:26:14, 19.12s/it]
{'loss': 0.3669, 'learning_rate': 1.9504582436998966e-06, 'rewards/chosen': -0.5642106533050537, 'rewards/rejected': -3.251951217651367, 'rewards/accuracies': 1.0, 'rewards/margins': 2.6877403259277344, 'policy_logps/rejected': -474.5362854003906, 'policy_logps/chosen': -288.6706848144531, 'referece_logps/rejected': -442.0168151855469, 'referece_logps/chosen': -283.0285949707031, 'logits/rejected': 0.15263226628303528, 'logits/chosen': 0.16511672735214233, 'epoch': 0.38}


 13%|█▎        | 345/2685 [1:56:43<12:31:37, 19.27s/it]
[2024-03-29 17:28:39,221] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.3829, 'learning_rate': 1.949705422944822e-06, 'rewards/chosen': -1.0990616083145142, 'rewards/rejected': -2.3568992614746094, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2578376531600952, 'policy_logps/rejected': -452.3148193359375, 'policy_logps/chosen': -405.90399169921875, 'referece_logps/rejected': -428.7458190917969, 'referece_logps/chosen': -394.9133605957031, 'logits/rejected': -0.5204014182090759, 'logits/chosen': -0.5232948660850525, 'epoch': 0.39}

 13%|█▎        | 346/2685 [1:57:06<13:17:53, 20.47s/it]

 13%|█▎        | 347/2685 [1:57:25<12:53:43, 19.86s/it]

 13%|█▎        | 348/2685 [1:57:46<13:04:12, 20.13s/it]

 13%|█▎        | 349/2685 [1:58:06<13:03:05, 20.11s/it]

 13%|█▎        | 350/2685 [1:58:26<13:04:11, 20.15s/it]


 13%|█▎        | 352/2685 [1:59:11<13:58:13, 21.56s/it]
{'loss': 0.4356, 'learning_rate': 1.947027036486188e-06, 'rewards/chosen': -1.076189637184143, 'rewards/rejected': -2.189133644104004, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1129440069198608, 'policy_logps/rejected': -330.43304443359375, 'policy_logps/chosen': -381.21002197265625, 'referece_logps/rejected': -308.5417175292969, 'referece_logps/chosen': -370.4481201171875, 'logits/rejected': -0.22102776169776917, 'logits/chosen': -0.24926435947418213, 'epoch': 0.39}

 13%|█▎        | 353/2685 [1:59:30<13:28:10, 20.79s/it]
[2024-03-29 17:31:47,835] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 13%|█▎        | 355/2685 [2:00:09<12:54:03, 19.93s/it]
[2024-03-29 17:32:05,417] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.3435, 'learning_rate': 1.9458584691559742e-06, 'rewards/chosen': -0.874774694442749, 'rewards/rejected': -2.4836478233337402, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6088733673095703, 'policy_logps/rejected': -242.6808624267578, 'policy_logps/chosen': -227.26382446289062, 'referece_logps/rejected': -217.84437561035156, 'referece_logps/chosen': -218.51608276367188, 'logits/rejected': -0.6049063801765442, 'logits/chosen': -0.46527859568595886, 'epoch': 0.4}

 13%|█▎        | 356/2685 [2:00:29<12:50:48, 19.86s/it]

 13%|█▎        | 357/2685 [2:00:46<12:16:21, 18.98s/it]


 13%|█▎        | 359/2685 [2:01:25<12:34:35, 19.46s/it]

 13%|█▎        | 360/2685 [2:01:46<12:44:05, 19.72s/it]
{'loss': 0.4811, 'learning_rate': 1.9438833303083674e-06, 'rewards/chosen': 0.0007598642259836197, 'rewards/rejected': -1.2282719612121582, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2290318012237549, 'policy_logps/rejected': -302.90899658203125, 'policy_logps/chosen': -358.8979797363281, 'referece_logps/rejected': -290.62628173828125, 'referece_logps/chosen': -358.90557861328125, 'logits/rejected': -0.9145170450210571, 'logits/chosen': -1.0613024234771729, 'epoch': 0.4}
[2024-03-29 17:34:00,137] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 361/2685 [2:02:04<12:27:15, 19.29s/it]

 13%|█▎        | 362/2685 [2:02:18<11:28:26, 17.78s/it]
[2024-03-29 17:34:33,070] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▎        | 363/2685 [2:02:37<11:38:32, 18.05s/it]

 14%|█▎        | 364/2685 [2:02:57<12:02:19, 18.67s/it]

 14%|█▎        | 365/2685 [2:03:14<11:43:20, 18.19s/it]

 14%|█▎        | 366/2685 [2:03:35<12:15:42, 19.04s/it]


 14%|█▎        | 368/2685 [2:04:14<12:16:18, 19.07s/it]

 14%|█▎        | 369/2685 [2:04:34<12:29:48, 19.43s/it]
{'loss': 0.3895, 'learning_rate': 1.9402415778313976e-06, 'rewards/chosen': -0.6855342984199524, 'rewards/rejected': -1.944846272468567, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2593119144439697, 'policy_logps/rejected': -233.2866668701172, 'policy_logps/chosen': -244.89471435546875, 'referece_logps/rejected': -213.8382110595703, 'referece_logps/chosen': -238.0393524169922, 'logits/rejected': -0.42601221799850464, 'logits/chosen': -0.5283034443855286, 'epoch': 0.41}
[2024-03-29 17:36:50,962] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 370/2685 [2:04:55<12:48:34, 19.92s/it]
[2024-03-29 17:37:12,770] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 371/2685 [2:05:17<13:10:05, 20.49s/it]

 14%|█▍        | 372/2685 [2:05:36<13:00:41, 20.25s/it]

 14%|█▍        | 373/2685 [2:05:52<12:11:04, 18.97s/it]

 14%|█▍        | 374/2685 [2:06:09<11:47:40, 18.37s/it]

 14%|█▍        | 375/2685 [2:06:25<11:19:31, 17.65s/it]

 14%|█▍        | 376/2685 [2:06:46<11:59:20, 18.69s/it]
[2024-03-29 17:39:05,015] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 377/2685 [2:07:09<12:42:53, 19.83s/it]


 14%|█▍        | 379/2685 [2:07:48<12:36:48, 19.69s/it]
{'loss': 0.3861, 'learning_rate': 1.936065195336954e-06, 'rewards/chosen': -0.46902140974998474, 'rewards/rejected': -1.6436965465545654, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1746751070022583, 'policy_logps/rejected': -195.22955322265625, 'policy_logps/chosen': -203.36553955078125, 'referece_logps/rejected': -178.79258728027344, 'referece_logps/chosen': -198.67532348632812, 'logits/rejected': -0.7412002682685852, 'logits/chosen': -0.8970392942428589, 'epoch': 0.42}

 14%|█▍        | 380/2685 [2:08:09<12:55:29, 20.19s/it]

 14%|█▍        | 381/2685 [2:08:29<12:52:01, 20.10s/it]

 14%|█▍        | 382/2685 [2:08:49<12:49:12, 20.04s/it]

 14%|█▍        | 383/2685 [2:09:09<12:40:36, 19.82s/it]

 14%|█▍        | 384/2685 [2:09:28<12:37:05, 19.74s/it]

 14%|█▍        | 385/2685 [2:09:49<12:46:25, 19.99s/it]
[2024-03-29 17:42:05,701] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 386/2685 [2:10:10<12:57:20, 20.29s/it]
[2024-03-29 17:42:28,060] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 387/2685 [2:10:32<13:20:48, 20.91s/it]

 14%|█▍        | 388/2685 [2:10:54<13:30:32, 21.17s/it]

 14%|█▍        | 389/2685 [2:11:14<13:15:23, 20.79s/it]

 15%|█▍        | 390/2685 [2:11:31<12:32:26, 19.67s/it]

 15%|█▍        | 391/2685 [2:11:50<12:22:20, 19.42s/it]

 15%|█▍        | 392/2685 [2:12:10<12:36:43, 19.80s/it]
[2024-03-29 17:44:27,448] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 393/2685 [2:12:31<12:51:36, 20.20s/it]

 15%|█▍        | 394/2685 [2:12:53<13:10:25, 20.70s/it]

 15%|█▍        | 395/2685 [2:13:11<12:31:23, 19.69s/it]

 15%|█▍        | 396/2685 [2:13:32<12:49:03, 20.16s/it]
[2024-03-29 17:45:49,846] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 397/2685 [2:13:54<13:09:09, 20.69s/it]

 15%|█▍        | 398/2685 [2:14:10<12:13:44, 19.25s/it]
[2024-03-29 17:46:27,047] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 399/2685 [2:14:31<12:37:06, 19.87s/it]
[2024-03-29 17:46:48,444] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 400/2685 [2:14:52<12:54:11, 20.33s/it]
[2024-03-29 17:47:09,675] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 401/2685 [2:15:14<13:04:09, 20.60s/it]
[2024-03-29 17:47:32,947] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 402/2685 [2:15:37<13:34:19, 21.40s/it]

 15%|█▌        | 403/2685 [2:15:54<12:42:06, 20.04s/it]

 15%|█▌        | 404/2685 [2:16:14<12:43:09, 20.07s/it]

 15%|█▌        | 405/2685 [2:16:36<13:01:11, 20.56s/it]

 15%|█▌        | 406/2685 [2:16:58<13:20:54, 21.09s/it]

 15%|█▌        | 407/2685 [2:17:18<13:05:23, 20.69s/it]

 15%|█▌        | 408/2685 [2:17:38<12:59:29, 20.54s/it]

 15%|█▌        | 409/2685 [2:17:57<12:47:39, 20.24s/it]

 15%|█▌        | 410/2685 [2:18:18<12:54:04, 20.42s/it]

 15%|█▌        | 411/2685 [2:18:37<12:39:02, 20.03s/it]

 15%|█▌        | 412/2685 [2:18:55<12:16:26, 19.44s/it]
[2024-03-29 17:51:14,256] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▌        | 413/2685 [2:19:18<12:54:07, 20.44s/it]
[2024-03-29 17:51:34,746] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▌        | 414/2685 [2:19:39<12:54:18, 20.46s/it]

 15%|█▌        | 415/2685 [2:19:58<12:43:26, 20.18s/it]
[2024-03-29 17:52:14,155] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▌        | 416/2685 [2:20:18<12:39:43, 20.09s/it]
[2024-03-29 17:52:36,630] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 16%|█▌        | 417/2685 [2:20:41<13:06:25, 20.80s/it]


 16%|█▌        | 419/2685 [2:21:17<12:16:59, 19.51s/it]

 16%|█▌        | 420/2685 [2:21:38<12:29:50, 19.86s/it]

 16%|█▌        | 421/2685 [2:21:58<12:35:19, 20.02s/it]

 16%|█▌        | 422/2685 [2:22:18<12:35:14, 20.02s/it]

 16%|█▌        | 423/2685 [2:22:38<12:37:04, 20.08s/it]

 16%|█▌        | 424/2685 [2:22:58<12:38:01, 20.12s/it]

 16%|█▌        | 425/2685 [2:23:19<12:41:04, 20.21s/it]

 16%|█▌        | 426/2685 [2:23:36<12:01:37, 19.17s/it]

 16%|█▌        | 427/2685 [2:23:55<12:09:19, 19.38s/it]

 16%|█▌        | 428/2685 [2:24:15<12:10:16, 19.41s/it]

 16%|█▌        | 429/2685 [2:24:34<12:10:27, 19.43s/it]

 16%|█▌        | 430/2685 [2:24:57<12:46:00, 20.38s/it]

 16%|█▌        | 431/2685 [2:25:17<12:38:18, 20.19s/it]

 16%|█▌        | 432/2685 [2:25:37<12:43:31, 20.33s/it]

 16%|█▌        | 433/2685 [2:25:57<12:39:29, 20.24s/it]

 16%|█▌        | 434/2685 [2:26:20<13:10:06, 21.06s/it]

 16%|█▌        | 435/2685 [2:26:40<12:52:02, 20.59s/it]

 16%|█▌        | 436/2685 [2:27:00<12:41:21, 20.31s/it]

 16%|█▋        | 437/2685 [2:27:21<12:49:33, 20.54s/it]

 16%|█▋        | 438/2685 [2:27:41<12:53:14, 20.65s/it]

 16%|█▋        | 439/2685 [2:28:01<12:44:08, 20.41s/it]

 16%|█▋        | 440/2685 [2:28:20<12:25:21, 19.92s/it]

 16%|█▋        | 441/2685 [2:28:41<12:32:26, 20.12s/it]

 16%|█▋        | 442/2685 [2:29:00<12:17:22, 19.72s/it]

 16%|█▋        | 443/2685 [2:29:15<11:31:53, 18.52s/it]

 17%|█▋        | 444/2685 [2:29:31<11:00:29, 17.68s/it]

 17%|█▋        | 445/2685 [2:29:51<11:23:16, 18.30s/it]

 17%|█▋        | 446/2685 [2:30:10<11:37:37, 18.69s/it]

 17%|█▋        | 447/2685 [2:30:31<12:04:18, 19.42s/it]

 17%|█▋        | 448/2685 [2:30:50<11:49:56, 19.04s/it]

 17%|█▋        | 449/2685 [2:31:05<11:06:20, 17.88s/it]

 17%|█▋        | 450/2685 [2:31:27<11:58:28, 19.29s/it]

 17%|█▋        | 451/2685 [2:31:47<12:01:10, 19.37s/it]

 17%|█▋        | 452/2685 [2:32:05<11:48:03, 19.03s/it]

 17%|█▋        | 453/2685 [2:32:25<11:53:01, 19.17s/it]

 17%|█▋        | 454/2685 [2:32:46<12:22:51, 19.98s/it]

 17%|█▋        | 455/2685 [2:33:05<12:05:53, 19.53s/it]

 17%|█▋        | 456/2685 [2:33:25<12:08:11, 19.60s/it]

 17%|█▋        | 457/2685 [2:33:44<12:02:11, 19.45s/it]

 17%|█▋        | 458/2685 [2:34:02<11:48:58, 19.10s/it]

 17%|█▋        | 459/2685 [2:34:24<12:14:42, 19.80s/it]

 17%|█▋        | 460/2685 [2:34:42<12:03:26, 19.51s/it]

 17%|█▋        | 461/2685 [2:35:02<12:04:18, 19.54s/it]

 17%|█▋        | 462/2685 [2:35:18<11:27:53, 18.57s/it]

 17%|█▋        | 463/2685 [2:35:39<11:48:10, 19.12s/it]

 17%|█▋        | 464/2685 [2:35:59<11:56:01, 19.34s/it]

 17%|█▋        | 465/2685 [2:36:19<12:04:02, 19.57s/it]

 17%|█▋        | 466/2685 [2:36:40<12:28:16, 20.23s/it]

 17%|█▋        | 467/2685 [2:37:00<12:20:43, 20.04s/it]

 17%|█▋        | 468/2685 [2:37:21<12:31:41, 20.34s/it]

 17%|█▋        | 469/2685 [2:37:39<12:08:06, 19.71s/it]

 18%|█▊        | 470/2685 [2:38:01<12:30:03, 20.32s/it]

 18%|█▊        | 471/2685 [2:38:21<12:29:55, 20.32s/it]

 18%|█▊        | 472/2685 [2:38:41<12:25:22, 20.21s/it]

 18%|█▊        | 473/2685 [2:39:03<12:45:11, 20.76s/it]

 18%|█▊        | 474/2685 [2:39:22<12:21:51, 20.13s/it]

 18%|█▊        | 475/2685 [2:39:41<12:13:44, 19.92s/it]

 18%|█▊        | 476/2685 [2:40:02<12:21:58, 20.15s/it]

 18%|█▊        | 477/2685 [2:40:23<12:28:49, 20.35s/it]

 18%|█▊        | 478/2685 [2:40:44<12:38:43, 20.63s/it]

 18%|█▊        | 479/2685 [2:41:04<12:31:54, 20.45s/it]

 18%|█▊        | 480/2685 [2:41:23<12:16:56, 20.05s/it]

 18%|█▊        | 481/2685 [2:41:46<12:42:18, 20.75s/it]

 18%|█▊        | 482/2685 [2:42:07<12:48:54, 20.94s/it]

 18%|█▊        | 483/2685 [2:42:23<11:55:22, 19.49s/it]

 18%|█▊        | 484/2685 [2:42:40<11:28:02, 18.76s/it]

 18%|█▊        | 485/2685 [2:43:00<11:39:57, 19.09s/it]

 18%|█▊        | 486/2685 [2:43:16<11:04:24, 18.13s/it]

 18%|█▊        | 487/2685 [2:43:36<11:21:27, 18.60s/it]

 18%|█▊        | 488/2685 [2:43:49<10:24:05, 17.04s/it]

 18%|█▊        | 489/2685 [2:44:09<10:50:23, 17.77s/it]

 18%|█▊        | 490/2685 [2:44:30<11:26:51, 18.78s/it]

 18%|█▊        | 491/2685 [2:44:49<11:31:16, 18.90s/it]

 18%|█▊        | 492/2685 [2:45:09<11:43:30, 19.25s/it]

 18%|█▊        | 493/2685 [2:45:31<12:07:56, 19.93s/it]

 18%|█▊        | 494/2685 [2:45:54<12:48:10, 21.04s/it]

 18%|█▊        | 495/2685 [2:46:10<11:51:03, 19.48s/it]

 18%|█▊        | 496/2685 [2:46:30<11:55:44, 19.62s/it]

 19%|█▊        | 497/2685 [2:46:50<11:55:19, 19.62s/it]

 19%|█▊        | 498/2685 [2:47:06<11:19:18, 18.64s/it]

 19%|█▊        | 499/2685 [2:47:24<11:13:11, 18.48s/it]

 19%|█▊        | 500/2685 [2:47:40<10:50:35, 17.87s/it]
 19%|█▊        | 500/2685 [2:47:40<10:50:35, 17.87s/it]/mnt/petrelfs/songmingyang/anaconda3/envs/vcd_origin/lib/python3.9/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
 19%|█▊        | 501/2685 [2:48:19<14:31:41, 23.95s/it]

 19%|█▊        | 502/2685 [2:48:38<13:39:06, 22.51s/it]
{'loss': 0.4349, 'learning_rate': 1.8737604880064667e-06, 'rewards/chosen': -1.0963454246520996, 'rewards/rejected': -2.5229907035827637, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4266453981399536, 'policy_logps/rejected': -413.82940673828125, 'policy_logps/chosen': -364.77935791015625, 'referece_logps/rejected': -388.5994873046875, 'referece_logps/chosen': -353.81591796875, 'logits/rejected': -0.5683443546295166, 'logits/chosen': -0.5102937817573547, 'epoch': 0.56}

 19%|█▊        | 503/2685 [2:48:59<13:22:50, 22.08s/it]

 19%|█▉        | 504/2685 [2:49:19<13:01:06, 21.49s/it]

 19%|█▉        | 505/2685 [2:49:41<13:07:42, 21.68s/it]


 19%|█▉        | 507/2685 [2:50:23<12:51:57, 21.27s/it]

 19%|█▉        | 508/2685 [2:50:44<12:49:11, 21.20s/it]

 19%|█▉        | 509/2685 [2:51:04<12:35:12, 20.82s/it]

 19%|█▉        | 510/2685 [2:51:26<12:48:46, 21.21s/it]
{'loss': 0.3223, 'learning_rate': 1.8690257510677628e-06, 'rewards/chosen': -1.97698974609375, 'rewards/rejected': -4.526750564575195, 'rewards/accuracies': 0.875, 'rewards/margins': 2.5497612953186035, 'policy_logps/rejected': -419.34869384765625, 'policy_logps/chosen': -411.61083984375, 'referece_logps/rejected': -374.0811462402344, 'referece_logps/chosen': -391.8409118652344, 'logits/rejected': -0.8267855644226074, 'logits/chosen': -0.7872102856636047, 'epoch': 0.57}

 19%|█▉        | 511/2685 [2:51:47<12:49:53, 21.25s/it]


 19%|█▉        | 513/2685 [2:52:24<11:59:31, 19.88s/it]
{'loss': 0.3677, 'learning_rate': 1.8672293303743735e-06, 'rewards/chosen': -1.6014565229415894, 'rewards/rejected': -3.6596462726593018, 'rewards/accuracies': 0.875, 'rewards/margins': 2.058189868927002, 'policy_logps/rejected': -299.92022705078125, 'policy_logps/chosen': -330.0150146484375, 'referece_logps/rejected': -263.32379150390625, 'referece_logps/chosen': -314.00042724609375, 'logits/rejected': 0.02442723512649536, 'logits/chosen': 0.1361904889345169, 'epoch': 0.57}


 19%|█▉        | 515/2685 [2:53:04<11:59:53, 19.90s/it]

 19%|█▉        | 516/2685 [2:53:22<11:36:07, 19.26s/it]

 19%|█▉        | 517/2685 [2:53:44<12:06:25, 20.10s/it]

 19%|█▉        | 518/2685 [2:54:00<11:21:34, 18.87s/it]

 19%|█▉        | 519/2685 [2:54:18<11:15:52, 18.72s/it]

 19%|█▉        | 520/2685 [2:54:34<10:43:25, 17.83s/it]

 19%|█▉        | 521/2685 [2:54:46<9:38:46, 16.05s/it]

 19%|█▉        | 522/2685 [2:55:02<9:37:24, 16.02s/it]

 19%|█▉        | 523/2685 [2:55:20<9:58:34, 16.61s/it]

 20%|█▉        | 524/2685 [2:55:43<11:02:31, 18.39s/it]

 20%|█▉        | 525/2685 [2:56:02<11:16:04, 18.78s/it]

 20%|█▉        | 526/2685 [2:56:22<11:25:13, 19.04s/it]

 20%|█▉        | 527/2685 [2:56:43<11:43:05, 19.55s/it]

 20%|█▉        | 528/2685 [2:57:04<12:06:42, 20.21s/it]

 20%|█▉        | 529/2685 [2:57:27<12:27:24, 20.80s/it]
{'loss': 0.4194, 'learning_rate': 1.8574571361306508e-06, 'rewards/chosen': -0.9502023458480835, 'rewards/rejected': -4.033535003662109, 'rewards/accuracies': 0.875, 'rewards/margins': 3.0833323001861572, 'policy_logps/rejected': -338.92742919921875, 'policy_logps/chosen': -301.09869384765625, 'referece_logps/rejected': -298.592041015625, 'referece_logps/chosen': -291.5966491699219, 'logits/rejected': 0.4412834644317627, 'logits/chosen': 0.3178951144218445, 'epoch': 0.59}

 20%|█▉        | 530/2685 [2:57:46<12:06:57, 20.24s/it]


 20%|█▉        | 532/2685 [2:58:22<11:25:54, 19.11s/it]
{'loss': 0.3264, 'learning_rate': 1.8555891697789506e-06, 'rewards/chosen': -0.17429295182228088, 'rewards/rejected': -3.207813024520874, 'rewards/accuracies': 1.0, 'rewards/margins': 3.033519744873047, 'policy_logps/rejected': -240.69117736816406, 'policy_logps/chosen': -268.6806335449219, 'referece_logps/rejected': -208.61305236816406, 'referece_logps/chosen': -266.93768310546875, 'logits/rejected': -0.7224298119544983, 'logits/chosen': -0.6501035690307617, 'epoch': 0.59}


 20%|█▉        | 534/2685 [2:59:01<11:30:27, 19.26s/it]

 20%|█▉        | 535/2685 [2:59:19<11:15:55, 18.86s/it]

 20%|█▉        | 536/2685 [2:59:39<11:29:01, 19.24s/it]
{'loss': 0.3061, 'learning_rate': 1.8530811176818512e-06, 'rewards/chosen': -0.6838256120681763, 'rewards/rejected': -2.8625411987304688, 'rewards/accuracies': 0.875, 'rewards/margins': 2.178715705871582, 'policy_logps/rejected': -309.4005432128906, 'policy_logps/chosen': -321.4189758300781, 'referece_logps/rejected': -280.775146484375, 'referece_logps/chosen': -314.58074951171875, 'logits/rejected': -0.5327418446540833, 'logits/chosen': -0.5688320398330688, 'epoch': 0.6}


 20%|██        | 538/2685 [3:00:21<11:57:02, 20.04s/it]

 20%|██        | 539/2685 [3:00:40<11:48:48, 19.82s/it]

 20%|██        | 540/2685 [3:00:59<11:35:44, 19.46s/it]

 20%|██        | 541/2685 [3:01:21<12:02:14, 20.21s/it]

 20%|██        | 542/2685 [3:01:42<12:15:24, 20.59s/it]

 20%|██        | 543/2685 [3:02:02<12:09:39, 20.44s/it]
{'loss': 0.3678, 'learning_rate': 1.848644257494751e-06, 'rewards/chosen': -1.3552865982055664, 'rewards/rejected': -3.9432826042175293, 'rewards/accuracies': 0.75, 'rewards/margins': 2.587996006011963, 'policy_logps/rejected': -315.6726379394531, 'policy_logps/chosen': -359.8866882324219, 'referece_logps/rejected': -276.23980712890625, 'referece_logps/chosen': -346.3338623046875, 'logits/rejected': -0.34607696533203125, 'logits/chosen': -0.39922821521759033, 'epoch': 0.61}

 20%|██        | 544/2685 [3:02:20<11:38:22, 19.57s/it]

 20%|██        | 545/2685 [3:02:38<11:22:02, 19.12s/it]

 20%|██        | 546/2685 [3:02:54<10:48:55, 18.20s/it]


 20%|██        | 548/2685 [3:03:35<11:31:34, 19.42s/it]
{'loss': 0.4197, 'learning_rate': 1.8454379967176446e-06, 'rewards/chosen': -1.1334989070892334, 'rewards/rejected': -2.998981475830078, 'rewards/accuracies': 0.875, 'rewards/margins': 1.8654826879501343, 'policy_logps/rejected': -369.56427001953125, 'policy_logps/chosen': -343.79412841796875, 'referece_logps/rejected': -339.574462890625, 'referece_logps/chosen': -332.4591369628906, 'logits/rejected': 0.26900842785835266, 'logits/chosen': 0.22862623631954193, 'epoch': 0.61}

 20%|██        | 549/2685 [3:03:56<11:42:16, 19.73s/it]


 21%|██        | 551/2685 [3:04:31<10:57:00, 18.47s/it]

 21%|██        | 552/2685 [3:04:45<10:09:03, 17.13s/it]

 21%|██        | 553/2685 [3:05:06<10:50:33, 18.31s/it]

 21%|██        | 554/2685 [3:05:27<11:27:14, 19.35s/it]
{'loss': 0.3312, 'learning_rate': 1.8415498860774817e-06, 'rewards/chosen': -1.4633944034576416, 'rewards/rejected': -3.2414779663085938, 'rewards/accuracies': 1.0, 'rewards/margins': 1.7780836820602417, 'policy_logps/rejected': -377.1036376953125, 'policy_logps/chosen': -316.4318542480469, 'referece_logps/rejected': -344.68890380859375, 'referece_logps/chosen': -301.79791259765625, 'logits/rejected': -0.8295596241950989, 'logits/chosen': -0.7272176742553711, 'epoch': 0.62}


 21%|██        | 556/2685 [3:06:05<11:10:33, 18.90s/it]

 21%|██        | 557/2685 [3:06:23<11:01:15, 18.64s/it]

 21%|██        | 558/2685 [3:06:45<11:34:29, 19.59s/it]

 21%|██        | 559/2685 [3:07:06<11:48:58, 20.01s/it]

 21%|██        | 560/2685 [3:07:27<11:59:08, 20.31s/it]

 21%|██        | 561/2685 [3:07:45<11:38:15, 19.72s/it]

 21%|██        | 562/2685 [3:08:07<12:03:50, 20.46s/it]
{'loss': 0.3884, 'learning_rate': 1.8362971804737697e-06, 'rewards/chosen': -0.427942156791687, 'rewards/rejected': -2.8510358333587646, 'rewards/accuracies': 1.0, 'rewards/margins': 2.423093557357788, 'policy_logps/rejected': -477.8852844238281, 'policy_logps/chosen': -526.059814453125, 'referece_logps/rejected': -449.3749084472656, 'referece_logps/chosen': -521.7803955078125, 'logits/rejected': 0.42886802554130554, 'logits/chosen': 0.38900506496429443, 'epoch': 0.63}

 21%|██        | 563/2685 [3:08:26<11:47:56, 20.02s/it]

 21%|██        | 564/2685 [3:08:46<11:45:21, 19.95s/it]


 21%|██        | 566/2685 [3:09:25<11:29:25, 19.52s/it]

 21%|██        | 567/2685 [3:09:44<11:24:38, 19.40s/it]

 21%|██        | 568/2685 [3:10:05<11:45:04, 19.98s/it]
{'loss': 0.3685, 'learning_rate': 1.8323065002965353e-06, 'rewards/chosen': -1.100454568862915, 'rewards/rejected': -2.3553354740142822, 'rewards/accuracies': 0.75, 'rewards/margins': 1.254880666732788, 'policy_logps/rejected': -304.6900634765625, 'policy_logps/chosen': -309.69793701171875, 'referece_logps/rejected': -281.1366882324219, 'referece_logps/chosen': -298.6933898925781, 'logits/rejected': -0.07042881846427917, 'logits/chosen': -0.16870692372322083, 'epoch': 0.63}


 21%|██        | 570/2685 [3:10:42<11:21:04, 19.32s/it]

 21%|██▏       | 571/2685 [3:11:05<12:06:07, 20.61s/it]

 21%|██▏       | 572/2685 [3:11:26<12:08:02, 20.67s/it]

 21%|██▏       | 573/2685 [3:11:46<11:59:45, 20.45s/it]

 21%|██▏       | 574/2685 [3:12:05<11:42:39, 19.97s/it]
{'loss': 0.3015, 'learning_rate': 1.828272208553812e-06, 'rewards/chosen': -1.0476094484329224, 'rewards/rejected': -2.6764638423919678, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6288542747497559, 'policy_logps/rejected': -288.09869384765625, 'policy_logps/chosen': -225.8112030029297, 'referece_logps/rejected': -261.33404541015625, 'referece_logps/chosen': -215.33509826660156, 'logits/rejected': -0.14758846163749695, 'logits/chosen': -0.15018367767333984, 'epoch': 0.64}


 21%|██▏       | 576/2685 [3:12:44<11:33:40, 19.73s/it]

 21%|██▏       | 577/2685 [3:13:00<10:56:00, 18.67s/it]

 22%|██▏       | 578/2685 [3:13:20<11:04:40, 18.93s/it]

 22%|██▏       | 579/2685 [3:13:39<11:10:54, 19.11s/it]
{'loss': 0.2623, 'learning_rate': 1.8248771368173522e-06, 'rewards/chosen': -1.22332763671875, 'rewards/rejected': -3.791362762451172, 'rewards/accuracies': 0.875, 'rewards/margins': 2.568035125732422, 'policy_logps/rejected': -317.7003479003906, 'policy_logps/chosen': -261.1995849609375, 'referece_logps/rejected': -279.7867126464844, 'referece_logps/chosen': -248.96630859375, 'logits/rejected': -0.36528119444847107, 'logits/chosen': -0.4051054120063782, 'epoch': 0.65}


 22%|██▏       | 581/2685 [3:14:20<11:32:55, 19.76s/it]

 22%|██▏       | 582/2685 [3:14:41<11:44:26, 20.10s/it]

 22%|██▏       | 583/2685 [3:14:58<11:13:19, 19.22s/it]

 22%|██▏       | 584/2685 [3:15:18<11:20:23, 19.43s/it]

 22%|██▏       | 585/2685 [3:15:38<11:22:17, 19.49s/it]
{'loss': 0.3643, 'learning_rate': 1.8207634412072764e-06, 'rewards/chosen': -0.8521653413772583, 'rewards/rejected': -2.602696180343628, 'rewards/accuracies': 0.75, 'rewards/margins': 1.7505309581756592, 'policy_logps/rejected': -429.60943603515625, 'policy_logps/chosen': -406.6622314453125, 'referece_logps/rejected': -403.58245849609375, 'referece_logps/chosen': -398.140625, 'logits/rejected': -0.23735906183719635, 'logits/chosen': -0.3234066665172577, 'epoch': 0.65}


 22%|██▏       | 587/2685 [3:16:18<11:29:54, 19.73s/it]
{'loss': 0.3358, 'learning_rate': 1.8193826415772414e-06, 'rewards/chosen': -0.6434999704360962, 'rewards/rejected': -2.7882282733917236, 'rewards/accuracies': 0.875, 'rewards/margins': 2.144727945327759, 'policy_logps/rejected': -354.7265319824219, 'policy_logps/chosen': -427.3144836425781, 'referece_logps/rejected': -326.84423828125, 'referece_logps/chosen': -420.87945556640625, 'logits/rejected': -0.3975115716457367, 'logits/chosen': -0.41146475076675415, 'epoch': 0.66}


 22%|██▏       | 589/2685 [3:16:58<11:34:58, 19.89s/it]
{'loss': 0.3168, 'learning_rate': 1.8179970714425352e-06, 'rewards/chosen': -0.6705219149589539, 'rewards/rejected': -3.1413159370422363, 'rewards/accuracies': 0.875, 'rewards/margins': 2.4707939624786377, 'policy_logps/rejected': -366.279052734375, 'policy_logps/chosen': -367.634521484375, 'referece_logps/rejected': -334.8658752441406, 'referece_logps/chosen': -360.9293212890625, 'logits/rejected': -1.1086664199829102, 'logits/chosen': -1.1709805727005005, 'epoch': 0.66}

 22%|██▏       | 590/2685 [3:17:21<12:05:08, 20.77s/it]

 22%|██▏       | 591/2685 [3:17:41<11:54:45, 20.48s/it]


 22%|██▏       | 593/2685 [3:18:18<11:25:05, 19.65s/it]

 22%|██▏       | 594/2685 [3:18:40<11:51:49, 20.43s/it]

 22%|██▏       | 595/2685 [3:19:02<12:03:46, 20.78s/it]
{'loss': 0.4523, 'learning_rate': 1.813811818817863e-06, 'rewards/chosen': -1.0661511421203613, 'rewards/rejected': -2.6121578216552734, 'rewards/accuracies': 0.625, 'rewards/margins': 1.5460065603256226, 'policy_logps/rejected': -245.61354064941406, 'policy_logps/chosen': -262.93792724609375, 'referece_logps/rejected': -219.4919891357422, 'referece_logps/chosen': -252.2764129638672, 'logits/rejected': -0.9178141355514526, 'logits/chosen': -0.9621498584747314, 'epoch': 0.66}


 22%|██▏       | 597/2685 [3:19:39<11:25:56, 19.71s/it]
{'loss': 0.362, 'learning_rate': 1.8124072476103956e-06, 'rewards/chosen': -1.1972018480300903, 'rewards/rejected': -3.0448813438415527, 'rewards/accuracies': 0.75, 'rewards/margins': 1.8476794958114624, 'policy_logps/rejected': -432.25201416015625, 'policy_logps/chosen': -367.6329650878906, 'referece_logps/rejected': -401.80322265625, 'referece_logps/chosen': -355.66094970703125, 'logits/rejected': -0.4290238320827484, 'logits/chosen': -0.3790721893310547, 'epoch': 0.67}


 22%|██▏       | 599/2685 [3:20:21<11:49:57, 20.42s/it]
{'loss': 0.4207, 'learning_rate': 1.8109979465095012e-06, 'rewards/chosen': -0.444441020488739, 'rewards/rejected': -2.6398353576660156, 'rewards/accuracies': 1.0, 'rewards/margins': 2.195394277572632, 'policy_logps/rejected': -310.25823974609375, 'policy_logps/chosen': -265.9245300292969, 'referece_logps/rejected': -283.85986328125, 'referece_logps/chosen': -261.4800720214844, 'logits/rejected': -0.01468716561794281, 'logits/chosen': -0.08129605650901794, 'epoch': 0.67}

 22%|██▏       | 600/2685 [3:20:36<10:52:30, 18.78s/it]


 22%|██▏       | 602/2685 [3:21:14<11:02:27, 19.08s/it]
{'loss': 0.266, 'learning_rate': 1.8088751442640549e-06, 'rewards/chosen': -1.2033659219741821, 'rewards/rejected': -2.0084962844848633, 'rewards/accuracies': 1.0, 'rewards/margins': 0.8051301836967468, 'policy_logps/rejected': -276.9429931640625, 'policy_logps/chosen': -258.49200439453125, 'referece_logps/rejected': -256.8580322265625, 'referece_logps/chosen': -246.45834350585938, 'logits/rejected': -0.2401694357395172, 'logits/chosen': -0.2084580808877945, 'epoch': 0.67}

 22%|██▏       | 603/2685 [3:21:34<11:05:19, 19.17s/it]

 22%|██▏       | 604/2685 [3:21:56<11:34:29, 20.02s/it]

 23%|██▎       | 605/2685 [3:22:18<11:56:07, 20.66s/it]


 23%|██▎       | 607/2685 [3:22:59<11:53:52, 20.61s/it]

 23%|██▎       | 608/2685 [3:23:18<11:43:27, 20.32s/it]

 23%|██▎       | 609/2685 [3:23:39<11:44:09, 20.35s/it]

 23%|██▎       | 610/2685 [3:24:01<12:02:46, 20.90s/it]

 23%|██▎       | 611/2685 [3:24:23<12:13:35, 21.22s/it]
{'loss': 0.2874, 'learning_rate': 1.802443273546722e-06, 'rewards/chosen': -0.39163264632225037, 'rewards/rejected': -2.4813928604125977, 'rewards/accuracies': 0.625, 'rewards/margins': 2.0897598266601562, 'policy_logps/rejected': -251.53152465820312, 'policy_logps/chosen': -210.73257446289062, 'referece_logps/rejected': -226.7176055908203, 'referece_logps/chosen': -206.81625366210938, 'logits/rejected': -0.29066798090934753, 'logits/chosen': -0.3208838105201721, 'epoch': 0.68}

 23%|██▎       | 612/2685 [3:24:40<11:31:33, 20.02s/it]

 23%|██▎       | 613/2685 [3:25:02<11:52:02, 20.62s/it]

 23%|██▎       | 614/2685 [3:25:25<12:16:43, 21.34s/it]

 23%|██▎       | 615/2685 [3:25:40<11:09:27, 19.40s/it]


 23%|██▎       | 617/2685 [3:26:23<11:41:57, 20.37s/it]

 23%|██▎       | 618/2685 [3:26:42<11:33:28, 20.13s/it]
{'loss': 0.3197, 'learning_rate': 1.7973752624589508e-06, 'rewards/chosen': -1.7460978031158447, 'rewards/rejected': -3.5028767585754395, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7567789554595947, 'policy_logps/rejected': -379.6134948730469, 'policy_logps/chosen': -277.2080993652344, 'referece_logps/rejected': -344.584716796875, 'referece_logps/chosen': -259.7471008300781, 'logits/rejected': -0.8683164119720459, 'logits/chosen': -0.8207699656486511, 'epoch': 0.69}

 23%|██▎       | 619/2685 [3:27:02<11:30:09, 20.04s/it]

 23%|██▎       | 620/2685 [3:27:20<11:07:50, 19.40s/it]

 23%|██▎       | 621/2685 [3:27:40<11:09:58, 19.48s/it]


 23%|██▎       | 623/2685 [3:28:19<11:10:43, 19.52s/it]
{'loss': 0.3711, 'learning_rate': 1.7937204156716231e-06, 'rewards/chosen': -0.9955079555511475, 'rewards/rejected': -3.3595776557922363, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3640694618225098, 'policy_logps/rejected': -268.494384765625, 'policy_logps/chosen': -242.16200256347656, 'referece_logps/rejected': -234.89862060546875, 'referece_logps/chosen': -232.2069091796875, 'logits/rejected': -0.045005589723587036, 'logits/chosen': 0.03516712784767151, 'epoch': 0.7}

 23%|██▎       | 624/2685 [3:28:40<11:27:51, 20.03s/it]

 23%|██▎       | 625/2685 [3:28:57<10:57:33, 19.15s/it]

 23%|██▎       | 626/2685 [3:29:20<11:31:46, 20.16s/it]


 23%|██▎       | 628/2685 [3:29:57<11:07:47, 19.48s/it]

 23%|██▎       | 629/2685 [3:30:19<11:29:45, 20.13s/it]

 23%|██▎       | 630/2685 [3:30:39<11:33:19, 20.24s/it]

 24%|██▎       | 631/2685 [3:31:01<11:42:57, 20.53s/it]
{'loss': 0.3133, 'learning_rate': 1.7878126424177157e-06, 'rewards/chosen': -1.262823462486267, 'rewards/rejected': -3.270867347717285, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0080440044403076, 'policy_logps/rejected': -386.51904296875, 'policy_logps/chosen': -272.9731750488281, 'referece_logps/rejected': -353.8103332519531, 'referece_logps/chosen': -260.3449401855469, 'logits/rejected': -0.4796857237815857, 'logits/chosen': -0.6616950035095215, 'epoch': 0.71}

 24%|██▎       | 632/2685 [3:31:20<11:31:00, 20.19s/it]

 24%|██▎       | 633/2685 [3:31:40<11:31:38, 20.22s/it]


 24%|██▎       | 635/2685 [3:32:19<11:18:27, 19.86s/it]
{'loss': 0.3933, 'learning_rate': 1.7848312011169723e-06, 'rewards/chosen': -1.594083309173584, 'rewards/rejected': -3.581812620162964, 'rewards/accuracies': 0.75, 'rewards/margins': 1.987729549407959, 'policy_logps/rejected': -409.7848815917969, 'policy_logps/chosen': -363.5629577636719, 'referece_logps/rejected': -373.9667663574219, 'referece_logps/chosen': -347.62213134765625, 'logits/rejected': -0.15704983472824097, 'logits/chosen': -0.24657385051250458, 'epoch': 0.71}

 24%|██▎       | 636/2685 [3:32:40<11:31:00, 20.23s/it]

 24%|██▎       | 637/2685 [3:32:58<11:04:00, 19.45s/it]

 24%|██▍       | 638/2685 [3:33:17<10:54:40, 19.19s/it]

 24%|██▍       | 639/2685 [3:33:38<11:19:56, 19.94s/it]

 24%|██▍       | 640/2685 [3:33:58<11:13:25, 19.76s/it]

 24%|██▍       | 641/2685 [3:34:18<11:21:32, 20.01s/it]


 24%|██▍       | 643/2685 [3:34:56<11:05:52, 19.57s/it]
{'loss': 0.3212, 'learning_rate': 1.7788135563290974e-06, 'rewards/chosen': -0.7090740203857422, 'rewards/rejected': -2.6854135990142822, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9763398170471191, 'policy_logps/rejected': -437.520751953125, 'policy_logps/chosen': -316.5871276855469, 'referece_logps/rejected': -410.6665954589844, 'referece_logps/chosen': -309.49639892578125, 'logits/rejected': -0.12879446148872375, 'logits/chosen': -0.23329311609268188, 'epoch': 0.72}


 24%|██▍       | 645/2685 [3:35:31<10:34:02, 18.65s/it]
{'loss': 0.3166, 'learning_rate': 1.777297787397563e-06, 'rewards/chosen': -1.2641236782073975, 'rewards/rejected': -3.7440693378448486, 'rewards/accuracies': 0.75, 'rewards/margins': 2.4799458980560303, 'policy_logps/rejected': -387.7437438964844, 'policy_logps/chosen': -347.034423828125, 'referece_logps/rejected': -350.30303955078125, 'referece_logps/chosen': -334.3931884765625, 'logits/rejected': -0.5225479006767273, 'logits/chosen': -0.5517495274543762, 'epoch': 0.72}

 24%|██▍       | 646/2685 [3:35:50<10:41:59, 18.89s/it]

 24%|██▍       | 647/2685 [3:36:10<10:48:35, 19.10s/it]


 24%|██▍       | 649/2685 [3:36:47<10:44:06, 18.98s/it]

 24%|██▍       | 650/2685 [3:37:07<10:50:45, 19.19s/it]
{'loss': 0.3604, 'learning_rate': 1.773488585447203e-06, 'rewards/chosen': -1.6592272520065308, 'rewards/rejected': -3.473553419113159, 'rewards/accuracies': 0.875, 'rewards/margins': 1.8143261671066284, 'policy_logps/rejected': -226.95692443847656, 'policy_logps/chosen': -241.00096130371094, 'referece_logps/rejected': -192.22137451171875, 'referece_logps/chosen': -224.40870666503906, 'logits/rejected': -1.3352322578430176, 'logits/chosen': -1.2266491651535034, 'epoch': 0.73}

 24%|██▍       | 651/2685 [3:37:29<11:15:13, 19.92s/it]

 24%|██▍       | 652/2685 [3:37:48<11:08:41, 19.74s/it]


 24%|██▍       | 654/2685 [3:38:34<12:04:35, 21.41s/it]
{'loss': 0.3132, 'learning_rate': 1.7704209523730693e-06, 'rewards/chosen': -1.356680989265442, 'rewards/rejected': -2.3960464000701904, 'rewards/accuracies': 0.625, 'rewards/margins': 1.039365530014038, 'policy_logps/rejected': -396.45220947265625, 'policy_logps/chosen': -356.0064697265625, 'referece_logps/rejected': -372.4917907714844, 'referece_logps/chosen': -342.439697265625, 'logits/rejected': 0.025929003953933716, 'logits/chosen': 0.08433759212493896, 'epoch': 0.73}

 24%|██▍       | 655/2685 [3:38:54<11:52:41, 21.06s/it]

 24%|██▍       | 656/2685 [3:39:10<11:03:44, 19.63s/it]

 24%|██▍       | 657/2685 [3:39:30<11:04:50, 19.67s/it]


 25%|██▍       | 659/2685 [3:40:06<10:36:45, 18.86s/it]
{'loss': 0.2715, 'learning_rate': 1.7665611888439351e-06, 'rewards/chosen': -0.7813785672187805, 'rewards/rejected': -3.505464553833008, 'rewards/accuracies': 0.875, 'rewards/margins': 2.724085807800293, 'policy_logps/rejected': -228.31854248046875, 'policy_logps/chosen': -133.498291015625, 'referece_logps/rejected': -193.26388549804688, 'referece_logps/chosen': -125.68450164794922, 'logits/rejected': -0.8509968519210815, 'logits/chosen': -0.716349720954895, 'epoch': 0.74}


 25%|██▍       | 661/2685 [3:40:47<11:05:54, 19.74s/it]
{'loss': 0.3555, 'learning_rate': 1.765009465347743e-06, 'rewards/chosen': -0.6756256222724915, 'rewards/rejected': -2.556927442550659, 'rewards/accuracies': 1.0, 'rewards/margins': 1.8813018798828125, 'policy_logps/rejected': -291.4269714355469, 'policy_logps/chosen': -216.82119750976562, 'referece_logps/rejected': -265.8576965332031, 'referece_logps/chosen': -210.06494140625, 'logits/rejected': -0.98033207654953, 'logits/chosen': -0.920677900314331, 'epoch': 0.74}

 25%|██▍       | 662/2685 [3:41:01<10:03:34, 17.90s/it]

 25%|██▍       | 663/2685 [3:41:21<10:26:59, 18.60s/it]


 25%|██▍       | 665/2685 [3:42:02<10:54:20, 19.44s/it]
{'loss': 0.3202, 'learning_rate': 1.7618926655951478e-06, 'rewards/chosen': -1.455540418624878, 'rewards/rejected': -3.6906321048736572, 'rewards/accuracies': 0.875, 'rewards/margins': 2.2350919246673584, 'policy_logps/rejected': -362.89483642578125, 'policy_logps/chosen': -361.3727111816406, 'referece_logps/rejected': -325.9884948730469, 'referece_logps/chosen': -346.81732177734375, 'logits/rejected': -0.3493231534957886, 'logits/chosen': -0.3246455490589142, 'epoch': 0.74}

 25%|██▍       | 666/2685 [3:42:19<10:30:55, 18.75s/it]

 25%|██▍       | 667/2685 [3:42:40<10:55:57, 19.50s/it]


 25%|██▍       | 669/2685 [3:43:14<10:20:52, 18.48s/it]

 25%|██▍       | 670/2685 [3:43:28<9:30:44, 16.99s/it]

 25%|██▍       | 671/2685 [3:43:44<9:24:31, 16.82s/it]

 25%|██▌       | 672/2685 [3:44:04<9:51:28, 17.63s/it]
{'loss': 0.4128, 'learning_rate': 1.7563956154713818e-06, 'rewards/chosen': -0.9752979278564453, 'rewards/rejected': -1.88796067237854, 'rewards/accuracies': 0.5, 'rewards/margins': 0.91266268491745, 'policy_logps/rejected': -376.2840270996094, 'policy_logps/chosen': -360.6818542480469, 'referece_logps/rejected': -357.4044189453125, 'referece_logps/chosen': -350.9288635253906, 'logits/rejected': -1.0106968879699707, 'logits/chosen': -0.9902331829071045, 'epoch': 0.75}


 25%|██▌       | 674/2685 [3:44:44<10:26:40, 18.70s/it]

 25%|██▌       | 675/2685 [3:45:02<10:22:51, 18.59s/it]
{'loss': 0.2411, 'learning_rate': 1.7540231997292111e-06, 'rewards/chosen': -0.7134748697280884, 'rewards/rejected': -3.6083202362060547, 'rewards/accuracies': 0.875, 'rewards/margins': 2.8948452472686768, 'policy_logps/rejected': -369.0110168457031, 'policy_logps/chosen': -303.423095703125, 'referece_logps/rejected': -332.9278259277344, 'referece_logps/chosen': -296.28839111328125, 'logits/rejected': -0.5897380113601685, 'logits/chosen': -0.642974853515625, 'epoch': 0.75}

 25%|██▌       | 676/2685 [3:45:21<10:29:03, 18.79s/it]


 25%|██▌       | 678/2685 [3:45:58<10:23:21, 18.64s/it]

 25%|██▌       | 679/2685 [3:46:20<10:56:02, 19.62s/it]

 25%|██▌       | 680/2685 [3:46:42<11:19:06, 20.32s/it]

 25%|██▌       | 681/2685 [3:47:04<11:37:07, 20.87s/it]
{'loss': 0.3403, 'learning_rate': 1.7492487671232783e-06, 'rewards/chosen': -1.13668954372406, 'rewards/rejected': -2.05535626411438, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9186667203903198, 'policy_logps/rejected': -361.36968994140625, 'policy_logps/chosen': -344.32861328125, 'referece_logps/rejected': -340.81610107421875, 'referece_logps/chosen': -332.961669921875, 'logits/rejected': -0.2929757237434387, 'logits/chosen': -0.2698954939842224, 'epoch': 0.76}


 25%|██▌       | 683/2685 [3:47:46<11:45:13, 21.14s/it]
{'loss': 0.2759, 'learning_rate': 1.7476485528478092e-06, 'rewards/chosen': -1.0801174640655518, 'rewards/rejected': -3.3638968467712402, 'rewards/accuracies': 1.0, 'rewards/margins': 2.2837793827056885, 'policy_logps/rejected': -199.13633728027344, 'policy_logps/chosen': -159.38735961914062, 'referece_logps/rejected': -165.49737548828125, 'referece_logps/chosen': -148.586181640625, 'logits/rejected': -0.969508707523346, 'logits/chosen': -1.034989595413208, 'epoch': 0.76}

 25%|██▌       | 684/2685 [3:48:09<12:05:38, 21.76s/it]

 26%|██▌       | 685/2685 [3:48:29<11:43:30, 21.11s/it]

 26%|██▌       | 686/2685 [3:48:47<11:13:00, 20.20s/it]

 26%|██▌       | 687/2685 [3:49:04<10:39:13, 19.20s/it]

 26%|██▌       | 688/2685 [3:49:26<11:07:50, 20.07s/it]

 26%|██▌       | 689/2685 [3:49:47<11:17:29, 20.37s/it]


 26%|██▌       | 691/2685 [3:50:28<11:21:48, 20.52s/it]
{'loss': 0.3699, 'learning_rate': 1.7412042606548907e-06, 'rewards/chosen': -1.3683792352676392, 'rewards/rejected': -3.848817825317383, 'rewards/accuracies': 1.0, 'rewards/margins': 2.480438232421875, 'policy_logps/rejected': -442.89141845703125, 'policy_logps/chosen': -449.04791259765625, 'referece_logps/rejected': -404.40325927734375, 'referece_logps/chosen': -435.3641052246094, 'logits/rejected': -0.8299248814582825, 'logits/chosen': -0.7652256488800049, 'epoch': 0.77}

 26%|██▌       | 692/2685 [3:50:50<11:27:55, 20.71s/it]

 26%|██▌       | 693/2685 [3:51:09<11:15:29, 20.35s/it]

 26%|██▌       | 694/2685 [3:51:26<10:40:22, 19.30s/it]


 26%|██▌       | 696/2685 [3:52:07<11:04:41, 20.05s/it]
{'loss': 0.3219, 'learning_rate': 1.737141477741638e-06, 'rewards/chosen': -1.231690526008606, 'rewards/rejected': -3.333552360534668, 'rewards/accuracies': 0.75, 'rewards/margins': 2.1018619537353516, 'policy_logps/rejected': -279.2554626464844, 'policy_logps/chosen': -278.17938232421875, 'referece_logps/rejected': -245.919921875, 'referece_logps/chosen': -265.86248779296875, 'logits/rejected': -0.4010796546936035, 'logits/chosen': -0.3960789442062378, 'epoch': 0.78}

 26%|██▌       | 697/2685 [3:52:26<10:59:48, 19.91s/it]

 26%|██▌       | 698/2685 [3:52:50<11:35:47, 21.01s/it]

 26%|██▌       | 699/2685 [3:53:08<11:05:01, 20.09s/it]

 26%|██▌       | 700/2685 [3:53:28<11:03:08, 20.04s/it]

 26%|██▌       | 701/2685 [3:53:47<10:58:27, 19.91s/it]

 26%|██▌       | 702/2685 [3:54:07<10:56:25, 19.86s/it]

 26%|██▌       | 703/2685 [3:54:26<10:50:23, 19.69s/it]

 26%|██▌       | 704/2685 [3:54:47<11:03:45, 20.10s/it]

 26%|██▋       | 705/2685 [3:55:05<10:37:21, 19.31s/it]


 26%|██▋       | 707/2685 [3:55:41<10:02:18, 18.27s/it]
{'loss': 0.3985, 'learning_rate': 1.728109147973235e-06, 'rewards/chosen': -2.043896436691284, 'rewards/rejected': -4.230747699737549, 'rewards/accuracies': 0.875, 'rewards/margins': 2.1868515014648438, 'policy_logps/rejected': -282.56280517578125, 'policy_logps/chosen': -292.8407287597656, 'referece_logps/rejected': -240.25531005859375, 'referece_logps/chosen': -272.4017639160156, 'logits/rejected': -0.9885332584381104, 'logits/chosen': -0.9258477091789246, 'epoch': 0.79}

 26%|██▋       | 708/2685 [3:56:03<10:42:54, 19.51s/it]


 26%|██▋       | 710/2685 [3:56:47<11:22:24, 20.73s/it]
{'loss': 0.3459, 'learning_rate': 1.7256234628598632e-06, 'rewards/chosen': -0.9179423451423645, 'rewards/rejected': -2.6689486503601074, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7510064840316772, 'policy_logps/rejected': -289.547119140625, 'policy_logps/chosen': -190.17404174804688, 'referece_logps/rejected': -262.85760498046875, 'referece_logps/chosen': -180.99462890625, 'logits/rejected': -0.07292833924293518, 'logits/chosen': 0.005196675658226013, 'epoch': 0.79}

 26%|██▋       | 711/2685 [3:57:08<11:27:35, 20.90s/it]

 27%|██▋       | 712/2685 [3:57:28<11:15:18, 20.54s/it]

 27%|██▋       | 713/2685 [3:57:50<11:26:49, 20.90s/it]

 27%|██▋       | 714/2685 [3:58:11<11:28:38, 20.96s/it]


 27%|██▋       | 716/2685 [3:58:57<12:04:56, 22.09s/it]
{'loss': 0.3116, 'learning_rate': 1.7206236090706134e-06, 'rewards/chosen': -2.575932741165161, 'rewards/rejected': -5.2616424560546875, 'rewards/accuracies': 0.875, 'rewards/margins': 2.6857099533081055, 'policy_logps/rejected': -354.2418518066406, 'policy_logps/chosen': -254.53839111328125, 'referece_logps/rejected': -301.62542724609375, 'referece_logps/chosen': -228.779052734375, 'logits/rejected': -0.7633604407310486, 'logits/chosen': -0.7504337430000305, 'epoch': 0.8}

 27%|██▋       | 717/2685 [3:59:16<11:35:34, 21.21s/it]

 27%|██▋       | 718/2685 [3:59:37<11:35:27, 21.21s/it]

 27%|██▋       | 719/2685 [4:00:01<11:56:57, 21.88s/it]

 27%|██▋       | 720/2685 [4:00:22<11:49:49, 21.67s/it]

 27%|██▋       | 721/2685 [4:00:42<11:30:24, 21.09s/it]

 27%|██▋       | 722/2685 [4:00:58<10:45:24, 19.73s/it]


 27%|██▋       | 724/2685 [4:01:39<10:52:18, 19.96s/it]

 27%|██▋       | 725/2685 [4:01:59<10:50:52, 19.92s/it]
{'loss': 0.2552, 'learning_rate': 1.7130531116312202e-06, 'rewards/chosen': -1.1903185844421387, 'rewards/rejected': -4.510555267333984, 'rewards/accuracies': 1.0, 'rewards/margins': 3.3202366828918457, 'policy_logps/rejected': -342.64447021484375, 'policy_logps/chosen': -315.746337890625, 'referece_logps/rejected': -297.5389099121094, 'referece_logps/chosen': -303.8431396484375, 'logits/rejected': -0.6379059553146362, 'logits/chosen': -0.5953159332275391, 'epoch': 0.81}

 27%|██▋       | 726/2685 [4:02:21<11:05:36, 20.39s/it]

 27%|██▋       | 727/2685 [4:02:39<10:42:11, 19.68s/it]


 27%|██▋       | 729/2685 [4:03:17<10:31:27, 19.37s/it]
{'loss': 0.3025, 'learning_rate': 1.7096614085372183e-06, 'rewards/chosen': -0.7394156455993652, 'rewards/rejected': -3.6935322284698486, 'rewards/accuracies': 1.0, 'rewards/margins': 2.9541165828704834, 'policy_logps/rejected': -404.29949951171875, 'policy_logps/chosen': -372.2059326171875, 'referece_logps/rejected': -367.3641662597656, 'referece_logps/chosen': -364.811767578125, 'logits/rejected': -0.5085453987121582, 'logits/chosen': -0.5429079532623291, 'epoch': 0.81}

 27%|██▋       | 730/2685 [4:03:35<10:15:11, 18.88s/it]

 27%|██▋       | 731/2685 [4:03:52<9:54:12, 18.25s/it]

 27%|██▋       | 732/2685 [4:04:13<10:24:38, 19.19s/it]

 27%|██▋       | 733/2685 [4:04:37<11:10:56, 20.62s/it]


 27%|██▋       | 735/2685 [4:05:21<11:32:51, 21.32s/it]
{'loss': 0.3307, 'learning_rate': 1.704542890981785e-06, 'rewards/chosen': -1.1268593072891235, 'rewards/rejected': -3.1455600261688232, 'rewards/accuracies': 0.875, 'rewards/margins': 2.01870059967041, 'policy_logps/rejected': -369.64813232421875, 'policy_logps/chosen': -296.876953125, 'referece_logps/rejected': -338.1925354003906, 'referece_logps/chosen': -285.60833740234375, 'logits/rejected': -0.19327113032341003, 'logits/chosen': -0.26330262422561646, 'epoch': 0.82}


 27%|██▋       | 737/2685 [4:06:05<11:43:04, 21.66s/it]
{'loss': 0.3978, 'learning_rate': 1.7028285013959614e-06, 'rewards/chosen': -1.4466876983642578, 'rewards/rejected': -3.0756943225860596, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6290063858032227, 'policy_logps/rejected': -290.1223449707031, 'policy_logps/chosen': -303.27557373046875, 'referece_logps/rejected': -259.36541748046875, 'referece_logps/chosen': -288.8087158203125, 'logits/rejected': -0.6875609159469604, 'logits/chosen': -0.669454038143158, 'epoch': 0.82}


 28%|██▊       | 739/2685 [4:06:46<11:20:47, 20.99s/it]
{'loss': 0.3949, 'learning_rate': 1.7011100198920527e-06, 'rewards/chosen': -0.7845777273178101, 'rewards/rejected': -2.531663179397583, 'rewards/accuracies': 0.875, 'rewards/margins': 1.747085452079773, 'policy_logps/rejected': -320.018798828125, 'policy_logps/chosen': -436.8877868652344, 'referece_logps/rejected': -294.7021484375, 'referece_logps/chosen': -429.0420227050781, 'logits/rejected': -0.8549025058746338, 'logits/chosen': -0.8239015340805054, 'epoch': 0.83}


 28%|██▊       | 741/2685 [4:07:25<10:59:23, 20.35s/it]
{'loss': 0.3395, 'learning_rate': 1.699387456475182e-06, 'rewards/chosen': -1.439888834953308, 'rewards/rejected': -1.6126154661178589, 'rewards/accuracies': 0.5, 'rewards/margins': 0.172726571559906, 'policy_logps/rejected': -315.7464904785156, 'policy_logps/chosen': -433.8077087402344, 'referece_logps/rejected': -299.62030029296875, 'referece_logps/chosen': -419.4088134765625, 'logits/rejected': 0.1814052313566208, 'logits/chosen': 0.15234369039535522, 'epoch': 0.83}

 28%|██▊       | 742/2685 [4:07:47<11:07:31, 20.61s/it]


 28%|██▊       | 744/2685 [4:08:27<11:06:43, 20.61s/it]

 28%|██▊       | 745/2685 [4:08:45<10:36:21, 19.68s/it]
{'loss': 0.2777, 'learning_rate': 1.6959301240418141e-06, 'rewards/chosen': -1.236689567565918, 'rewards/rejected': -3.186610221862793, 'rewards/accuracies': 1.0, 'rewards/margins': 1.949920892715454, 'policy_logps/rejected': -355.0907287597656, 'policy_logps/chosen': -354.45428466796875, 'referece_logps/rejected': -323.22467041015625, 'referece_logps/chosen': -342.08740234375, 'logits/rejected': -0.10916803777217865, 'logits/chosen': -0.045975953340530396, 'epoch': 0.83}

 28%|██▊       | 746/2685 [4:09:02<10:08:52, 18.84s/it]


 28%|██▊       | 748/2685 [4:09:42<10:29:40, 19.50s/it]

 28%|██▊       | 749/2685 [4:10:02<10:34:12, 19.66s/it]

 28%|██▊       | 750/2685 [4:10:22<10:38:15, 19.79s/it]
{'loss': 0.452, 'learning_rate': 1.6915856768814197e-06, 'rewards/chosen': -0.9853055477142334, 'rewards/rejected': -2.847501516342163, 'rewards/accuracies': 0.75, 'rewards/margins': 1.8621959686279297, 'policy_logps/rejected': -275.57080078125, 'policy_logps/chosen': -224.3284912109375, 'referece_logps/rejected': -247.09576416015625, 'referece_logps/chosen': -214.47543334960938, 'logits/rejected': -0.6531233191490173, 'logits/chosen': -0.6071323752403259, 'epoch': 0.84}

 28%|██▊       | 751/2685 [4:10:40<10:22:23, 19.31s/it]


 28%|██▊       | 753/2685 [4:11:26<11:24:23, 21.25s/it]
{'loss': 0.4137, 'learning_rate': 1.6889669190756866e-06, 'rewards/chosen': -1.6763437986373901, 'rewards/rejected': -2.8505771160125732, 'rewards/accuracies': 0.5, 'rewards/margins': 1.174233317375183, 'policy_logps/rejected': -489.82489013671875, 'policy_logps/chosen': -589.8244018554688, 'referece_logps/rejected': -461.31915283203125, 'referece_logps/chosen': -573.0609130859375, 'logits/rejected': -0.47046729922294617, 'logits/chosen': -0.5029402375221252, 'epoch': 0.84}

 28%|██▊       | 754/2685 [4:11:48<11:28:00, 21.38s/it]

 28%|██▊       | 755/2685 [4:12:11<11:49:03, 22.04s/it]

 28%|██▊       | 756/2685 [4:12:31<11:25:19, 21.32s/it]

 28%|██▊       | 757/2685 [4:12:53<11:36:00, 21.66s/it]

 28%|██▊       | 758/2685 [4:13:15<11:35:38, 21.66s/it]

 28%|██▊       | 759/2685 [4:13:35<11:21:20, 21.23s/it]


 28%|██▊       | 761/2685 [4:14:18<11:23:05, 21.30s/it]

 28%|██▊       | 762/2685 [4:14:35<10:44:40, 20.11s/it]

 28%|██▊       | 763/2685 [4:14:55<10:48:16, 20.24s/it]

 28%|██▊       | 764/2685 [4:15:16<10:56:14, 20.50s/it]

 28%|██▊       | 765/2685 [4:15:37<10:56:29, 20.52s/it]

 29%|██▊       | 766/2685 [4:15:58<11:01:15, 20.68s/it]

 29%|██▊       | 767/2685 [4:16:19<11:00:48, 20.67s/it]

 29%|██▊       | 768/2685 [4:16:41<11:16:11, 21.16s/it]

 29%|██▊       | 769/2685 [4:17:02<11:10:29, 21.00s/it]

 29%|██▊       | 770/2685 [4:17:22<11:07:54, 20.93s/it]

 29%|██▊       | 771/2685 [4:17:43<11:05:31, 20.86s/it]

 29%|██▉       | 772/2685 [4:18:02<10:41:42, 20.13s/it]

 29%|██▉       | 773/2685 [4:18:18<10:03:07, 18.93s/it]

 29%|██▉       | 774/2685 [4:18:39<10:29:30, 19.76s/it]

 29%|██▉       | 775/2685 [4:18:54<9:40:01, 18.22s/it]

 29%|██▉       | 776/2685 [4:19:14<9:55:43, 18.72s/it]

 29%|██▉       | 777/2685 [4:19:34<10:06:27, 19.07s/it]

 29%|██▉       | 778/2685 [4:19:53<10:09:34, 19.18s/it]

 29%|██▉       | 779/2685 [4:20:08<9:30:04, 17.95s/it]

 29%|██▉       | 780/2685 [4:20:29<9:53:42, 18.70s/it]

 29%|██▉       | 781/2685 [4:20:49<10:07:23, 19.14s/it]

 29%|██▉       | 782/2685 [4:21:09<10:16:40, 19.44s/it]

 29%|██▉       | 783/2685 [4:21:32<10:46:43, 20.40s/it]

 29%|██▉       | 784/2685 [4:21:48<10:08:05, 19.19s/it]

 29%|██▉       | 785/2685 [4:22:06<9:51:14, 18.67s/it]

 29%|██▉       | 786/2685 [4:22:25<10:03:06, 19.06s/it]

 29%|██▉       | 787/2685 [4:22:45<10:10:49, 19.31s/it]

 29%|██▉       | 788/2685 [4:23:03<9:50:26, 18.68s/it]

 29%|██▉       | 789/2685 [4:23:25<10:25:46, 19.80s/it]

 29%|██▉       | 790/2685 [4:23:47<10:48:12, 20.52s/it]

 29%|██▉       | 791/2685 [4:24:13<11:34:53, 22.01s/it]
{'loss': 0.2518, 'learning_rate': 1.6550264951275402e-06, 'rewards/chosen': -0.7690844535827637, 'rewards/rejected': -3.702160596847534, 'rewards/accuracies': 1.0, 'rewards/margins': 2.9330761432647705, 'policy_logps/rejected': -333.4782409667969, 'policy_logps/chosen': -296.3905029296875, 'referece_logps/rejected': -296.4566650390625, 'referece_logps/chosen': -288.69964599609375, 'logits/rejected': 0.17519205808639526, 'logits/chosen': 0.22095376253128052, 'epoch': 0.88}


 30%|██▉       | 793/2685 [4:24:52<10:57:10, 20.84s/it]

 30%|██▉       | 794/2685 [4:25:11<10:41:10, 20.34s/it]

 30%|██▉       | 795/2685 [4:25:35<11:13:52, 21.39s/it]

 30%|██▉       | 796/2685 [4:25:54<10:52:53, 20.74s/it]

 30%|██▉       | 797/2685 [4:26:18<11:15:02, 21.45s/it]

 30%|██▉       | 798/2685 [4:26:37<10:54:06, 20.80s/it]

 30%|██▉       | 799/2685 [4:26:58<11:00:58, 21.03s/it]

 30%|██▉       | 800/2685 [4:27:20<11:06:39, 21.22s/it]

 30%|██▉       | 801/2685 [4:27:42<11:10:47, 21.36s/it]

 30%|██▉       | 802/2685 [4:28:02<10:59:15, 21.01s/it]
{'loss': 0.2804, 'learning_rate': 1.644941511207742e-06, 'rewards/chosen': -0.08250744640827179, 'rewards/rejected': -3.2840187549591064, 'rewards/accuracies': 1.0, 'rewards/margins': 3.2015113830566406, 'policy_logps/rejected': -276.0284118652344, 'policy_logps/chosen': -206.72128295898438, 'referece_logps/rejected': -243.188232421875, 'referece_logps/chosen': -205.8961944580078, 'logits/rejected': -0.9415562152862549, 'logits/chosen': -0.8982998132705688, 'epoch': 0.9}
[2024-03-29 20:00:13,203] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 30%|██▉       | 804/2685 [4:28:36<9:57:54, 19.07s/it]

 30%|██▉       | 805/2685 [4:28:53<9:37:30, 18.43s/it]

 30%|███       | 806/2685 [4:29:05<8:37:50, 16.54s/it]

 30%|███       | 807/2685 [4:29:21<8:32:14, 16.37s/it]

 30%|███       | 808/2685 [4:29:33<7:52:56, 15.12s/it]

 30%|███       | 809/2685 [4:29:56<9:09:36, 17.58s/it]
{'loss': 0.2065, 'learning_rate': 1.6384645424699834e-06, 'rewards/chosen': -0.8336998224258423, 'rewards/rejected': -3.3924777507781982, 'rewards/accuracies': 1.0, 'rewards/margins': 2.5587778091430664, 'policy_logps/rejected': -434.4952087402344, 'policy_logps/chosen': -228.97116088867188, 'referece_logps/rejected': -400.5704345703125, 'referece_logps/chosen': -220.63417053222656, 'logits/rejected': -0.7299200296401978, 'logits/chosen': -0.6135923862457275, 'epoch': 0.9}


 30%|███       | 811/2685 [4:30:33<9:33:26, 18.36s/it]

 30%|███       | 812/2685 [4:30:56<10:16:35, 19.75s/it]
[2024-03-29 20:02:51,790] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 30%|███       | 813/2685 [4:31:19<10:46:57, 20.74s/it]

 30%|███       | 814/2685 [4:31:41<10:56:20, 21.05s/it]
[2024-03-29 20:03:36,597] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 30%|███       | 815/2685 [4:31:59<10:31:59, 20.28s/it]
[2024-03-29 20:03:55,079] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 30%|███       | 816/2685 [4:32:21<10:46:45, 20.76s/it]

 30%|███       | 817/2685 [4:32:43<10:57:11, 21.11s/it]

 30%|███       | 818/2685 [4:33:03<10:47:34, 20.81s/it]

 31%|███       | 819/2685 [4:33:23<10:40:03, 20.58s/it]

 31%|███       | 820/2685 [4:33:46<10:59:34, 21.22s/it]
[2024-03-29 20:05:41,760] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 31%|███       | 821/2685 [4:34:09<11:17:24, 21.81s/it]

 31%|███       | 822/2685 [4:34:29<11:00:48, 21.28s/it]

 31%|███       | 823/2685 [4:34:49<10:45:20, 20.80s/it]

 31%|███       | 824/2685 [4:35:05<10:02:41, 19.43s/it]
{'loss': 0.3126, 'learning_rate': 1.6244325875267802e-06, 'rewards/chosen': -1.219619870185852, 'rewards/rejected': -3.3729090690612793, 'rewards/accuracies': 1.0, 'rewards/margins': 2.153289318084717, 'policy_logps/rejected': -435.4820251464844, 'policy_logps/chosen': -345.3262939453125, 'referece_logps/rejected': -401.7528991699219, 'referece_logps/chosen': -333.13006591796875, 'logits/rejected': -0.9613359570503235, 'logits/chosen': -0.889599621295929, 'epoch': 0.92}


 31%|███       | 826/2685 [4:35:45<10:14:37, 19.84s/it]

 31%|███       | 827/2685 [4:36:08<10:45:52, 20.86s/it]
[2024-03-29 20:08:04,162] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 31%|███       | 828/2685 [4:36:28<10:36:34, 20.57s/it]

 31%|███       | 829/2685 [4:36:48<10:29:22, 20.35s/it]

 31%|███       | 830/2685 [4:37:08<10:23:41, 20.17s/it]

 31%|███       | 831/2685 [4:37:27<10:18:24, 20.01s/it]

 31%|███       | 832/2685 [4:37:49<10:36:45, 20.62s/it]

 31%|███       | 833/2685 [4:38:07<10:07:30, 19.68s/it]

 31%|███       | 834/2685 [4:38:29<10:29:56, 20.42s/it]

 31%|███       | 835/2685 [4:38:52<10:56:09, 21.28s/it]

 31%|███       | 836/2685 [4:39:15<11:14:04, 21.87s/it]

 31%|███       | 837/2685 [4:39:39<11:25:36, 22.26s/it]

 31%|███       | 838/2685 [4:39:56<10:36:46, 20.69s/it]

 31%|███       | 839/2685 [4:40:14<10:17:47, 20.08s/it]

 31%|███▏      | 840/2685 [4:40:32<9:58:54, 19.48s/it]

 31%|███▏      | 841/2685 [4:40:56<10:33:32, 20.61s/it]
[2024-03-29 20:12:51,684] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 31%|███▏      | 842/2685 [4:41:12<9:57:04, 19.44s/it]
[2024-03-29 20:13:08,378] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 31%|███▏      | 843/2685 [4:41:31<9:48:29, 19.17s/it]

 31%|███▏      | 844/2685 [4:41:47<9:20:24, 18.26s/it]

 31%|███▏      | 845/2685 [4:42:10<10:02:36, 19.65s/it]

 32%|███▏      | 846/2685 [4:42:29<9:59:35, 19.56s/it]

 32%|███▏      | 847/2685 [4:42:49<10:03:18, 19.69s/it]

 32%|███▏      | 848/2685 [4:43:09<10:04:23, 19.74s/it]

 32%|███▏      | 849/2685 [4:43:22<8:59:52, 17.64s/it]

 32%|███▏      | 850/2685 [4:43:42<9:26:39, 18.53s/it]

 32%|███▏      | 851/2685 [4:44:05<10:04:00, 19.76s/it]
[2024-03-29 20:16:01,142] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.2964, 'learning_rate': 1.598662882312615e-06, 'rewards/chosen': -1.7268118858337402, 'rewards/rejected': -3.801602840423584, 'rewards/accuracies': 1.0, 'rewards/margins': 2.0747909545898438, 'policy_logps/rejected': -457.9054870605469, 'policy_logps/chosen': -353.5397644042969, 'referece_logps/rejected': -419.8894348144531, 'referece_logps/chosen': -336.27166748046875, 'logits/rejected': -0.5270691514015198, 'logits/chosen': -0.5419098138809204, 'epoch': 0.95}
[2024-03-29 20:16:18,217] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 32%|███▏      | 853/2685 [4:44:45<10:11:38, 20.03s/it]

 32%|███▏      | 854/2685 [4:45:04<10:02:42, 19.75s/it]

 32%|███▏      | 855/2685 [4:45:23<9:55:32, 19.53s/it]
{'loss': 0.4005, 'learning_rate': 1.5947904591990904e-06, 'rewards/chosen': -1.3055202960968018, 'rewards/rejected': -3.3199713230133057, 'rewards/accuracies': 0.75, 'rewards/margins': 2.014451026916504, 'policy_logps/rejected': -330.3103332519531, 'policy_logps/chosen': -330.0062561035156, 'referece_logps/rejected': -297.11065673828125, 'referece_logps/chosen': -316.9510498046875, 'logits/rejected': -0.28828442096710205, 'logits/chosen': -0.3835495114326477, 'epoch': 0.96}
[2024-03-29 20:17:36,227] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 32%|███▏      | 856/2685 [4:45:40<9:35:28, 18.88s/it]

 32%|███▏      | 857/2685 [4:46:00<9:45:21, 19.21s/it]


 32%|███▏      | 859/2685 [4:46:41<10:07:02, 19.95s/it]

 32%|███▏      | 860/2685 [4:46:59<9:50:16, 19.41s/it]

 32%|███▏      | 861/2685 [4:47:21<10:07:09, 19.97s/it]
{'loss': 0.2595, 'learning_rate': 1.58895588099049e-06, 'rewards/chosen': -1.678449034690857, 'rewards/rejected': -3.1685450077056885, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4900959730148315, 'policy_logps/rejected': -324.1068115234375, 'policy_logps/chosen': -355.7051696777344, 'referece_logps/rejected': -292.42132568359375, 'referece_logps/chosen': -338.920654296875, 'logits/rejected': -0.5020807981491089, 'logits/chosen': -0.5653597116470337, 'epoch': 0.96}
[2024-03-29 20:19:36,541] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 32%|███▏      | 863/2685 [4:47:55<9:11:29, 18.16s/it]

 32%|███▏      | 864/2685 [4:48:16<9:40:59, 19.14s/it]

 32%|███▏      | 865/2685 [4:48:34<9:31:42, 18.85s/it]

 32%|███▏      | 866/2685 [4:48:56<9:57:24, 19.71s/it]

 32%|███▏      | 867/2685 [4:49:17<10:12:34, 20.22s/it]

 32%|███▏      | 868/2685 [4:49:38<10:14:00, 20.28s/it]

 32%|███▏      | 869/2685 [4:49:58<10:14:25, 20.30s/it]

 32%|███▏      | 870/2685 [4:50:16<9:54:21, 19.65s/it]

 32%|███▏      | 871/2685 [4:50:35<9:47:08, 19.42s/it]
{'loss': 0.3796, 'learning_rate': 1.5791631570790696e-06, 'rewards/chosen': -1.2542736530303955, 'rewards/rejected': -3.0025084018707275, 'rewards/accuracies': 0.875, 'rewards/margins': 1.748234510421753, 'policy_logps/rejected': -319.84320068359375, 'policy_logps/chosen': -275.55810546875, 'referece_logps/rejected': -289.818115234375, 'referece_logps/chosen': -263.0153503417969, 'logits/rejected': -0.46499133110046387, 'logits/chosen': -0.5177742838859558, 'epoch': 0.97}
[2024-03-29 20:22:54,650] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 32%|███▏      | 872/2685 [4:50:59<10:23:57, 20.65s/it]
[2024-03-29 20:23:16,750] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 33%|███▎      | 874/2685 [4:51:42<10:37:58, 21.14s/it]
[2024-03-29 20:23:38,007] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 33%|███▎      | 875/2685 [4:52:03<10:38:58, 21.18s/it]

 33%|███▎      | 876/2685 [4:52:23<10:27:40, 20.82s/it]

 33%|███▎      | 877/2685 [4:52:44<10:28:28, 20.86s/it]

 33%|███▎      | 878/2685 [4:53:02<10:01:06, 19.96s/it]

 33%|███▎      | 879/2685 [4:53:22<9:56:52, 19.83s/it]

 33%|███▎      | 880/2685 [4:53:36<9:06:35, 18.17s/it]

 33%|███▎      | 881/2685 [4:53:56<9:25:36, 18.81s/it]
{'loss': 0.3107, 'learning_rate': 1.5692861359103302e-06, 'rewards/chosen': -0.9343281984329224, 'rewards/rejected': -2.6886467933654785, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7543184757232666, 'policy_logps/rejected': -194.31414794921875, 'policy_logps/chosen': -218.9361572265625, 'referece_logps/rejected': -167.4276885986328, 'referece_logps/chosen': -209.59286499023438, 'logits/rejected': -0.9169229865074158, 'logits/chosen': -0.9559211730957031, 'epoch': 0.98}

 33%|███▎      | 882/2685 [4:54:17<9:45:29, 19.48s/it]


 33%|███▎      | 884/2685 [4:55:02<10:26:25, 20.87s/it]
{'loss': 0.2724, 'learning_rate': 1.5663068061985524e-06, 'rewards/chosen': -1.7435643672943115, 'rewards/rejected': -3.201388120651245, 'rewards/accuracies': 0.875, 'rewards/margins': 1.457823634147644, 'policy_logps/rejected': -257.95306396484375, 'policy_logps/chosen': -186.923828125, 'referece_logps/rejected': -225.939208984375, 'referece_logps/chosen': -169.48818969726562, 'logits/rejected': -0.4882584512233734, 'logits/chosen': -0.43907132744789124, 'epoch': 0.99}


 33%|███▎      | 886/2685 [4:55:40<9:55:54, 19.87s/it]

 33%|███▎      | 887/2685 [4:56:02<10:19:39, 20.68s/it]

 33%|███▎      | 888/2685 [4:56:24<10:32:51, 21.13s/it]

 33%|███▎      | 889/2685 [4:56:48<10:54:57, 21.88s/it]

 33%|███▎      | 890/2685 [4:57:03<9:48:36, 19.68s/it]

 33%|███▎      | 891/2685 [4:57:22<9:48:39, 19.69s/it]

 33%|███▎      | 892/2685 [4:57:41<9:36:24, 19.29s/it]

 33%|███▎      | 893/2685 [4:57:59<9:23:48, 18.88s/it]

 33%|███▎      | 894/2685 [4:58:19<9:35:31, 19.28s/it]

 33%|███▎      | 895/2685 [4:58:43<10:18:30, 20.73s/it]

 33%|███▎      | 896/2685 [4:59:05<10:26:30, 21.01s/it]

 33%|███▎      | 897/2685 [4:59:26<10:31:13, 21.18s/it]

 33%|███▎      | 898/2685 [4:59:49<10:45:15, 21.67s/it]

 33%|███▎      | 899/2685 [5:00:10<10:40:00, 21.50s/it]

 34%|███▎      | 900/2685 [5:00:31<10:33:20, 21.29s/it]
{'loss': 0.314, 'learning_rate': 1.5502927152373913e-06, 'rewards/chosen': -0.5207563638687134, 'rewards/rejected': -3.412196636199951, 'rewards/accuracies': 0.875, 'rewards/margins': 2.8914401531219482, 'policy_logps/rejected': -321.8033447265625, 'policy_logps/chosen': -352.979248046875, 'referece_logps/rejected': -287.681396484375, 'referece_logps/chosen': -347.77166748046875, 'logits/rejected': -0.4664698839187622, 'logits/chosen': -0.43672049045562744, 'epoch': 1.01}


 34%|███▎      | 902/2685 [5:01:13<10:30:54, 21.23s/it]
{'loss': 0.2647, 'learning_rate': 1.548276413802037e-06, 'rewards/chosen': -1.3108094930648804, 'rewards/rejected': -3.4038684368133545, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0930590629577637, 'policy_logps/rejected': -356.9937438964844, 'policy_logps/chosen': -354.9627685546875, 'referece_logps/rejected': -322.95501708984375, 'referece_logps/chosen': -341.8546447753906, 'logits/rejected': -0.3539193868637085, 'logits/chosen': -0.3440611660480499, 'epoch': 1.01}


 34%|███▎      | 904/2685 [5:01:50<9:54:04, 20.01s/it]
{'loss': 0.3071, 'learning_rate': 1.546256920261968e-06, 'rewards/chosen': -1.6518771648406982, 'rewards/rejected': -4.080864906311035, 'rewards/accuracies': 0.875, 'rewards/margins': 2.428987503051758, 'policy_logps/rejected': -317.2861633300781, 'policy_logps/chosen': -273.8265075683594, 'referece_logps/rejected': -276.4775085449219, 'referece_logps/chosen': -257.3077392578125, 'logits/rejected': 0.22544576227664948, 'logits/chosen': 0.2788403332233429, 'epoch': 1.01}

 34%|███▎      | 905/2685 [5:02:10<9:48:28, 19.84s/it]


 34%|███▍      | 907/2685 [5:02:51<9:56:27, 20.13s/it]
{'loss': 0.3005, 'learning_rate': 1.5432217204804188e-06, 'rewards/chosen': -0.7418264150619507, 'rewards/rejected': -2.16580867767334, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4239823818206787, 'policy_logps/rejected': -262.9767150878906, 'policy_logps/chosen': -189.8933868408203, 'referece_logps/rejected': -241.31863403320312, 'referece_logps/chosen': -182.47512817382812, 'logits/rejected': -1.5523850917816162, 'logits/chosen': -1.6863559484481812, 'epoch': 1.01}


 34%|███▍      | 909/2685 [5:03:24<8:51:53, 17.97s/it]
{'loss': 0.3195, 'learning_rate': 1.5411942981587077e-06, 'rewards/chosen': -1.9101759195327759, 'rewards/rejected': -3.1965010166168213, 'rewards/accuracies': 0.75, 'rewards/margins': 1.286325454711914, 'policy_logps/rejected': -250.33599853515625, 'policy_logps/chosen': -237.31961059570312, 'referece_logps/rejected': -218.37098693847656, 'referece_logps/chosen': -218.21783447265625, 'logits/rejected': -0.6961575746536255, 'logits/chosen': -0.7642370462417603, 'epoch': 1.02}

 34%|███▍      | 910/2685 [5:03:43<9:01:53, 18.32s/it]


 34%|███▍      | 912/2685 [5:04:27<9:49:01, 19.93s/it]
{'loss': 0.4497, 'learning_rate': 1.5381472604846062e-06, 'rewards/chosen': -1.5395488739013672, 'rewards/rejected': -2.465222120285034, 'rewards/accuracies': 0.5, 'rewards/margins': 0.925673246383667, 'policy_logps/rejected': -368.7129821777344, 'policy_logps/chosen': -379.278564453125, 'referece_logps/rejected': -344.06072998046875, 'referece_logps/chosen': -363.883056640625, 'logits/rejected': 0.09824749827384949, 'logits/chosen': 0.07325775921344757, 'epoch': 1.02}

 34%|███▍      | 913/2685 [5:04:44<9:26:41, 19.19s/it]


 34%|███▍      | 915/2685 [5:05:27<10:02:30, 20.42s/it]
{'loss': 0.3245, 'learning_rate': 1.5350931732676538e-06, 'rewards/chosen': -1.7974975109100342, 'rewards/rejected': -4.521344184875488, 'rewards/accuracies': 0.875, 'rewards/margins': 2.723846912384033, 'policy_logps/rejected': -239.20425415039062, 'policy_logps/chosen': -208.89718627929688, 'referece_logps/rejected': -193.99081420898438, 'referece_logps/chosen': -190.92222595214844, 'logits/rejected': -1.0131895542144775, 'logits/chosen': -1.0705879926681519, 'epoch': 1.02}


 34%|███▍      | 917/2685 [5:06:07<9:54:34, 20.18s/it]

 34%|███▍      | 918/2685 [5:06:27<9:48:58, 20.00s/it]

 34%|███▍      | 919/2685 [5:06:40<8:55:12, 18.18s/it]
{'loss': 0.28, 'learning_rate': 1.5310101601848148e-06, 'rewards/chosen': -1.7841763496398926, 'rewards/rejected': -3.813438892364502, 'rewards/accuracies': 1.0, 'rewards/margins': 2.0292625427246094, 'policy_logps/rejected': -337.420166015625, 'policy_logps/chosen': -295.19488525390625, 'referece_logps/rejected': -299.28582763671875, 'referece_logps/chosen': -277.3531188964844, 'logits/rejected': -0.725516676902771, 'logits/chosen': -0.678164541721344, 'epoch': 1.03}


 34%|███▍      | 921/2685 [5:07:11<8:14:01, 16.80s/it]
{'loss': 0.3243, 'learning_rate': 1.5289640103269623e-06, 'rewards/chosen': -2.0400032997131348, 'rewards/rejected': -4.648580074310303, 'rewards/accuracies': 1.0, 'rewards/margins': 2.608577013015747, 'policy_logps/rejected': -288.3714599609375, 'policy_logps/chosen': -222.41197204589844, 'referece_logps/rejected': -241.88565063476562, 'referece_logps/chosen': -202.01194763183594, 'logits/rejected': -0.4619903862476349, 'logits/chosen': -0.44071274995803833, 'epoch': 1.03}

 34%|███▍      | 922/2685 [5:07:34<9:05:32, 18.57s/it]


 34%|███▍      | 924/2685 [5:08:13<9:24:03, 19.22s/it]
{'loss': 0.3275, 'learning_rate': 1.5258890148931368e-06, 'rewards/chosen': -2.5705645084381104, 'rewards/rejected': -5.135802745819092, 'rewards/accuracies': 0.875, 'rewards/margins': 2.5652379989624023, 'policy_logps/rejected': -287.90191650390625, 'policy_logps/chosen': -281.5870361328125, 'referece_logps/rejected': -236.54388427734375, 'referece_logps/chosen': -255.88140869140625, 'logits/rejected': -0.007033601403236389, 'logits/chosen': 0.0822853147983551, 'epoch': 1.03}


 34%|███▍      | 926/2685 [5:08:56<10:01:19, 20.51s/it]

 35%|███▍      | 927/2685 [5:09:15<9:52:57, 20.24s/it]
{'loss': 0.344, 'learning_rate': 1.5228071304952348e-06, 'rewards/chosen': -0.7047783136367798, 'rewards/rejected': -2.123443365097046, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4186651706695557, 'policy_logps/rejected': -232.61453247070312, 'policy_logps/chosen': -237.01507568359375, 'referece_logps/rejected': -211.3800811767578, 'referece_logps/chosen': -229.96731567382812, 'logits/rejected': -0.4264988899230957, 'logits/chosen': -0.5708969235420227, 'epoch': 1.04}


 35%|███▍      | 929/2685 [5:09:53<9:32:04, 19.55s/it]
{'loss': 0.3635, 'learning_rate': 1.5207487336272734e-06, 'rewards/chosen': -2.7478952407836914, 'rewards/rejected': -4.712734699249268, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9648398160934448, 'policy_logps/rejected': -293.02020263671875, 'policy_logps/chosen': -292.853271484375, 'referece_logps/rejected': -245.89285278320312, 'referece_logps/chosen': -265.37432861328125, 'logits/rejected': 0.5273343920707703, 'logits/chosen': 0.5509722232818604, 'epoch': 1.04}

 35%|███▍      | 930/2685 [5:10:12<9:30:41, 19.51s/it]

 35%|███▍      | 931/2685 [5:10:32<9:35:07, 19.67s/it]


 35%|███▍      | 933/2685 [5:11:09<9:12:44, 18.93s/it]
{'loss': 0.3101, 'learning_rate': 1.516622856383393e-06, 'rewards/chosen': -0.8170225620269775, 'rewards/rejected': -2.9393703937530518, 'rewards/accuracies': 0.75, 'rewards/margins': 2.122347831726074, 'policy_logps/rejected': -281.44219970703125, 'policy_logps/chosen': -288.7960205078125, 'referece_logps/rejected': -252.0484619140625, 'referece_logps/chosen': -280.62579345703125, 'logits/rejected': -0.8183048963546753, 'logits/chosen': -0.8278441429138184, 'epoch': 1.04}

 35%|███▍      | 934/2685 [5:11:28<9:19:37, 19.18s/it]


 35%|███▍      | 936/2685 [5:12:12<9:53:08, 20.35s/it]

 35%|███▍      | 937/2685 [5:12:33<9:59:21, 20.57s/it]
{'loss': 0.3846, 'learning_rate': 1.5124849478953166e-06, 'rewards/chosen': -1.1479922533035278, 'rewards/rejected': -3.5094010829925537, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3614089488983154, 'policy_logps/rejected': -342.20068359375, 'policy_logps/chosen': -278.43310546875, 'referece_logps/rejected': -307.106689453125, 'referece_logps/chosen': -266.95318603515625, 'logits/rejected': -0.671330451965332, 'logits/chosen': -0.6032460927963257, 'epoch': 1.05}

 35%|███▍      | 938/2685 [5:12:54<10:08:30, 20.90s/it]

 35%|███▍      | 939/2685 [5:13:14<9:56:44, 20.51s/it]

 35%|███▌      | 940/2685 [5:13:34<9:54:00, 20.42s/it]

 35%|███▌      | 941/2685 [5:13:55<9:54:33, 20.45s/it]


 35%|███▌      | 943/2685 [5:14:39<10:23:20, 21.47s/it]

 35%|███▌      | 944/2685 [5:14:59<10:11:11, 21.06s/it]

 35%|███▌      | 945/2685 [5:15:19<10:01:45, 20.75s/it]

 35%|███▌      | 946/2685 [5:15:38<9:40:15, 20.02s/it]
{'loss': 0.2122, 'learning_rate': 1.5031311641491015e-06, 'rewards/chosen': -1.1996350288391113, 'rewards/rejected': -2.332812547683716, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1331775188446045, 'policy_logps/rejected': -284.2552490234375, 'policy_logps/chosen': -395.6818542480469, 'referece_logps/rejected': -260.9271240234375, 'referece_logps/chosen': -383.68548583984375, 'logits/rejected': -0.7103303670883179, 'logits/chosen': -0.6869856119155884, 'epoch': 1.06}


 35%|███▌      | 948/2685 [5:16:20<9:50:59, 20.41s/it]
{'loss': 0.3548, 'learning_rate': 1.5010444511688928e-06, 'rewards/chosen': -1.2323448657989502, 'rewards/rejected': -2.7187185287475586, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4863735437393188, 'policy_logps/rejected': -291.43841552734375, 'policy_logps/chosen': -265.6072082519531, 'referece_logps/rejected': -264.2512512207031, 'referece_logps/chosen': -253.28375244140625, 'logits/rejected': -0.6332072019577026, 'logits/chosen': -0.6841568946838379, 'epoch': 1.06}


 35%|███▌      | 950/2685 [5:16:59<9:45:31, 20.25s/it]

 35%|███▌      | 951/2685 [5:17:18<9:30:45, 19.75s/it]

 35%|███▌      | 952/2685 [5:17:37<9:29:15, 19.71s/it]

 35%|███▌      | 953/2685 [5:18:00<9:52:38, 20.53s/it]
{'loss': 0.2258, 'learning_rate': 1.495814932949933e-06, 'rewards/chosen': -1.8032333850860596, 'rewards/rejected': -5.958508014678955, 'rewards/accuracies': 1.0, 'rewards/margins': 4.155274868011475, 'policy_logps/rejected': -600.2286376953125, 'policy_logps/chosen': -594.7318115234375, 'referece_logps/rejected': -540.6436157226562, 'referece_logps/chosen': -576.699462890625, 'logits/rejected': 0.6247994899749756, 'logits/chosen': 0.5945301651954651, 'epoch': 1.06}


 36%|███▌      | 955/2685 [5:18:40<9:44:15, 20.26s/it]

 36%|███▌      | 956/2685 [5:19:02<9:56:36, 20.70s/it]

 36%|███▌      | 957/2685 [5:19:22<9:50:01, 20.49s/it]

 36%|███▌      | 958/2685 [5:19:41<9:42:33, 20.24s/it]

 36%|███▌      | 959/2685 [5:19:59<9:20:31, 19.49s/it]

 36%|███▌      | 960/2685 [5:20:18<9:13:15, 19.24s/it]

 36%|███▌      | 961/2685 [5:20:40<9:34:53, 20.01s/it]

 36%|███▌      | 962/2685 [5:21:02<9:51:26, 20.60s/it]
{'loss': 0.31, 'learning_rate': 1.4863564635107683e-06, 'rewards/chosen': -1.5023783445358276, 'rewards/rejected': -2.463165760040283, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9607876539230347, 'policy_logps/rejected': -317.925048828125, 'policy_logps/chosen': -371.1681213378906, 'referece_logps/rejected': -293.2934265136719, 'referece_logps/chosen': -356.14434814453125, 'logits/rejected': 0.2005307674407959, 'logits/chosen': 0.09288612008094788, 'epoch': 1.07}


 36%|███▌      | 964/2685 [5:21:33<8:36:54, 18.02s/it]

 36%|███▌      | 965/2685 [5:21:56<9:19:03, 19.50s/it]
{'loss': 0.3498, 'learning_rate': 1.4831908430096113e-06, 'rewards/chosen': -1.4315588474273682, 'rewards/rejected': -2.9531991481781006, 'rewards/accuracies': 0.75, 'rewards/margins': 1.521640419960022, 'policy_logps/rejected': -290.38330078125, 'policy_logps/chosen': -263.3966369628906, 'referece_logps/rejected': -260.851318359375, 'referece_logps/chosen': -249.08106994628906, 'logits/rejected': -1.265517234802246, 'logits/chosen': -1.1010565757751465, 'epoch': 1.08}


 36%|███▌      | 967/2685 [5:22:42<10:06:02, 21.17s/it]
[2024-03-29 20:54:37,869] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.2886, 'learning_rate': 1.4810769103163005e-06, 'rewards/chosen': -0.982492208480835, 'rewards/rejected': -4.378143310546875, 'rewards/accuracies': 0.75, 'rewards/margins': 3.395650863647461, 'policy_logps/rejected': -471.2855529785156, 'policy_logps/chosen': -389.79461669921875, 'referece_logps/rejected': -427.5041809082031, 'referece_logps/chosen': -379.9697265625, 'logits/rejected': -0.12168989330530167, 'logits/chosen': -0.07588692009449005, 'epoch': 1.08}


 36%|███▌      | 969/2685 [5:23:18<9:23:56, 19.72s/it]
{'loss': 0.376, 'learning_rate': 1.4789601767586172e-06, 'rewards/chosen': -1.3159821033477783, 'rewards/rejected': -3.1364903450012207, 'rewards/accuracies': 0.75, 'rewards/margins': 1.8205084800720215, 'policy_logps/rejected': -589.595458984375, 'policy_logps/chosen': -516.8109130859375, 'referece_logps/rejected': -558.2305908203125, 'referece_logps/chosen': -503.65106201171875, 'logits/rejected': -0.2819705903530121, 'logits/chosen': -0.3465276062488556, 'epoch': 1.08}


 36%|███▌      | 971/2685 [5:23:58<9:26:14, 19.82s/it]

 36%|███▌      | 972/2685 [5:24:18<9:26:17, 19.84s/it]
{'loss': 0.2999, 'learning_rate': 1.4757798517640936e-06, 'rewards/chosen': -0.5206169486045837, 'rewards/rejected': -3.262664556503296, 'rewards/accuracies': 0.875, 'rewards/margins': 2.7420473098754883, 'policy_logps/rejected': -312.30462646484375, 'policy_logps/chosen': -268.45684814453125, 'referece_logps/rejected': -279.677978515625, 'referece_logps/chosen': -263.25067138671875, 'logits/rejected': -0.5189922451972961, 'logits/chosen': -0.5510116815567017, 'epoch': 1.09}

 36%|███▌      | 973/2685 [5:24:35<9:04:53, 19.10s/it]

 36%|███▋      | 974/2685 [5:24:55<9:11:39, 19.34s/it]


 36%|███▋      | 976/2685 [5:25:32<8:55:25, 18.80s/it]

 36%|███▋      | 977/2685 [5:25:55<9:25:40, 19.87s/it]
{'loss': 0.3005, 'learning_rate': 1.4704654806027557e-06, 'rewards/chosen': -1.5413151979446411, 'rewards/rejected': -3.780144214630127, 'rewards/accuracies': 0.875, 'rewards/margins': 2.2388288974761963, 'policy_logps/rejected': -472.27398681640625, 'policy_logps/chosen': -462.1108703613281, 'referece_logps/rejected': -434.4725036621094, 'referece_logps/chosen': -446.69769287109375, 'logits/rejected': -0.508840024471283, 'logits/chosen': -0.5378843545913696, 'epoch': 1.09}

 36%|███▋      | 978/2685 [5:26:15<9:32:08, 20.11s/it]

 36%|███▋      | 979/2685 [5:26:31<8:58:54, 18.95s/it]

 36%|███▋      | 980/2685 [5:26:53<9:24:36, 19.87s/it]


 37%|███▋      | 982/2685 [5:27:38<10:01:39, 21.20s/it]
{'loss': 0.3364, 'learning_rate': 1.4651339902108638e-06, 'rewards/chosen': -0.6817648410797119, 'rewards/rejected': -2.993224859237671, 'rewards/accuracies': 0.875, 'rewards/margins': 2.31145977973938, 'policy_logps/rejected': -313.4446716308594, 'policy_logps/chosen': -216.42596435546875, 'referece_logps/rejected': -283.51239013671875, 'referece_logps/chosen': -209.6083221435547, 'logits/rejected': -1.0892359018325806, 'logits/chosen': -1.0971616506576538, 'epoch': 1.1}


 37%|███▋      | 984/2685 [5:28:18<9:47:28, 20.72s/it]

 37%|███▋      | 985/2685 [5:28:37<9:26:42, 20.00s/it]

 37%|███▋      | 986/2685 [5:28:56<9:21:47, 19.84s/it]

 37%|███▋      | 987/2685 [5:29:17<9:25:34, 19.98s/it]

 37%|███▋      | 988/2685 [5:29:31<8:35:05, 18.21s/it]

 37%|███▋      | 989/2685 [5:29:53<9:06:30, 19.33s/it]
{'loss': 0.3145, 'learning_rate': 1.4576415128511822e-06, 'rewards/chosen': -1.424594521522522, 'rewards/rejected': -3.322570562362671, 'rewards/accuracies': 0.875, 'rewards/margins': 1.8979758024215698, 'policy_logps/rejected': -448.665771484375, 'policy_logps/chosen': -279.7545166015625, 'referece_logps/rejected': -415.4400634765625, 'referece_logps/chosen': -265.5085754394531, 'logits/rejected': -0.3689766824245453, 'logits/chosen': -0.5287182927131653, 'epoch': 1.11}

 37%|███▋      | 990/2685 [5:30:12<9:08:24, 19.41s/it]

 37%|███▋      | 991/2685 [5:30:32<9:10:30, 19.50s/it]

 37%|███▋      | 992/2685 [5:30:52<9:15:10, 19.68s/it]

 37%|███▋      | 993/2685 [5:31:12<9:15:16, 19.69s/it]

 37%|███▋      | 994/2685 [5:31:32<9:16:22, 19.74s/it]
[2024-03-29 21:03:47,290] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 37%|███▋      | 995/2685 [5:31:51<9:15:21, 19.72s/it]

 37%|███▋      | 996/2685 [5:32:09<9:00:38, 19.21s/it]
[2024-03-29 21:04:26,113] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 37%|███▋      | 997/2685 [5:32:30<9:13:51, 19.69s/it]


 37%|███▋      | 999/2685 [5:33:01<8:10:02, 17.44s/it]

 37%|███▋      | 1000/2685 [5:33:23<8:47:02, 18.77s/it]

 37%|███▋      | 1001/2685 [5:33:53<10:22:07, 22.17s/it]
{'loss': 0.2156, 'learning_rate': 1.4447216275435022e-06, 'rewards/chosen': -1.2618862390518188, 'rewards/rejected': -3.1668736934661865, 'rewards/accuracies': 1.0, 'rewards/margins': 1.9049875736236572, 'policy_logps/rejected': -266.9207763671875, 'policy_logps/chosen': -283.662353515625, 'referece_logps/rejected': -235.25204467773438, 'referece_logps/chosen': -271.0434875488281, 'logits/rejected': -0.15682432055473328, 'logits/chosen': -0.14419034123420715, 'epoch': 1.12}

 37%|███▋      | 1002/2685 [5:34:12<9:59:54, 21.39s/it]

 37%|███▋      | 1003/2685 [5:34:32<9:46:09, 20.91s/it]

 37%|███▋      | 1004/2685 [5:34:52<9:38:32, 20.65s/it]

 37%|███▋      | 1005/2685 [5:35:07<8:46:09, 18.79s/it]


 38%|███▊      | 1007/2685 [5:35:47<9:06:07, 19.53s/it]

 38%|███▊      | 1008/2685 [5:36:07<9:09:26, 19.66s/it]

 38%|███▊      | 1009/2685 [5:36:27<9:11:13, 19.73s/it]
{'loss': 0.2747, 'learning_rate': 1.4360564195609945e-06, 'rewards/chosen': -1.9402947425842285, 'rewards/rejected': -3.4474215507507324, 'rewards/accuracies': 0.75, 'rewards/margins': 1.5071265697479248, 'policy_logps/rejected': -313.6123352050781, 'policy_logps/chosen': -269.5716552734375, 'referece_logps/rejected': -279.1380920410156, 'referece_logps/chosen': -250.16871643066406, 'logits/rejected': -0.5438859462738037, 'logits/chosen': -0.6728134751319885, 'epoch': 1.13}
[2024-03-29 21:08:44,809] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 38%|███▊      | 1010/2685 [5:36:49<9:29:55, 20.42s/it]
[2024-03-29 21:09:05,792] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 38%|███▊      | 1011/2685 [5:37:10<9:34:20, 20.59s/it]

 38%|███▊      | 1012/2685 [5:37:30<9:28:00, 20.37s/it]

 38%|███▊      | 1013/2685 [5:37:51<9:40:36, 20.84s/it]
[2024-03-29 21:10:10,206] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 38%|███▊      | 1014/2685 [5:38:14<9:55:12, 21.37s/it]


 38%|███▊      | 1016/2685 [5:38:57<9:56:22, 21.44s/it]
{'loss': 0.295, 'learning_rate': 1.42844101401821e-06, 'rewards/chosen': -1.0089972019195557, 'rewards/rejected': -3.2961766719818115, 'rewards/accuracies': 0.875, 'rewards/margins': 2.2871792316436768, 'policy_logps/rejected': -327.674072265625, 'policy_logps/chosen': -245.2730255126953, 'referece_logps/rejected': -294.7123107910156, 'referece_logps/chosen': -235.18307495117188, 'logits/rejected': -1.2108681201934814, 'logits/chosen': -1.1877212524414062, 'epoch': 1.14}


 38%|███▊      | 1018/2685 [5:39:37<9:36:19, 20.74s/it]

 38%|███▊      | 1019/2685 [5:39:57<9:28:51, 20.49s/it]
{'loss': 0.2764, 'learning_rate': 1.4251678830356406e-06, 'rewards/chosen': -1.456707239151001, 'rewards/rejected': -4.125583648681641, 'rewards/accuracies': 1.0, 'rewards/margins': 2.6688756942749023, 'policy_logps/rejected': -297.4937744140625, 'policy_logps/chosen': -227.02804565429688, 'referece_logps/rejected': -256.2379150390625, 'referece_logps/chosen': -212.4609832763672, 'logits/rejected': -0.17938560247421265, 'logits/chosen': -0.11711055785417557, 'epoch': 1.14}


 38%|███▊      | 1021/2685 [5:40:35<9:12:03, 19.91s/it]

 38%|███▊      | 1022/2685 [5:40:55<9:11:23, 19.89s/it]
{'loss': 0.4125, 'learning_rate': 1.4218891825009618e-06, 'rewards/chosen': -1.2224385738372803, 'rewards/rejected': -2.3094255924224854, 'rewards/accuracies': 0.875, 'rewards/margins': 1.086987018585205, 'policy_logps/rejected': -411.58465576171875, 'policy_logps/chosen': -382.43438720703125, 'referece_logps/rejected': -388.4903564453125, 'referece_logps/chosen': -370.21002197265625, 'logits/rejected': -0.3961629271507263, 'logits/chosen': -0.4337776303291321, 'epoch': 1.14}

 38%|███▊      | 1023/2685 [5:41:16<9:22:03, 20.29s/it]

 38%|███▊      | 1024/2685 [5:41:34<9:01:12, 19.55s/it]

 38%|███▊      | 1025/2685 [5:41:54<9:05:03, 19.70s/it]

 38%|███▊      | 1026/2685 [5:42:15<9:12:21, 19.98s/it]

 38%|███▊      | 1027/2685 [5:42:35<9:09:15, 19.88s/it]


 38%|███▊      | 1029/2685 [5:43:14<9:02:59, 19.67s/it]
{'loss': 0.3512, 'learning_rate': 1.414217463281007e-06, 'rewards/chosen': -1.7952091693878174, 'rewards/rejected': -4.3696441650390625, 'rewards/accuracies': 0.875, 'rewards/margins': 2.574434757232666, 'policy_logps/rejected': -562.5645751953125, 'policy_logps/chosen': -689.669921875, 'referece_logps/rejected': -518.8681640625, 'referece_logps/chosen': -671.7178955078125, 'logits/rejected': 0.0840255469083786, 'logits/chosen': -0.02749616652727127, 'epoch': 1.15}


 38%|███▊      | 1031/2685 [5:43:52<8:51:33, 19.28s/it]
{'loss': 0.1711, 'learning_rate': 1.4120200934441063e-06, 'rewards/chosen': -0.28159236907958984, 'rewards/rejected': -2.679650068283081, 'rewards/accuracies': 1.0, 'rewards/margins': 2.3980579376220703, 'policy_logps/rejected': -343.4103088378906, 'policy_logps/chosen': -312.3094787597656, 'referece_logps/rejected': -316.61383056640625, 'referece_logps/chosen': -309.4935607910156, 'logits/rejected': -0.7113529443740845, 'logits/chosen': -0.7364416122436523, 'epoch': 1.15}


 38%|███▊      | 1033/2685 [5:44:32<9:01:17, 19.66s/it]
{'loss': 0.3291, 'learning_rate': 1.4098203247965873e-06, 'rewards/chosen': -1.0412923097610474, 'rewards/rejected': -2.983440399169922, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9421480894088745, 'policy_logps/rejected': -301.082763671875, 'policy_logps/chosen': -295.508544921875, 'referece_logps/rejected': -271.2484130859375, 'referece_logps/chosen': -285.0956115722656, 'logits/rejected': 0.01601549983024597, 'logits/chosen': 0.05746939778327942, 'epoch': 1.15}

 39%|███▊      | 1034/2685 [5:44:52<9:04:43, 19.80s/it]

 39%|███▊      | 1035/2685 [5:45:12<9:06:31, 19.87s/it]

 39%|███▊      | 1036/2685 [5:45:33<9:14:02, 20.16s/it]
[2024-03-29 21:17:51,159] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 39%|███▊      | 1037/2685 [5:45:55<9:31:08, 20.79s/it]

 39%|███▊      | 1038/2685 [5:46:15<9:26:08, 20.62s/it]


 39%|███▊      | 1040/2685 [5:46:58<9:31:46, 20.85s/it]

 39%|███▉      | 1041/2685 [5:47:18<9:24:35, 20.61s/it]

 39%|███▉      | 1042/2685 [5:47:38<9:18:28, 20.39s/it]

 39%|███▉      | 1043/2685 [5:47:56<8:59:53, 19.73s/it]
{'loss': 0.3583, 'learning_rate': 1.3987859481367546e-06, 'rewards/chosen': -1.14120614528656, 'rewards/rejected': -2.457531690597534, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3163254261016846, 'policy_logps/rejected': -238.60336303710938, 'policy_logps/chosen': -233.46945190429688, 'referece_logps/rejected': -214.02804565429688, 'referece_logps/chosen': -222.05740356445312, 'logits/rejected': -1.2571965456008911, 'logits/chosen': -1.3216012716293335, 'epoch': 1.17}

 39%|███▉      | 1044/2685 [5:48:14<8:50:37, 19.40s/it]
[2024-03-29 21:20:32,208] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 39%|███▉      | 1045/2685 [5:48:36<9:09:30, 20.10s/it]


 39%|███▉      | 1047/2685 [5:49:16<9:06:03, 20.00s/it]
{'loss': 0.3242, 'learning_rate': 1.3943558551133186e-06, 'rewards/chosen': -0.4333314895629883, 'rewards/rejected': -2.6339035034179688, 'rewards/accuracies': 0.75, 'rewards/margins': 2.2005720138549805, 'policy_logps/rejected': -214.9903564453125, 'policy_logps/chosen': -207.1736602783203, 'referece_logps/rejected': -188.6513214111328, 'referece_logps/chosen': -202.84034729003906, 'logits/rejected': -0.6577911376953125, 'logits/chosen': -0.5910158157348633, 'epoch': 1.17}

 39%|███▉      | 1048/2685 [5:49:36<9:06:23, 20.03s/it]

 39%|███▉      | 1049/2685 [5:49:59<9:30:46, 20.93s/it]

 39%|███▉      | 1050/2685 [5:50:17<9:01:44, 19.88s/it]


 39%|███▉      | 1052/2685 [5:50:58<9:15:55, 20.43s/it]
{'loss': 0.2801, 'learning_rate': 1.3888053361424983e-06, 'rewards/chosen': -0.889130711555481, 'rewards/rejected': -2.8010618686676025, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9119313955307007, 'policy_logps/rejected': -297.1722106933594, 'policy_logps/chosen': -256.3428039550781, 'referece_logps/rejected': -269.1615905761719, 'referece_logps/chosen': -247.45147705078125, 'logits/rejected': 0.2649587094783783, 'logits/chosen': 0.3297276496887207, 'epoch': 1.18}

 39%|███▉      | 1053/2685 [5:51:18<9:14:16, 20.38s/it]

 39%|███▉      | 1054/2685 [5:51:38<9:09:42, 20.22s/it]


 39%|███▉      | 1056/2685 [5:52:18<9:00:47, 19.92s/it]

 39%|███▉      | 1057/2685 [5:52:38<9:02:37, 20.00s/it]
{'loss': 0.3226, 'learning_rate': 1.38324066937877e-06, 'rewards/chosen': -1.1654480695724487, 'rewards/rejected': -5.627199649810791, 'rewards/accuracies': 1.0, 'rewards/margins': 4.461751461029053, 'policy_logps/rejected': -389.9513854980469, 'policy_logps/chosen': -292.18914794921875, 'referece_logps/rejected': -333.67938232421875, 'referece_logps/chosen': -280.5346374511719, 'logits/rejected': -1.2028590440750122, 'logits/chosen': -1.1262967586517334, 'epoch': 1.18}

 39%|███▉      | 1058/2685 [5:52:55<8:41:30, 19.23s/it]


 39%|███▉      | 1060/2685 [5:53:38<9:11:42, 20.37s/it]
{'loss': 0.2376, 'learning_rate': 1.3798951625930416e-06, 'rewards/chosen': -0.8532208800315857, 'rewards/rejected': -4.790266990661621, 'rewards/accuracies': 0.875, 'rewards/margins': 3.9370462894439697, 'policy_logps/rejected': -362.3966979980469, 'policy_logps/chosen': -323.5204162597656, 'referece_logps/rejected': -314.4940185546875, 'referece_logps/chosen': -314.98822021484375, 'logits/rejected': -0.7458550930023193, 'logits/chosen': -0.6700005531311035, 'epoch': 1.18}

 40%|███▉      | 1061/2685 [5:53:55<8:46:30, 19.45s/it]

 40%|███▉      | 1062/2685 [5:54:15<8:46:12, 19.45s/it]

 40%|███▉      | 1063/2685 [5:54:38<9:14:03, 20.50s/it]

 40%|███▉      | 1064/2685 [5:54:55<8:52:01, 19.69s/it]


 40%|███▉      | 1066/2685 [5:55:30<8:17:39, 18.44s/it]
{'loss': 0.2662, 'learning_rate': 1.3731892634263305e-06, 'rewards/chosen': -1.6169705390930176, 'rewards/rejected': -3.1747546195983887, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5577839612960815, 'policy_logps/rejected': -286.31658935546875, 'policy_logps/chosen': -295.955810546875, 'referece_logps/rejected': -254.56903076171875, 'referece_logps/chosen': -279.78607177734375, 'logits/rejected': -0.3076087534427643, 'logits/chosen': -0.21998685598373413, 'epoch': 1.19}


 40%|███▉      | 1068/2685 [5:56:13<8:52:40, 19.77s/it]
{'loss': 0.2318, 'learning_rate': 1.370949600869768e-06, 'rewards/chosen': -0.20110750198364258, 'rewards/rejected': -3.6965479850769043, 'rewards/accuracies': 0.875, 'rewards/margins': 3.4954402446746826, 'policy_logps/rejected': -310.708740234375, 'policy_logps/chosen': -305.06280517578125, 'referece_logps/rejected': -273.74322509765625, 'referece_logps/chosen': -303.0517272949219, 'logits/rejected': -0.5108673572540283, 'logits/chosen': -0.5638810396194458, 'epoch': 1.19}

 40%|███▉      | 1069/2685 [5:56:33<8:58:16, 19.99s/it]

 40%|███▉      | 1070/2685 [5:56:48<8:13:50, 18.35s/it]

 40%|███▉      | 1071/2685 [5:57:05<8:05:47, 18.06s/it]

 40%|███▉      | 1072/2685 [5:57:25<8:23:39, 18.73s/it]

 40%|███▉      | 1073/2685 [5:57:45<8:32:40, 19.08s/it]

 40%|████      | 1074/2685 [5:58:09<9:07:02, 20.37s/it]

 40%|████      | 1075/2685 [5:58:24<8:27:18, 18.91s/it]

 40%|████      | 1076/2685 [5:58:40<8:04:35, 18.07s/it]

 40%|████      | 1077/2685 [5:59:02<8:36:31, 19.27s/it]

 40%|████      | 1078/2685 [5:59:24<8:56:28, 20.03s/it]


 40%|████      | 1080/2685 [5:59:59<8:26:12, 18.92s/it]
{'loss': 0.249, 'learning_rate': 1.3574667291876047e-06, 'rewards/chosen': -0.6184743642807007, 'rewards/rejected': -3.0032365322113037, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3847620487213135, 'policy_logps/rejected': -261.6238098144531, 'policy_logps/chosen': -211.29534912109375, 'referece_logps/rejected': -231.59144592285156, 'referece_logps/chosen': -205.110595703125, 'logits/rejected': 0.08128741383552551, 'logits/chosen': 0.002218768000602722, 'epoch': 1.21}

 40%|████      | 1081/2685 [6:00:16<8:11:43, 18.39s/it]

 40%|████      | 1082/2685 [6:00:37<8:32:56, 19.20s/it]

 40%|████      | 1083/2685 [6:00:58<8:46:25, 19.72s/it]

 40%|████      | 1084/2685 [6:01:17<8:42:29, 19.58s/it]

 40%|████      | 1085/2685 [6:01:31<7:59:25, 17.98s/it]

 40%|████      | 1086/2685 [6:01:51<8:12:07, 18.47s/it]

 40%|████      | 1087/2685 [6:02:09<8:11:44, 18.46s/it]

 41%|████      | 1088/2685 [6:02:30<8:28:48, 19.12s/it]

 41%|████      | 1089/2685 [6:02:50<8:38:12, 19.48s/it]

 41%|████      | 1090/2685 [6:03:08<8:20:57, 18.84s/it]

 41%|████      | 1091/2685 [6:03:28<8:27:38, 19.11s/it]

 41%|████      | 1092/2685 [6:03:49<8:46:34, 19.83s/it]

 41%|████      | 1093/2685 [6:04:10<8:53:27, 20.11s/it]

 41%|████      | 1094/2685 [6:04:29<8:46:46, 19.87s/it]

 41%|████      | 1095/2685 [6:04:50<8:56:28, 20.24s/it]

 41%|████      | 1096/2685 [6:05:09<8:41:19, 19.69s/it]


 41%|████      | 1098/2685 [6:05:49<8:42:37, 19.76s/it]

 41%|████      | 1099/2685 [6:06:07<8:33:43, 19.43s/it]

 41%|████      | 1100/2685 [6:06:30<8:56:30, 20.31s/it]

 41%|████      | 1101/2685 [6:06:49<8:51:00, 20.11s/it]

 41%|████      | 1102/2685 [6:07:10<8:51:57, 20.16s/it]

 41%|████      | 1103/2685 [6:07:31<8:59:35, 20.47s/it]

 41%|████      | 1104/2685 [6:07:49<8:43:58, 19.89s/it]

 41%|████      | 1105/2685 [6:08:13<9:12:12, 20.97s/it]

 41%|████      | 1106/2685 [6:08:32<8:53:54, 20.29s/it]

 41%|████      | 1107/2685 [6:08:52<8:57:56, 20.45s/it]

 41%|████▏     | 1108/2685 [6:09:09<8:29:52, 19.40s/it]

 41%|████▏     | 1109/2685 [6:09:30<8:36:16, 19.65s/it]

 41%|████▏     | 1110/2685 [6:09:52<8:56:27, 20.44s/it]

 41%|████▏     | 1111/2685 [6:10:12<8:49:35, 20.19s/it]

 41%|████▏     | 1112/2685 [6:10:31<8:44:15, 20.00s/it]

 41%|████▏     | 1113/2685 [6:10:51<8:42:41, 19.95s/it]

 41%|████▏     | 1114/2685 [6:11:11<8:45:52, 20.08s/it]

 42%|████▏     | 1115/2685 [6:11:32<8:50:53, 20.29s/it]

 42%|████▏     | 1116/2685 [6:11:52<8:46:25, 20.13s/it]

 42%|████▏     | 1117/2685 [6:12:11<8:35:09, 19.71s/it]

 42%|████▏     | 1118/2685 [6:12:31<8:43:07, 20.03s/it]

 42%|████▏     | 1119/2685 [6:12:51<8:39:42, 19.91s/it]

 42%|████▏     | 1120/2685 [6:13:12<8:50:59, 20.36s/it]

 42%|████▏     | 1121/2685 [6:13:32<8:47:16, 20.23s/it]

 42%|████▏     | 1122/2685 [6:13:49<8:22:32, 19.29s/it]

 42%|████▏     | 1123/2685 [6:14:11<8:37:59, 19.90s/it]

 42%|████▏     | 1124/2685 [6:14:30<8:32:41, 19.71s/it]

 42%|████▏     | 1125/2685 [6:14:53<8:55:15, 20.59s/it]

 42%|████▏     | 1126/2685 [6:15:13<8:50:05, 20.40s/it]

 42%|████▏     | 1127/2685 [6:15:32<8:45:05, 20.22s/it]

 42%|████▏     | 1128/2685 [6:15:52<8:41:47, 20.11s/it]

 42%|████▏     | 1129/2685 [6:16:12<8:39:59, 20.05s/it]

 42%|████▏     | 1130/2685 [6:16:31<8:30:05, 19.68s/it]

 42%|████▏     | 1131/2685 [6:16:52<8:39:58, 20.08s/it]

 42%|████▏     | 1132/2685 [6:17:12<8:39:48, 20.08s/it]

 42%|████▏     | 1133/2685 [6:17:30<8:22:29, 19.43s/it]

 42%|████▏     | 1134/2685 [6:17:50<8:23:24, 19.47s/it]

 42%|████▏     | 1135/2685 [6:18:07<8:11:14, 19.02s/it]

 42%|████▏     | 1136/2685 [6:18:28<8:24:11, 19.53s/it]

 42%|████▏     | 1137/2685 [6:18:46<8:11:25, 19.05s/it]

 42%|████▏     | 1138/2685 [6:19:07<8:26:35, 19.65s/it]

 42%|████▏     | 1139/2685 [6:19:28<8:37:29, 20.08s/it]

 42%|████▏     | 1140/2685 [6:19:48<8:31:57, 19.88s/it]

 42%|████▏     | 1141/2685 [6:20:09<8:42:36, 20.31s/it]

 43%|████▎     | 1142/2685 [6:20:30<8:50:54, 20.64s/it]

 43%|████▎     | 1143/2685 [6:20:47<8:20:58, 19.49s/it]

 43%|████▎     | 1144/2685 [6:21:04<8:01:39, 18.75s/it]

 43%|████▎     | 1145/2685 [6:21:24<8:08:46, 19.04s/it]

 43%|████▎     | 1146/2685 [6:21:37<7:21:41, 17.22s/it]

 43%|████▎     | 1147/2685 [6:21:59<7:55:42, 18.56s/it]

 43%|████▎     | 1148/2685 [6:22:19<8:05:32, 18.95s/it]

 43%|████▎     | 1149/2685 [6:22:42<8:39:51, 20.31s/it]

 43%|████▎     | 1150/2685 [6:23:00<8:19:28, 19.52s/it]

 43%|████▎     | 1151/2685 [6:23:15<7:47:28, 18.28s/it]

 43%|████▎     | 1152/2685 [6:23:32<7:37:51, 17.92s/it]

 43%|████▎     | 1153/2685 [6:23:51<7:41:27, 18.07s/it]

 43%|████▎     | 1154/2685 [6:24:11<8:01:02, 18.85s/it]

 43%|████▎     | 1155/2685 [6:24:32<8:13:57, 19.37s/it]

 43%|████▎     | 1156/2685 [6:24:52<8:16:11, 19.47s/it]

 43%|████▎     | 1157/2685 [6:25:11<8:12:40, 19.35s/it]

 43%|████▎     | 1158/2685 [6:25:29<8:07:19, 19.15s/it]

 43%|████▎     | 1159/2685 [6:25:49<8:11:06, 19.31s/it]

 43%|████▎     | 1160/2685 [6:26:09<8:18:31, 19.61s/it]

 43%|████▎     | 1161/2685 [6:26:23<7:36:09, 17.96s/it]

 43%|████▎     | 1162/2685 [6:26:40<7:25:03, 17.53s/it]

 43%|████▎     | 1163/2685 [6:27:02<7:57:03, 18.81s/it]
{'loss': 0.259, 'learning_rate': 1.2623133623877854e-06, 'rewards/chosen': -0.6549844741821289, 'rewards/rejected': -4.193024158477783, 'rewards/accuracies': 1.0, 'rewards/margins': 3.538039207458496, 'policy_logps/rejected': -348.8289489746094, 'policy_logps/chosen': -343.0965881347656, 'referece_logps/rejected': -306.8987121582031, 'referece_logps/chosen': -336.5467834472656, 'logits/rejected': -0.08034783601760864, 'logits/chosen': -0.16250237822532654, 'epoch': 1.3}

 43%|████▎     | 1164/2685 [6:27:23<8:13:16, 19.46s/it]

 43%|████▎     | 1165/2685 [6:27:43<8:17:32, 19.64s/it]


 43%|████▎     | 1167/2685 [6:28:23<8:25:09, 19.97s/it]

 44%|████▎     | 1168/2685 [6:28:40<8:02:39, 19.09s/it]

 44%|████▎     | 1169/2685 [6:29:00<8:05:25, 19.21s/it]
{'loss': 0.2699, 'learning_rate': 1.2553213373773471e-06, 'rewards/chosen': -0.25659722089767456, 'rewards/rejected': -3.048757314682007, 'rewards/accuracies': 1.0, 'rewards/margins': 2.7921600341796875, 'policy_logps/rejected': -379.0887451171875, 'policy_logps/chosen': -309.7144775390625, 'referece_logps/rejected': -348.60113525390625, 'referece_logps/chosen': -307.1485290527344, 'logits/rejected': 0.3206334114074707, 'logits/chosen': 0.34928953647613525, 'epoch': 1.31}


 44%|████▎     | 1171/2685 [6:29:34<7:35:41, 18.06s/it]

 44%|████▎     | 1172/2685 [6:29:56<7:59:49, 19.03s/it]

 44%|████▎     | 1173/2685 [6:30:13<7:51:14, 18.70s/it]

 44%|████▎     | 1174/2685 [6:30:33<8:00:24, 19.08s/it]
{'loss': 0.2783, 'learning_rate': 1.2494844146570158e-06, 'rewards/chosen': -0.8035027980804443, 'rewards/rejected': -4.2727484703063965, 'rewards/accuracies': 1.0, 'rewards/margins': 3.4692459106445312, 'policy_logps/rejected': -294.94085693359375, 'policy_logps/chosen': -220.42269897460938, 'referece_logps/rejected': -252.21336364746094, 'referece_logps/chosen': -212.38766479492188, 'logits/rejected': -0.46880072355270386, 'logits/chosen': -0.46041756868362427, 'epoch': 1.31}

 44%|████▍     | 1175/2685 [6:30:53<8:02:35, 19.18s/it]


 44%|████▍     | 1177/2685 [6:31:36<8:31:06, 20.34s/it]

 44%|████▍     | 1178/2685 [6:31:56<8:29:23, 20.28s/it]
{'loss': 0.3428, 'learning_rate': 1.2448083299684428e-06, 'rewards/chosen': 0.28507956862449646, 'rewards/rejected': -1.7684141397476196, 'rewards/accuracies': 0.625, 'rewards/margins': 2.0534937381744385, 'policy_logps/rejected': -493.6946105957031, 'policy_logps/chosen': -418.32568359375, 'referece_logps/rejected': -476.010498046875, 'referece_logps/chosen': -421.17645263671875, 'logits/rejected': -0.49984440207481384, 'logits/chosen': -0.4262590706348419, 'epoch': 1.32}


 44%|████▍     | 1180/2685 [6:32:30<7:45:21, 18.55s/it]

 44%|████▍     | 1181/2685 [6:32:52<8:14:30, 19.73s/it]

 44%|████▍     | 1182/2685 [6:33:11<8:04:54, 19.36s/it]

 44%|████▍     | 1183/2685 [6:33:32<8:15:43, 19.80s/it]

 44%|████▍     | 1184/2685 [6:33:50<8:02:34, 19.29s/it]
{'loss': 0.271, 'learning_rate': 1.2377835473303096e-06, 'rewards/chosen': -1.674375057220459, 'rewards/rejected': -3.0562405586242676, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3818652629852295, 'policy_logps/rejected': -324.5600280761719, 'policy_logps/chosen': -268.7781066894531, 'referece_logps/rejected': -293.99761962890625, 'referece_logps/chosen': -252.0343780517578, 'logits/rejected': -0.7969935536384583, 'logits/chosen': -0.8235564827919006, 'epoch': 1.32}

 44%|████▍     | 1185/2685 [6:34:09<8:02:58, 19.32s/it]


 44%|████▍     | 1187/2685 [6:34:51<8:20:16, 20.04s/it]
{'loss': 0.2653, 'learning_rate': 1.234266460672082e-06, 'rewards/chosen': -1.8999799489974976, 'rewards/rejected': -5.614816665649414, 'rewards/accuracies': 1.0, 'rewards/margins': 3.714837074279785, 'policy_logps/rejected': -378.9130859375, 'policy_logps/chosen': -304.6405334472656, 'referece_logps/rejected': -322.764892578125, 'referece_logps/chosen': -285.6407470703125, 'logits/rejected': -0.12952569127082825, 'logits/chosen': -0.26092255115509033, 'epoch': 1.33}


 44%|████▍     | 1189/2685 [6:35:34<8:35:05, 20.66s/it]

 44%|████▍     | 1190/2685 [6:35:54<8:29:58, 20.47s/it]

 44%|████▍     | 1191/2685 [6:36:13<8:17:11, 19.97s/it]

 44%|████▍     | 1192/2685 [6:36:32<8:13:08, 19.82s/it]

 44%|████▍     | 1193/2685 [6:36:50<7:58:23, 19.24s/it]

 44%|████▍     | 1194/2685 [6:37:14<8:33:35, 20.67s/it]

 45%|████▍     | 1195/2685 [6:37:35<8:32:58, 20.66s/it]

 45%|████▍     | 1196/2685 [6:37:49<7:44:18, 18.71s/it]

 45%|████▍     | 1197/2685 [6:38:06<7:31:53, 18.22s/it]

 45%|████▍     | 1198/2685 [6:38:25<7:37:27, 18.46s/it]

 45%|████▍     | 1199/2685 [6:38:43<7:31:52, 18.25s/it]

 45%|████▍     | 1200/2685 [6:39:02<7:42:04, 18.67s/it]

 45%|████▍     | 1201/2685 [6:39:22<7:50:53, 19.04s/it]

 45%|████▍     | 1202/2685 [6:39:42<8:00:21, 19.43s/it]

 45%|████▍     | 1203/2685 [6:40:01<7:53:57, 19.19s/it]

 45%|████▍     | 1204/2685 [6:40:19<7:44:00, 18.80s/it]

 45%|████▍     | 1205/2685 [6:40:40<8:02:15, 19.55s/it]

 45%|████▍     | 1206/2685 [6:41:00<8:03:40, 19.62s/it]

 45%|████▍     | 1207/2685 [6:41:21<8:12:08, 19.98s/it]

 45%|████▍     | 1208/2685 [6:41:38<7:52:25, 19.19s/it]

 45%|████▌     | 1209/2685 [6:42:01<8:16:02, 20.16s/it]

 45%|████▌     | 1210/2685 [6:42:21<8:16:40, 20.20s/it]

 45%|████▌     | 1211/2685 [6:42:41<8:13:08, 20.07s/it]

 45%|████▌     | 1212/2685 [6:43:01<8:16:15, 20.21s/it]

 45%|████▌     | 1213/2685 [6:43:23<8:29:22, 20.76s/it]

 45%|████▌     | 1214/2685 [6:43:43<8:20:24, 20.41s/it]

 45%|████▌     | 1215/2685 [6:44:03<8:15:37, 20.23s/it]

 45%|████▌     | 1216/2685 [6:44:23<8:13:52, 20.17s/it]

 45%|████▌     | 1217/2685 [6:44:45<8:26:00, 20.68s/it]

 45%|████▌     | 1218/2685 [6:45:05<8:23:20, 20.59s/it]
{'loss': 0.4068, 'learning_rate': 1.1977519512162914e-06, 'rewards/chosen': -1.908834457397461, 'rewards/rejected': -4.227536201477051, 'rewards/accuracies': 1.0, 'rewards/margins': 2.31870174407959, 'policy_logps/rejected': -368.7054443359375, 'policy_logps/chosen': -374.5110168457031, 'referece_logps/rejected': -326.4300842285156, 'referece_logps/chosen': -355.42266845703125, 'logits/rejected': 0.050962843000888824, 'logits/chosen': 0.08260730654001236, 'epoch': 1.36}


 45%|████▌     | 1220/2685 [6:45:47<8:25:30, 20.70s/it]

 45%|████▌     | 1221/2685 [6:46:07<8:20:46, 20.52s/it]

 46%|████▌     | 1222/2685 [6:46:25<8:01:13, 19.74s/it]
{'loss': 0.2734, 'learning_rate': 1.1930191711157736e-06, 'rewards/chosen': -0.5292324423789978, 'rewards/rejected': -2.14404034614563, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6148077249526978, 'policy_logps/rejected': -279.33441162109375, 'policy_logps/chosen': -263.7265319824219, 'referece_logps/rejected': -257.89404296875, 'referece_logps/chosen': -258.4342041015625, 'logits/rejected': -0.7016462087631226, 'logits/chosen': -0.7746585607528687, 'epoch': 1.37}


 46%|████▌     | 1224/2685 [6:47:04<8:02:54, 19.83s/it]

 46%|████▌     | 1225/2685 [6:47:23<7:59:39, 19.71s/it]
{'loss': 0.3079, 'learning_rate': 1.1894666301129824e-06, 'rewards/chosen': -0.8846772313117981, 'rewards/rejected': -3.391530752182007, 'rewards/accuracies': 1.0, 'rewards/margins': 2.5068540573120117, 'policy_logps/rejected': -336.875732421875, 'policy_logps/chosen': -312.8675231933594, 'referece_logps/rejected': -302.96038818359375, 'referece_logps/chosen': -304.020751953125, 'logits/rejected': -0.3111340403556824, 'logits/chosen': -0.3267289102077484, 'epoch': 1.37}

 46%|████▌     | 1226/2685 [6:47:44<8:07:22, 20.04s/it]


 46%|████▌     | 1228/2685 [6:48:21<7:45:19, 19.16s/it]

 46%|████▌     | 1229/2685 [6:48:39<7:39:34, 18.94s/it]

 46%|████▌     | 1230/2685 [6:48:59<7:45:00, 19.18s/it]

 46%|████▌     | 1231/2685 [6:49:11<6:50:42, 16.95s/it]

 46%|████▌     | 1232/2685 [6:49:33<7:24:31, 18.36s/it]

 46%|████▌     | 1233/2685 [6:49:54<7:44:30, 19.19s/it]
{'loss': 0.3191, 'learning_rate': 1.1799811799741209e-06, 'rewards/chosen': -0.7716622352600098, 'rewards/rejected': -2.667149305343628, 'rewards/accuracies': 0.75, 'rewards/margins': 1.8954869508743286, 'policy_logps/rejected': -269.0289306640625, 'policy_logps/chosen': -281.1327819824219, 'referece_logps/rejected': -242.35740661621094, 'referece_logps/chosen': -273.4161376953125, 'logits/rejected': -0.5433491468429565, 'logits/chosen': -0.6034191846847534, 'epoch': 1.38}


 46%|████▌     | 1235/2685 [6:50:34<7:51:32, 19.51s/it]

 46%|████▌     | 1236/2685 [6:50:54<7:55:37, 19.69s/it]

 46%|████▌     | 1237/2685 [6:51:14<7:57:42, 19.79s/it]

 46%|████▌     | 1238/2685 [6:51:29<7:25:24, 18.47s/it]
{'loss': 0.3278, 'learning_rate': 1.1740442036559174e-06, 'rewards/chosen': -2.1772685050964355, 'rewards/rejected': -4.339931488037109, 'rewards/accuracies': 0.75, 'rewards/margins': 2.162663221359253, 'policy_logps/rejected': -248.66262817382812, 'policy_logps/chosen': -221.8416290283203, 'referece_logps/rejected': -205.2633056640625, 'referece_logps/chosen': -200.06893920898438, 'logits/rejected': -0.5425363183021545, 'logits/chosen': -0.596846342086792, 'epoch': 1.38}


 46%|████▌     | 1240/2685 [6:52:12<7:58:15, 19.86s/it]
{'loss': 0.313, 'learning_rate': 1.1716676277561545e-06, 'rewards/chosen': -1.9658715724945068, 'rewards/rejected': -3.9278197288513184, 'rewards/accuracies': 1.0, 'rewards/margins': 1.961948037147522, 'policy_logps/rejected': -255.4649658203125, 'policy_logps/chosen': -250.29747009277344, 'referece_logps/rejected': -216.18678283691406, 'referece_logps/chosen': -230.6387939453125, 'logits/rejected': -0.8607867956161499, 'logits/chosen': -0.8495557308197021, 'epoch': 1.39}

 46%|████▌     | 1241/2685 [6:52:27<7:19:35, 18.27s/it]


 46%|████▋     | 1243/2685 [6:53:10<8:05:01, 20.18s/it]

 46%|████▋     | 1244/2685 [6:53:31<8:13:49, 20.56s/it]

 46%|████▋     | 1245/2685 [6:53:52<8:13:45, 20.57s/it]

 46%|████▋     | 1246/2685 [6:54:12<8:07:43, 20.34s/it]

 46%|████▋     | 1247/2685 [6:54:31<8:01:26, 20.09s/it]

 46%|████▋     | 1248/2685 [6:54:53<8:14:30, 20.65s/it]

 47%|████▋     | 1249/2685 [6:55:13<8:09:54, 20.47s/it]

 47%|████▋     | 1250/2685 [6:55:28<7:29:41, 18.80s/it]

 47%|████▋     | 1251/2685 [6:55:48<7:34:46, 19.03s/it]

 47%|████▋     | 1252/2685 [6:56:07<7:38:25, 19.19s/it]

 47%|████▋     | 1253/2685 [6:56:25<7:30:05, 18.86s/it]
{'loss': 0.2157, 'learning_rate': 1.1561961414076597e-06, 'rewards/chosen': -1.0090904235839844, 'rewards/rejected': -4.02658748626709, 'rewards/accuracies': 1.0, 'rewards/margins': 3.0174975395202637, 'policy_logps/rejected': -266.5771789550781, 'policy_logps/chosen': -298.7602233886719, 'referece_logps/rejected': -226.3113250732422, 'referece_logps/chosen': -288.6693420410156, 'logits/rejected': -0.6471754908561707, 'logits/chosen': -0.6556034684181213, 'epoch': 1.4}


 47%|████▋     | 1255/2685 [6:57:05<7:40:38, 19.33s/it]

 47%|████▋     | 1256/2685 [6:57:23<7:29:41, 18.88s/it]

 47%|████▋     | 1257/2685 [6:57:43<7:36:29, 19.18s/it]

 47%|████▋     | 1258/2685 [6:58:05<7:58:44, 20.13s/it]

 47%|████▋     | 1259/2685 [6:58:25<7:57:02, 20.07s/it]

 47%|████▋     | 1260/2685 [6:58:46<8:04:22, 20.39s/it]

 47%|████▋     | 1261/2685 [6:59:08<8:09:54, 20.64s/it]

 47%|████▋     | 1262/2685 [6:59:26<7:53:04, 19.95s/it]

 47%|████▋     | 1263/2685 [6:59:50<8:19:22, 21.07s/it]

 47%|████▋     | 1264/2685 [7:00:12<8:26:50, 21.40s/it]

 47%|████▋     | 1265/2685 [7:00:30<8:03:10, 20.42s/it]

 47%|████▋     | 1266/2685 [7:00:50<8:00:21, 20.31s/it]

 47%|████▋     | 1267/2685 [7:01:08<7:43:08, 19.60s/it]
{'loss': 0.2513, 'learning_rate': 1.1394916824761127e-06, 'rewards/chosen': -1.524849534034729, 'rewards/rejected': -3.018259286880493, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4934098720550537, 'policy_logps/rejected': -336.06805419921875, 'policy_logps/chosen': -310.8753967285156, 'referece_logps/rejected': -305.8854675292969, 'referece_logps/chosen': -295.62689208984375, 'logits/rejected': -1.0817413330078125, 'logits/chosen': -0.9519050121307373, 'epoch': 1.42}

 47%|████▋     | 1268/2685 [7:01:24<7:15:24, 18.44s/it]

 47%|████▋     | 1269/2685 [7:01:35<6:23:47, 16.26s/it]


 47%|████▋     | 1271/2685 [7:02:12<6:54:32, 17.59s/it]
{'loss': 0.2366, 'learning_rate': 1.1347114622258611e-06, 'rewards/chosen': -1.2305923700332642, 'rewards/rejected': -5.5339741706848145, 'rewards/accuracies': 1.0, 'rewards/margins': 4.303381443023682, 'policy_logps/rejected': -501.0995178222656, 'policy_logps/chosen': -443.3658447265625, 'referece_logps/rejected': -445.759765625, 'referece_logps/chosen': -431.0599060058594, 'logits/rejected': -0.26170653104782104, 'logits/chosen': -0.23317879438400269, 'epoch': 1.42}


 47%|████▋     | 1273/2685 [7:02:52<7:20:13, 18.71s/it]
{'loss': 0.3438, 'learning_rate': 1.1323201686921437e-06, 'rewards/chosen': -2.353302001953125, 'rewards/rejected': -5.223109722137451, 'rewards/accuracies': 0.875, 'rewards/margins': 2.869807720184326, 'policy_logps/rejected': -339.1875305175781, 'policy_logps/chosen': -285.4955749511719, 'referece_logps/rejected': -286.9564208984375, 'referece_logps/chosen': -261.96258544921875, 'logits/rejected': -0.6556437015533447, 'logits/chosen': -0.6354402899742126, 'epoch': 1.42}


 47%|████▋     | 1275/2685 [7:03:33<7:40:37, 19.60s/it]
{'loss': 0.3026, 'learning_rate': 1.1299281047808876e-06, 'rewards/chosen': -1.1971684694290161, 'rewards/rejected': -3.5082180500030518, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3110499382019043, 'policy_logps/rejected': -459.60015869140625, 'policy_logps/chosen': -436.234619140625, 'referece_logps/rejected': -424.5179748535156, 'referece_logps/chosen': -424.2629089355469, 'logits/rejected': -0.3498155176639557, 'logits/chosen': -0.36388450860977173, 'epoch': 1.42}

 48%|████▊     | 1276/2685 [7:03:53<7:48:03, 19.93s/it]


 48%|████▊     | 1278/2685 [7:04:29<7:20:15, 18.77s/it]
{'loss': 0.3207, 'learning_rate': 1.1263385949221293e-06, 'rewards/chosen': -1.6517531871795654, 'rewards/rejected': -4.951453685760498, 'rewards/accuracies': 0.75, 'rewards/margins': 3.2997004985809326, 'policy_logps/rejected': -372.61895751953125, 'policy_logps/chosen': -397.7974548339844, 'referece_logps/rejected': -323.10443115234375, 'referece_logps/chosen': -381.2799377441406, 'logits/rejected': -0.038225896656513214, 'logits/chosen': -0.008225986734032631, 'epoch': 1.43}

 48%|████▊     | 1279/2685 [7:04:51<7:45:32, 19.87s/it]


 48%|████▊     | 1281/2685 [7:05:31<7:43:23, 19.80s/it]

 48%|████▊     | 1282/2685 [7:05:51<7:42:48, 19.79s/it]

 48%|████▊     | 1283/2685 [7:06:11<7:46:44, 19.97s/it]

 48%|████▊     | 1284/2685 [7:06:30<7:41:46, 19.78s/it]
{'loss': 0.2685, 'learning_rate': 1.1191546572720324e-06, 'rewards/chosen': -2.1622259616851807, 'rewards/rejected': -3.81459379196167, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6523675918579102, 'policy_logps/rejected': -271.5595397949219, 'policy_logps/chosen': -215.28245544433594, 'referece_logps/rejected': -233.41360473632812, 'referece_logps/chosen': -193.66017150878906, 'logits/rejected': -0.8406859636306763, 'logits/chosen': -0.9519016742706299, 'epoch': 1.43}

 48%|████▊     | 1285/2685 [7:06:50<7:41:14, 19.77s/it]


 48%|████▊     | 1287/2685 [7:07:31<7:54:55, 20.38s/it]
{'loss': 0.2469, 'learning_rate': 1.115560323587791e-06, 'rewards/chosen': -1.238764762878418, 'rewards/rejected': -5.981295108795166, 'rewards/accuracies': 1.0, 'rewards/margins': 4.742530345916748, 'policy_logps/rejected': -339.54718017578125, 'policy_logps/chosen': -267.6494445800781, 'referece_logps/rejected': -279.7342224121094, 'referece_logps/chosen': -255.26177978515625, 'logits/rejected': -1.161393165588379, 'logits/chosen': -1.2318538427352905, 'epoch': 1.44}


 48%|████▊     | 1289/2685 [7:08:12<7:58:55, 20.58s/it]

 48%|████▊     | 1290/2685 [7:08:31<7:45:24, 20.02s/it]

 48%|████▊     | 1291/2685 [7:08:48<7:26:56, 19.24s/it]
{'loss': 0.3339, 'learning_rate': 1.1107655320160277e-06, 'rewards/chosen': -1.0069037675857544, 'rewards/rejected': -2.5491695404052734, 'rewards/accuracies': 0.875, 'rewards/margins': 1.542265772819519, 'policy_logps/rejected': -320.150390625, 'policy_logps/chosen': -370.5323181152344, 'referece_logps/rejected': -294.65869140625, 'referece_logps/chosen': -360.4632873535156, 'logits/rejected': -1.0828524827957153, 'logits/chosen': -0.8627851605415344, 'epoch': 1.44}

 48%|████▊     | 1292/2685 [7:09:08<7:31:13, 19.44s/it]

 48%|████▊     | 1293/2685 [7:09:30<7:46:22, 20.10s/it]


 48%|████▊     | 1295/2685 [7:10:11<7:52:10, 20.38s/it]
{'loss': 0.2281, 'learning_rate': 1.1059681609084428e-06, 'rewards/chosen': -1.9021015167236328, 'rewards/rejected': -4.2184529304504395, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3163514137268066, 'policy_logps/rejected': -384.4573974609375, 'policy_logps/chosen': -394.07598876953125, 'referece_logps/rejected': -342.27288818359375, 'referece_logps/chosen': -375.05499267578125, 'logits/rejected': -0.24300570785999298, 'logits/chosen': -0.19082732498645782, 'epoch': 1.45}

 48%|████▊     | 1296/2685 [7:10:34<8:07:50, 21.07s/it]

 48%|████▊     | 1297/2685 [7:10:56<8:12:59, 21.31s/it]

 48%|████▊     | 1298/2685 [7:11:17<8:15:52, 21.45s/it]

 48%|████▊     | 1299/2685 [7:11:38<8:07:00, 21.08s/it]

 48%|████▊     | 1300/2685 [7:11:57<7:57:44, 20.70s/it]

 48%|████▊     | 1301/2685 [7:12:18<7:58:09, 20.73s/it]


 49%|████▊     | 1303/2685 [7:12:49<6:58:54, 18.19s/it]

 49%|████▊     | 1304/2685 [7:13:09<7:12:54, 18.81s/it]

 49%|████▊     | 1305/2685 [7:13:29<7:17:16, 19.01s/it]

 49%|████▊     | 1306/2685 [7:13:49<7:25:43, 19.39s/it]
{'loss': 0.2717, 'learning_rate': 1.0927630019435065e-06, 'rewards/chosen': -2.277405023574829, 'rewards/rejected': -4.760231018066406, 'rewards/accuracies': 0.75, 'rewards/margins': 2.4828262329101562, 'policy_logps/rejected': -415.3719177246094, 'policy_logps/chosen': -385.9127197265625, 'referece_logps/rejected': -367.7696228027344, 'referece_logps/chosen': -363.138671875, 'logits/rejected': -0.28172415494918823, 'logits/chosen': -0.3345717787742615, 'epoch': 1.46}


 49%|████▊     | 1308/2685 [7:14:29<7:25:36, 19.42s/it]
{'loss': 0.3957, 'learning_rate': 1.0903602405457022e-06, 'rewards/chosen': -2.3018295764923096, 'rewards/rejected': -5.673842906951904, 'rewards/accuracies': 0.875, 'rewards/margins': 3.3720130920410156, 'policy_logps/rejected': -378.78094482421875, 'policy_logps/chosen': -368.8729248046875, 'referece_logps/rejected': -322.0425109863281, 'referece_logps/chosen': -345.8546142578125, 'logits/rejected': -0.48293524980545044, 'logits/chosen': -0.5125733613967896, 'epoch': 1.46}


 49%|████▉     | 1310/2685 [7:15:11<7:49:24, 20.48s/it]
{'loss': 0.3574, 'learning_rate': 1.0879569530640785e-06, 'rewards/chosen': -2.6836674213409424, 'rewards/rejected': -5.647621154785156, 'rewards/accuracies': 0.75, 'rewards/margins': 2.963954210281372, 'policy_logps/rejected': -394.7595520019531, 'policy_logps/chosen': -339.7598876953125, 'referece_logps/rejected': -338.2833251953125, 'referece_logps/chosen': -312.9232482910156, 'logits/rejected': 0.39046961069107056, 'logits/chosen': 0.40071946382522583, 'epoch': 1.46}

 49%|████▉     | 1311/2685 [7:15:32<7:52:40, 20.64s/it]

 49%|████▉     | 1312/2685 [7:15:56<8:10:55, 21.45s/it]

 49%|████▉     | 1313/2685 [7:16:18<8:14:56, 21.64s/it]


 49%|████▉     | 1315/2685 [7:16:57<7:52:59, 20.72s/it]
{'loss': 0.2324, 'learning_rate': 1.0819465245738646e-06, 'rewards/chosen': -2.132075309753418, 'rewards/rejected': -4.578054904937744, 'rewards/accuracies': 1.0, 'rewards/margins': 2.445979595184326, 'policy_logps/rejected': -323.51544189453125, 'policy_logps/chosen': -246.84054565429688, 'referece_logps/rejected': -277.7348937988281, 'referece_logps/chosen': -225.519775390625, 'logits/rejected': -0.6316904425621033, 'logits/chosen': -0.5842316746711731, 'epoch': 1.47}


 49%|████▉     | 1317/2685 [7:17:38<7:43:05, 20.31s/it]
{'loss': 0.6066, 'learning_rate': 1.079541506006124e-06, 'rewards/chosen': -2.0058319568634033, 'rewards/rejected': -3.698737144470215, 'rewards/accuracies': 0.625, 'rewards/margins': 1.692905068397522, 'policy_logps/rejected': -434.4950256347656, 'policy_logps/chosen': -314.7729797363281, 'referece_logps/rejected': -397.5076904296875, 'referece_logps/chosen': -294.71466064453125, 'logits/rejected': -0.7661306858062744, 'logits/chosen': -0.7519387006759644, 'epoch': 1.47}

 49%|████▉     | 1318/2685 [7:18:00<8:00:08, 21.07s/it]

 49%|████▉     | 1319/2685 [7:18:20<7:50:27, 20.66s/it]


 49%|████▉     | 1321/2685 [7:19:00<7:39:21, 20.21s/it]
{'loss': 0.2882, 'learning_rate': 1.0747300935864243e-06, 'rewards/chosen': -0.8329156637191772, 'rewards/rejected': -3.9167261123657227, 'rewards/accuracies': 1.0, 'rewards/margins': 3.0838100910186768, 'policy_logps/rejected': -276.0075378417969, 'policy_logps/chosen': -257.4656982421875, 'referece_logps/rejected': -236.84027099609375, 'referece_logps/chosen': -249.13653564453125, 'logits/rejected': -0.45167410373687744, 'logits/chosen': -0.5230631828308105, 'epoch': 1.48}

 49%|████▉     | 1322/2685 [7:19:22<7:55:54, 20.95s/it]

 49%|████▉     | 1323/2685 [7:19:45<8:10:40, 21.62s/it]


 49%|████▉     | 1325/2685 [7:20:24<7:41:38, 20.37s/it]

 49%|████▉     | 1326/2685 [7:20:45<7:49:01, 20.71s/it]

 49%|████▉     | 1327/2685 [7:21:07<7:58:11, 21.13s/it]
{'loss': 0.2044, 'learning_rate': 1.0675097468583651e-06, 'rewards/chosen': -1.0906178951263428, 'rewards/rejected': -4.306400775909424, 'rewards/accuracies': 1.0, 'rewards/margins': 3.215782880783081, 'policy_logps/rejected': -324.30389404296875, 'policy_logps/chosen': -340.25115966796875, 'referece_logps/rejected': -281.2398986816406, 'referece_logps/chosen': -329.344970703125, 'logits/rejected': -1.2498712539672852, 'logits/chosen': -1.2512131929397583, 'epoch': 1.48}


 49%|████▉     | 1329/2685 [7:21:45<7:27:08, 19.79s/it]

 50%|████▉     | 1330/2685 [7:22:06<7:31:40, 20.00s/it]

 50%|████▉     | 1331/2685 [7:22:26<7:31:45, 20.02s/it]
{'loss': 0.2894, 'learning_rate': 1.0626941937857584e-06, 'rewards/chosen': -1.7699638605117798, 'rewards/rejected': -5.122548580169678, 'rewards/accuracies': 1.0, 'rewards/margins': 3.3525853157043457, 'policy_logps/rejected': -506.83758544921875, 'policy_logps/chosen': -398.3383483886719, 'referece_logps/rejected': -455.612060546875, 'referece_logps/chosen': -380.638671875, 'logits/rejected': 0.27593380212783813, 'logits/chosen': 0.17972151935100555, 'epoch': 1.49}

 50%|████▉     | 1332/2685 [7:22:46<7:36:11, 20.23s/it]


 50%|████▉     | 1334/2685 [7:23:26<7:29:43, 19.97s/it]

 50%|████▉     | 1335/2685 [7:23:46<7:28:33, 19.94s/it]

 50%|████▉     | 1336/2685 [7:24:07<7:39:33, 20.44s/it]

 50%|████▉     | 1337/2685 [7:24:28<7:40:07, 20.48s/it]

 50%|████▉     | 1338/2685 [7:24:47<7:33:45, 20.21s/it]
{'loss': 0.1817, 'learning_rate': 1.0542635301735156e-06, 'rewards/chosen': -1.0102558135986328, 'rewards/rejected': -3.4670231342315674, 'rewards/accuracies': 1.0, 'rewards/margins': 2.4567673206329346, 'policy_logps/rejected': -347.9920959472656, 'policy_logps/chosen': -340.7846374511719, 'referece_logps/rejected': -313.3218688964844, 'referece_logps/chosen': -330.68206787109375, 'logits/rejected': -0.1062977984547615, 'logits/chosen': -0.18512605130672455, 'epoch': 1.49}

 50%|████▉     | 1339/2685 [7:25:07<7:26:18, 19.89s/it]

 50%|████▉     | 1340/2685 [7:25:25<7:15:37, 19.43s/it]

 50%|████▉     | 1341/2685 [7:25:47<7:29:45, 20.08s/it]


 50%|█████     | 1343/2685 [7:26:26<7:25:01, 19.90s/it]

 50%|█████     | 1344/2685 [7:26:44<7:08:17, 19.16s/it]
{'loss': 0.3394, 'learning_rate': 1.0470341440173287e-06, 'rewards/chosen': -1.1176968812942505, 'rewards/rejected': -4.004156112670898, 'rewards/accuracies': 1.0, 'rewards/margins': 2.8864593505859375, 'policy_logps/rejected': -260.0034484863281, 'policy_logps/chosen': -228.6803436279297, 'referece_logps/rejected': -219.9618682861328, 'referece_logps/chosen': -217.50338745117188, 'logits/rejected': -0.4049203395843506, 'logits/chosen': -0.36456528306007385, 'epoch': 1.5}

 50%|█████     | 1345/2685 [7:27:05<7:23:50, 19.87s/it]

 50%|█████     | 1346/2685 [7:27:23<7:11:26, 19.33s/it]

 50%|█████     | 1347/2685 [7:27:45<7:27:15, 20.06s/it]

 50%|█████     | 1348/2685 [7:28:03<7:16:11, 19.57s/it]


 50%|█████     | 1350/2685 [7:28:44<7:23:25, 19.93s/it]

 50%|█████     | 1351/2685 [7:29:06<7:36:41, 20.54s/it]
{'loss': 0.3507, 'learning_rate': 1.0385967718999127e-06, 'rewards/chosen': -1.3568867444992065, 'rewards/rejected': -2.269970417022705, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9130836725234985, 'policy_logps/rejected': -361.6836853027344, 'policy_logps/chosen': -260.4112854003906, 'referece_logps/rejected': -338.9839782714844, 'referece_logps/chosen': -246.8424072265625, 'logits/rejected': 0.25879162549972534, 'logits/chosen': 0.2526806890964508, 'epoch': 1.51}

 50%|█████     | 1352/2685 [7:29:27<7:41:43, 20.78s/it]

 50%|█████     | 1353/2685 [7:29:44<7:13:25, 19.52s/it]

 50%|█████     | 1354/2685 [7:30:00<6:48:51, 18.43s/it]

 50%|█████     | 1355/2685 [7:30:20<6:58:48, 18.89s/it]

 51%|█████     | 1356/2685 [7:30:40<7:03:38, 19.13s/it]

 51%|█████     | 1357/2685 [7:31:01<7:16:56, 19.74s/it]

 51%|█████     | 1358/2685 [7:31:23<7:31:49, 20.43s/it]

 51%|█████     | 1359/2685 [7:31:43<7:31:37, 20.44s/it]


 51%|█████     | 1361/2685 [7:32:24<7:33:22, 20.55s/it]
{'loss': 0.3382, 'learning_rate': 1.0265387571969766e-06, 'rewards/chosen': -1.6857532262802124, 'rewards/rejected': -3.380600929260254, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6948477029800415, 'policy_logps/rejected': -220.86441040039062, 'policy_logps/chosen': -213.56982421875, 'referece_logps/rejected': -187.05838012695312, 'referece_logps/chosen': -196.71229553222656, 'logits/rejected': 0.1381090134382248, 'logits/chosen': 0.14884096384048462, 'epoch': 1.52}

 51%|█████     | 1362/2685 [7:32:47<7:48:15, 21.24s/it]

 51%|█████     | 1363/2685 [7:33:05<7:23:13, 20.12s/it]

 51%|█████     | 1364/2685 [7:33:28<7:44:17, 21.09s/it]

 51%|█████     | 1365/2685 [7:33:49<7:41:20, 20.97s/it]

 51%|█████     | 1366/2685 [7:34:08<7:31:27, 20.54s/it]

 51%|█████     | 1367/2685 [7:34:26<7:12:07, 19.67s/it]

 51%|█████     | 1368/2685 [7:34:44<7:03:38, 19.30s/it]

 51%|█████     | 1369/2685 [7:35:04<7:05:23, 19.39s/it]

 51%|█████     | 1370/2685 [7:35:24<7:06:27, 19.46s/it]

 51%|█████     | 1371/2685 [7:35:40<6:47:27, 18.61s/it]

 51%|█████     | 1372/2685 [7:36:01<7:00:56, 19.24s/it]


 51%|█████     | 1374/2685 [7:36:39<6:56:15, 19.05s/it]
{'loss': 0.2793, 'learning_rate': 1.0108578257715034e-06, 'rewards/chosen': -1.7403239011764526, 'rewards/rejected': -3.943922281265259, 'rewards/accuracies': 0.875, 'rewards/margins': 2.2035984992980957, 'policy_logps/rejected': -244.2034149169922, 'policy_logps/chosen': -155.25120544433594, 'referece_logps/rejected': -204.76417541503906, 'referece_logps/chosen': -137.84796142578125, 'logits/rejected': -0.4919167160987854, 'logits/chosen': -0.9399093389511108, 'epoch': 1.54}

 51%|█████     | 1375/2685 [7:37:00<7:10:51, 19.73s/it]

 51%|█████     | 1376/2685 [7:37:18<6:56:47, 19.10s/it]

 51%|█████▏    | 1377/2685 [7:37:35<6:46:45, 18.66s/it]

 51%|█████▏    | 1378/2685 [7:37:56<7:01:20, 19.34s/it]

 51%|█████▏    | 1379/2685 [7:38:13<6:43:49, 18.55s/it]

 51%|█████▏    | 1380/2685 [7:38:31<6:42:41, 18.51s/it]


 51%|█████▏    | 1382/2685 [7:39:11<6:54:07, 19.07s/it]
{'loss': 0.3331, 'learning_rate': 1.001206448499033e-06, 'rewards/chosen': -0.9546481370925903, 'rewards/rejected': -2.9893176555633545, 'rewards/accuracies': 0.75, 'rewards/margins': 2.034669876098633, 'policy_logps/rejected': -263.1858215332031, 'policy_logps/chosen': -224.68734741210938, 'referece_logps/rejected': -233.2926483154297, 'referece_logps/chosen': -215.140869140625, 'logits/rejected': -0.5707943439483643, 'logits/chosen': -0.7335655689239502, 'epoch': 1.54}


 52%|█████▏    | 1384/2685 [7:39:49<6:54:03, 19.10s/it]
{'loss': 0.2577, 'learning_rate': 9.987935515009671e-07, 'rewards/chosen': -0.997075080871582, 'rewards/rejected': -3.517606735229492, 'rewards/accuracies': 1.0, 'rewards/margins': 2.5205318927764893, 'policy_logps/rejected': -434.98150634765625, 'policy_logps/chosen': -475.8931579589844, 'referece_logps/rejected': -399.8054504394531, 'referece_logps/chosen': -465.92242431640625, 'logits/rejected': -0.3669944703578949, 'logits/chosen': -0.2674155533313751, 'epoch': 1.55}

 52%|█████▏    | 1385/2685 [7:40:07<6:49:33, 18.90s/it]

 52%|█████▏    | 1386/2685 [7:40:27<6:52:57, 19.07s/it]

 52%|█████▏    | 1387/2685 [7:40:45<6:49:28, 18.93s/it]


 52%|█████▏    | 1389/2685 [7:41:21<6:44:58, 18.75s/it]
{'loss': 0.2933, 'learning_rate': 9.927613704659428e-07, 'rewards/chosen': -3.2062058448791504, 'rewards/rejected': -4.681465148925781, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4752590656280518, 'policy_logps/rejected': -380.6736755371094, 'policy_logps/chosen': -287.5667419433594, 'referece_logps/rejected': -333.8590087890625, 'referece_logps/chosen': -255.5046844482422, 'logits/rejected': 0.19803208112716675, 'logits/chosen': -0.12425832450389862, 'epoch': 1.55}

 52%|█████▏    | 1390/2685 [7:41:42<6:58:00, 19.37s/it]

 52%|█████▏    | 1391/2685 [7:42:01<6:55:09, 19.25s/it]

 52%|█████▏    | 1392/2685 [7:42:21<6:59:12, 19.45s/it]


 52%|█████▏    | 1394/2685 [7:43:03<7:15:55, 20.26s/it]
{'loss': 0.251, 'learning_rate': 9.86729452829134e-07, 'rewards/chosen': -1.024530053138733, 'rewards/rejected': -3.1081671714782715, 'rewards/accuracies': 0.875, 'rewards/margins': 2.08363676071167, 'policy_logps/rejected': -348.927734375, 'policy_logps/chosen': -386.97332763671875, 'referece_logps/rejected': -317.8460693359375, 'referece_logps/chosen': -376.72802734375, 'logits/rejected': -0.20545554161071777, 'logits/chosen': -0.1817694455385208, 'epoch': 1.56}


 52%|█████▏    | 1396/2685 [7:43:41<7:03:58, 19.73s/it]
{'loss': 0.3065, 'learning_rate': 9.843168086918515e-07, 'rewards/chosen': -1.1945993900299072, 'rewards/rejected': -3.2080161571502686, 'rewards/accuracies': 1.0, 'rewards/margins': 2.0134167671203613, 'policy_logps/rejected': -289.0408630371094, 'policy_logps/chosen': -208.27841186523438, 'referece_logps/rejected': -256.960693359375, 'referece_logps/chosen': -196.33242797851562, 'logits/rejected': -0.8777243494987488, 'logits/chosen': -0.8816864490509033, 'epoch': 1.56}

 52%|█████▏    | 1397/2685 [7:44:01<7:02:06, 19.66s/it]

 52%|█████▏    | 1398/2685 [7:44:20<7:00:08, 19.59s/it]

 52%|█████▏    | 1399/2685 [7:44:40<7:04:56, 19.83s/it]

 52%|█████▏    | 1400/2685 [7:45:02<7:12:33, 20.20s/it]

 52%|█████▏    | 1401/2685 [7:45:22<7:15:52, 20.37s/it]

 52%|█████▏    | 1402/2685 [7:45:44<7:22:45, 20.71s/it]


 52%|█████▏    | 1404/2685 [7:46:17<6:33:33, 18.43s/it]

 52%|█████▏    | 1405/2685 [7:46:39<6:57:19, 19.56s/it]
{'loss': 0.3002, 'learning_rate': 9.734612428030233e-07, 'rewards/chosen': -1.6426773071289062, 'rewards/rejected': -3.5149054527282715, 'rewards/accuracies': 0.75, 'rewards/margins': 1.8722282648086548, 'policy_logps/rejected': -310.32110595703125, 'policy_logps/chosen': -364.942626953125, 'referece_logps/rejected': -275.1720275878906, 'referece_logps/chosen': -348.5158386230469, 'logits/rejected': -0.22576141357421875, 'logits/chosen': -0.3207806348800659, 'epoch': 1.57}

 52%|█████▏    | 1406/2685 [7:46:58<6:51:11, 19.29s/it]

 52%|█████▏    | 1407/2685 [7:47:16<6:44:19, 18.98s/it]

 52%|█████▏    | 1408/2685 [7:47:38<7:00:28, 19.76s/it]

 52%|█████▏    | 1409/2685 [7:47:58<7:03:24, 19.91s/it]

 53%|█████▎    | 1410/2685 [7:48:19<7:06:45, 20.08s/it]

 53%|█████▎    | 1411/2685 [7:48:42<7:25:39, 20.99s/it]

 53%|█████▎    | 1412/2685 [7:48:58<6:54:31, 19.54s/it]

 53%|█████▎    | 1413/2685 [7:49:19<7:01:37, 19.89s/it]


 53%|█████▎    | 1415/2685 [7:49:56<6:42:50, 19.03s/it]
{'loss': 0.1848, 'learning_rate': 9.614032281000874e-07, 'rewards/chosen': -1.0752031803131104, 'rewards/rejected': -4.487112045288086, 'rewards/accuracies': 0.875, 'rewards/margins': 3.4119091033935547, 'policy_logps/rejected': -241.05125427246094, 'policy_logps/chosen': -269.3983459472656, 'referece_logps/rejected': -196.1801300048828, 'referece_logps/chosen': -258.64630126953125, 'logits/rejected': -0.5582492351531982, 'logits/chosen': -0.5877737402915955, 'epoch': 1.58}

 53%|█████▎    | 1416/2685 [7:50:17<6:57:21, 19.73s/it]

 53%|█████▎    | 1417/2685 [7:50:37<6:59:39, 19.86s/it]

 53%|█████▎    | 1418/2685 [7:50:57<7:00:10, 19.90s/it]

 53%|█████▎    | 1419/2685 [7:51:19<7:14:57, 20.61s/it]

 53%|█████▎    | 1420/2685 [7:51:38<7:03:57, 20.11s/it]

 53%|█████▎    | 1421/2685 [7:51:59<7:09:58, 20.41s/it]

 53%|█████▎    | 1422/2685 [7:52:21<7:13:45, 20.61s/it]


 53%|█████▎    | 1424/2685 [7:53:02<7:09:04, 20.42s/it]
{'loss': 0.4015, 'learning_rate': 9.505557680527245e-07, 'rewards/chosen': -0.9522053003311157, 'rewards/rejected': -3.6320419311523438, 'rewards/accuracies': 0.75, 'rewards/margins': 2.6798367500305176, 'policy_logps/rejected': -364.79266357421875, 'policy_logps/chosen': -448.39715576171875, 'referece_logps/rejected': -328.4722900390625, 'referece_logps/chosen': -438.8751525878906, 'logits/rejected': -0.5542975664138794, 'logits/chosen': -0.6071881055831909, 'epoch': 1.59}

 53%|█████▎    | 1425/2685 [7:53:24<7:20:50, 20.99s/it]

 53%|█████▎    | 1426/2685 [7:53:44<7:10:55, 20.54s/it]


 53%|█████▎    | 1428/2685 [7:54:20<6:44:09, 19.29s/it]
{'loss': 0.2317, 'learning_rate': 9.457364698264846e-07, 'rewards/chosen': -2.1726131439208984, 'rewards/rejected': -4.189947605133057, 'rewards/accuracies': 0.875, 'rewards/margins': 2.017334461212158, 'policy_logps/rejected': -486.7829895019531, 'policy_logps/chosen': -328.77374267578125, 'referece_logps/rejected': -444.88348388671875, 'referece_logps/chosen': -307.047607421875, 'logits/rejected': -0.10713446885347366, 'logits/chosen': 0.023691080510616302, 'epoch': 1.6}

 53%|█████▎    | 1429/2685 [7:54:39<6:43:28, 19.27s/it]

 53%|█████▎    | 1430/2685 [7:54:59<6:45:04, 19.37s/it]

 53%|█████▎    | 1431/2685 [7:55:16<6:33:58, 18.85s/it]

 53%|█████▎    | 1432/2685 [7:55:33<6:23:38, 18.37s/it]

 53%|█████▎    | 1433/2685 [7:55:55<6:40:51, 19.21s/it]

 53%|█████▎    | 1434/2685 [7:56:17<6:58:32, 20.07s/it]


 53%|█████▎    | 1436/2685 [7:56:54<6:43:37, 19.39s/it]

 54%|█████▎    | 1437/2685 [7:57:14<6:48:56, 19.66s/it]

 54%|█████▎    | 1438/2685 [7:57:36<7:00:00, 20.21s/it]

 54%|█████▎    | 1439/2685 [7:57:56<7:00:22, 20.24s/it]

 54%|█████▎    | 1440/2685 [7:58:17<7:03:41, 20.42s/it]

 54%|█████▎    | 1441/2685 [7:58:40<7:18:48, 21.16s/it]

 54%|█████▎    | 1442/2685 [7:59:01<7:20:27, 21.26s/it]

 54%|█████▎    | 1443/2685 [7:59:22<7:18:30, 21.18s/it]

 54%|█████▍    | 1444/2685 [7:59:45<7:27:22, 21.63s/it]

 54%|█████▍    | 1445/2685 [8:00:03<7:06:40, 20.65s/it]

 54%|█████▍    | 1446/2685 [8:00:27<7:23:38, 21.48s/it]

 54%|█████▍    | 1447/2685 [8:00:47<7:13:47, 21.02s/it]

 54%|█████▍    | 1448/2685 [8:01:06<7:03:48, 20.56s/it]
{'loss': 0.2654, 'learning_rate': 9.216611778141276e-07, 'rewards/chosen': -1.7183432579040527, 'rewards/rejected': -4.561269760131836, 'rewards/accuracies': 1.0, 'rewards/margins': 2.842926502227783, 'policy_logps/rejected': -455.8808288574219, 'policy_logps/chosen': -362.5442199707031, 'referece_logps/rejected': -410.2681579589844, 'referece_logps/chosen': -345.36077880859375, 'logits/rejected': -0.019381284713745117, 'logits/chosen': 0.0009232461452484131, 'epoch': 1.62}

 54%|█████▍    | 1449/2685 [8:01:25<6:50:42, 19.94s/it]


 54%|█████▍    | 1451/2685 [8:02:02<6:39:28, 19.42s/it]

 54%|█████▍    | 1452/2685 [8:02:22<6:42:00, 19.56s/it]

 54%|█████▍    | 1453/2685 [8:02:43<6:48:58, 19.92s/it]

 54%|█████▍    | 1454/2685 [8:03:04<6:56:09, 20.28s/it]

 54%|█████▍    | 1455/2685 [8:03:23<6:47:08, 19.86s/it]

 54%|█████▍    | 1456/2685 [8:03:43<6:49:30, 19.99s/it]
{'loss': 0.2334, 'learning_rate': 9.120430469359215e-07, 'rewards/chosen': -1.0094101428985596, 'rewards/rejected': -5.1433634757995605, 'rewards/accuracies': 0.875, 'rewards/margins': 4.13395357131958, 'policy_logps/rejected': -541.285400390625, 'policy_logps/chosen': -546.2630615234375, 'referece_logps/rejected': -489.85174560546875, 'referece_logps/chosen': -536.1688232421875, 'logits/rejected': 0.2307320237159729, 'logits/chosen': 0.2588837444782257, 'epoch': 1.63}


 54%|█████▍    | 1458/2685 [8:04:24<6:58:08, 20.45s/it]

 54%|█████▍    | 1459/2685 [8:04:46<7:03:31, 20.73s/it]

 54%|█████▍    | 1460/2685 [8:05:07<7:07:49, 20.95s/it]

 54%|█████▍    | 1461/2685 [8:05:28<7:05:15, 20.85s/it]

 54%|█████▍    | 1462/2685 [8:05:49<7:06:43, 20.93s/it]

 54%|█████▍    | 1463/2685 [8:06:09<7:00:35, 20.65s/it]

 55%|█████▍    | 1464/2685 [8:06:26<6:40:07, 19.66s/it]

 55%|█████▍    | 1465/2685 [8:06:44<6:24:01, 18.89s/it]

 55%|█████▍    | 1466/2685 [8:07:03<6:25:11, 18.96s/it]

 55%|█████▍    | 1467/2685 [8:07:22<6:28:19, 19.13s/it]

 55%|█████▍    | 1468/2685 [8:07:44<6:41:38, 19.80s/it]

 55%|█████▍    | 1469/2685 [8:08:03<6:40:53, 19.78s/it]
{'loss': 0.2775, 'learning_rate': 8.964314570603096e-07, 'rewards/chosen': -2.1755294799804688, 'rewards/rejected': -4.615844249725342, 'rewards/accuracies': 0.75, 'rewards/margins': 2.440314292907715, 'policy_logps/rejected': -360.38189697265625, 'policy_logps/chosen': -304.0919189453125, 'referece_logps/rejected': -314.22344970703125, 'referece_logps/chosen': -282.336669921875, 'logits/rejected': -0.24360564351081848, 'logits/chosen': -0.17768524587154388, 'epoch': 1.64}


 55%|█████▍    | 1471/2685 [8:08:38<6:13:50, 18.48s/it]

 55%|█████▍    | 1472/2685 [8:08:57<6:12:36, 18.43s/it]

 55%|█████▍    | 1473/2685 [8:09:17<6:25:10, 19.07s/it]

 55%|█████▍    | 1474/2685 [8:09:34<6:10:50, 18.37s/it]

 55%|█████▍    | 1475/2685 [8:09:55<6:25:00, 19.09s/it]
{'loss': 0.1775, 'learning_rate': 8.892344679839723e-07, 'rewards/chosen': -2.2058000564575195, 'rewards/rejected': -6.5142412185668945, 'rewards/accuracies': 0.875, 'rewards/margins': 4.308441162109375, 'policy_logps/rejected': -422.25701904296875, 'policy_logps/chosen': -364.89404296875, 'referece_logps/rejected': -357.11456298828125, 'referece_logps/chosen': -342.83599853515625, 'logits/rejected': -0.8024481534957886, 'logits/chosen': -0.7967789769172668, 'epoch': 1.65}

 55%|█████▍    | 1476/2685 [8:10:15<6:29:37, 19.34s/it]

 55%|█████▌    | 1477/2685 [8:10:29<5:59:29, 17.86s/it]


 55%|█████▌    | 1479/2685 [8:11:08<6:20:46, 18.94s/it]

 55%|█████▌    | 1480/2685 [8:11:26<6:16:36, 18.75s/it]
{'loss': 0.3337, 'learning_rate': 8.832413946585258e-07, 'rewards/chosen': -1.9936861991882324, 'rewards/rejected': -4.357581615447998, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3638949394226074, 'policy_logps/rejected': -444.5853271484375, 'policy_logps/chosen': -404.47308349609375, 'referece_logps/rejected': -401.0095520019531, 'referece_logps/chosen': -384.53619384765625, 'logits/rejected': 0.1204492449760437, 'logits/chosen': -0.01832018792629242, 'epoch': 1.65}


 55%|█████▌    | 1482/2685 [8:12:03<6:14:29, 18.68s/it]

 55%|█████▌    | 1483/2685 [8:12:23<6:20:51, 19.01s/it]

 55%|█████▌    | 1484/2685 [8:12:43<6:27:17, 19.35s/it]

 55%|█████▌    | 1485/2685 [8:13:03<6:30:36, 19.53s/it]

 55%|█████▌    | 1486/2685 [8:13:25<6:44:12, 20.23s/it]

 55%|█████▌    | 1487/2685 [8:13:44<6:35:51, 19.83s/it]
{'loss': 0.3157, 'learning_rate': 8.748582784627654e-07, 'rewards/chosen': -1.3851299285888672, 'rewards/rejected': -2.485640525817871, 'rewards/accuracies': 0.875, 'rewards/margins': 1.100510597229004, 'policy_logps/rejected': -236.88226318359375, 'policy_logps/chosen': -198.59188842773438, 'referece_logps/rejected': -212.02586364746094, 'referece_logps/chosen': -184.74058532714844, 'logits/rejected': -0.4810318052768707, 'logits/chosen': -0.47575947642326355, 'epoch': 1.66}


 55%|█████▌    | 1489/2685 [8:14:19<6:06:08, 18.37s/it]
{'loss': 0.3083, 'learning_rate': 8.724647155811396e-07, 'rewards/chosen': -1.3333537578582764, 'rewards/rejected': -3.92873477935791, 'rewards/accuracies': 0.875, 'rewards/margins': 2.595381259918213, 'policy_logps/rejected': -343.3282470703125, 'policy_logps/chosen': -306.4438781738281, 'referece_logps/rejected': -304.0409240722656, 'referece_logps/chosen': -293.1103210449219, 'logits/rejected': -1.2612173557281494, 'logits/chosen': -1.230552077293396, 'epoch': 1.66}


 56%|█████▌    | 1491/2685 [8:14:51<5:43:32, 17.26s/it]

 56%|█████▌    | 1492/2685 [8:15:10<5:55:07, 17.86s/it]

 56%|█████▌    | 1493/2685 [8:15:31<6:10:08, 18.63s/it]
{'loss': 0.2689, 'learning_rate': 8.676798313078565e-07, 'rewards/chosen': -0.19978727400302887, 'rewards/rejected': -3.9238672256469727, 'rewards/accuracies': 1.0, 'rewards/margins': 3.7240796089172363, 'policy_logps/rejected': -489.8924560546875, 'policy_logps/chosen': -596.9146728515625, 'referece_logps/rejected': -450.65374755859375, 'referece_logps/chosen': -594.916748046875, 'logits/rejected': 0.1957484483718872, 'logits/chosen': 0.08994945883750916, 'epoch': 1.67}


 56%|█████▌    | 1495/2685 [8:16:06<5:52:47, 17.79s/it]

 56%|█████▌    | 1496/2685 [8:16:29<6:23:20, 19.34s/it]

 56%|█████▌    | 1497/2685 [8:16:48<6:23:17, 19.36s/it]

 56%|█████▌    | 1498/2685 [8:17:06<6:16:02, 19.01s/it]

 56%|█████▌    | 1499/2685 [8:17:25<6:16:32, 19.05s/it]

 56%|█████▌    | 1500/2685 [8:17:49<6:41:01, 20.31s/it]

 56%|█████▌    | 1501/2685 [8:18:22<7:57:51, 24.22s/it]

 56%|█████▌    | 1502/2685 [8:18:42<7:31:46, 22.91s/it]

 56%|█████▌    | 1503/2685 [8:19:03<7:19:13, 22.30s/it]

 56%|█████▌    | 1504/2685 [8:19:25<7:17:22, 22.22s/it]

 56%|█████▌    | 1505/2685 [8:19:43<6:52:37, 20.98s/it]

 56%|█████▌    | 1506/2685 [8:19:57<6:13:51, 19.03s/it]

 56%|█████▌    | 1507/2685 [8:20:19<6:27:09, 19.72s/it]

 56%|█████▌    | 1508/2685 [8:20:38<6:27:00, 19.73s/it]

 56%|█████▌    | 1509/2685 [8:21:02<6:50:13, 20.93s/it]

 56%|█████▌    | 1510/2685 [8:21:23<6:50:44, 20.97s/it]

 56%|█████▋    | 1511/2685 [8:21:45<6:56:51, 21.30s/it]
{'loss': 0.2221, 'learning_rate': 8.461875927904332e-07, 'rewards/chosen': -0.8785237669944763, 'rewards/rejected': -3.2751333713531494, 'rewards/accuracies': 1.0, 'rewards/margins': 2.3966097831726074, 'policy_logps/rejected': -257.3096618652344, 'policy_logps/chosen': -245.01673889160156, 'referece_logps/rejected': -224.55833435058594, 'referece_logps/chosen': -236.2314910888672, 'logits/rejected': -1.1588093042373657, 'logits/chosen': -1.103420615196228, 'epoch': 1.69}


 56%|█████▋    | 1513/2685 [8:22:26<6:45:08, 20.74s/it]
{'loss': 0.3273, 'learning_rate': 8.438038585923402e-07, 'rewards/chosen': -1.554370641708374, 'rewards/rejected': -4.930696964263916, 'rewards/accuracies': 1.0, 'rewards/margins': 3.3763270378112793, 'policy_logps/rejected': -447.0623474121094, 'policy_logps/chosen': -331.2344665527344, 'referece_logps/rejected': -397.75531005859375, 'referece_logps/chosen': -315.6907653808594, 'logits/rejected': -0.6590238809585571, 'logits/chosen': -0.6934108734130859, 'epoch': 1.69}

 56%|█████▋    | 1514/2685 [8:22:46<6:38:18, 20.41s/it]


 56%|█████▋    | 1516/2685 [8:23:23<6:20:54, 19.55s/it]

 56%|█████▋    | 1517/2685 [8:23:43<6:22:43, 19.66s/it]

 57%|█████▋    | 1518/2685 [8:24:05<6:37:54, 20.46s/it]

 57%|█████▋    | 1519/2685 [8:24:22<6:17:07, 19.41s/it]

 57%|█████▋    | 1520/2685 [8:24:44<6:32:26, 20.21s/it]

 57%|█████▋    | 1521/2685 [8:25:03<6:21:19, 19.66s/it]

 57%|█████▋    | 1522/2685 [8:25:24<6:31:06, 20.18s/it]

 57%|█████▋    | 1523/2685 [8:25:44<6:26:34, 19.96s/it]

 57%|█████▋    | 1524/2685 [8:26:05<6:32:53, 20.30s/it]

 57%|█████▋    | 1525/2685 [8:26:25<6:30:05, 20.18s/it]

 57%|█████▋    | 1526/2685 [8:26:40<6:04:30, 18.87s/it]

 57%|█████▋    | 1527/2685 [8:27:00<6:09:51, 19.16s/it]

 57%|█████▋    | 1528/2685 [8:27:21<6:16:51, 19.54s/it]

 57%|█████▋    | 1529/2685 [8:27:41<6:22:12, 19.84s/it]

 57%|█████▋    | 1530/2685 [8:27:55<5:49:01, 18.13s/it]

 57%|█████▋    | 1531/2685 [8:28:14<5:49:55, 18.19s/it]

 57%|█████▋    | 1532/2685 [8:28:30<5:38:42, 17.63s/it]

 57%|█████▋    | 1533/2685 [8:28:52<6:01:18, 18.82s/it]

 57%|█████▋    | 1534/2685 [8:29:12<6:10:02, 19.29s/it]

 57%|█████▋    | 1535/2685 [8:29:35<6:30:57, 20.40s/it]

 57%|█████▋    | 1536/2685 [8:29:57<6:39:54, 20.88s/it]

 57%|█████▋    | 1537/2685 [8:30:13<6:12:01, 19.44s/it]

 57%|█████▋    | 1538/2685 [8:30:36<6:31:53, 20.50s/it]
{'loss': 0.3464, 'learning_rate': 8.140883928370854e-07, 'rewards/chosen': -1.6828923225402832, 'rewards/rejected': -4.0253424644470215, 'rewards/accuracies': 0.875, 'rewards/margins': 2.34244966506958, 'policy_logps/rejected': -356.69903564453125, 'policy_logps/chosen': -412.8910827636719, 'referece_logps/rejected': -316.4456481933594, 'referece_logps/chosen': -396.0621337890625, 'logits/rejected': -1.3888139724731445, 'logits/chosen': -1.3160597085952759, 'epoch': 1.72}


 57%|█████▋    | 1540/2685 [8:31:13<6:07:52, 19.28s/it]

 57%|█████▋    | 1541/2685 [8:31:32<6:03:16, 19.05s/it]

 57%|█████▋    | 1542/2685 [8:31:51<6:06:19, 19.23s/it]

 57%|█████▋    | 1543/2685 [8:32:14<6:25:05, 20.23s/it]

 58%|█████▊    | 1544/2685 [8:32:32<6:12:30, 19.59s/it]

 58%|█████▊    | 1545/2685 [8:32:51<6:10:50, 19.52s/it]

 58%|█████▊    | 1546/2685 [8:33:13<6:25:59, 20.33s/it]

 58%|█████▊    | 1547/2685 [8:33:36<6:37:20, 20.95s/it]
{'loss': 0.2868, 'learning_rate': 8.034308163657699e-07, 'rewards/chosen': -1.7334275245666504, 'rewards/rejected': -4.397567272186279, 'rewards/accuracies': 0.875, 'rewards/margins': 2.664139747619629, 'policy_logps/rejected': -354.89642333984375, 'policy_logps/chosen': -266.0534973144531, 'referece_logps/rejected': -310.92083740234375, 'referece_logps/chosen': -248.71922302246094, 'logits/rejected': -0.042215317487716675, 'logits/chosen': -0.0007690191268920898, 'epoch': 1.73}

 58%|█████▊    | 1548/2685 [8:33:57<6:37:19, 20.97s/it]

 58%|█████▊    | 1549/2685 [8:34:19<6:41:07, 21.19s/it]

 58%|█████▊    | 1550/2685 [8:34:37<6:23:04, 20.25s/it]


 58%|█████▊    | 1552/2685 [8:35:10<5:49:00, 18.48s/it]
{'loss': 0.3491, 'learning_rate': 7.97519873980819e-07, 'rewards/chosen': -0.9388769268989563, 'rewards/rejected': -4.061617374420166, 'rewards/accuracies': 0.875, 'rewards/margins': 3.1227402687072754, 'policy_logps/rejected': -371.1647644042969, 'policy_logps/chosen': -252.8367462158203, 'referece_logps/rejected': -330.548583984375, 'referece_logps/chosen': -243.447998046875, 'logits/rejected': -0.6067493557929993, 'logits/chosen': -0.5998668074607849, 'epoch': 1.73}

 58%|█████▊    | 1553/2685 [8:35:31<6:02:58, 19.24s/it]

 58%|█████▊    | 1554/2685 [8:35:55<6:27:24, 20.55s/it]


 58%|█████▊    | 1556/2685 [8:36:24<5:32:03, 17.65s/it]
{'loss': 0.2842, 'learning_rate': 7.927964145864929e-07, 'rewards/chosen': -1.5180222988128662, 'rewards/rejected': -4.925708770751953, 'rewards/accuracies': 0.875, 'rewards/margins': 3.407686710357666, 'policy_logps/rejected': -420.9154357910156, 'policy_logps/chosen': -407.64434814453125, 'referece_logps/rejected': -371.6583251953125, 'referece_logps/chosen': -392.464111328125, 'logits/rejected': -1.318776249885559, 'logits/chosen': -1.3591316938400269, 'epoch': 1.74}

 58%|█████▊    | 1557/2685 [8:36:39<5:15:07, 16.76s/it]

 58%|█████▊    | 1558/2685 [8:36:59<5:34:49, 17.83s/it]

 58%|█████▊    | 1559/2685 [8:37:19<5:46:21, 18.46s/it]

 58%|█████▊    | 1560/2685 [8:37:39<5:53:16, 18.84s/it]

 58%|█████▊    | 1561/2685 [8:37:59<6:02:06, 19.33s/it]


 58%|█████▊    | 1563/2685 [8:38:44<6:29:28, 20.83s/it]

 58%|█████▊    | 1564/2685 [8:39:04<6:24:19, 20.57s/it]

 58%|█████▊    | 1565/2685 [8:39:25<6:25:27, 20.65s/it]
{'loss': 0.2651, 'learning_rate': 7.821864412511484e-07, 'rewards/chosen': -1.3767670392990112, 'rewards/rejected': -4.248446941375732, 'rewards/accuracies': 1.0, 'rewards/margins': 2.8716800212860107, 'policy_logps/rejected': -549.7431030273438, 'policy_logps/chosen': -432.1890869140625, 'referece_logps/rejected': -507.2586669921875, 'referece_logps/chosen': -418.42144775390625, 'logits/rejected': -0.2791288495063782, 'logits/chosen': -0.36814379692077637, 'epoch': 1.75}

 58%|█████▊    | 1566/2685 [8:39:45<6:25:22, 20.66s/it]


 58%|█████▊    | 1568/2685 [8:40:27<6:29:24, 20.92s/it]

 58%|█████▊    | 1569/2685 [8:40:45<6:14:08, 20.12s/it]
{'loss': 0.3025, 'learning_rate': 7.774790660436857e-07, 'rewards/chosen': -1.2374926805496216, 'rewards/rejected': -2.967473030090332, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7299805879592896, 'policy_logps/rejected': -268.63519287109375, 'policy_logps/chosen': -195.14877319335938, 'referece_logps/rejected': -238.96044921875, 'referece_logps/chosen': -182.77386474609375, 'logits/rejected': -0.4230414628982544, 'logits/chosen': -0.563130259513855, 'epoch': 1.75}

 58%|█████▊    | 1570/2685 [8:41:05<6:15:56, 20.23s/it]


 59%|█████▊    | 1572/2685 [8:41:42<5:55:04, 19.14s/it]

 59%|█████▊    | 1573/2685 [8:42:00<5:49:37, 18.86s/it]

 59%|█████▊    | 1574/2685 [8:42:21<5:57:37, 19.31s/it]

 59%|█████▊    | 1575/2685 [8:42:40<5:59:18, 19.42s/it]

 59%|█████▊    | 1576/2685 [8:43:02<6:11:18, 20.09s/it]
{'loss': 0.2465, 'learning_rate': 7.692536947956964e-07, 'rewards/chosen': -1.2229336500167847, 'rewards/rejected': -3.330697774887085, 'rewards/accuracies': 0.75, 'rewards/margins': 2.10776424407959, 'policy_logps/rejected': -292.2739562988281, 'policy_logps/chosen': -394.6900939941406, 'referece_logps/rejected': -258.96697998046875, 'referece_logps/chosen': -382.46075439453125, 'logits/rejected': -0.2958775460720062, 'logits/chosen': -0.25606879591941833, 'epoch': 1.76}


 59%|█████▉    | 1578/2685 [8:43:40<6:03:38, 19.71s/it]
{'loss': 0.3054, 'learning_rate': 7.669065857813599e-07, 'rewards/chosen': -1.596187710762024, 'rewards/rejected': -6.827552795410156, 'rewards/accuracies': 1.0, 'rewards/margins': 5.231365203857422, 'policy_logps/rejected': -371.5823059082031, 'policy_logps/chosen': -337.5140075683594, 'referece_logps/rejected': -303.3067626953125, 'referece_logps/chosen': -321.5521545410156, 'logits/rejected': -1.0463978052139282, 'logits/chosen': -1.0300875902175903, 'epoch': 1.76}


 59%|█████▉    | 1580/2685 [8:44:16<5:47:00, 18.84s/it]
{'loss': 0.2858, 'learning_rate': 7.645608338536458e-07, 'rewards/chosen': -1.147011637687683, 'rewards/rejected': -3.3501698970794678, 'rewards/accuracies': 0.875, 'rewards/margins': 2.203158378601074, 'policy_logps/rejected': -382.24237060546875, 'policy_logps/chosen': -325.8130187988281, 'referece_logps/rejected': -348.7406921386719, 'referece_logps/chosen': -314.3429260253906, 'logits/rejected': 0.3833494782447815, 'logits/chosen': 0.4344397187232971, 'epoch': 1.77}


 59%|█████▉    | 1582/2685 [8:44:51<5:26:47, 17.78s/it]

 59%|█████▉    | 1583/2685 [8:45:09<5:27:30, 17.83s/it]

 59%|█████▉    | 1584/2685 [8:45:28<5:37:33, 18.40s/it]

 59%|█████▉    | 1585/2685 [8:45:48<5:45:14, 18.83s/it]
{'loss': 0.3444, 'learning_rate': 7.587024808936323e-07, 'rewards/chosen': -1.0367106199264526, 'rewards/rejected': -4.002025604248047, 'rewards/accuracies': 0.875, 'rewards/margins': 2.9653146266937256, 'policy_logps/rejected': -286.6753845214844, 'policy_logps/chosen': -276.9083557128906, 'referece_logps/rejected': -246.6551055908203, 'referece_logps/chosen': -266.5412292480469, 'logits/rejected': -0.7594333291053772, 'logits/chosen': -0.783845067024231, 'epoch': 1.77}

 59%|█████▉    | 1586/2685 [8:46:08<5:48:51, 19.05s/it]

 59%|█████▉    | 1587/2685 [8:46:27<5:52:06, 19.24s/it]


 59%|█████▉    | 1589/2685 [8:47:05<5:47:53, 19.05s/it]

 59%|█████▉    | 1590/2685 [8:47:23<5:43:49, 18.84s/it]

 59%|█████▉    | 1591/2685 [8:47:43<5:47:50, 19.08s/it]

 59%|█████▉    | 1592/2685 [8:48:03<5:54:12, 19.44s/it]

 59%|█████▉    | 1593/2685 [8:48:23<5:57:58, 19.67s/it]

 59%|█████▉    | 1594/2685 [8:48:46<6:15:18, 20.64s/it]

 59%|█████▉    | 1595/2685 [8:49:05<6:02:12, 19.94s/it]

 59%|█████▉    | 1596/2685 [8:49:25<6:02:55, 20.00s/it]

 59%|█████▉    | 1597/2685 [8:49:45<6:06:11, 20.19s/it]

 60%|█████▉    | 1598/2685 [8:50:00<5:38:20, 18.68s/it]
{'loss': 0.3037, 'learning_rate': 7.435123861594607e-07, 'rewards/chosen': -2.0190603733062744, 'rewards/rejected': -4.787975788116455, 'rewards/accuracies': 1.0, 'rewards/margins': 2.7689151763916016, 'policy_logps/rejected': -356.3542175292969, 'policy_logps/chosen': -350.60980224609375, 'referece_logps/rejected': -308.4744567871094, 'referece_logps/chosen': -330.4192199707031, 'logits/rejected': -0.4682003855705261, 'logits/chosen': -0.4621596038341522, 'epoch': 1.79}

 60%|█████▉    | 1599/2685 [8:50:20<5:41:48, 18.88s/it]

 60%|█████▉    | 1600/2685 [8:50:40<5:50:05, 19.36s/it]

 60%|█████▉    | 1601/2685 [8:50:58<5:40:32, 18.85s/it]


 60%|█████▉    | 1603/2685 [8:51:43<6:11:29, 20.60s/it]

 60%|█████▉    | 1604/2685 [8:52:03<6:08:43, 20.47s/it]

 60%|█████▉    | 1605/2685 [8:52:23<6:04:02, 20.22s/it]

 60%|█████▉    | 1606/2685 [8:52:43<6:01:09, 20.08s/it]
{'loss': 0.2524, 'learning_rate': 7.341957565412063e-07, 'rewards/chosen': -2.064950466156006, 'rewards/rejected': -4.471155643463135, 'rewards/accuracies': 0.875, 'rewards/margins': 2.406205177307129, 'policy_logps/rejected': -333.9285888671875, 'policy_logps/chosen': -325.4596862792969, 'referece_logps/rejected': -289.217041015625, 'referece_logps/chosen': -304.8101806640625, 'logits/rejected': -0.06776507198810577, 'logits/chosen': -0.059800054877996445, 'epoch': 1.79}

 60%|█████▉    | 1607/2685 [8:52:56<5:26:19, 18.16s/it]


 60%|█████▉    | 1609/2685 [8:53:37<5:44:35, 19.21s/it]
{'loss': 0.2912, 'learning_rate': 7.307083574137874e-07, 'rewards/chosen': -0.72074294090271, 'rewards/rejected': -4.184682846069336, 'rewards/accuracies': 1.0, 'rewards/margins': 3.463939666748047, 'policy_logps/rejected': -354.0541687011719, 'policy_logps/chosen': -323.7679443359375, 'referece_logps/rejected': -312.20733642578125, 'referece_logps/chosen': -316.5605163574219, 'logits/rejected': -0.025981783866882324, 'logits/chosen': -0.12089090794324875, 'epoch': 1.8}


 60%|██████    | 1611/2685 [8:54:16<5:46:53, 19.38s/it]
{'loss': 0.2797, 'learning_rate': 7.283853816370386e-07, 'rewards/chosen': -1.0586055517196655, 'rewards/rejected': -5.802037239074707, 'rewards/accuracies': 1.0, 'rewards/margins': 4.743432521820068, 'policy_logps/rejected': -355.8487854003906, 'policy_logps/chosen': -341.294189453125, 'referece_logps/rejected': -297.8283996582031, 'referece_logps/chosen': -330.7081604003906, 'logits/rejected': -0.8804970979690552, 'logits/chosen': -0.7809391021728516, 'epoch': 1.8}


 60%|██████    | 1613/2685 [8:54:55<5:46:55, 19.42s/it]

 60%|██████    | 1614/2685 [8:55:17<5:57:18, 20.02s/it]

 60%|██████    | 1615/2685 [8:55:35<5:46:14, 19.42s/it]

 60%|██████    | 1616/2685 [8:55:53<5:39:09, 19.04s/it]

 60%|██████    | 1617/2685 [8:56:15<5:56:52, 20.05s/it]
{'loss': 0.2925, 'learning_rate': 7.214259965178673e-07, 'rewards/chosen': -1.3810853958129883, 'rewards/rejected': -4.142314910888672, 'rewards/accuracies': 0.875, 'rewards/margins': 2.7612292766571045, 'policy_logps/rejected': -434.845703125, 'policy_logps/chosen': -411.0596923828125, 'referece_logps/rejected': -393.4225769042969, 'referece_logps/chosen': -397.2488098144531, 'logits/rejected': -0.08399461209774017, 'logits/chosen': -0.13969480991363525, 'epoch': 1.81}

 60%|██████    | 1618/2685 [8:56:34<5:50:11, 19.69s/it]

 60%|██████    | 1619/2685 [8:56:55<5:53:21, 19.89s/it]


 60%|██████    | 1621/2685 [8:57:35<5:57:40, 20.17s/it]

 60%|██████    | 1622/2685 [8:57:57<6:05:20, 20.62s/it]
{'loss': 0.3587, 'learning_rate': 7.156376438330106e-07, 'rewards/chosen': -0.8676584362983704, 'rewards/rejected': -3.244443416595459, 'rewards/accuracies': 0.875, 'rewards/margins': 2.376784563064575, 'policy_logps/rejected': -420.4992370605469, 'policy_logps/chosen': -333.1650085449219, 'referece_logps/rejected': -388.0547790527344, 'referece_logps/chosen': -324.4884338378906, 'logits/rejected': -0.49881941080093384, 'logits/chosen': -0.39161643385887146, 'epoch': 1.81}


 60%|██████    | 1624/2685 [8:58:37<5:59:03, 20.30s/it]

 61%|██████    | 1625/2685 [8:58:58<6:01:37, 20.47s/it]
{'loss': 0.2209, 'learning_rate': 7.121695854792411e-07, 'rewards/chosen': -1.73714017868042, 'rewards/rejected': -4.514669895172119, 'rewards/accuracies': 1.0, 'rewards/margins': 2.777529716491699, 'policy_logps/rejected': -327.2970886230469, 'policy_logps/chosen': -257.684814453125, 'referece_logps/rejected': -282.15032958984375, 'referece_logps/chosen': -240.31341552734375, 'logits/rejected': -1.0916833877563477, 'logits/chosen': -1.0755399465560913, 'epoch': 1.82}


 61%|██████    | 1627/2685 [8:59:36<5:49:23, 19.81s/it]

 61%|██████    | 1628/2685 [8:59:55<5:45:36, 19.62s/it]
{'loss': 0.2432, 'learning_rate': 7.087052976042787e-07, 'rewards/chosen': -0.4971371293067932, 'rewards/rejected': -3.495069742202759, 'rewards/accuracies': 1.0, 'rewards/margins': 2.9979326725006104, 'policy_logps/rejected': -250.46697998046875, 'policy_logps/chosen': -281.863525390625, 'referece_logps/rejected': -215.51626586914062, 'referece_logps/chosen': -276.89215087890625, 'logits/rejected': -0.7873106002807617, 'logits/chosen': -0.7807720303535461, 'epoch': 1.82}

 61%|██████    | 1629/2685 [9:00:13<5:36:13, 19.10s/it]

 61%|██████    | 1630/2685 [9:00:33<5:39:55, 19.33s/it]


 61%|██████    | 1632/2685 [9:01:12<5:41:54, 19.48s/it]

 61%|██████    | 1633/2685 [9:01:33<5:50:51, 20.01s/it]
{'loss': 0.3182, 'learning_rate': 7.029399865554869e-07, 'rewards/chosen': -1.6426931619644165, 'rewards/rejected': -4.099696159362793, 'rewards/accuracies': 0.75, 'rewards/margins': 2.457002639770508, 'policy_logps/rejected': -323.8876953125, 'policy_logps/chosen': -270.441162109375, 'referece_logps/rejected': -282.8907470703125, 'referece_logps/chosen': -254.0142059326172, 'logits/rejected': -0.13405875861644745, 'logits/chosen': -0.13715791702270508, 'epoch': 1.82}

 61%|██████    | 1634/2685 [9:01:54<5:56:28, 20.35s/it]

 61%|██████    | 1635/2685 [9:02:14<5:54:19, 20.25s/it]

 61%|██████    | 1636/2685 [9:02:36<6:03:06, 20.77s/it]

 61%|██████    | 1637/2685 [9:02:57<6:02:21, 20.75s/it]

 61%|██████    | 1638/2685 [9:03:17<5:58:18, 20.53s/it]


 61%|██████    | 1640/2685 [9:03:58<5:54:12, 20.34s/it]
{'loss': 0.296, 'learning_rate': 6.948867577585849e-07, 'rewards/chosen': -1.1624791622161865, 'rewards/rejected': -2.2636144161224365, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1011351346969604, 'policy_logps/rejected': -273.39605712890625, 'policy_logps/chosen': -334.21331787109375, 'referece_logps/rejected': -250.75991821289062, 'referece_logps/chosen': -322.5885314941406, 'logits/rejected': -0.7818954586982727, 'logits/chosen': -0.714036762714386, 'epoch': 1.83}

 61%|██████    | 1641/2685 [9:04:11<5:17:37, 18.25s/it]

 61%|██████    | 1642/2685 [9:04:32<5:28:08, 18.88s/it]

 61%|██████    | 1643/2685 [9:04:51<5:32:44, 19.16s/it]

 61%|██████    | 1644/2685 [9:05:12<5:38:11, 19.49s/it]

 61%|██████▏   | 1645/2685 [9:05:31<5:37:51, 19.49s/it]

 61%|██████▏   | 1646/2685 [9:05:50<5:32:32, 19.20s/it]

