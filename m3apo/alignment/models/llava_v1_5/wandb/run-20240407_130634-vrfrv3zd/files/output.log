  0%|          | 0/16104 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:179: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/16104 [00:15<68:06:10, 15.23s/it]
{'loss': 0.6931, 'learning_rate': 4.132231404958678e-09, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'policy_logps/rejected': -439.2776184082031, 'policy_logps/chosen': -393.5560302734375, 'referece_logps/rejected': -439.2776184082031, 'referece_logps/chosen': -393.5560302734375, 'logits/rejected': -0.025150049477815628, 'logits/chosen': -0.06190981715917587, 'epoch': 0.0}

  0%|          | 2/16104 [00:26<58:22:36, 13.05s/it]

  0%|          | 3/16104 [00:48<75:56:52, 16.98s/it]

  0%|          | 4/16104 [00:59<65:09:03, 14.57s/it]


  0%|          | 6/16104 [01:27<62:36:21, 14.00s/it]
{'loss': 0.6919, 'learning_rate': 2.4793388429752066e-08, 'rewards/chosen': -0.011812974698841572, 'rewards/rejected': -0.015495110303163528, 'rewards/accuracies': 0.5, 'rewards/margins': 0.003682134672999382, 'policy_logps/rejected': -402.6881408691406, 'policy_logps/chosen': -422.4175109863281, 'referece_logps/rejected': -402.533203125, 'referece_logps/chosen': -422.29937744140625, 'logits/rejected': -0.6933864951133728, 'logits/chosen': -0.5964383482933044, 'epoch': 0.0}


  0%|          | 8/16104 [01:58<63:49:29, 14.27s/it]
{'loss': 0.706, 'learning_rate': 3.305785123966942e-08, 'rewards/chosen': -0.017262648791074753, 'rewards/rejected': 0.011122512631118298, 'rewards/accuracies': 0.125, 'rewards/margins': -0.028385164216160774, 'policy_logps/rejected': -480.10540771484375, 'policy_logps/chosen': -322.5233154296875, 'referece_logps/rejected': -480.2166748046875, 'referece_logps/chosen': -322.3506774902344, 'logits/rejected': -0.8031325340270996, 'logits/chosen': -0.713514506816864, 'epoch': 0.0}


  0%|          | 10/16104 [02:27<65:48:01, 14.72s/it]

  0%|          | 11/16104 [02:45<70:17:40, 15.72s/it]
{'loss': 0.6923, 'learning_rate': 4.545454545454545e-08, 'rewards/chosen': -0.014132787473499775, 'rewards/rejected': 0.006560515146702528, 'rewards/accuracies': 0.5, 'rewards/margins': -0.020693300291895866, 'policy_logps/rejected': -276.5426025390625, 'policy_logps/chosen': -326.8597717285156, 'referece_logps/rejected': -276.60821533203125, 'referece_logps/chosen': -326.71844482421875, 'logits/rejected': -0.3595156669616699, 'logits/chosen': -0.31478673219680786, 'epoch': 0.0}


  0%|          | 13/16104 [03:09<61:15:51, 13.71s/it]
{'loss': 0.6914, 'learning_rate': 5.3719008264462806e-08, 'rewards/chosen': 0.006855917163193226, 'rewards/rejected': -0.03237514942884445, 'rewards/accuracies': 0.625, 'rewards/margins': 0.039231058210134506, 'policy_logps/rejected': -521.2257690429688, 'policy_logps/chosen': -285.12969970703125, 'referece_logps/rejected': -520.9019775390625, 'referece_logps/chosen': -285.1982421875, 'logits/rejected': -0.3075644373893738, 'logits/chosen': -0.2773951590061188, 'epoch': 0.0}


  0%|          | 15/16104 [03:49<75:06:19, 16.81s/it]

  0%|          | 16/16104 [04:11<81:47:40, 18.30s/it]
{'loss': 0.6964, 'learning_rate': 6.611570247933884e-08, 'rewards/chosen': -0.019800329580903053, 'rewards/rejected': 0.031129073351621628, 'rewards/accuracies': 0.25, 'rewards/margins': -0.05092940479516983, 'policy_logps/rejected': -473.3189697265625, 'policy_logps/chosen': -390.0374450683594, 'referece_logps/rejected': -473.6302490234375, 'referece_logps/chosen': -389.8394470214844, 'logits/rejected': -1.186356782913208, 'logits/chosen': -0.9168229103088379, 'epoch': 0.01}

  0%|          | 17/16104 [04:27<78:04:27, 17.47s/it]


  0%|          | 19/16104 [04:53<67:26:21, 15.09s/it]
{'loss': 0.6933, 'learning_rate': 7.851239669421488e-08, 'rewards/chosen': -0.018857384100556374, 'rewards/rejected': -0.010522841475903988, 'rewards/accuracies': 0.5, 'rewards/margins': -0.008334542624652386, 'policy_logps/rejected': -321.4450378417969, 'policy_logps/chosen': -514.8936157226562, 'referece_logps/rejected': -321.33984375, 'referece_logps/chosen': -514.705078125, 'logits/rejected': -1.184084415435791, 'logits/chosen': -1.264973521232605, 'epoch': 0.01}

  0%|          | 20/16104 [05:06<64:42:24, 14.48s/it]


  0%|          | 22/16104 [05:34<64:19:21, 14.40s/it]
{'loss': 0.6878, 'learning_rate': 9.09090909090909e-08, 'rewards/chosen': 0.0018832210917025805, 'rewards/rejected': 0.006409359630197287, 'rewards/accuracies': 0.5, 'rewards/margins': -0.004526137374341488, 'policy_logps/rejected': -329.007568359375, 'policy_logps/chosen': -358.60101318359375, 'referece_logps/rejected': -329.0716857910156, 'referece_logps/chosen': -358.6198425292969, 'logits/rejected': -0.5225370526313782, 'logits/chosen': -0.5922199487686157, 'epoch': 0.01}

  0%|          | 23/16104 [05:52<69:55:53, 15.66s/it]


  0%|          | 25/16104 [06:19<64:02:35, 14.34s/it]
{'loss': 0.6968, 'learning_rate': 1.0330578512396694e-07, 'rewards/chosen': 0.0031555183231830597, 'rewards/rejected': 0.020168302580714226, 'rewards/accuracies': 0.5, 'rewards/margins': -0.017012786120176315, 'policy_logps/rejected': -215.3812255859375, 'policy_logps/chosen': -344.18719482421875, 'referece_logps/rejected': -215.58291625976562, 'referece_logps/chosen': -344.21875, 'logits/rejected': -1.0401109457015991, 'logits/chosen': -0.960885763168335, 'epoch': 0.01}


  0%|          | 27/16104 [06:43<58:55:01, 13.19s/it]

  0%|          | 28/16104 [06:56<57:39:09, 12.91s/it]
{'loss': 0.6933, 'learning_rate': 1.1570247933884297e-07, 'rewards/chosen': 0.017508508637547493, 'rewards/rejected': -0.022127535194158554, 'rewards/accuracies': 0.875, 'rewards/margins': 0.0396360419690609, 'policy_logps/rejected': -479.77447509765625, 'policy_logps/chosen': -510.57427978515625, 'referece_logps/rejected': -479.55322265625, 'referece_logps/chosen': -510.7493591308594, 'logits/rejected': -0.6348325610160828, 'logits/chosen': -0.6787732839584351, 'epoch': 0.01}


  0%|          | 30/16104 [07:30<65:10:18, 14.60s/it]

  0%|          | 31/16104 [07:52<75:11:58, 16.84s/it]
{'loss': 0.6954, 'learning_rate': 1.28099173553719e-07, 'rewards/chosen': 0.00502090435475111, 'rewards/rejected': 0.0021507269702851772, 'rewards/accuracies': 0.625, 'rewards/margins': 0.00287017785012722, 'policy_logps/rejected': -313.09454345703125, 'policy_logps/chosen': -496.63104248046875, 'referece_logps/rejected': -313.1160583496094, 'referece_logps/chosen': -496.6813049316406, 'logits/rejected': -0.7034676671028137, 'logits/chosen': -0.5528861880302429, 'epoch': 0.01}
[2024-04-07 13:14:48,177] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  0%|          | 33/16104 [08:20<67:59:34, 15.23s/it]
{'loss': 0.693, 'learning_rate': 1.3636363636363635e-07, 'rewards/chosen': 0.017726898193359375, 'rewards/rejected': -0.007481672801077366, 'rewards/accuracies': 0.75, 'rewards/margins': 0.025208568200469017, 'policy_logps/rejected': -467.0458679199219, 'policy_logps/chosen': -515.068115234375, 'referece_logps/rejected': -466.9710388183594, 'referece_logps/chosen': -515.2454223632812, 'logits/rejected': -0.5007662773132324, 'logits/chosen': -0.4179399907588959, 'epoch': 0.01}


  0%|          | 35/16104 [08:48<65:41:13, 14.72s/it]
{'loss': 0.6848, 'learning_rate': 1.446280991735537e-07, 'rewards/chosen': 0.033715251833200455, 'rewards/rejected': -0.0063762664794921875, 'rewards/accuracies': 0.75, 'rewards/margins': 0.040091514587402344, 'policy_logps/rejected': -571.9952392578125, 'policy_logps/chosen': -360.34039306640625, 'referece_logps/rejected': -571.9315185546875, 'referece_logps/chosen': -360.6775817871094, 'logits/rejected': -0.8442288041114807, 'logits/chosen': -0.5392776727676392, 'epoch': 0.01}


  0%|          | 37/16104 [09:19<68:20:07, 15.31s/it]

  0%|          | 38/16104 [09:34<67:38:22, 15.16s/it]
{'loss': 0.6925, 'learning_rate': 1.5702479338842976e-07, 'rewards/chosen': 0.04881763458251953, 'rewards/rejected': -0.014783287420868874, 'rewards/accuracies': 0.875, 'rewards/margins': 0.06360092759132385, 'policy_logps/rejected': -375.00567626953125, 'policy_logps/chosen': -563.6575927734375, 'referece_logps/rejected': -374.85784912109375, 'referece_logps/chosen': -564.1458129882812, 'logits/rejected': -0.021615326404571533, 'logits/chosen': 0.04431295394897461, 'epoch': 0.01}


  0%|          | 40/16104 [10:12<76:22:08, 17.11s/it]

  0%|          | 41/16104 [10:30<78:09:10, 17.52s/it]
{'loss': 0.6914, 'learning_rate': 1.6942148760330577e-07, 'rewards/chosen': 0.0001876825699582696, 'rewards/rejected': -0.016721535474061966, 'rewards/accuracies': 0.625, 'rewards/margins': 0.016909217461943626, 'policy_logps/rejected': -363.9910583496094, 'policy_logps/chosen': -242.3496856689453, 'referece_logps/rejected': -363.82391357421875, 'referece_logps/chosen': -242.35153198242188, 'logits/rejected': -0.8165524005889893, 'logits/chosen': -0.6925357580184937, 'epoch': 0.02}


  0%|          | 43/16104 [10:54<64:51:24, 14.54s/it]

  0%|          | 44/16104 [11:06<61:37:52, 13.82s/it]
{'loss': 0.6915, 'learning_rate': 1.818181818181818e-07, 'rewards/chosen': 0.0014854425098747015, 'rewards/rejected': 0.011641694232821465, 'rewards/accuracies': 0.5, 'rewards/margins': -0.01015625149011612, 'policy_logps/rejected': -357.3775634765625, 'policy_logps/chosen': -315.13262939453125, 'referece_logps/rejected': -357.49395751953125, 'referece_logps/chosen': -315.1474914550781, 'logits/rejected': -0.03696402162313461, 'logits/chosen': -0.03455878421664238, 'epoch': 0.02}


  0%|          | 46/16104 [11:35<63:57:38, 14.34s/it]
{'loss': 0.6978, 'learning_rate': 1.9008264462809918e-07, 'rewards/chosen': -0.042036816477775574, 'rewards/rejected': 0.00019865063950419426, 'rewards/accuracies': 0.25, 'rewards/margins': -0.042235467582941055, 'policy_logps/rejected': -363.6967468261719, 'policy_logps/chosen': -341.5735778808594, 'referece_logps/rejected': -363.69873046875, 'referece_logps/chosen': -341.1531982421875, 'logits/rejected': -1.1211899518966675, 'logits/chosen': -1.2401870489120483, 'epoch': 0.02}

  0%|          | 47/16104 [11:47<60:59:40, 13.68s/it]


  0%|          | 49/16104 [12:26<74:26:26, 16.69s/it]

  0%|          | 50/16104 [12:40<70:25:16, 15.79s/it]
{'loss': 0.6909, 'learning_rate': 2.0661157024793388e-07, 'rewards/chosen': 0.06830578297376633, 'rewards/rejected': 0.013305664993822575, 'rewards/accuracies': 0.75, 'rewards/margins': 0.05500011518597603, 'policy_logps/rejected': -391.78485107421875, 'policy_logps/chosen': -355.56488037109375, 'referece_logps/rejected': -391.91796875, 'referece_logps/chosen': -356.2479248046875, 'logits/rejected': 0.36684656143188477, 'logits/chosen': 0.36182963848114014, 'epoch': 0.02}


  0%|          | 52/16104 [13:14<72:03:26, 16.16s/it]
{'loss': 0.6954, 'learning_rate': 2.1487603305785122e-07, 'rewards/chosen': 0.006829071324318647, 'rewards/rejected': -0.0068454742431640625, 'rewards/accuracies': 0.625, 'rewards/margins': 0.013674546033143997, 'policy_logps/rejected': -343.936279296875, 'policy_logps/chosen': -360.5175476074219, 'referece_logps/rejected': -343.8677978515625, 'referece_logps/chosen': -360.5858154296875, 'logits/rejected': -0.6523257493972778, 'logits/chosen': -0.6945684552192688, 'epoch': 0.02}


  0%|          | 54/16104 [13:46<71:16:33, 15.99s/it]

  0%|          | 55/16104 [14:09<79:54:09, 17.92s/it]
[2024-04-07 13:20:49,714] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  0%|          | 56/16104 [14:30<83:57:42, 18.83s/it]

  0%|          | 57/16104 [14:48<83:24:11, 18.71s/it]

  0%|          | 58/16104 [15:06<82:21:34, 18.48s/it]

  0%|          | 59/16104 [15:22<79:31:09, 17.84s/it]
{'loss': 0.6927, 'learning_rate': 2.43801652892562e-07, 'rewards/chosen': 0.010863114148378372, 'rewards/rejected': -0.00024948175996541977, 'rewards/accuracies': 0.5, 'rewards/margins': 0.011112594977021217, 'policy_logps/rejected': -217.1564178466797, 'policy_logps/chosen': -382.5401306152344, 'referece_logps/rejected': -217.15390014648438, 'referece_logps/chosen': -382.6487121582031, 'logits/rejected': -0.3147674798965454, 'logits/chosen': -0.3207237124443054, 'epoch': 0.02}

  0%|          | 60/16104 [15:44<84:11:58, 18.89s/it]


  0%|          | 62/16104 [16:14<76:22:34, 17.14s/it]

  0%|          | 63/16104 [16:30<74:47:50, 16.79s/it]

  0%|          | 64/16104 [16:42<68:47:01, 15.44s/it]

  0%|          | 65/16104 [16:58<69:00:45, 15.49s/it]

  0%|          | 66/16104 [17:10<64:26:23, 14.46s/it]

  0%|          | 67/16104 [17:21<59:25:24, 13.34s/it]
{'loss': 0.6964, 'learning_rate': 2.7685950413223143e-07, 'rewards/chosen': 0.003120614215731621, 'rewards/rejected': -0.0015487665077671409, 'rewards/accuracies': 0.625, 'rewards/margins': 0.004669380374252796, 'policy_logps/rejected': -476.6980895996094, 'policy_logps/chosen': -431.327880859375, 'referece_logps/rejected': -476.6825866699219, 'referece_logps/chosen': -431.3591003417969, 'logits/rejected': -0.07767072319984436, 'logits/chosen': 0.07096482068300247, 'epoch': 0.02}

  0%|          | 68/16104 [17:38<64:09:10, 14.40s/it]

  0%|          | 69/16104 [17:52<63:49:43, 14.33s/it]


  0%|          | 71/16104 [18:33<78:24:35, 17.61s/it]

  0%|          | 72/16104 [18:50<78:06:00, 17.54s/it]

  0%|          | 73/16104 [19:12<84:10:50, 18.90s/it]

  0%|          | 74/16104 [19:26<77:39:12, 17.44s/it]
{'loss': 0.6921, 'learning_rate': 3.0578512396694214e-07, 'rewards/chosen': 0.017385482788085938, 'rewards/rejected': -0.025591090321540833, 'rewards/accuracies': 0.75, 'rewards/margins': 0.04297657310962677, 'policy_logps/rejected': -284.01422119140625, 'policy_logps/chosen': -414.68341064453125, 'referece_logps/rejected': -283.75830078125, 'referece_logps/chosen': -414.8572082519531, 'logits/rejected': -0.623022198677063, 'logits/chosen': -0.773481011390686, 'epoch': 0.03}

  0%|          | 75/16104 [19:40<72:06:25, 16.19s/it]


  0%|          | 77/16104 [20:16<76:47:15, 17.25s/it]

  0%|          | 78/16104 [20:33<75:48:17, 17.03s/it]
{'loss': 0.698, 'learning_rate': 3.2231404958677684e-07, 'rewards/chosen': -0.024765396490693092, 'rewards/rejected': -0.019985675811767578, 'rewards/accuracies': 0.375, 'rewards/margins': -0.0047797211445868015, 'policy_logps/rejected': -369.3931884765625, 'policy_logps/chosen': -362.376220703125, 'referece_logps/rejected': -369.19329833984375, 'referece_logps/chosen': -362.12860107421875, 'logits/rejected': -0.6396108269691467, 'logits/chosen': -0.5837193727493286, 'epoch': 0.03}


  0%|          | 80/16104 [21:10<79:16:04, 17.81s/it]
{'loss': 0.6863, 'learning_rate': 3.305785123966942e-07, 'rewards/chosen': -0.00972366239875555, 'rewards/rejected': 0.006427288055419922, 'rewards/accuracies': 0.375, 'rewards/margins': -0.016150951385498047, 'policy_logps/rejected': -283.68963623046875, 'policy_logps/chosen': -396.7414245605469, 'referece_logps/rejected': -283.75390625, 'referece_logps/chosen': -396.64422607421875, 'logits/rejected': 0.4221404194831848, 'logits/chosen': 0.37301477789878845, 'epoch': 0.03}

  1%|          | 81/16104 [21:31<83:29:54, 18.76s/it]


  1%|          | 83/16104 [22:11<86:07:24, 19.35s/it]
{'loss': 0.691, 'learning_rate': 3.429752066115703e-07, 'rewards/chosen': 0.015502356924116611, 'rewards/rejected': 0.008579827845096588, 'rewards/accuracies': 0.375, 'rewards/margins': 0.006922528613358736, 'policy_logps/rejected': -316.3493957519531, 'policy_logps/chosen': -285.62261962890625, 'referece_logps/rejected': -316.4351806640625, 'referece_logps/chosen': -285.7776184082031, 'logits/rejected': -0.422913521528244, 'logits/chosen': -0.5637932419776917, 'epoch': 0.03}

  1%|          | 84/16104 [22:28<83:15:03, 18.71s/it]


  1%|          | 86/16104 [22:56<71:40:56, 16.11s/it]
{'loss': 0.6977, 'learning_rate': 3.5537190082644623e-07, 'rewards/chosen': -0.014795685186982155, 'rewards/rejected': -0.004680633544921875, 'rewards/accuracies': 0.625, 'rewards/margins': -0.01011505164206028, 'policy_logps/rejected': -637.8048095703125, 'policy_logps/chosen': -441.37677001953125, 'referece_logps/rejected': -637.7579956054688, 'referece_logps/chosen': -441.22882080078125, 'logits/rejected': -0.1242796778678894, 'logits/chosen': -0.03800355643033981, 'epoch': 0.03}


  1%|          | 88/16104 [23:23<66:08:59, 14.87s/it]
{'loss': 0.6998, 'learning_rate': 3.636363636363636e-07, 'rewards/chosen': 0.020815275609493256, 'rewards/rejected': 0.0007037399336695671, 'rewards/accuracies': 0.5, 'rewards/margins': 0.020111538469791412, 'policy_logps/rejected': -380.3812561035156, 'policy_logps/chosen': -314.74456787109375, 'referece_logps/rejected': -380.3882751464844, 'referece_logps/chosen': -314.95269775390625, 'logits/rejected': -0.5273846983909607, 'logits/chosen': -0.5846521854400635, 'epoch': 0.03}

  1%|          | 89/16104 [23:37<65:35:31, 14.74s/it]
[2024-04-07 13:30:32,639] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  1%|          | 91/16104 [24:13<74:12:50, 16.68s/it]
{'loss': 0.6859, 'learning_rate': 3.7603305785123967e-07, 'rewards/chosen': 0.031398870050907135, 'rewards/rejected': -0.00274162320420146, 'rewards/accuracies': 0.625, 'rewards/margins': 0.034140489995479584, 'policy_logps/rejected': -409.84808349609375, 'policy_logps/chosen': -441.63458251953125, 'referece_logps/rejected': -409.8206481933594, 'referece_logps/chosen': -441.9485778808594, 'logits/rejected': -0.6918161511421204, 'logits/chosen': -0.7929053902626038, 'epoch': 0.03}


  1%|          | 93/16104 [24:53<81:17:47, 18.28s/it]
[2024-04-07 13:31:33,646] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 94/16104 [25:07<75:56:22, 17.08s/it]

  1%|          | 95/16104 [25:19<69:36:00, 15.65s/it]
{'loss': 0.6884, 'learning_rate': 3.9256198347107437e-07, 'rewards/chosen': 0.03802242502570152, 'rewards/rejected': -0.022148704156279564, 'rewards/accuracies': 0.875, 'rewards/margins': 0.06017112731933594, 'policy_logps/rejected': -207.20901489257812, 'policy_logps/chosen': -221.96188354492188, 'referece_logps/rejected': -206.98751831054688, 'referece_logps/chosen': -222.34210205078125, 'logits/rejected': -1.1250789165496826, 'logits/chosen': -0.9667565226554871, 'epoch': 0.04}


  1%|          | 97/16104 [25:45<63:38:36, 14.31s/it]
{'loss': 0.6964, 'learning_rate': 4.0082644628099174e-07, 'rewards/chosen': -0.01446981355547905, 'rewards/rejected': -0.013142299838364124, 'rewards/accuracies': 0.5, 'rewards/margins': -0.0013275165110826492, 'policy_logps/rejected': -261.94488525390625, 'policy_logps/chosen': -438.4164733886719, 'referece_logps/rejected': -261.8134765625, 'referece_logps/chosen': -438.27178955078125, 'logits/rejected': -0.9577104449272156, 'logits/chosen': -1.0373027324676514, 'epoch': 0.04}


  1%|          | 99/16104 [26:31<83:30:40, 18.78s/it]
{'loss': 0.6948, 'learning_rate': 4.090909090909091e-07, 'rewards/chosen': 0.00811023823916912, 'rewards/rejected': 0.019436264410614967, 'rewards/accuracies': 0.5, 'rewards/margins': -0.011326026171445847, 'policy_logps/rejected': -283.5720520019531, 'policy_logps/chosen': -351.83831787109375, 'referece_logps/rejected': -283.76641845703125, 'referece_logps/chosen': -351.9194641113281, 'logits/rejected': -1.0520803928375244, 'logits/chosen': -1.0570602416992188, 'epoch': 0.04}

  1%|          | 100/16104 [26:46<77:58:25, 17.54s/it]


  1%|          | 102/16104 [27:15<71:02:30, 15.98s/it]

  1%|          | 103/16104 [27:27<65:48:59, 14.81s/it]
{'loss': 0.6948, 'learning_rate': 4.256198347107438e-07, 'rewards/chosen': -0.040818024426698685, 'rewards/rejected': -0.0034043313935399055, 'rewards/accuracies': 0.25, 'rewards/margins': -0.037413693964481354, 'policy_logps/rejected': -267.9251403808594, 'policy_logps/chosen': -350.20123291015625, 'referece_logps/rejected': -267.89111328125, 'referece_logps/chosen': -349.7930603027344, 'logits/rejected': 0.12535440921783447, 'logits/chosen': 0.12012351304292679, 'epoch': 0.04}

  1%|          | 104/16104 [27:44<68:36:44, 15.44s/it]

  1%|          | 105/16104 [28:04<74:31:06, 16.77s/it]

  1%|          | 106/16104 [28:20<74:12:46, 16.70s/it]


  1%|          | 108/16104 [28:55<75:58:18, 17.10s/it]
{'loss': 0.6885, 'learning_rate': 4.462809917355372e-07, 'rewards/chosen': 0.059353023767471313, 'rewards/rejected': -0.0002798080677166581, 'rewards/accuracies': 0.875, 'rewards/margins': 0.05963282659649849, 'policy_logps/rejected': -177.11663818359375, 'policy_logps/chosen': -344.3746643066406, 'referece_logps/rejected': -177.11383056640625, 'referece_logps/chosen': -344.96820068359375, 'logits/rejected': -0.18867219984531403, 'logits/chosen': -0.3192465901374817, 'epoch': 0.04}

  1%|          | 109/16104 [29:06<67:54:54, 15.29s/it]


  1%|          | 111/16104 [29:33<64:17:51, 14.47s/it]

  1%|          | 112/16104 [29:51<69:39:38, 15.68s/it]
{'loss': 0.6916, 'learning_rate': 4.628099173553719e-07, 'rewards/chosen': -0.025325680151581764, 'rewards/rejected': -0.005025100894272327, 'rewards/accuracies': 0.625, 'rewards/margins': -0.020300578325986862, 'policy_logps/rejected': -465.82568359375, 'policy_logps/chosen': -492.0393371582031, 'referece_logps/rejected': -465.7754821777344, 'referece_logps/chosen': -491.78607177734375, 'logits/rejected': 0.4301289916038513, 'logits/chosen': 0.8043839931488037, 'epoch': 0.04}

  1%|          | 113/16104 [30:08<71:41:59, 16.14s/it]

  1%|          | 114/16104 [30:23<69:00:09, 15.54s/it]


  1%|          | 116/16104 [31:05<82:07:44, 18.49s/it]
{'loss': 0.6946, 'learning_rate': 4.793388429752066e-07, 'rewards/chosen': -0.013316823169589043, 'rewards/rejected': 0.0015949257649481297, 'rewards/accuracies': 0.5, 'rewards/margins': -0.014911746606230736, 'policy_logps/rejected': -439.9029541015625, 'policy_logps/chosen': -300.4142761230469, 'referece_logps/rejected': -439.91888427734375, 'referece_logps/chosen': -300.2810974121094, 'logits/rejected': -0.32125478982925415, 'logits/chosen': -0.244134783744812, 'epoch': 0.04}

  1%|          | 117/16104 [31:22<79:20:36, 17.87s/it]

  1%|          | 118/16104 [31:34<72:12:02, 16.26s/it]

  1%|          | 119/16104 [31:50<72:20:35, 16.29s/it]

  1%|          | 120/16104 [32:13<80:34:02, 18.15s/it]

  1%|          | 121/16104 [32:28<75:49:30, 17.08s/it]

  1%|          | 122/16104 [32:46<78:11:10, 17.61s/it]

  1%|          | 123/16104 [33:00<72:43:45, 16.38s/it]

  1%|          | 124/16104 [33:24<82:20:49, 18.55s/it]

  1%|          | 125/16104 [33:41<81:35:55, 18.38s/it]

  1%|          | 126/16104 [34:01<83:10:31, 18.74s/it]
[2024-04-07 13:41:06,172] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 127/16104 [34:25<90:14:08, 20.33s/it]
[2024-04-07 13:41:28,451] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 128/16104 [34:47<92:49:16, 20.92s/it]

  1%|          | 129/16104 [35:09<93:09:35, 20.99s/it]

  1%|          | 130/16104 [35:30<93:08:59, 20.99s/it]

  1%|          | 131/16104 [35:49<90:59:12, 20.51s/it]

  1%|          | 132/16104 [36:07<87:08:44, 19.64s/it]

  1%|          | 133/16104 [36:28<89:15:20, 20.12s/it]

  1%|          | 134/16104 [36:48<89:29:35, 20.17s/it]

  1%|          | 135/16104 [37:07<88:15:05, 19.90s/it]

  1%|          | 136/16104 [37:21<80:07:46, 18.07s/it]

  1%|          | 137/16104 [37:37<77:45:59, 17.53s/it]

  1%|          | 138/16104 [37:53<75:17:28, 16.98s/it]

  1%|          | 139/16104 [38:10<75:24:29, 17.00s/it]

  1%|          | 140/16104 [38:21<67:47:24, 15.29s/it]

  1%|          | 141/16104 [38:32<61:35:48, 13.89s/it]

  1%|          | 142/16104 [38:43<57:58:42, 13.08s/it]

  1%|          | 143/16104 [39:03<67:01:44, 15.12s/it]

  1%|          | 144/16104 [39:14<61:04:44, 13.78s/it]

  1%|          | 145/16104 [39:24<56:57:08, 12.85s/it]

  1%|          | 146/16104 [39:45<67:38:45, 15.26s/it]

  1%|          | 147/16104 [40:02<69:15:20, 15.62s/it]

  1%|          | 148/16104 [40:15<66:27:42, 15.00s/it]

  1%|          | 149/16104 [40:28<63:09:18, 14.25s/it]

  1%|          | 150/16104 [40:40<60:23:20, 13.63s/it]

  1%|          | 151/16104 [40:57<65:11:35, 14.71s/it]

  1%|          | 152/16104 [41:14<67:35:54, 15.26s/it]

  1%|          | 153/16104 [41:30<68:50:42, 15.54s/it]

  1%|          | 154/16104 [41:42<64:13:48, 14.50s/it]

  1%|          | 155/16104 [42:00<69:24:23, 15.67s/it]

  1%|          | 156/16104 [42:16<69:01:29, 15.58s/it]

  1%|          | 157/16104 [42:35<73:05:46, 16.50s/it]

  1%|          | 158/16104 [42:47<67:13:30, 15.18s/it]

  1%|          | 159/16104 [43:09<77:02:04, 17.39s/it]

  1%|          | 160/16104 [43:21<69:23:09, 15.67s/it]

  1%|          | 161/16104 [43:36<68:42:52, 15.52s/it]
[2024-04-07 13:50:38,619] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 162/16104 [43:58<76:48:14, 17.34s/it]
[2024-04-07 13:50:55,394] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 163/16104 [44:14<76:02:34, 17.17s/it]

  1%|          | 164/16104 [44:25<67:56:34, 15.34s/it]

  1%|          | 165/16104 [44:40<67:26:11, 15.23s/it]

  1%|          | 166/16104 [45:01<74:46:46, 16.89s/it]

  1%|          | 167/16104 [45:22<80:34:56, 18.20s/it]

  1%|          | 168/16104 [45:39<78:21:48, 17.70s/it]

  1%|          | 169/16104 [45:52<71:53:59, 16.24s/it]

  1%|          | 170/16104 [46:04<66:44:28, 15.08s/it]

  1%|          | 171/16104 [46:20<68:01:17, 15.37s/it]
[2024-04-07 13:53:19,233] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 172/16104 [46:38<71:29:24, 16.15s/it]

  1%|          | 173/16104 [47:01<79:43:35, 18.02s/it]

  1%|          | 174/16104 [47:12<70:27:31, 15.92s/it]

  1%|          | 175/16104 [47:24<65:58:32, 14.91s/it]
[2024-04-07 13:54:24,918] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 176/16104 [47:44<72:22:34, 16.36s/it]

  1%|          | 177/16104 [47:55<65:06:49, 14.72s/it]

  1%|          | 178/16104 [48:13<70:20:51, 15.90s/it]

  1%|          | 179/16104 [48:32<73:53:51, 16.71s/it]

  1%|          | 180/16104 [48:43<65:58:24, 14.91s/it]

  1%|          | 181/16104 [49:07<78:22:01, 17.72s/it]

  1%|          | 182/16104 [49:24<76:49:09, 17.37s/it]

  1%|          | 183/16104 [49:42<77:52:59, 17.61s/it]

  1%|          | 184/16104 [49:53<69:26:41, 15.70s/it]

  1%|          | 185/16104 [50:09<69:19:12, 15.68s/it]

  1%|          | 186/16104 [50:20<64:02:05, 14.48s/it]

  1%|          | 187/16104 [50:43<74:49:24, 16.92s/it]

  1%|          | 188/16104 [50:58<72:00:14, 16.29s/it]

  1%|          | 189/16104 [51:09<65:58:34, 14.92s/it]

  1%|          | 190/16104 [51:28<70:31:48, 15.96s/it]

  1%|          | 191/16104 [51:39<63:33:55, 14.38s/it]

  1%|          | 192/16104 [51:59<71:34:53, 16.19s/it]

  1%|          | 193/16104 [52:13<68:45:31, 15.56s/it]
[2024-04-07 13:59:16,047] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 194/16104 [52:35<77:15:55, 17.48s/it]
[2024-04-07 13:59:35,965] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 195/16104 [52:55<80:29:21, 18.21s/it]

  1%|          | 196/16104 [53:12<78:41:32, 17.81s/it]

  1%|          | 197/16104 [53:24<70:48:07, 16.02s/it]

  1%|          | 198/16104 [53:38<68:33:39, 15.52s/it]

  1%|          | 199/16104 [53:51<64:55:16, 14.69s/it]

  1%|          | 200/16104 [54:09<69:28:19, 15.73s/it]
[2024-04-07 14:01:12,201] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|          | 201/16104 [54:31<78:08:34, 17.69s/it]

  1%|▏         | 202/16104 [54:48<77:25:17, 17.53s/it]

  1%|▏         | 203/16104 [55:02<72:41:26, 16.46s/it]

  1%|▏         | 204/16104 [55:21<76:15:50, 17.27s/it]

  1%|▏         | 205/16104 [55:37<74:30:39, 16.87s/it]
[2024-04-07 14:02:39,559] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 206/16104 [55:59<80:10:00, 18.15s/it]

  1%|▏         | 207/16104 [56:17<80:18:46, 18.19s/it]
[2024-04-07 14:03:11,125] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  1%|▏         | 209/16104 [56:45<70:52:48, 16.05s/it]

  1%|▏         | 210/16104 [57:03<74:28:26, 16.87s/it]

  1%|▏         | 211/16104 [57:21<75:24:55, 17.08s/it]

  1%|▏         | 212/16104 [57:37<73:33:03, 16.66s/it]

  1%|▏         | 213/16104 [57:48<67:09:50, 15.22s/it]

  1%|▏         | 214/16104 [58:03<66:16:51, 15.02s/it]

  1%|▏         | 215/16104 [58:15<62:40:40, 14.20s/it]

  1%|▏         | 216/16104 [58:36<71:24:27, 16.18s/it]

  1%|▏         | 217/16104 [58:55<75:15:44, 17.05s/it]

  1%|▏         | 218/16104 [59:10<71:57:11, 16.31s/it]

  1%|▏         | 219/16104 [59:23<67:39:43, 15.33s/it]

  1%|▏         | 220/16104 [59:43<74:36:03, 16.91s/it]
[2024-04-07 14:06:24,442] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 221/16104 [1:00:04<78:55:23, 17.89s/it]

  1%|▏         | 222/16104 [1:00:18<74:21:23, 16.85s/it]

  1%|▏         | 223/16104 [1:00:38<78:01:39, 17.69s/it]

  1%|▏         | 224/16104 [1:00:51<72:02:53, 16.33s/it]

  1%|▏         | 225/16104 [1:01:10<75:58:15, 17.22s/it]

  1%|▏         | 226/16104 [1:01:32<82:43:09, 18.75s/it]
[2024-04-07 14:08:13,495] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 227/16104 [1:01:55<87:13:05, 19.78s/it]
[2024-04-07 14:08:35,654] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 228/16104 [1:02:06<76:00:00, 17.23s/it]

  1%|▏         | 229/16104 [1:02:20<72:20:35, 16.41s/it]
[2024-04-07 14:09:01,428] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 230/16104 [1:02:35<70:18:42, 15.95s/it]

  1%|▏         | 231/16104 [1:02:46<63:57:52, 14.51s/it]

  1%|▏         | 232/16104 [1:03:03<66:39:37, 15.12s/it]

  1%|▏         | 233/16104 [1:03:18<66:59:02, 15.19s/it]
[2024-04-07 14:09:59,368] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 234/16104 [1:03:40<75:18:55, 17.08s/it]

  1%|▏         | 235/16104 [1:03:54<71:20:31, 16.18s/it]

  1%|▏         | 236/16104 [1:04:16<78:56:16, 17.91s/it]

  1%|▏         | 237/16104 [1:04:37<83:21:33, 18.91s/it]

  1%|▏         | 238/16104 [1:04:56<83:42:20, 18.99s/it]
[2024-04-07 14:11:37,316] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  1%|▏         | 239/16104 [1:05:15<83:02:37, 18.84s/it]

  1%|▏         | 240/16104 [1:05:37<87:12:33, 19.79s/it]

  1%|▏         | 241/16104 [1:05:56<86:40:05, 19.67s/it]
{'loss': 0.6682, 'learning_rate': 9.958677685950413e-07, 'rewards/chosen': -0.006747914478182793, 'rewards/rejected': -0.06755227595567703, 'rewards/accuracies': 0.75, 'rewards/margins': 0.06080436706542969, 'policy_logps/rejected': -262.1175231933594, 'policy_logps/chosen': -231.42620849609375, 'referece_logps/rejected': -261.4419860839844, 'referece_logps/chosen': -231.35873413085938, 'logits/rejected': -0.5123100876808167, 'logits/chosen': -0.48984307050704956, 'epoch': 0.09}

  2%|▏         | 242/16104 [1:06:12<81:00:48, 18.39s/it]

  2%|▏         | 243/16104 [1:06:30<80:59:55, 18.38s/it]


  2%|▏         | 245/16104 [1:07:05<78:53:42, 17.91s/it]
{'loss': 0.6675, 'learning_rate': 1.012396694214876e-06, 'rewards/chosen': 0.04522399976849556, 'rewards/rejected': -0.0390409491956234, 'rewards/accuracies': 0.875, 'rewards/margins': 0.08426495641469955, 'policy_logps/rejected': -202.79833984375, 'policy_logps/chosen': -300.8727111816406, 'referece_logps/rejected': -202.40792846679688, 'referece_logps/chosen': -301.3249816894531, 'logits/rejected': -1.2015621662139893, 'logits/chosen': -1.114212155342102, 'epoch': 0.09}
[2024-04-07 14:14:06,948] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  2%|▏         | 247/16104 [1:07:45<83:39:10, 18.99s/it]

  2%|▏         | 248/16104 [1:08:03<81:41:15, 18.55s/it]
[2024-04-07 14:14:43,857] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6751, 'learning_rate': 1.024793388429752e-06, 'rewards/chosen': -0.04228077456355095, 'rewards/rejected': -0.08622922003269196, 'rewards/accuracies': 0.5, 'rewards/margins': 0.0439484529197216, 'policy_logps/rejected': -346.2285461425781, 'policy_logps/chosen': -372.81451416015625, 'referece_logps/rejected': -345.3662109375, 'referece_logps/chosen': -372.3916931152344, 'logits/rejected': -0.759596586227417, 'logits/chosen': -0.7782468795776367, 'epoch': 0.09}

  2%|▏         | 249/16104 [1:08:14<72:08:18, 16.38s/it]


  2%|▏         | 251/16104 [1:08:51<74:50:52, 17.00s/it]
{'loss': 0.6794, 'learning_rate': 1.037190082644628e-06, 'rewards/chosen': 0.02293701283633709, 'rewards/rejected': -0.06491565704345703, 'rewards/accuracies': 0.875, 'rewards/margins': 0.08785267174243927, 'policy_logps/rejected': -421.3249206542969, 'policy_logps/chosen': -528.2332153320312, 'referece_logps/rejected': -420.67572021484375, 'referece_logps/chosen': -528.4625854492188, 'logits/rejected': -1.0830527544021606, 'logits/chosen': -0.9768812656402588, 'epoch': 0.09}


  2%|▏         | 253/16104 [1:09:26<74:35:30, 16.94s/it]
{'loss': 0.6889, 'learning_rate': 1.0454545454545454e-06, 'rewards/chosen': -0.02188110165297985, 'rewards/rejected': -0.018611624836921692, 'rewards/accuracies': 0.5, 'rewards/margins': -0.0032694812398403883, 'policy_logps/rejected': -273.9632263183594, 'policy_logps/chosen': -369.82708740234375, 'referece_logps/rejected': -273.7771301269531, 'referece_logps/chosen': -369.6082458496094, 'logits/rejected': 0.34934481978416443, 'logits/chosen': 0.2541758418083191, 'epoch': 0.09}

  2%|▏         | 254/16104 [1:09:42<73:46:16, 16.76s/it]

  2%|▏         | 255/16104 [1:09:58<72:44:18, 16.52s/it]


  2%|▏         | 257/16104 [1:10:30<70:32:06, 16.02s/it]
{'loss': 0.6808, 'learning_rate': 1.0619834710743801e-06, 'rewards/chosen': 0.01022262591868639, 'rewards/rejected': -0.013136672787368298, 'rewards/accuracies': 0.375, 'rewards/margins': 0.02335929684340954, 'policy_logps/rejected': -297.2660217285156, 'policy_logps/chosen': -343.7178649902344, 'referece_logps/rejected': -297.1346435546875, 'referece_logps/chosen': -343.8200988769531, 'logits/rejected': 0.36980319023132324, 'logits/chosen': 0.37473276257514954, 'epoch': 0.1}
[2024-04-07 14:17:34,898] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 258/16104 [1:10:54<80:17:03, 18.24s/it]
[2024-04-07 14:17:55,191] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  2%|▏         | 260/16104 [1:11:33<82:59:42, 18.86s/it]

  2%|▏         | 261/16104 [1:11:47<76:19:26, 17.34s/it]
{'loss': 0.6829, 'learning_rate': 1.0785123966942149e-06, 'rewards/chosen': -0.04544010013341904, 'rewards/rejected': -0.1231159120798111, 'rewards/accuracies': 0.625, 'rewards/margins': 0.07767581939697266, 'policy_logps/rejected': -601.66455078125, 'policy_logps/chosen': -449.07159423828125, 'referece_logps/rejected': -600.4334106445312, 'referece_logps/chosen': -448.6171875, 'logits/rejected': -0.48026585578918457, 'logits/chosen': -0.45499032735824585, 'epoch': 0.1}

  2%|▏         | 262/16104 [1:12:04<76:18:36, 17.34s/it]


  2%|▏         | 264/16104 [1:12:37<74:42:13, 16.98s/it]

  2%|▏         | 265/16104 [1:12:59<80:38:38, 18.33s/it]
{'loss': 0.672, 'learning_rate': 1.0950413223140496e-06, 'rewards/chosen': -0.05260830000042915, 'rewards/rejected': -0.13349077105522156, 'rewards/accuracies': 0.5, 'rewards/margins': 0.08088245987892151, 'policy_logps/rejected': -435.4179992675781, 'policy_logps/chosen': -442.31158447265625, 'referece_logps/rejected': -434.08306884765625, 'referece_logps/chosen': -441.7855529785156, 'logits/rejected': -0.9162977337837219, 'logits/chosen': -0.8556364178657532, 'epoch': 0.1}


  2%|▏         | 267/16104 [1:13:27<71:17:32, 16.21s/it]

  2%|▏         | 268/16104 [1:13:45<73:46:08, 16.77s/it]

  2%|▏         | 269/16104 [1:13:57<67:51:31, 15.43s/it]

  2%|▏         | 270/16104 [1:14:08<61:35:55, 14.01s/it]

  2%|▏         | 271/16104 [1:14:20<58:27:16, 13.29s/it]
{'loss': 0.6848, 'learning_rate': 1.1198347107438016e-06, 'rewards/chosen': -0.01674346998333931, 'rewards/rejected': 0.01831207238137722, 'rewards/accuracies': 0.5, 'rewards/margins': -0.03505554422736168, 'policy_logps/rejected': -457.23394775390625, 'policy_logps/chosen': -568.758056640625, 'referece_logps/rejected': -457.4170837402344, 'referece_logps/chosen': -568.5906372070312, 'logits/rejected': -0.6644887328147888, 'logits/chosen': -0.7328668832778931, 'epoch': 0.1}


  2%|▏         | 273/16104 [1:14:50<64:31:36, 14.67s/it]
{'loss': 0.689, 'learning_rate': 1.128099173553719e-06, 'rewards/chosen': -0.02003498002886772, 'rewards/rejected': -0.061175636947155, 'rewards/accuracies': 0.625, 'rewards/margins': 0.04114065319299698, 'policy_logps/rejected': -300.2679443359375, 'policy_logps/chosen': -305.7012634277344, 'referece_logps/rejected': -299.65625, 'referece_logps/chosen': -305.50091552734375, 'logits/rejected': -0.3714001476764679, 'logits/chosen': -0.33299535512924194, 'epoch': 0.1}


  2%|▏         | 275/16104 [1:15:17<60:48:35, 13.83s/it]

  2%|▏         | 276/16104 [1:15:37<68:49:37, 15.65s/it]
{'loss': 0.6824, 'learning_rate': 1.140495867768595e-06, 'rewards/chosen': 0.03433369845151901, 'rewards/rejected': -0.009063530713319778, 'rewards/accuracies': 0.625, 'rewards/margins': 0.04339723661541939, 'policy_logps/rejected': -364.9564514160156, 'policy_logps/chosen': -351.3528137207031, 'referece_logps/rejected': -364.86578369140625, 'referece_logps/chosen': -351.6961364746094, 'logits/rejected': -0.607917070388794, 'logits/chosen': -0.6691784858703613, 'epoch': 0.1}


  2%|▏         | 278/16104 [1:16:12<72:37:22, 16.52s/it]

  2%|▏         | 279/16104 [1:16:30<75:10:15, 17.10s/it]

  2%|▏         | 280/16104 [1:16:51<80:43:29, 18.37s/it]

  2%|▏         | 281/16104 [1:17:12<83:05:13, 18.90s/it]

  2%|▏         | 282/16104 [1:17:24<73:57:39, 16.83s/it]

  2%|▏         | 283/16104 [1:17:36<68:16:33, 15.54s/it]

  2%|▏         | 284/16104 [1:17:50<66:13:21, 15.07s/it]

  2%|▏         | 285/16104 [1:18:13<76:50:29, 17.49s/it]

  2%|▏         | 286/16104 [1:18:32<78:13:19, 17.80s/it]

  2%|▏         | 287/16104 [1:18:48<75:52:36, 17.27s/it]

  2%|▏         | 288/16104 [1:19:02<72:28:44, 16.50s/it]

  2%|▏         | 289/16104 [1:19:13<65:15:30, 14.85s/it]

  2%|▏         | 290/16104 [1:19:31<69:21:44, 15.79s/it]

  2%|▏         | 291/16104 [1:19:42<62:46:14, 14.29s/it]

  2%|▏         | 292/16104 [1:19:54<59:27:26, 13.54s/it]

  2%|▏         | 293/16104 [1:20:05<56:38:33, 12.90s/it]

  2%|▏         | 294/16104 [1:20:18<56:46:22, 12.93s/it]

  2%|▏         | 295/16104 [1:20:37<64:43:57, 14.74s/it]

  2%|▏         | 296/16104 [1:20:55<69:06:49, 15.74s/it]
{'loss': 0.6897, 'learning_rate': 1.2231404958677686e-06, 'rewards/chosen': -0.004847717471420765, 'rewards/rejected': -0.08731593936681747, 'rewards/accuracies': 0.75, 'rewards/margins': 0.08246822655200958, 'policy_logps/rejected': -353.71234130859375, 'policy_logps/chosen': -383.6629333496094, 'referece_logps/rejected': -352.83917236328125, 'referece_logps/chosen': -383.6144714355469, 'logits/rejected': -0.4847496747970581, 'logits/chosen': -0.3101663291454315, 'epoch': 0.11}


  2%|▏         | 298/16104 [1:21:32<74:50:11, 17.04s/it]

  2%|▏         | 299/16104 [1:21:44<68:35:29, 15.62s/it]

  2%|▏         | 300/16104 [1:22:06<76:37:42, 17.46s/it]
[2024-04-07 14:28:46,948] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 301/16104 [1:22:26<80:31:25, 18.34s/it]
[2024-04-07 14:29:07,365] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 302/16104 [1:22:44<79:31:03, 18.12s/it]

  2%|▏         | 303/16104 [1:22:55<69:49:09, 15.91s/it]

  2%|▏         | 304/16104 [1:23:09<67:53:11, 15.47s/it]

  2%|▏         | 305/16104 [1:23:31<76:05:39, 17.34s/it]

  2%|▏         | 306/16104 [1:23:47<74:00:39, 16.87s/it]

  2%|▏         | 307/16104 [1:24:07<78:29:40, 17.89s/it]

  2%|▏         | 308/16104 [1:24:25<78:44:50, 17.95s/it]

  2%|▏         | 309/16104 [1:24:42<78:03:02, 17.79s/it]

  2%|▏         | 310/16104 [1:24:58<75:13:34, 17.15s/it]

  2%|▏         | 311/16104 [1:25:15<74:50:58, 17.06s/it]

  2%|▏         | 312/16104 [1:25:33<76:21:15, 17.41s/it]

  2%|▏         | 313/16104 [1:25:47<71:59:00, 16.41s/it]

  2%|▏         | 314/16104 [1:26:09<79:00:27, 18.01s/it]

  2%|▏         | 315/16104 [1:26:25<76:39:37, 17.48s/it]

  2%|▏         | 316/16104 [1:26:46<80:50:59, 18.44s/it]
[2024-04-07 14:33:26,851] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  2%|▏         | 317/16104 [1:27:03<79:23:40, 18.10s/it]

  2%|▏         | 318/16104 [1:27:19<76:43:23, 17.50s/it]

  2%|▏         | 319/16104 [1:27:42<83:56:39, 19.14s/it]
{'loss': 0.649, 'learning_rate': 1.318181818181818e-06, 'rewards/chosen': 0.03059682995080948, 'rewards/rejected': -0.06051216647028923, 'rewards/accuracies': 0.75, 'rewards/margins': 0.09110899269580841, 'policy_logps/rejected': -341.89434814453125, 'policy_logps/chosen': -304.2259521484375, 'referece_logps/rejected': -341.2892150878906, 'referece_logps/chosen': -304.53192138671875, 'logits/rejected': -0.07483565807342529, 'logits/chosen': -0.04152718558907509, 'epoch': 0.12}


  2%|▏         | 321/16104 [1:28:16<77:02:48, 17.57s/it]

  2%|▏         | 322/16104 [1:28:35<78:25:23, 17.89s/it]

  2%|▏         | 323/16104 [1:28:57<84:02:04, 19.17s/it]

  2%|▏         | 324/16104 [1:29:18<85:43:07, 19.56s/it]

  2%|▏         | 325/16104 [1:29:31<77:43:31, 17.73s/it]

  2%|▏         | 326/16104 [1:29:52<81:51:25, 18.68s/it]

  2%|▏         | 327/16104 [1:30:07<76:40:18, 17.50s/it]

  2%|▏         | 328/16104 [1:30:18<68:54:57, 15.73s/it]

  2%|▏         | 329/16104 [1:30:38<73:24:49, 16.75s/it]

  2%|▏         | 330/16104 [1:30:56<75:03:53, 17.13s/it]

  2%|▏         | 331/16104 [1:31:15<77:34:54, 17.71s/it]

  2%|▏         | 332/16104 [1:31:30<74:44:27, 17.06s/it]

  2%|▏         | 333/16104 [1:31:46<72:51:14, 16.63s/it]

  2%|▏         | 334/16104 [1:32:05<75:50:10, 17.31s/it]

  2%|▏         | 335/16104 [1:32:18<71:11:07, 16.25s/it]

  2%|▏         | 336/16104 [1:32:40<77:31:40, 17.70s/it]

  2%|▏         | 337/16104 [1:32:51<68:47:44, 15.71s/it]

  2%|▏         | 338/16104 [1:33:05<66:45:47, 15.24s/it]

  2%|▏         | 339/16104 [1:33:27<75:45:46, 17.30s/it]
[2024-04-07 14:40:07,939] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6685, 'learning_rate': 1.4008264462809917e-06, 'rewards/chosen': -0.021572303026914597, 'rewards/rejected': -0.09272614121437073, 'rewards/accuracies': 0.625, 'rewards/margins': 0.07115383446216583, 'policy_logps/rejected': -425.8436279296875, 'policy_logps/chosen': -473.5101013183594, 'referece_logps/rejected': -424.9163818359375, 'referece_logps/chosen': -473.2944030761719, 'logits/rejected': 0.1988455355167389, 'logits/chosen': 0.20196761190891266, 'epoch': 0.13}

  2%|▏         | 340/16104 [1:33:48<80:28:12, 18.38s/it]
[2024-04-07 14:40:48,830] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  2%|▏         | 342/16104 [1:34:29<85:07:28, 19.44s/it]

  2%|▏         | 343/16104 [1:34:48<84:51:54, 19.38s/it]

  2%|▏         | 344/16104 [1:35:09<87:50:23, 20.06s/it]

  2%|▏         | 345/16104 [1:35:21<76:56:13, 17.58s/it]

  2%|▏         | 346/16104 [1:35:35<71:22:08, 16.30s/it]

  2%|▏         | 347/16104 [1:35:55<77:07:27, 17.62s/it]

  2%|▏         | 348/16104 [1:36:17<82:09:02, 18.77s/it]

  2%|▏         | 349/16104 [1:36:29<74:16:19, 16.97s/it]

  2%|▏         | 350/16104 [1:36:41<67:33:25, 15.44s/it]

  2%|▏         | 351/16104 [1:36:54<63:39:07, 14.55s/it]

  2%|▏         | 352/16104 [1:37:17<75:12:39, 17.19s/it]

  2%|▏         | 353/16104 [1:37:37<78:16:27, 17.89s/it]

  2%|▏         | 354/16104 [1:37:58<82:40:35, 18.90s/it]
{'loss': 0.6673, 'learning_rate': 1.462809917355372e-06, 'rewards/chosen': -0.09994449466466904, 'rewards/rejected': -0.09501980990171432, 'rewards/accuracies': 0.625, 'rewards/margins': -0.004924677312374115, 'policy_logps/rejected': -295.7755432128906, 'policy_logps/chosen': -327.677001953125, 'referece_logps/rejected': -294.82537841796875, 'referece_logps/chosen': -326.6775817871094, 'logits/rejected': 0.2690735459327698, 'logits/chosen': 0.3259083032608032, 'epoch': 0.13}


  2%|▏         | 356/16104 [1:38:39<86:46:44, 19.84s/it]

  2%|▏         | 357/16104 [1:38:55<81:11:00, 18.56s/it]

  2%|▏         | 358/16104 [1:39:16<83:59:59, 19.20s/it]
{'loss': 0.6492, 'learning_rate': 1.4793388429752064e-06, 'rewards/chosen': -0.06321382522583008, 'rewards/rejected': -0.3805515468120575, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3173377513885498, 'policy_logps/rejected': -402.94000244140625, 'policy_logps/chosen': -246.27235412597656, 'referece_logps/rejected': -399.134521484375, 'referece_logps/chosen': -245.64019775390625, 'logits/rejected': -0.434948593378067, 'logits/chosen': -0.4141908884048462, 'epoch': 0.13}


  2%|▏         | 360/16104 [1:39:57<87:55:13, 20.10s/it]

  2%|▏         | 361/16104 [1:40:19<90:10:04, 20.62s/it]
{'loss': 0.6322, 'learning_rate': 1.4917355371900826e-06, 'rewards/chosen': -0.20807333290576935, 'rewards/rejected': -0.3335888385772705, 'rewards/accuracies': 0.75, 'rewards/margins': 0.12551549077033997, 'policy_logps/rejected': -345.51312255859375, 'policy_logps/chosen': -287.5310363769531, 'referece_logps/rejected': -342.1772766113281, 'referece_logps/chosen': -285.4503173828125, 'logits/rejected': -0.9423377513885498, 'logits/chosen': -0.8011264801025391, 'epoch': 0.13}


  2%|▏         | 363/16104 [1:40:53<80:00:48, 18.30s/it]

  2%|▏         | 364/16104 [1:41:08<76:01:50, 17.39s/it]
{'loss': 0.655, 'learning_rate': 1.5041322314049587e-06, 'rewards/chosen': -0.14487294852733612, 'rewards/rejected': -0.1002260148525238, 'rewards/accuracies': 0.25, 'rewards/margins': -0.04464692622423172, 'policy_logps/rejected': -308.30657958984375, 'policy_logps/chosen': -262.1756286621094, 'referece_logps/rejected': -307.3043212890625, 'referece_logps/chosen': -260.7268981933594, 'logits/rejected': -1.5091850757598877, 'logits/chosen': -1.512848138809204, 'epoch': 0.14}

  2%|▏         | 365/16104 [1:41:29<80:15:14, 18.36s/it]

  2%|▏         | 366/16104 [1:41:42<73:56:02, 16.91s/it]
[2024-04-07 14:48:43,594] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  2%|▏         | 368/16104 [1:42:20<77:15:15, 17.67s/it]

  2%|▏         | 369/16104 [1:42:32<69:58:16, 16.01s/it]

  2%|▏         | 370/16104 [1:42:49<71:46:16, 16.42s/it]
{'loss': 0.6551, 'learning_rate': 1.5289256198347107e-06, 'rewards/chosen': -0.033045388758182526, 'rewards/rejected': -0.1637582927942276, 'rewards/accuracies': 0.75, 'rewards/margins': 0.13071288168430328, 'policy_logps/rejected': -333.1249694824219, 'policy_logps/chosen': -427.0785217285156, 'referece_logps/rejected': -331.4873962402344, 'referece_logps/chosen': -426.748046875, 'logits/rejected': -1.524592399597168, 'logits/chosen': -1.5295841693878174, 'epoch': 0.14}


  2%|▏         | 372/16104 [1:43:28<78:46:06, 18.02s/it]
{'loss': 0.6823, 'learning_rate': 1.537190082644628e-06, 'rewards/chosen': -0.2008281648159027, 'rewards/rejected': -0.29222986102104187, 'rewards/accuracies': 0.5, 'rewards/margins': 0.09140168130397797, 'policy_logps/rejected': -439.3670349121094, 'policy_logps/chosen': -601.897216796875, 'referece_logps/rejected': -436.4447326660156, 'referece_logps/chosen': -599.8890380859375, 'logits/rejected': 0.222259521484375, 'logits/chosen': 0.24737252295017242, 'epoch': 0.14}

  2%|▏         | 373/16104 [1:43:40<71:57:50, 16.47s/it]


  2%|▏         | 375/16104 [1:44:11<68:37:16, 15.71s/it]

  2%|▏         | 376/16104 [1:44:28<69:47:26, 15.97s/it]

  2%|▏         | 377/16104 [1:44:42<66:47:22, 15.29s/it]

  2%|▏         | 378/16104 [1:45:00<70:20:19, 16.10s/it]
{'loss': 0.6623, 'learning_rate': 1.56198347107438e-06, 'rewards/chosen': -0.12649652361869812, 'rewards/rejected': -0.1512601226568222, 'rewards/accuracies': 0.75, 'rewards/margins': 0.02476363256573677, 'policy_logps/rejected': -271.5100402832031, 'policy_logps/chosen': -418.0774841308594, 'referece_logps/rejected': -269.9974365234375, 'referece_logps/chosen': -416.8125, 'logits/rejected': -1.4959453344345093, 'logits/chosen': -1.370739459991455, 'epoch': 0.14}


  2%|▏         | 380/16104 [1:45:28<65:53:36, 15.09s/it]

  2%|▏         | 381/16104 [1:45:46<70:20:20, 16.11s/it]

  2%|▏         | 382/16104 [1:46:04<72:26:02, 16.59s/it]

  2%|▏         | 383/16104 [1:46:24<76:54:07, 17.61s/it]

  2%|▏         | 384/16104 [1:46:36<69:59:59, 16.03s/it]

  2%|▏         | 385/16104 [1:46:52<70:04:14, 16.05s/it]

  2%|▏         | 386/16104 [1:47:12<74:39:55, 17.10s/it]

  2%|▏         | 387/16104 [1:47:24<67:31:14, 15.47s/it]

  2%|▏         | 388/16104 [1:47:36<64:06:54, 14.69s/it]

  2%|▏         | 389/16104 [1:47:54<68:13:25, 15.63s/it]
{'loss': 0.6345, 'learning_rate': 1.6074380165289256e-06, 'rewards/chosen': -0.09133587777614594, 'rewards/rejected': -0.30470192432403564, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2133660465478897, 'policy_logps/rejected': -293.0018310546875, 'policy_logps/chosen': -322.3803405761719, 'referece_logps/rejected': -289.9548034667969, 'referece_logps/chosen': -321.46697998046875, 'logits/rejected': 0.06328041851520538, 'logits/chosen': 0.08937236666679382, 'epoch': 0.14}


  2%|▏         | 391/16104 [1:48:34<78:04:36, 17.89s/it]

  2%|▏         | 392/16104 [1:48:54<80:42:29, 18.49s/it]

  2%|▏         | 393/16104 [1:49:12<80:14:05, 18.38s/it]
{'loss': 0.6487, 'learning_rate': 1.6239669421487603e-06, 'rewards/chosen': 0.002013778779655695, 'rewards/rejected': -0.057909391820430756, 'rewards/accuracies': 0.625, 'rewards/margins': 0.05992317199707031, 'policy_logps/rejected': -515.8243408203125, 'policy_logps/chosen': -500.9413757324219, 'referece_logps/rejected': -515.2452392578125, 'referece_logps/chosen': -500.9615173339844, 'logits/rejected': -0.09534904360771179, 'logits/chosen': -0.02195550501346588, 'epoch': 0.15}

  2%|▏         | 394/16104 [1:49:31<81:12:41, 18.61s/it]

  2%|▏         | 395/16104 [1:49:51<82:48:02, 18.98s/it]


  2%|▏         | 397/16104 [1:50:27<78:21:52, 17.96s/it]
{'loss': 0.6739, 'learning_rate': 1.6404958677685949e-06, 'rewards/chosen': -0.09887171536684036, 'rewards/rejected': -0.28556156158447266, 'rewards/accuracies': 0.75, 'rewards/margins': 0.1866898536682129, 'policy_logps/rejected': -441.6321716308594, 'policy_logps/chosen': -358.4125671386719, 'referece_logps/rejected': -438.776611328125, 'referece_logps/chosen': -357.423828125, 'logits/rejected': -0.40662673115730286, 'logits/chosen': -0.41829413175582886, 'epoch': 0.15}


  2%|▏         | 399/16104 [1:51:02<77:07:19, 17.68s/it]
{'loss': 0.6749, 'learning_rate': 1.6487603305785124e-06, 'rewards/chosen': -0.1106746643781662, 'rewards/rejected': -0.1475580334663391, 'rewards/accuracies': 0.625, 'rewards/margins': 0.03688335791230202, 'policy_logps/rejected': -398.7373352050781, 'policy_logps/chosen': -303.3221130371094, 'referece_logps/rejected': -397.26177978515625, 'referece_logps/chosen': -302.2153625488281, 'logits/rejected': -0.7051728367805481, 'logits/chosen': -0.6346604824066162, 'epoch': 0.15}


  2%|▏         | 401/16104 [1:51:28<66:58:46, 15.36s/it]
{'loss': 0.6502, 'learning_rate': 1.6570247933884296e-06, 'rewards/chosen': -0.20276814699172974, 'rewards/rejected': -0.25520724058151245, 'rewards/accuracies': 0.75, 'rewards/margins': 0.052439119666814804, 'policy_logps/rejected': -342.02557373046875, 'policy_logps/chosen': -401.376953125, 'referece_logps/rejected': -339.4734802246094, 'referece_logps/chosen': -399.3492736816406, 'logits/rejected': -0.776800274848938, 'logits/chosen': -0.8066094517707825, 'epoch': 0.15}


  3%|▎         | 403/16104 [1:51:55<61:37:58, 14.13s/it]
{'loss': 0.6661, 'learning_rate': 1.665289256198347e-06, 'rewards/chosen': -0.11484576016664505, 'rewards/rejected': -0.12732429802417755, 'rewards/accuracies': 0.375, 'rewards/margins': 0.012478546239435673, 'policy_logps/rejected': -556.9009399414062, 'policy_logps/chosen': -330.6817321777344, 'referece_logps/rejected': -555.627685546875, 'referece_logps/chosen': -329.53326416015625, 'logits/rejected': -1.1549129486083984, 'logits/chosen': -1.0216233730316162, 'epoch': 0.15}

  3%|▎         | 404/16104 [1:52:05<57:09:10, 13.11s/it]


  3%|▎         | 406/16104 [1:52:38<65:46:02, 15.08s/it]
{'loss': 0.6528, 'learning_rate': 1.677685950413223e-06, 'rewards/chosen': -0.04860077053308487, 'rewards/rejected': -0.11649561673402786, 'rewards/accuracies': 0.875, 'rewards/margins': 0.0678948387503624, 'policy_logps/rejected': -536.3994750976562, 'policy_logps/chosen': -400.379150390625, 'referece_logps/rejected': -535.2344970703125, 'referece_logps/chosen': -399.89312744140625, 'logits/rejected': -0.5679470896720886, 'logits/chosen': -0.5022835731506348, 'epoch': 0.15}


  3%|▎         | 408/16104 [1:53:12<68:01:04, 15.60s/it]

  3%|▎         | 409/16104 [1:53:36<78:49:38, 18.08s/it]
{'loss': 0.6675, 'learning_rate': 1.6900826446280991e-06, 'rewards/chosen': -0.03280830755829811, 'rewards/rejected': -0.2160392701625824, 'rewards/accuracies': 0.75, 'rewards/margins': 0.18323098123073578, 'policy_logps/rejected': -307.03021240234375, 'policy_logps/chosen': -281.2884521484375, 'referece_logps/rejected': -304.86981201171875, 'referece_logps/chosen': -280.96038818359375, 'logits/rejected': -0.7291032671928406, 'logits/chosen': -0.7673317790031433, 'epoch': 0.15}

  3%|▎         | 410/16104 [1:53:53<78:02:47, 17.90s/it]

  3%|▎         | 411/16104 [1:54:13<80:49:03, 18.54s/it]


  3%|▎         | 413/16104 [1:54:54<85:27:36, 19.61s/it]
[2024-04-07 15:01:35,400] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  3%|▎         | 414/16104 [1:55:10<80:43:34, 18.52s/it]
[2024-04-07 15:01:51,391] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  3%|▎         | 415/16104 [1:55:26<77:25:47, 17.77s/it]
{'loss': 0.6554, 'learning_rate': 1.7148760330578512e-06, 'rewards/chosen': -0.20308572053909302, 'rewards/rejected': -0.2435046285390854, 'rewards/accuracies': 0.5, 'rewards/margins': 0.04041891172528267, 'policy_logps/rejected': -345.2617492675781, 'policy_logps/chosen': -375.7765197753906, 'referece_logps/rejected': -342.8266906738281, 'referece_logps/chosen': -373.7456359863281, 'logits/rejected': -0.987480103969574, 'logits/chosen': -1.0744190216064453, 'epoch': 0.15}

  3%|▎         | 416/16104 [1:55:44<76:40:06, 17.59s/it]


  3%|▎         | 418/16104 [1:56:18<77:55:18, 17.88s/it]

  3%|▎         | 419/16104 [1:56:35<76:14:10, 17.50s/it]
{'loss': 0.673, 'learning_rate': 1.7314049586776857e-06, 'rewards/chosen': -0.14949531853199005, 'rewards/rejected': -0.17357425391674042, 'rewards/accuracies': 0.5, 'rewards/margins': 0.024078937247395515, 'policy_logps/rejected': -307.826904296875, 'policy_logps/chosen': -337.1268005371094, 'referece_logps/rejected': -306.0911560058594, 'referece_logps/chosen': -335.6318664550781, 'logits/rejected': -0.7691470980644226, 'logits/chosen': -0.8493906259536743, 'epoch': 0.16}


  3%|▎         | 421/16104 [1:57:07<74:09:07, 17.02s/it]

  3%|▎         | 422/16104 [1:57:22<72:32:28, 16.65s/it]
{'loss': 0.6791, 'learning_rate': 1.7438016528925618e-06, 'rewards/chosen': -0.15480594336986542, 'rewards/rejected': -0.1256418228149414, 'rewards/accuracies': 0.25, 'rewards/margins': -0.029164116829633713, 'policy_logps/rejected': -387.5718078613281, 'policy_logps/chosen': -355.79852294921875, 'referece_logps/rejected': -386.31536865234375, 'referece_logps/chosen': -354.2504577636719, 'logits/rejected': -0.9160072803497314, 'logits/chosen': -0.7629162073135376, 'epoch': 0.16}


  3%|▎         | 424/16104 [1:58:01<79:06:16, 18.16s/it]

  3%|▎         | 425/16104 [1:58:13<70:55:16, 16.28s/it]
{'loss': 0.634, 'learning_rate': 1.756198347107438e-06, 'rewards/chosen': 0.004820631816983223, 'rewards/rejected': -0.2594926953315735, 'rewards/accuracies': 0.75, 'rewards/margins': 0.26431331038475037, 'policy_logps/rejected': -311.11590576171875, 'policy_logps/chosen': -326.36651611328125, 'referece_logps/rejected': -308.52099609375, 'referece_logps/chosen': -326.4147033691406, 'logits/rejected': -0.20397266745567322, 'logits/chosen': -0.23157057166099548, 'epoch': 0.16}


  3%|▎         | 427/16104 [1:58:41<67:19:58, 15.46s/it]

  3%|▎         | 428/16104 [1:58:53<62:38:37, 14.39s/it]

  3%|▎         | 429/16104 [1:59:05<60:00:35, 13.78s/it]

  3%|▎         | 430/16104 [1:59:26<69:16:19, 15.91s/it]
{'loss': 0.6548, 'learning_rate': 1.7768595041322313e-06, 'rewards/chosen': -0.19954566657543182, 'rewards/rejected': -0.3100203275680542, 'rewards/accuracies': 0.625, 'rewards/margins': 0.11047469079494476, 'policy_logps/rejected': -312.2205810546875, 'policy_logps/chosen': -552.181396484375, 'referece_logps/rejected': -309.120361328125, 'referece_logps/chosen': -550.1859130859375, 'logits/rejected': -0.6338889002799988, 'logits/chosen': -0.49918681383132935, 'epoch': 0.16}


  3%|▎         | 432/16104 [2:00:03<74:51:48, 17.20s/it]
[2024-04-07 15:06:43,719] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  3%|▎         | 433/16104 [2:00:24<80:37:12, 18.52s/it]
{'loss': 0.6907, 'learning_rate': 1.7892561983471072e-06, 'rewards/chosen': -0.15311852097511292, 'rewards/rejected': -0.16787175834178925, 'rewards/accuracies': 0.75, 'rewards/margins': 0.01475323922932148, 'policy_logps/rejected': -327.60491943359375, 'policy_logps/chosen': -464.65838623046875, 'referece_logps/rejected': -325.92620849609375, 'referece_logps/chosen': -463.127197265625, 'logits/rejected': 0.11767984926700592, 'logits/chosen': 0.1036609411239624, 'epoch': 0.16}


  3%|▎         | 435/16104 [2:00:57<76:18:35, 17.53s/it]
{'loss': 0.6306, 'learning_rate': 1.7975206611570247e-06, 'rewards/chosen': -0.16035804152488708, 'rewards/rejected': -0.3341139853000641, 'rewards/accuracies': 0.625, 'rewards/margins': 0.1737559288740158, 'policy_logps/rejected': -242.99403381347656, 'policy_logps/chosen': -307.1637878417969, 'referece_logps/rejected': -239.6528778076172, 'referece_logps/chosen': -305.5602111816406, 'logits/rejected': -1.1688162088394165, 'logits/chosen': -1.2187767028808594, 'epoch': 0.16}

  3%|▎         | 436/16104 [2:01:08<67:08:48, 15.43s/it]

  3%|▎         | 437/16104 [2:01:26<70:32:35, 16.21s/it]


  3%|▎         | 439/16104 [2:01:59<73:35:57, 16.91s/it]
{'loss': 0.6759, 'learning_rate': 1.8140495867768594e-06, 'rewards/chosen': -0.15943165123462677, 'rewards/rejected': -0.2553871273994446, 'rewards/accuracies': 0.625, 'rewards/margins': 0.09595546871423721, 'policy_logps/rejected': -266.2387390136719, 'policy_logps/chosen': -370.4920654296875, 'referece_logps/rejected': -263.6848449707031, 'referece_logps/chosen': -368.89776611328125, 'logits/rejected': -1.1184945106506348, 'logits/chosen': -1.217272400856018, 'epoch': 0.16}


  3%|▎         | 441/16104 [2:02:37<77:27:40, 17.80s/it]

  3%|▎         | 442/16104 [2:02:53<74:32:35, 17.13s/it]
{'loss': 0.6752, 'learning_rate': 1.8264462809917353e-06, 'rewards/chosen': -0.1562049835920334, 'rewards/rejected': -0.25360336899757385, 'rewards/accuracies': 0.75, 'rewards/margins': 0.09739837795495987, 'policy_logps/rejected': -322.6604919433594, 'policy_logps/chosen': -361.7056884765625, 'referece_logps/rejected': -320.1244201660156, 'referece_logps/chosen': -360.14361572265625, 'logits/rejected': -0.5852938890457153, 'logits/chosen': -0.5023800134658813, 'epoch': 0.16}

  3%|▎         | 443/16104 [2:03:12<77:27:54, 17.81s/it]

  3%|▎         | 444/16104 [2:03:30<77:46:20, 17.88s/it]


  3%|▎         | 446/16104 [2:04:07<79:28:21, 18.27s/it]
{'loss': 0.6198, 'learning_rate': 1.8429752066115703e-06, 'rewards/chosen': -0.05437718331813812, 'rewards/rejected': -0.25383883714675903, 'rewards/accuracies': 0.75, 'rewards/margins': 0.1994616538286209, 'policy_logps/rejected': -431.1039733886719, 'policy_logps/chosen': -436.22430419921875, 'referece_logps/rejected': -428.5655822753906, 'referece_logps/chosen': -435.68048095703125, 'logits/rejected': -0.3964000940322876, 'logits/chosen': -0.29280540347099304, 'epoch': 0.17}


  3%|▎         | 448/16104 [2:04:47<84:18:49, 19.39s/it]

  3%|▎         | 449/16104 [2:05:07<84:26:51, 19.42s/it]

  3%|▎         | 450/16104 [2:05:27<84:58:20, 19.54s/it]

  3%|▎         | 451/16104 [2:05:40<76:22:03, 17.56s/it]
{'loss': 0.6436, 'learning_rate': 1.8636363636363635e-06, 'rewards/chosen': -0.29430848360061646, 'rewards/rejected': -0.3248831033706665, 'rewards/accuracies': 0.625, 'rewards/margins': 0.030574608594179153, 'policy_logps/rejected': -308.7886657714844, 'policy_logps/chosen': -443.99273681640625, 'referece_logps/rejected': -305.5398254394531, 'referece_logps/chosen': -441.04962158203125, 'logits/rejected': -0.927243709564209, 'logits/chosen': -0.9699218273162842, 'epoch': 0.17}


  3%|▎         | 453/16104 [2:06:09<70:20:05, 16.18s/it]
{'loss': 0.6653, 'learning_rate': 1.871900826446281e-06, 'rewards/chosen': -0.26201096177101135, 'rewards/rejected': -0.22976571321487427, 'rewards/accuracies': 0.375, 'rewards/margins': -0.03224525600671768, 'policy_logps/rejected': -499.9704895019531, 'policy_logps/chosen': -535.05810546875, 'referece_logps/rejected': -497.6728515625, 'referece_logps/chosen': -532.43798828125, 'logits/rejected': -1.5575603246688843, 'logits/chosen': -1.3712974786758423, 'epoch': 0.17}

  3%|▎         | 454/16104 [2:06:24<68:31:07, 15.76s/it]

  3%|▎         | 455/16104 [2:06:45<74:57:17, 17.24s/it]

  3%|▎         | 456/16104 [2:06:57<68:40:29, 15.80s/it]


  3%|▎         | 458/16104 [2:07:23<63:22:04, 14.58s/it]

  3%|▎         | 459/16104 [2:07:44<71:00:33, 16.34s/it]
{'loss': 0.6328, 'learning_rate': 1.896694214876033e-06, 'rewards/chosen': -0.08918952941894531, 'rewards/rejected': -0.25107041001319885, 'rewards/accuracies': 0.5, 'rewards/margins': 0.16188089549541473, 'policy_logps/rejected': -431.787353515625, 'policy_logps/chosen': -296.11553955078125, 'referece_logps/rejected': -429.27667236328125, 'referece_logps/chosen': -295.2236633300781, 'logits/rejected': -1.307297945022583, 'logits/chosen': -1.075993537902832, 'epoch': 0.17}


  3%|▎         | 461/16104 [2:08:19<75:20:21, 17.34s/it]

  3%|▎         | 462/16104 [2:08:38<76:35:50, 17.63s/it]
{'loss': 0.6282, 'learning_rate': 1.909090909090909e-06, 'rewards/chosen': -0.31115466356277466, 'rewards/rejected': -0.5057674050331116, 'rewards/accuracies': 0.875, 'rewards/margins': 0.1946127861738205, 'policy_logps/rejected': -472.91424560546875, 'policy_logps/chosen': -429.9436340332031, 'referece_logps/rejected': -467.8565368652344, 'referece_logps/chosen': -426.83209228515625, 'logits/rejected': -0.35979706048965454, 'logits/chosen': -0.4309026598930359, 'epoch': 0.17}

  3%|▎         | 463/16104 [2:08:52<72:18:02, 16.64s/it]

  3%|▎         | 464/16104 [2:09:03<65:10:19, 15.00s/it]

  3%|▎         | 465/16104 [2:09:22<70:29:36, 16.23s/it]

  3%|▎         | 466/16104 [2:09:40<72:36:52, 16.72s/it]

  3%|▎         | 467/16104 [2:09:52<66:57:30, 15.42s/it]


  3%|▎         | 469/16104 [2:10:21<63:19:40, 14.58s/it]
{'loss': 0.681, 'learning_rate': 1.93801652892562e-06, 'rewards/chosen': -0.2107202708721161, 'rewards/rejected': -0.320944219827652, 'rewards/accuracies': 0.625, 'rewards/margins': 0.11022395640611649, 'policy_logps/rejected': -333.8081359863281, 'policy_logps/chosen': -404.77044677734375, 'referece_logps/rejected': -330.59869384765625, 'referece_logps/chosen': -402.66326904296875, 'logits/rejected': -0.6739887595176697, 'logits/chosen': -0.6522131562232971, 'epoch': 0.17}

  3%|▎         | 470/16104 [2:10:32<58:37:56, 13.50s/it]

  3%|▎         | 471/16104 [2:10:44<56:22:38, 12.98s/it]


  3%|▎         | 473/16104 [2:11:14<58:49:25, 13.55s/it]
{'loss': 0.6521, 'learning_rate': 1.9545454545454545e-06, 'rewards/chosen': -0.16296596825122833, 'rewards/rejected': -0.2975040078163147, 'rewards/accuracies': 0.625, 'rewards/margins': 0.13453803956508636, 'policy_logps/rejected': -317.62408447265625, 'policy_logps/chosen': -402.8381652832031, 'referece_logps/rejected': -314.6490478515625, 'referece_logps/chosen': -401.2084655761719, 'logits/rejected': -0.7178482413291931, 'logits/chosen': -0.7247104644775391, 'epoch': 0.18}

  3%|▎         | 474/16104 [2:11:25<55:12:33, 12.72s/it]

  3%|▎         | 475/16104 [2:11:35<52:37:16, 12.12s/it]


  3%|▎         | 477/16104 [2:12:02<55:26:51, 12.77s/it]

  3%|▎         | 478/16104 [2:12:15<56:19:21, 12.98s/it]
{'loss': 0.6559, 'learning_rate': 1.975206611570248e-06, 'rewards/chosen': -0.33879679441452026, 'rewards/rejected': -0.30186063051223755, 'rewards/accuracies': 0.25, 'rewards/margins': -0.03693617880344391, 'policy_logps/rejected': -320.372314453125, 'policy_logps/chosen': -384.7362365722656, 'referece_logps/rejected': -317.3537292480469, 'referece_logps/chosen': -381.3482360839844, 'logits/rejected': -0.9480596780776978, 'logits/chosen': -0.8552790284156799, 'epoch': 0.18}

  3%|▎         | 479/16104 [2:12:31<59:11:36, 13.64s/it]

  3%|▎         | 480/16104 [2:12:53<70:35:51, 16.27s/it]

  3%|▎         | 481/16104 [2:13:13<75:35:37, 17.42s/it]

  3%|▎         | 482/16104 [2:13:35<81:44:42, 18.84s/it]

  3%|▎         | 483/16104 [2:13:57<85:30:31, 19.71s/it]

  3%|▎         | 484/16104 [2:14:20<90:13:43, 20.80s/it]

  3%|▎         | 485/16104 [2:14:35<82:10:04, 18.94s/it]

  3%|▎         | 486/16104 [2:14:52<79:04:04, 18.23s/it]

  3%|▎         | 487/16104 [2:15:08<77:13:17, 17.80s/it]

  3%|▎         | 488/16104 [2:15:28<78:59:47, 18.21s/it]

  3%|▎         | 489/16104 [2:15:44<76:12:21, 17.57s/it]

  3%|▎         | 490/16104 [2:15:57<70:17:15, 16.21s/it]


  3%|▎         | 492/16104 [2:16:34<77:18:11, 17.83s/it]
{'loss': 0.6913, 'learning_rate': 1.999998705543171e-06, 'rewards/chosen': -0.2520536482334137, 'rewards/rejected': -0.3410188555717468, 'rewards/accuracies': 0.5, 'rewards/margins': 0.08896522969007492, 'policy_logps/rejected': -364.53045654296875, 'policy_logps/chosen': -407.70928955078125, 'referece_logps/rejected': -361.1202392578125, 'referece_logps/chosen': -405.18878173828125, 'logits/rejected': -0.8811207413673401, 'logits/chosen': -0.8511278033256531, 'epoch': 0.18}


  3%|▎         | 494/16104 [2:17:08<77:19:54, 17.83s/it]
{'loss': 0.5836, 'learning_rate': 1.9999979774114506e-06, 'rewards/chosen': -0.19020721316337585, 'rewards/rejected': -0.4065783619880676, 'rewards/accuracies': 0.625, 'rewards/margins': 0.21637116372585297, 'policy_logps/rejected': -228.04098510742188, 'policy_logps/chosen': -254.12347412109375, 'referece_logps/rejected': -223.97520446777344, 'referece_logps/chosen': -252.2213897705078, 'logits/rejected': -1.1903247833251953, 'logits/chosen': -1.0279052257537842, 'epoch': 0.18}

  3%|▎         | 495/16104 [2:17:19<68:35:35, 15.82s/it]

  3%|▎         | 496/16104 [2:17:33<65:50:37, 15.19s/it]

  3%|▎         | 497/16104 [2:17:49<66:19:55, 15.30s/it]

  3%|▎         | 498/16104 [2:18:11<75:37:49, 17.45s/it]


  3%|▎         | 500/16104 [2:18:42<71:43:22, 16.55s/it]
  3%|▎         | 500/16104 [2:18:42<71:43:22, 16.55s/it]/mnt/petrelfs/songmingyang/anaconda3/envs/vcd_origin/lib/python3.9/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
  3%|▎         | 501/16104 [2:19:08<83:59:15, 19.38s/it]

  3%|▎         | 502/16104 [2:19:20<74:26:03, 17.17s/it]

  3%|▎         | 503/16104 [2:19:36<73:14:43, 16.90s/it]

  3%|▎         | 504/16104 [2:19:50<69:23:20, 16.01s/it]
{'loss': 0.7253, 'learning_rate': 1.9999919096539837e-06, 'rewards/chosen': -0.3811637759208679, 'rewards/rejected': -0.16087712347507477, 'rewards/accuracies': 0.125, 'rewards/margins': -0.22028665244579315, 'policy_logps/rejected': -436.78179931640625, 'policy_logps/chosen': -475.0351867675781, 'referece_logps/rejected': -435.17303466796875, 'referece_logps/chosen': -471.22357177734375, 'logits/rejected': 0.10657939314842224, 'logits/chosen': -0.03932596743106842, 'epoch': 0.19}

  3%|▎         | 505/16104 [2:20:09<73:31:31, 16.97s/it]

  3%|▎         | 506/16104 [2:20:31<79:18:15, 18.30s/it]

  3%|▎         | 507/16104 [2:20:45<74:08:28, 17.11s/it]

  3%|▎         | 508/16104 [2:21:06<78:48:35, 18.19s/it]

  3%|▎         | 509/16104 [2:21:19<72:02:44, 16.63s/it]

  3%|▎         | 510/16104 [2:21:39<76:28:37, 17.66s/it]

  3%|▎         | 511/16104 [2:22:01<82:43:08, 19.10s/it]

  3%|▎         | 512/16104 [2:22:22<84:44:08, 19.56s/it]


  3%|▎         | 514/16104 [2:22:56<78:23:52, 18.10s/it]
{'loss': 0.649, 'learning_rate': 1.9999817967521444e-06, 'rewards/chosen': -0.2168203443288803, 'rewards/rejected': -0.6976698040962219, 'rewards/accuracies': 0.875, 'rewards/margins': 0.4808494746685028, 'policy_logps/rejected': -310.29205322265625, 'policy_logps/chosen': -398.0668029785156, 'referece_logps/rejected': -303.3153381347656, 'referece_logps/chosen': -395.89862060546875, 'logits/rejected': -0.43186113238334656, 'logits/chosen': -0.14029301702976227, 'epoch': 0.19}

  3%|▎         | 515/16104 [2:23:09<71:51:28, 16.59s/it]

  3%|▎         | 516/16104 [2:23:30<77:12:25, 17.83s/it]


  3%|▎         | 518/16104 [2:23:58<68:43:59, 15.88s/it]
{'loss': 0.6071, 'learning_rate': 1.9999766189595986e-06, 'rewards/chosen': -0.26820048689842224, 'rewards/rejected': -0.5952005386352539, 'rewards/accuracies': 0.75, 'rewards/margins': 0.32700005173683167, 'policy_logps/rejected': -354.9358825683594, 'policy_logps/chosen': -391.0778503417969, 'referece_logps/rejected': -348.9839172363281, 'referece_logps/chosen': -388.3958435058594, 'logits/rejected': -1.3219285011291504, 'logits/chosen': -1.2686437368392944, 'epoch': 0.19}

  3%|▎         | 519/16104 [2:24:10<63:02:26, 14.56s/it]


  3%|▎         | 521/16104 [2:24:39<63:00:38, 14.56s/it]
{'loss': 0.608, 'learning_rate': 1.9999723108812053e-06, 'rewards/chosen': -0.3281145393848419, 'rewards/rejected': -0.43854808807373047, 'rewards/accuracies': 0.75, 'rewards/margins': 0.11043356359004974, 'policy_logps/rejected': -289.9475402832031, 'policy_logps/chosen': -264.6585998535156, 'referece_logps/rejected': -285.5620422363281, 'referece_logps/chosen': -261.37744140625, 'logits/rejected': -0.7812007665634155, 'logits/chosen': -0.9148284792900085, 'epoch': 0.19}

  3%|▎         | 522/16104 [2:24:51<60:14:39, 13.92s/it]

  3%|▎         | 523/16104 [2:25:04<58:30:59, 13.52s/it]
[2024-04-07 15:32:04,808] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  3%|▎         | 524/16104 [2:25:24<66:45:11, 15.42s/it]

  3%|▎         | 525/16104 [2:25:36<62:56:58, 14.55s/it]

  3%|▎         | 526/16104 [2:25:48<59:17:12, 13.70s/it]


  3%|▎         | 528/16104 [2:26:13<56:12:22, 12.99s/it]
{'loss': 0.6978, 'learning_rate': 1.99996084292803e-06, 'rewards/chosen': -0.4643205404281616, 'rewards/rejected': -0.4531616270542145, 'rewards/accuracies': 0.5, 'rewards/margins': -0.011158930137753487, 'policy_logps/rejected': -316.7197570800781, 'policy_logps/chosen': -377.74310302734375, 'referece_logps/rejected': -312.1881103515625, 'referece_logps/chosen': -373.0998840332031, 'logits/rejected': -1.0216490030288696, 'logits/chosen': -1.0813665390014648, 'epoch': 0.2}
[2024-04-07 15:33:15,064] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  3%|▎         | 530/16104 [2:26:51<68:05:22, 15.74s/it]

  3%|▎         | 531/16104 [2:27:08<70:58:30, 16.41s/it]
{'loss': 0.6247, 'learning_rate': 1.9999553213365808e-06, 'rewards/chosen': -0.705579400062561, 'rewards/rejected': -0.8502786755561829, 'rewards/accuracies': 0.625, 'rewards/margins': 0.1446993052959442, 'policy_logps/rejected': -457.6585693359375, 'policy_logps/chosen': -488.5596923828125, 'referece_logps/rejected': -449.15582275390625, 'referece_logps/chosen': -481.50396728515625, 'logits/rejected': 0.3444558382034302, 'logits/chosen': 0.4161243140697479, 'epoch': 0.2}


  3%|▎         | 533/16104 [2:27:45<75:20:24, 17.42s/it]
{'loss': 0.6181, 'learning_rate': 1.9999514380256047e-06, 'rewards/chosen': -0.8389926552772522, 'rewards/rejected': -1.0929648876190186, 'rewards/accuracies': 0.75, 'rewards/margins': 0.25397220253944397, 'policy_logps/rejected': -367.1153564453125, 'policy_logps/chosen': -420.5708312988281, 'referece_logps/rejected': -356.18572998046875, 'referece_logps/chosen': -412.1808776855469, 'logits/rejected': -0.961993932723999, 'logits/chosen': -0.8294894099235535, 'epoch': 0.2}

  3%|▎         | 534/16104 [2:28:04<77:46:19, 17.98s/it]


  3%|▎         | 536/16104 [2:28:37<73:57:00, 17.10s/it]

  3%|▎         | 537/16104 [2:28:57<78:14:19, 18.09s/it]

  3%|▎         | 538/16104 [2:29:21<85:24:57, 19.75s/it]
[2024-04-07 15:36:01,730] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5725, 'learning_rate': 1.9999410218777596e-06, 'rewards/chosen': -0.22988396883010864, 'rewards/rejected': -0.5569031834602356, 'rewards/accuracies': 0.75, 'rewards/margins': 0.32701921463012695, 'policy_logps/rejected': -410.0971984863281, 'policy_logps/chosen': -531.689208984375, 'referece_logps/rejected': -404.5281677246094, 'referece_logps/chosen': -529.390380859375, 'logits/rejected': -0.6209247708320618, 'logits/chosen': -0.3574402332305908, 'epoch': 0.2}

  3%|▎         | 539/16104 [2:29:34<77:30:32, 17.93s/it]

  3%|▎         | 540/16104 [2:29:56<81:53:24, 18.94s/it]

  3%|▎         | 541/16104 [2:30:08<73:28:32, 17.00s/it]


  3%|▎         | 543/16104 [2:30:47<79:25:58, 18.38s/it]
{'loss': 0.6343, 'learning_rate': 1.9999295944950286e-06, 'rewards/chosen': -0.24297180771827698, 'rewards/rejected': -0.32417839765548706, 'rewards/accuracies': 0.75, 'rewards/margins': 0.08120660483837128, 'policy_logps/rejected': -293.3412780761719, 'policy_logps/chosen': -333.6949157714844, 'referece_logps/rejected': -290.0994873046875, 'referece_logps/chosen': -331.26519775390625, 'logits/rejected': -0.10223710536956787, 'logits/chosen': -0.2283892035484314, 'epoch': 0.2}

  3%|▎         | 544/16104 [2:31:08<83:18:14, 19.27s/it]

  3%|▎         | 545/16104 [2:31:24<78:42:14, 18.21s/it]


  3%|▎         | 547/16104 [2:31:47<63:35:25, 14.72s/it]
{'loss': 0.6217, 'learning_rate': 1.9999197245074567e-06, 'rewards/chosen': -0.4957166314125061, 'rewards/rejected': -0.683502197265625, 'rewards/accuracies': 0.5, 'rewards/margins': 0.18778552114963531, 'policy_logps/rejected': -403.8370361328125, 'policy_logps/chosen': -487.50347900390625, 'referece_logps/rejected': -397.0020446777344, 'referece_logps/chosen': -482.54632568359375, 'logits/rejected': -1.5674784183502197, 'logits/chosen': -1.53827965259552, 'epoch': 0.2}

  3%|▎         | 548/16104 [2:31:58<58:18:04, 13.49s/it]

  3%|▎         | 549/16104 [2:32:08<54:37:46, 12.64s/it]

  3%|▎         | 550/16104 [2:32:24<58:39:51, 13.58s/it]

  3%|▎         | 551/16104 [2:32:44<66:00:45, 15.28s/it]


  3%|▎         | 553/16104 [2:33:09<61:05:00, 14.14s/it]
{'loss': 0.6006, 'learning_rate': 1.9999037060721556e-06, 'rewards/chosen': -0.15438559651374817, 'rewards/rejected': -0.6945813894271851, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5401958227157593, 'policy_logps/rejected': -286.469482421875, 'policy_logps/chosen': -501.22686767578125, 'referece_logps/rejected': -279.523681640625, 'referece_logps/chosen': -499.68304443359375, 'logits/rejected': -0.9015277028083801, 'logits/chosen': -0.9463641047477722, 'epoch': 0.21}


  3%|▎         | 555/16104 [2:33:45<70:36:59, 16.35s/it]
{'loss': 0.6013, 'learning_rate': 1.9998980430094333e-06, 'rewards/chosen': -0.3275804817676544, 'rewards/rejected': -0.5851839780807495, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2576034665107727, 'policy_logps/rejected': -509.63525390625, 'policy_logps/chosen': -466.0126953125, 'referece_logps/rejected': -503.7834167480469, 'referece_logps/chosen': -462.73687744140625, 'logits/rejected': -1.0446993112564087, 'logits/chosen': -0.8873511552810669, 'epoch': 0.21}

  3%|▎         | 556/16104 [2:34:06<77:21:03, 17.91s/it]


  3%|▎         | 558/16104 [2:34:37<70:45:00, 16.38s/it]

  3%|▎         | 559/16104 [2:34:49<65:01:47, 15.06s/it]
{'loss': 0.7011, 'learning_rate': 1.9998862315130142e-06, 'rewards/chosen': -0.37557849287986755, 'rewards/rejected': -0.45210230350494385, 'rewards/accuracies': 0.625, 'rewards/margins': 0.0765237882733345, 'policy_logps/rejected': -333.0434265136719, 'policy_logps/chosen': -449.3309326171875, 'referece_logps/rejected': -328.5224304199219, 'referece_logps/chosen': -445.5751647949219, 'logits/rejected': 0.4704276919364929, 'logits/chosen': 0.31317847967147827, 'epoch': 0.21}

  3%|▎         | 560/16104 [2:35:07<68:09:44, 15.79s/it]

  3%|▎         | 561/16104 [2:35:20<65:22:02, 15.14s/it]

  3%|▎         | 562/16104 [2:35:37<67:19:00, 15.59s/it]

  3%|▎         | 563/16104 [2:35:48<61:49:33, 14.32s/it]

  4%|▎         | 564/16104 [2:36:08<68:44:42, 15.93s/it]


  4%|▎         | 566/16104 [2:36:51<81:38:35, 18.92s/it]
{'loss': 0.6425, 'learning_rate': 1.9998640041826736e-06, 'rewards/chosen': -0.3580610156059265, 'rewards/rejected': -0.6799920797348022, 'rewards/accuracies': 0.75, 'rewards/margins': 0.32193106412887573, 'policy_logps/rejected': -329.1421203613281, 'policy_logps/chosen': -408.8736572265625, 'referece_logps/rejected': -322.3421936035156, 'referece_logps/chosen': -405.2929992675781, 'logits/rejected': -0.7839928865432739, 'logits/chosen': -0.67979896068573, 'epoch': 0.21}

  4%|▎         | 567/16104 [2:37:04<73:22:54, 17.00s/it]

  4%|▎         | 568/16104 [2:37:16<67:12:22, 15.57s/it]

  4%|▎         | 569/16104 [2:37:29<63:27:22, 14.71s/it]

  4%|▎         | 570/16104 [2:37:41<60:16:09, 13.97s/it]

  4%|▎         | 571/16104 [2:38:03<70:24:22, 16.32s/it]

  4%|▎         | 572/16104 [2:38:18<69:12:18, 16.04s/it]

  4%|▎         | 573/16104 [2:38:33<67:47:11, 15.71s/it]

  4%|▎         | 574/16104 [2:38:53<73:50:27, 17.12s/it]

  4%|▎         | 575/16104 [2:39:09<71:42:29, 16.62s/it]

  4%|▎         | 576/16104 [2:39:21<65:23:44, 15.16s/it]

  4%|▎         | 577/16104 [2:39:39<69:44:42, 16.17s/it]

  4%|▎         | 578/16104 [2:40:00<75:48:23, 17.58s/it]

  4%|▎         | 579/16104 [2:40:20<78:19:00, 18.16s/it]

  4%|▎         | 580/16104 [2:40:38<78:51:46, 18.29s/it]

  4%|▎         | 581/16104 [2:40:53<74:30:56, 17.28s/it]

  4%|▎         | 582/16104 [2:41:12<77:01:42, 17.87s/it]

  4%|▎         | 583/16104 [2:41:33<80:02:44, 18.57s/it]

  4%|▎         | 584/16104 [2:41:55<84:55:09, 19.70s/it]

  4%|▎         | 585/16104 [2:42:09<77:42:24, 18.03s/it]

  4%|▎         | 586/16104 [2:42:29<79:37:30, 18.47s/it]


  4%|▎         | 588/16104 [2:43:04<79:17:11, 18.40s/it]
{'loss': 0.6447, 'learning_rate': 1.999781244724849e-06, 'rewards/chosen': -0.31715890765190125, 'rewards/rejected': -0.6197260022163391, 'rewards/accuracies': 0.625, 'rewards/margins': 0.30256712436676025, 'policy_logps/rejected': -334.1353454589844, 'policy_logps/chosen': -396.90155029296875, 'referece_logps/rejected': -327.9381103515625, 'referece_logps/chosen': -393.7299499511719, 'logits/rejected': 0.14949646592140198, 'logits/chosen': 0.18285396695137024, 'epoch': 0.22}

  4%|▎         | 589/16104 [2:43:22<78:11:09, 18.14s/it]

  4%|▎         | 590/16104 [2:43:36<73:49:48, 17.13s/it]


  4%|▎         | 592/16104 [2:44:15<78:33:53, 18.23s/it]

  4%|▎         | 593/16104 [2:44:27<70:40:46, 16.40s/it]

  4%|▎         | 594/16104 [2:44:47<75:57:19, 17.63s/it]

  4%|▎         | 595/16104 [2:45:04<75:06:47, 17.44s/it]

  4%|▎         | 596/16104 [2:45:20<73:04:39, 16.96s/it]

  4%|▎         | 597/16104 [2:45:44<81:37:35, 18.95s/it]
[2024-04-07 15:52:24,881] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▎         | 598/16104 [2:46:05<84:59:40, 19.73s/it]

  4%|▎         | 599/16104 [2:46:22<80:32:48, 18.70s/it]

  4%|▎         | 600/16104 [2:46:44<85:17:00, 19.80s/it]

  4%|▎         | 601/16104 [2:47:07<89:16:04, 20.73s/it]

  4%|▎         | 602/16104 [2:47:26<86:35:37, 20.11s/it]

  4%|▎         | 603/16104 [2:47:46<87:30:40, 20.32s/it]

  4%|▍         | 604/16104 [2:48:06<86:13:15, 20.03s/it]

  4%|▍         | 605/16104 [2:48:26<86:12:08, 20.02s/it]

  4%|▍         | 606/16104 [2:48:44<84:09:31, 19.55s/it]

  4%|▍         | 607/16104 [2:48:57<74:46:02, 17.37s/it]

  4%|▍         | 608/16104 [2:49:16<77:39:23, 18.04s/it]

  4%|▍         | 609/16104 [2:49:31<73:09:02, 17.00s/it]

  4%|▍         | 610/16104 [2:49:52<79:12:08, 18.40s/it]

  4%|▍         | 611/16104 [2:50:09<77:33:19, 18.02s/it]

  4%|▍         | 612/16104 [2:50:30<80:50:56, 18.79s/it]

  4%|▍         | 613/16104 [2:50:42<72:34:46, 16.87s/it]

  4%|▍         | 614/16104 [2:51:03<77:12:29, 17.94s/it]

  4%|▍         | 615/16104 [2:51:23<80:15:10, 18.65s/it]

  4%|▍         | 616/16104 [2:51:40<78:01:17, 18.14s/it]

  4%|▍         | 617/16104 [2:51:52<70:20:48, 16.35s/it]

  4%|▍         | 618/16104 [2:52:04<64:29:08, 14.99s/it]

  4%|▍         | 619/16104 [2:52:22<68:19:41, 15.89s/it]

  4%|▍         | 620/16104 [2:52:44<75:28:23, 17.55s/it]

  4%|▍         | 621/16104 [2:53:01<75:16:49, 17.50s/it]

  4%|▍         | 622/16104 [2:53:21<78:26:20, 18.24s/it]

  4%|▍         | 623/16104 [2:53:40<78:54:46, 18.35s/it]

  4%|▍         | 624/16104 [2:53:54<74:22:09, 17.30s/it]

  4%|▍         | 625/16104 [2:54:16<79:28:32, 18.48s/it]

  4%|▍         | 626/16104 [2:54:29<73:32:15, 17.10s/it]

  4%|▍         | 627/16104 [2:54:50<77:36:39, 18.05s/it]

  4%|▍         | 628/16104 [2:55:01<68:16:20, 15.88s/it]

  4%|▍         | 629/16104 [2:55:22<75:07:56, 17.48s/it]

  4%|▍         | 630/16104 [2:55:36<70:49:08, 16.48s/it]

  4%|▍         | 631/16104 [2:55:54<73:01:28, 16.99s/it]

  4%|▍         | 632/16104 [2:56:10<72:13:03, 16.80s/it]
[2024-04-07 16:02:51,519] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 633/16104 [2:56:23<66:18:19, 15.43s/it]

  4%|▍         | 634/16104 [2:56:40<69:10:57, 16.10s/it]

  4%|▍         | 635/16104 [2:56:59<72:52:26, 16.96s/it]

  4%|▍         | 636/16104 [2:57:22<80:38:53, 18.77s/it]

  4%|▍         | 637/16104 [2:57:44<83:53:55, 19.53s/it]

  4%|▍         | 638/16104 [2:58:01<80:53:36, 18.83s/it]
[2024-04-07 16:04:41,862] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 639/16104 [2:58:23<85:36:22, 19.93s/it]

  4%|▍         | 640/16104 [2:58:40<82:01:29, 19.10s/it]

  4%|▍         | 641/16104 [2:58:54<75:05:31, 17.48s/it]

  4%|▍         | 642/16104 [2:59:14<77:49:35, 18.12s/it]

  4%|▍         | 643/16104 [2:59:30<75:46:50, 17.65s/it]

  4%|▍         | 644/16104 [2:59:43<69:24:31, 16.16s/it]

  4%|▍         | 645/16104 [3:00:07<78:55:57, 18.38s/it]
[2024-04-07 16:06:47,630] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 646/16104 [3:00:24<77:47:51, 18.12s/it]

  4%|▍         | 647/16104 [3:00:48<85:44:48, 19.97s/it]
[2024-04-07 16:07:29,427] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 648/16104 [3:01:01<76:10:00, 17.74s/it]

  4%|▍         | 649/16104 [3:01:21<79:05:23, 18.42s/it]

  4%|▍         | 650/16104 [3:01:38<77:34:36, 18.07s/it]

  4%|▍         | 651/16104 [3:01:54<75:18:21, 17.54s/it]

  4%|▍         | 652/16104 [3:02:12<75:34:13, 17.61s/it]

  4%|▍         | 653/16104 [3:02:29<74:38:31, 17.39s/it]

  4%|▍         | 654/16104 [3:02:41<66:55:04, 15.59s/it]
[2024-04-07 16:09:21,580] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 655/16104 [3:02:58<69:34:38, 16.21s/it]

  4%|▍         | 656/16104 [3:03:16<72:12:35, 16.83s/it]

  4%|▍         | 657/16104 [3:03:36<75:55:26, 17.69s/it]

  4%|▍         | 658/16104 [3:04:00<83:33:34, 19.48s/it]

  4%|▍         | 659/16104 [3:04:22<87:07:10, 20.31s/it]

  4%|▍         | 660/16104 [3:04:44<89:53:02, 20.95s/it]

  4%|▍         | 661/16104 [3:04:58<80:36:02, 18.79s/it]

  4%|▍         | 662/16104 [3:05:12<73:49:54, 17.21s/it]

  4%|▍         | 663/16104 [3:05:25<68:20:13, 15.93s/it]

  4%|▍         | 664/16104 [3:05:45<73:54:35, 17.23s/it]

  4%|▍         | 665/16104 [3:06:03<75:00:27, 17.49s/it]

  4%|▍         | 666/16104 [3:06:21<76:06:17, 17.75s/it]

  4%|▍         | 667/16104 [3:06:42<79:48:40, 18.61s/it]

  4%|▍         | 668/16104 [3:06:54<71:11:30, 16.60s/it]

  4%|▍         | 669/16104 [3:07:15<76:27:28, 17.83s/it]

  4%|▍         | 670/16104 [3:07:34<78:22:12, 18.28s/it]

  4%|▍         | 671/16104 [3:07:53<79:31:21, 18.55s/it]

  4%|▍         | 672/16104 [3:08:13<80:56:58, 18.88s/it]
{'loss': 0.5894, 'learning_rate': 1.9992852212297582e-06, 'rewards/chosen': -1.0908855199813843, 'rewards/rejected': -1.4211212396621704, 'rewards/accuracies': 0.875, 'rewards/margins': 0.33023566007614136, 'policy_logps/rejected': -313.5145568847656, 'policy_logps/chosen': -311.96795654296875, 'referece_logps/rejected': -299.3033752441406, 'referece_logps/chosen': -301.05908203125, 'logits/rejected': -0.4884815812110901, 'logits/chosen': -0.3624904155731201, 'epoch': 0.25}


  4%|▍         | 674/16104 [3:08:53<84:24:36, 19.69s/it]
[2024-04-07 16:15:33,880] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 675/16104 [3:09:13<84:52:05, 19.80s/it]
[2024-04-07 16:15:53,933] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 676/16104 [3:09:34<87:08:54, 20.34s/it]

  4%|▍         | 677/16104 [3:09:53<84:50:54, 19.80s/it]
{'loss': 0.6313, 'learning_rate': 1.9992467003329533e-06, 'rewards/chosen': -0.8910727500915527, 'rewards/rejected': -1.4587972164154053, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5677245855331421, 'policy_logps/rejected': -338.8908386230469, 'policy_logps/chosen': -576.5554809570312, 'referece_logps/rejected': -324.3028564453125, 'referece_logps/chosen': -567.644775390625, 'logits/rejected': 0.30699634552001953, 'logits/chosen': 0.3585216999053955, 'epoch': 0.25}


  4%|▍         | 679/16104 [3:10:29<80:50:42, 18.87s/it]
[2024-04-07 16:17:10,323] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  4%|▍         | 680/16104 [3:10:49<81:40:28, 19.06s/it]

  4%|▍         | 681/16104 [3:11:05<78:23:58, 18.30s/it]

  4%|▍         | 682/16104 [3:11:25<79:46:40, 18.62s/it]

  4%|▍         | 683/16104 [3:11:43<78:47:00, 18.39s/it]

  4%|▍         | 684/16104 [3:12:01<78:14:21, 18.27s/it]

  4%|▍         | 685/16104 [3:12:20<79:15:32, 18.51s/it]
{'loss': 0.6346, 'learning_rate': 1.9991829650065905e-06, 'rewards/chosen': -0.7600914239883423, 'rewards/rejected': -1.1514984369277954, 'rewards/accuracies': 0.625, 'rewards/margins': 0.39140698313713074, 'policy_logps/rejected': -441.8671569824219, 'policy_logps/chosen': -413.49169921875, 'referece_logps/rejected': -430.3522033691406, 'referece_logps/chosen': -405.8907775878906, 'logits/rejected': -0.1842130869626999, 'logits/chosen': 0.10996204614639282, 'epoch': 0.26}


  4%|▍         | 687/16104 [3:12:57<80:57:26, 18.90s/it]
[2024-04-07 16:19:38,341] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.572, 'learning_rate': 1.9991666269811535e-06, 'rewards/chosen': -0.5371429920196533, 'rewards/rejected': -0.8564437031745911, 'rewards/accuracies': 0.875, 'rewards/margins': 0.3193007707595825, 'policy_logps/rejected': -454.6908874511719, 'policy_logps/chosen': -526.0050659179688, 'referece_logps/rejected': -446.12640380859375, 'referece_logps/chosen': -520.6336059570312, 'logits/rejected': -0.1801418513059616, 'logits/chosen': -0.15570053458213806, 'epoch': 0.26}


  4%|▍         | 689/16104 [3:13:38<84:15:39, 19.68s/it]

  4%|▍         | 690/16104 [3:13:53<79:12:57, 18.50s/it]

  4%|▍         | 691/16104 [3:14:09<74:49:23, 17.48s/it]

  4%|▍         | 692/16104 [3:14:26<74:44:46, 17.46s/it]

  4%|▍         | 693/16104 [3:14:48<80:05:51, 18.71s/it]
{'loss': 0.5837, 'learning_rate': 1.9991166428818033e-06, 'rewards/chosen': -0.868943452835083, 'rewards/rejected': -1.3160208463668823, 'rewards/accuracies': 0.75, 'rewards/margins': 0.44707751274108887, 'policy_logps/rejected': -497.0007019042969, 'policy_logps/chosen': -404.7852478027344, 'referece_logps/rejected': -483.8404541015625, 'referece_logps/chosen': -396.0958251953125, 'logits/rejected': 0.542728841304779, 'logits/chosen': 0.5489899516105652, 'epoch': 0.26}


  4%|▍         | 695/16104 [3:15:25<80:27:02, 18.80s/it]

  4%|▍         | 696/16104 [3:15:47<84:16:29, 19.69s/it]

  4%|▍         | 697/16104 [3:16:08<85:59:12, 20.09s/it]

  4%|▍         | 698/16104 [3:16:22<77:28:12, 18.10s/it]
{'loss': 0.5322, 'learning_rate': 1.9990738780212507e-06, 'rewards/chosen': -0.40229278802871704, 'rewards/rejected': -0.8661580085754395, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4638651907444, 'policy_logps/rejected': -315.3807678222656, 'policy_logps/chosen': -273.20428466796875, 'referece_logps/rejected': -306.71917724609375, 'referece_logps/chosen': -269.18133544921875, 'logits/rejected': -0.2707211375236511, 'logits/chosen': -0.23514069616794586, 'epoch': 0.26}
[2024-04-07 16:23:23,479] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  4%|▍         | 700/16104 [3:16:57<75:56:52, 17.75s/it]

  4%|▍         | 701/16104 [3:17:17<78:31:31, 18.35s/it]

  4%|▍         | 702/16104 [3:17:31<73:18:06, 17.13s/it]

  4%|▍         | 703/16104 [3:17:47<71:46:05, 16.78s/it]

  4%|▍         | 704/16104 [3:18:03<69:59:59, 16.36s/it]

  4%|▍         | 705/16104 [3:18:19<70:07:00, 16.39s/it]

  4%|▍         | 706/16104 [3:18:34<68:21:27, 15.98s/it]

  4%|▍         | 707/16104 [3:18:45<61:46:59, 14.45s/it]

  4%|▍         | 708/16104 [3:18:56<56:55:42, 13.31s/it]

  4%|▍         | 709/16104 [3:19:13<62:09:47, 14.54s/it]

  4%|▍         | 710/16104 [3:19:35<71:23:34, 16.70s/it]
{'loss': 0.5358, 'learning_rate': 1.9989671201799792e-06, 'rewards/chosen': -0.9246269464492798, 'rewards/rejected': -1.3241138458251953, 'rewards/accuracies': 1.0, 'rewards/margins': 0.3994869887828827, 'policy_logps/rejected': -326.8226623535156, 'policy_logps/chosen': -411.83380126953125, 'referece_logps/rejected': -313.5815124511719, 'referece_logps/chosen': -402.58746337890625, 'logits/rejected': -0.07141712307929993, 'logits/chosen': -0.03462725877761841, 'epoch': 0.26}


  4%|▍         | 712/16104 [3:20:09<74:04:30, 17.33s/it]

  4%|▍         | 713/16104 [3:20:26<73:03:25, 17.09s/it]

  4%|▍         | 714/16104 [3:20:38<67:09:30, 15.71s/it]

  4%|▍         | 715/16104 [3:20:50<62:48:24, 14.69s/it]

  4%|▍         | 716/16104 [3:21:11<70:58:22, 16.60s/it]
{'loss': 0.6134, 'learning_rate': 1.998911559080061e-06, 'rewards/chosen': -0.7188451290130615, 'rewards/rejected': -0.9630599021911621, 'rewards/accuracies': 0.5, 'rewards/margins': 0.24421483278274536, 'policy_logps/rejected': -409.2698974609375, 'policy_logps/chosen': -364.88739013671875, 'referece_logps/rejected': -399.6392822265625, 'referece_logps/chosen': -357.698974609375, 'logits/rejected': -0.22177600860595703, 'logits/chosen': -0.24131469428539276, 'epoch': 0.27}

  4%|▍         | 717/16104 [3:21:27<69:38:42, 16.29s/it]


  4%|▍         | 719/16104 [3:21:54<63:19:29, 14.82s/it]

  4%|▍         | 720/16104 [3:22:08<62:03:20, 14.52s/it]
{'loss': 0.5854, 'learning_rate': 1.9988737101866934e-06, 'rewards/chosen': -0.5619675517082214, 'rewards/rejected': -1.2420475482940674, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6800800561904907, 'policy_logps/rejected': -279.319091796875, 'policy_logps/chosen': -335.5379333496094, 'referece_logps/rejected': -266.89862060546875, 'referece_logps/chosen': -329.9182434082031, 'logits/rejected': -1.1027274131774902, 'logits/chosen': -0.9154403209686279, 'epoch': 0.27}


  4%|▍         | 722/16104 [3:22:49<74:51:05, 17.52s/it]

  4%|▍         | 723/16104 [3:23:09<78:56:10, 18.48s/it]
{'loss': 0.5919, 'learning_rate': 1.998844899249981e-06, 'rewards/chosen': -0.7108381390571594, 'rewards/rejected': -1.2541292905807495, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5432911515235901, 'policy_logps/rejected': -325.31756591796875, 'policy_logps/chosen': -295.21307373046875, 'referece_logps/rejected': -312.7762756347656, 'referece_logps/chosen': -288.10467529296875, 'logits/rejected': -0.7977723479270935, 'logits/chosen': -0.8463650941848755, 'epoch': 0.27}


  5%|▍         | 725/16104 [3:23:40<73:04:43, 17.11s/it]

  5%|▍         | 726/16104 [3:23:52<66:00:00, 15.45s/it]
{'loss': 0.5321, 'learning_rate': 1.9988157246677513e-06, 'rewards/chosen': -0.6485381126403809, 'rewards/rejected': -0.8886616230010986, 'rewards/accuracies': 0.625, 'rewards/margins': 0.24012354016304016, 'policy_logps/rejected': -242.96334838867188, 'policy_logps/chosen': -313.35321044921875, 'referece_logps/rejected': -234.07672119140625, 'referece_logps/chosen': -306.86785888671875, 'logits/rejected': -0.8985859751701355, 'logits/chosen': -1.023153305053711, 'epoch': 0.27}

  5%|▍         | 727/16104 [3:24:05<62:49:25, 14.71s/it]


  5%|▍         | 729/16104 [3:24:45<75:40:06, 17.72s/it]
{'loss': 0.6154, 'learning_rate': 1.9987861864506252e-06, 'rewards/chosen': -0.5907147526741028, 'rewards/rejected': -1.1547971963882446, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5640823841094971, 'policy_logps/rejected': -269.7119445800781, 'policy_logps/chosen': -322.6895751953125, 'referece_logps/rejected': -258.1639404296875, 'referece_logps/chosen': -316.7824401855469, 'logits/rejected': -0.28294235467910767, 'logits/chosen': -0.1318047195672989, 'epoch': 0.27}

  5%|▍         | 730/16104 [3:24:59<70:12:53, 16.44s/it]


  5%|▍         | 732/16104 [3:25:36<76:25:26, 17.90s/it]
{'loss': 0.5783, 'learning_rate': 1.9987562846093573e-06, 'rewards/chosen': -0.5051653385162354, 'rewards/rejected': -0.7280603051185608, 'rewards/accuracies': 0.875, 'rewards/margins': 0.22289496660232544, 'policy_logps/rejected': -297.8673095703125, 'policy_logps/chosen': -476.1075439453125, 'referece_logps/rejected': -290.58673095703125, 'referece_logps/chosen': -471.05596923828125, 'logits/rejected': -0.322419673204422, 'logits/chosen': -0.3975735902786255, 'epoch': 0.27}

  5%|▍         | 733/16104 [3:25:55<77:26:41, 18.14s/it]


  5%|▍         | 735/16104 [3:26:30<76:42:53, 17.97s/it]

  5%|▍         | 736/16104 [3:26:43<69:54:57, 16.38s/it]

  5%|▍         | 737/16104 [3:27:00<71:17:04, 16.70s/it]

  5%|▍         | 738/16104 [3:27:20<75:24:45, 17.67s/it]
{'loss': 0.5185, 'learning_rate': 1.9986953900980708e-06, 'rewards/chosen': -0.32421568036079407, 'rewards/rejected': -1.0768711566925049, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7526555061340332, 'policy_logps/rejected': -328.13299560546875, 'policy_logps/chosen': -366.1566162109375, 'referece_logps/rejected': -317.3642578125, 'referece_logps/chosen': -362.91448974609375, 'logits/rejected': -0.9522336721420288, 'logits/chosen': -1.0624154806137085, 'epoch': 0.27}


  5%|▍         | 740/16104 [3:27:47<66:11:49, 15.51s/it]

  5%|▍         | 741/16104 [3:28:00<62:58:58, 14.76s/it]
{'loss': 0.651, 'learning_rate': 1.9986643974502225e-06, 'rewards/chosen': -0.8425037860870361, 'rewards/rejected': -0.7810642123222351, 'rewards/accuracies': 0.625, 'rewards/margins': -0.06143958866596222, 'policy_logps/rejected': -277.904541015625, 'policy_logps/chosen': -386.3526611328125, 'referece_logps/rejected': -270.0939025878906, 'referece_logps/chosen': -377.9276123046875, 'logits/rejected': -0.5879226922988892, 'logits/chosen': -0.4847877621650696, 'epoch': 0.28}


  5%|▍         | 743/16104 [3:28:36<70:01:38, 16.41s/it]

  5%|▍         | 744/16104 [3:28:59<78:15:51, 18.34s/it]

  5%|▍         | 745/16104 [3:29:14<73:23:58, 17.20s/it]
{'loss': 0.6488, 'learning_rate': 1.9986225083531455e-06, 'rewards/chosen': -0.49671003222465515, 'rewards/rejected': -0.8971418142318726, 'rewards/accuracies': 0.75, 'rewards/margins': 0.40043187141418457, 'policy_logps/rejected': -446.88946533203125, 'policy_logps/chosen': -540.8807983398438, 'referece_logps/rejected': -437.9180908203125, 'referece_logps/chosen': -535.9136962890625, 'logits/rejected': -0.07678736746311188, 'logits/chosen': -0.03770159184932709, 'epoch': 0.28}


  5%|▍         | 747/16104 [3:29:42<67:26:59, 15.81s/it]
{'loss': 0.6441, 'learning_rate': 1.998601321426533e-06, 'rewards/chosen': -0.7006548047065735, 'rewards/rejected': -0.7094704508781433, 'rewards/accuracies': 0.375, 'rewards/margins': 0.008815594017505646, 'policy_logps/rejected': -598.85693359375, 'policy_logps/chosen': -458.3837890625, 'referece_logps/rejected': -591.76220703125, 'referece_logps/chosen': -451.37725830078125, 'logits/rejected': -0.8504862189292908, 'logits/chosen': -0.7056633830070496, 'epoch': 0.28}
[2024-04-07 16:36:44,235] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  5%|▍         | 749/16104 [3:30:18<71:22:05, 16.73s/it]

  5%|▍         | 750/16104 [3:30:30<65:01:30, 15.25s/it]

  5%|▍         | 751/16104 [3:30:41<59:10:30, 13.88s/it]
{'loss': 0.5944, 'learning_rate': 1.9985584628343026e-06, 'rewards/chosen': -0.4879215359687805, 'rewards/rejected': -0.9067739248275757, 'rewards/accuracies': 0.625, 'rewards/margins': 0.41885241866111755, 'policy_logps/rejected': -319.9305725097656, 'policy_logps/chosen': -460.42999267578125, 'referece_logps/rejected': -310.86285400390625, 'referece_logps/chosen': -455.5507507324219, 'logits/rejected': -1.2549558877944946, 'logits/chosen': -1.4232640266418457, 'epoch': 0.28}


  5%|▍         | 753/16104 [3:31:04<54:30:11, 12.78s/it]

  5%|▍         | 754/16104 [3:31:23<62:24:47, 14.64s/it]
{'loss': 0.6817, 'learning_rate': 1.9985258947571646e-06, 'rewards/chosen': -0.6043127179145813, 'rewards/rejected': -0.3230094909667969, 'rewards/accuracies': 0.375, 'rewards/margins': -0.2813032269477844, 'policy_logps/rejected': -339.81671142578125, 'policy_logps/chosen': -348.7606201171875, 'referece_logps/rejected': -336.5865783691406, 'referece_logps/chosen': -342.71746826171875, 'logits/rejected': -0.8145152926445007, 'logits/chosen': -0.6978845596313477, 'epoch': 0.28}


  5%|▍         | 756/16104 [3:31:58<68:44:30, 16.12s/it]
{'loss': 0.6602, 'learning_rate': 1.9985039807442362e-06, 'rewards/chosen': -0.3831344544887543, 'rewards/rejected': -0.5852280259132385, 'rewards/accuracies': 0.625, 'rewards/margins': 0.20209351181983948, 'policy_logps/rejected': -376.0191650390625, 'policy_logps/chosen': -393.2060852050781, 'referece_logps/rejected': -370.1669006347656, 'referece_logps/chosen': -389.374755859375, 'logits/rejected': 0.3785167932510376, 'logits/chosen': 0.33888906240463257, 'epoch': 0.28}


  5%|▍         | 758/16104 [3:32:40<80:42:39, 18.93s/it]

  5%|▍         | 759/16104 [3:33:05<87:29:05, 20.52s/it]

  5%|▍         | 760/16104 [3:33:27<89:35:53, 21.02s/it]

  5%|▍         | 761/16104 [3:33:46<87:45:18, 20.59s/it]

  5%|▍         | 762/16104 [3:34:06<86:21:38, 20.26s/it]
{'loss': 0.6288, 'learning_rate': 1.9984372693293465e-06, 'rewards/chosen': -0.2962891459465027, 'rewards/rejected': -1.1517068147659302, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8554176688194275, 'policy_logps/rejected': -466.41680908203125, 'policy_logps/chosen': -328.8548278808594, 'referece_logps/rejected': -454.8997497558594, 'referece_logps/chosen': -325.8919677734375, 'logits/rejected': -1.0731767416000366, 'logits/chosen': -0.9538095593452454, 'epoch': 0.28}


  5%|▍         | 764/16104 [3:34:37<76:46:29, 18.02s/it]

  5%|▍         | 765/16104 [3:34:57<79:29:26, 18.66s/it]

  5%|▍         | 766/16104 [3:35:12<74:42:39, 17.54s/it]

  5%|▍         | 767/16104 [3:35:28<73:11:22, 17.18s/it]

  5%|▍         | 768/16104 [3:35:47<74:22:30, 17.46s/it]

  5%|▍         | 769/16104 [3:36:01<70:48:43, 16.62s/it]

  5%|▍         | 770/16104 [3:36:24<79:16:15, 18.61s/it]
[2024-04-07 16:43:05,511] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▍         | 771/16104 [3:36:37<71:24:54, 16.77s/it]

  5%|▍         | 772/16104 [3:36:58<77:01:22, 18.09s/it]

  5%|▍         | 773/16104 [3:37:15<75:42:57, 17.78s/it]

  5%|▍         | 774/16104 [3:37:36<80:12:35, 18.84s/it]
{'loss': 0.5042, 'learning_rate': 1.99829948463387e-06, 'rewards/chosen': -0.5475759506225586, 'rewards/rejected': -1.2385625839233398, 'rewards/accuracies': 1.0, 'rewards/margins': 0.6909866333007812, 'policy_logps/rejected': -236.80738830566406, 'policy_logps/chosen': -318.2862548828125, 'referece_logps/rejected': -224.42176818847656, 'referece_logps/chosen': -312.8105163574219, 'logits/rejected': 0.1516171246767044, 'logits/chosen': 0.1696687638759613, 'epoch': 0.29}
[2024-04-07 16:44:40,870] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▍         | 775/16104 [3:38:00<85:59:24, 20.19s/it]

  5%|▍         | 776/16104 [3:38:20<85:44:19, 20.14s/it]


  5%|▍         | 778/16104 [3:38:49<72:06:18, 16.94s/it]
{'loss': 0.6494, 'learning_rate': 1.9982522641061977e-06, 'rewards/chosen': -0.498513400554657, 'rewards/rejected': -0.5832989811897278, 'rewards/accuracies': 0.625, 'rewards/margins': 0.08478554338216782, 'policy_logps/rejected': -236.57159423828125, 'policy_logps/chosen': -365.5723876953125, 'referece_logps/rejected': -230.7386016845703, 'referece_logps/chosen': -360.58721923828125, 'logits/rejected': -0.8180538415908813, 'logits/chosen': -0.8198313117027283, 'epoch': 0.29}

  5%|▍         | 779/16104 [3:39:08<74:47:11, 17.57s/it]


  5%|▍         | 781/16104 [3:39:45<77:31:05, 18.21s/it]
[2024-04-07 16:46:25,767] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▍         | 782/16104 [3:40:07<83:10:50, 19.54s/it]

  5%|▍         | 783/16104 [3:40:29<86:09:47, 20.25s/it]
[2024-04-07 16:47:10,301] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▍         | 784/16104 [3:40:45<80:19:50, 18.88s/it]

  5%|▍         | 785/16104 [3:41:05<82:13:02, 19.32s/it]
{'loss': 0.5694, 'learning_rate': 1.99816807352968e-06, 'rewards/chosen': -0.6658969521522522, 'rewards/rejected': -1.2547394037246704, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5888422727584839, 'policy_logps/rejected': -374.7620849609375, 'policy_logps/chosen': -430.90875244140625, 'referece_logps/rejected': -362.2146911621094, 'referece_logps/chosen': -424.249755859375, 'logits/rejected': 0.20429068803787231, 'logits/chosen': 0.19759118556976318, 'epoch': 0.29}

  5%|▍         | 786/16104 [3:41:24<81:28:36, 19.15s/it]

  5%|▍         | 787/16104 [3:41:44<82:40:21, 19.43s/it]

  5%|▍         | 788/16104 [3:42:00<78:08:23, 18.37s/it]

  5%|▍         | 789/16104 [3:42:22<82:52:18, 19.48s/it]

  5%|▍         | 790/16104 [3:42:40<81:27:19, 19.15s/it]


  5%|▍         | 792/16104 [3:43:16<77:57:55, 18.33s/it]

  5%|▍         | 793/16104 [3:43:37<82:24:14, 19.38s/it]
[2024-04-07 16:50:18,527] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▍         | 794/16104 [3:43:53<78:04:40, 18.36s/it]
[2024-04-07 16:50:34,515] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▍         | 795/16104 [3:44:05<69:56:30, 16.45s/it]
{'loss': 0.6248, 'learning_rate': 1.998044369217473e-06, 'rewards/chosen': -0.4251260757446289, 'rewards/rejected': -0.8224983811378479, 'rewards/accuracies': 0.75, 'rewards/margins': 0.397372305393219, 'policy_logps/rejected': -400.70086669921875, 'policy_logps/chosen': -335.7371520996094, 'referece_logps/rejected': -392.47589111328125, 'referece_logps/chosen': -331.48590087890625, 'logits/rejected': -0.8977834582328796, 'logits/chosen': -0.9230055212974548, 'epoch': 0.3}

  5%|▍         | 796/16104 [3:44:17<63:26:57, 14.92s/it]

  5%|▍         | 797/16104 [3:44:30<61:35:56, 14.49s/it]

  5%|▍         | 798/16104 [3:44:50<68:48:14, 16.18s/it]


  5%|▍         | 800/16104 [3:45:22<67:52:17, 15.97s/it]

  5%|▍         | 801/16104 [3:45:44<75:36:46, 17.79s/it]

  5%|▍         | 802/16104 [3:46:01<74:58:54, 17.64s/it]
{'loss': 0.6314, 'learning_rate': 1.9979553739950926e-06, 'rewards/chosen': -0.47806990146636963, 'rewards/rejected': -0.9940998554229736, 'rewards/accuracies': 0.75, 'rewards/margins': 0.516029953956604, 'policy_logps/rejected': -386.536865234375, 'policy_logps/chosen': -450.5072021484375, 'referece_logps/rejected': -376.59588623046875, 'referece_logps/chosen': -445.7264709472656, 'logits/rejected': 0.06461933255195618, 'logits/chosen': 0.0636407732963562, 'epoch': 0.3}

  5%|▍         | 803/16104 [3:46:19<74:43:41, 17.58s/it]

  5%|▍         | 804/16104 [3:46:35<72:34:09, 17.08s/it]

  5%|▍         | 805/16104 [3:46:54<75:46:55, 17.83s/it]
[2024-04-07 16:53:53,556] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▌         | 806/16104 [3:47:12<76:23:28, 17.98s/it]

  5%|▌         | 807/16104 [3:47:29<73:54:43, 17.39s/it]

  5%|▌         | 808/16104 [3:47:49<77:47:49, 18.31s/it]


  5%|▌         | 810/16104 [3:48:22<73:48:38, 17.37s/it]
{'loss': 0.631, 'learning_rate': 1.9978512430358297e-06, 'rewards/chosen': -0.26965007185935974, 'rewards/rejected': -0.5707547664642334, 'rewards/accuracies': 0.875, 'rewards/margins': 0.30110475420951843, 'policy_logps/rejected': -252.7510986328125, 'policy_logps/chosen': -303.7252502441406, 'referece_logps/rejected': -247.04354858398438, 'referece_logps/chosen': -301.02874755859375, 'logits/rejected': -1.0687135457992554, 'logits/chosen': -1.0931456089019775, 'epoch': 0.3}


  5%|▌         | 812/16104 [3:48:58<76:37:08, 18.04s/it]
{'loss': 0.5778, 'learning_rate': 1.9978248066367877e-06, 'rewards/chosen': -0.9723678231239319, 'rewards/rejected': -1.429120659828186, 'rewards/accuracies': 0.75, 'rewards/margins': 0.456752747297287, 'policy_logps/rejected': -386.9893493652344, 'policy_logps/chosen': -413.73516845703125, 'referece_logps/rejected': -372.6981201171875, 'referece_logps/chosen': -404.0115051269531, 'logits/rejected': -0.8389491438865662, 'logits/chosen': -0.8431254029273987, 'epoch': 0.3}

  5%|▌         | 813/16104 [3:49:15<75:13:56, 17.71s/it]


  5%|▌         | 815/16104 [3:49:50<75:32:14, 17.79s/it]
{'loss': 0.673, 'learning_rate': 1.997784849311116e-06, 'rewards/chosen': -0.4640718698501587, 'rewards/rejected': -0.7914654016494751, 'rewards/accuracies': 0.625, 'rewards/margins': 0.32739347219467163, 'policy_logps/rejected': -243.10044860839844, 'policy_logps/chosen': -270.58380126953125, 'referece_logps/rejected': -235.185791015625, 'referece_logps/chosen': -265.9430847167969, 'logits/rejected': -0.8522962927818298, 'logits/chosen': -0.7650666832923889, 'epoch': 0.3}


  5%|▌         | 817/16104 [3:50:28<78:03:30, 18.38s/it]

  5%|▌         | 818/16104 [3:50:44<74:43:56, 17.60s/it]
{'loss': 0.6307, 'learning_rate': 1.9977445287258553e-06, 'rewards/chosen': -0.522221565246582, 'rewards/rejected': -0.6603044867515564, 'rewards/accuracies': 0.625, 'rewards/margins': 0.13808289170265198, 'policy_logps/rejected': -373.0238037109375, 'policy_logps/chosen': -359.9488830566406, 'referece_logps/rejected': -366.42071533203125, 'referece_logps/chosen': -354.7266845703125, 'logits/rejected': 0.0010502636432647705, 'logits/chosen': 0.002934873104095459, 'epoch': 0.3}


  5%|▌         | 820/16104 [3:51:08<62:08:53, 14.64s/it]

  5%|▌         | 821/16104 [3:51:22<61:25:39, 14.47s/it]
{'loss': 0.5838, 'learning_rate': 1.9977038448956843e-06, 'rewards/chosen': -0.3392293155193329, 'rewards/rejected': -0.6407889127731323, 'rewards/accuracies': 0.75, 'rewards/margins': 0.30155956745147705, 'policy_logps/rejected': -237.3279266357422, 'policy_logps/chosen': -441.5881042480469, 'referece_logps/rejected': -230.92001342773438, 'referece_logps/chosen': -438.19580078125, 'logits/rejected': -0.05858144909143448, 'logits/chosen': 0.055162638425827026, 'epoch': 0.31}


  5%|▌         | 823/16104 [3:51:58<71:09:29, 16.76s/it]

  5%|▌         | 824/16104 [3:52:10<65:25:02, 15.41s/it]

  5%|▌         | 825/16104 [3:52:26<66:27:40, 15.66s/it]

  5%|▌         | 826/16104 [3:52:38<61:01:03, 14.38s/it]

  5%|▌         | 827/16104 [3:52:50<57:52:35, 13.64s/it]

  5%|▌         | 828/16104 [3:53:00<54:06:59, 12.75s/it]
{'loss': 0.5829, 'learning_rate': 1.997607503422973e-06, 'rewards/chosen': -0.4791003167629242, 'rewards/rejected': -0.773864209651947, 'rewards/accuracies': 0.75, 'rewards/margins': 0.29476386308670044, 'policy_logps/rejected': -317.9544372558594, 'policy_logps/chosen': -351.4755859375, 'referece_logps/rejected': -310.2158203125, 'referece_logps/chosen': -346.6845703125, 'logits/rejected': -0.5465564131736755, 'logits/chosen': -0.5043106079101562, 'epoch': 0.31}

  5%|▌         | 829/16104 [3:53:19<60:57:05, 14.36s/it]


  5%|▌         | 831/16104 [3:53:44<57:12:52, 13.49s/it]
{'loss': 0.5861, 'learning_rate': 1.9975656088841503e-06, 'rewards/chosen': -0.6237105131149292, 'rewards/rejected': -0.910946249961853, 'rewards/accuracies': 0.625, 'rewards/margins': 0.28723573684692383, 'policy_logps/rejected': -357.6209411621094, 'policy_logps/chosen': -263.0458984375, 'referece_logps/rejected': -348.5115051269531, 'referece_logps/chosen': -256.80877685546875, 'logits/rejected': -0.7171804904937744, 'logits/chosen': -0.7009491920471191, 'epoch': 0.31}


  5%|▌         | 833/16104 [3:54:12<58:45:45, 13.85s/it]

  5%|▌         | 834/16104 [3:54:28<61:28:45, 14.49s/it]
{'loss': 0.6181, 'learning_rate': 1.997523351165557e-06, 'rewards/chosen': -0.5975925326347351, 'rewards/rejected': -0.8785688281059265, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2809763252735138, 'policy_logps/rejected': -474.0528564453125, 'policy_logps/chosen': -460.1324462890625, 'referece_logps/rejected': -465.2671813964844, 'referece_logps/chosen': -454.15655517578125, 'logits/rejected': -0.7058106660842896, 'logits/chosen': -0.8781276941299438, 'epoch': 0.31}


  5%|▌         | 836/16104 [3:55:02<64:55:44, 15.31s/it]
{'loss': 0.6406, 'learning_rate': 1.9974949775942133e-06, 'rewards/chosen': -0.48284128308296204, 'rewards/rejected': -0.6960367560386658, 'rewards/accuracies': 0.625, 'rewards/margins': 0.21319541335105896, 'policy_logps/rejected': -308.62689208984375, 'policy_logps/chosen': -334.18988037109375, 'referece_logps/rejected': -301.66650390625, 'referece_logps/chosen': -329.3614196777344, 'logits/rejected': 0.11090478301048279, 'logits/chosen': -0.07283981144428253, 'epoch': 0.31}

  5%|▌         | 837/16104 [3:55:15<62:02:18, 14.63s/it]

  5%|▌         | 838/16104 [3:55:35<69:25:56, 16.37s/it]

  5%|▌         | 839/16104 [3:55:55<74:04:51, 17.47s/it]


  5%|▌         | 841/16104 [3:56:22<64:00:04, 15.10s/it]

  5%|▌         | 842/16104 [3:56:35<60:43:02, 14.32s/it]
{'loss': 0.5683, 'learning_rate': 1.997408888487842e-06, 'rewards/chosen': -0.691264271736145, 'rewards/rejected': -0.8259432315826416, 'rewards/accuracies': 0.5, 'rewards/margins': 0.13467895984649658, 'policy_logps/rejected': -389.92156982421875, 'policy_logps/chosen': -357.8330078125, 'referece_logps/rejected': -381.662109375, 'referece_logps/chosen': -350.92034912109375, 'logits/rejected': -0.6218530535697937, 'logits/chosen': -0.6159021854400635, 'epoch': 0.31}


  5%|▌         | 844/16104 [3:57:01<57:14:58, 13.51s/it]
{'loss': 0.5804, 'learning_rate': 1.997379869337082e-06, 'rewards/chosen': -0.45776110887527466, 'rewards/rejected': -0.8008254170417786, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3430642783641815, 'policy_logps/rejected': -382.23193359375, 'policy_logps/chosen': -430.0085144042969, 'referece_logps/rejected': -374.2236633300781, 'referece_logps/chosen': -425.430908203125, 'logits/rejected': -0.33533141016960144, 'logits/chosen': -0.21301859617233276, 'epoch': 0.31}

  5%|▌         | 845/16104 [3:57:17<61:35:49, 14.53s/it]

  5%|▌         | 846/16104 [3:57:34<63:28:54, 14.98s/it]
[2024-04-07 17:04:32,659] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▌         | 847/16104 [3:57:52<67:26:01, 15.91s/it]


  5%|▌         | 849/16104 [3:58:24<67:48:23, 16.00s/it]
{'loss': 0.5235, 'learning_rate': 1.9973066154191046e-06, 'rewards/chosen': -0.6191306710243225, 'rewards/rejected': -1.0953443050384521, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4762137234210968, 'policy_logps/rejected': -278.5971374511719, 'policy_logps/chosen': -419.78955078125, 'referece_logps/rejected': -267.6436767578125, 'referece_logps/chosen': -413.5982666015625, 'logits/rejected': -0.7815907001495361, 'logits/chosen': -0.6945881247520447, 'epoch': 0.32}

  5%|▌         | 850/16104 [3:58:45<73:21:56, 17.31s/it]


  5%|▌         | 852/16104 [3:59:18<71:24:47, 16.86s/it]
{'loss': 0.5491, 'learning_rate': 1.9972621789495863e-06, 'rewards/chosen': -0.5945209860801697, 'rewards/rejected': -1.0079246759414673, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4134036898612976, 'policy_logps/rejected': -405.9722595214844, 'policy_logps/chosen': -374.4275817871094, 'referece_logps/rejected': -395.8929748535156, 'referece_logps/chosen': -368.4823303222656, 'logits/rejected': -0.030155260115861893, 'logits/chosen': 0.03739473223686218, 'epoch': 0.32}

  5%|▌         | 853/16104 [3:59:37<73:57:41, 17.46s/it]
[2024-04-07 17:06:38,637] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  5%|▌         | 854/16104 [3:59:58<77:55:29, 18.40s/it]

  5%|▌         | 855/16104 [4:00:16<77:19:44, 18.26s/it]

  5%|▌         | 856/16104 [4:00:32<74:57:17, 17.70s/it]


  5%|▌         | 858/16104 [4:01:08<75:34:28, 17.85s/it]

  5%|▌         | 859/16104 [4:01:19<66:21:47, 15.67s/it]

  5%|▌         | 860/16104 [4:01:31<61:52:30, 14.61s/it]

  5%|▌         | 861/16104 [4:01:45<61:04:40, 14.43s/it]
{'loss': 0.6057, 'learning_rate': 1.9971266911905856e-06, 'rewards/chosen': -0.6467449069023132, 'rewards/rejected': -0.6219630241394043, 'rewards/accuracies': 0.5, 'rewards/margins': -0.024781979620456696, 'policy_logps/rejected': -508.4697265625, 'policy_logps/chosen': -662.2182006835938, 'referece_logps/rejected': -502.2501220703125, 'referece_logps/chosen': -655.750732421875, 'logits/rejected': 0.3370994031429291, 'logits/chosen': 0.48395609855651855, 'epoch': 0.32}


  5%|▌         | 863/16104 [4:02:23<69:47:06, 16.48s/it]
{'loss': 0.5583, 'learning_rate': 1.9970961390928826e-06, 'rewards/chosen': -0.8525272011756897, 'rewards/rejected': -0.8671492338180542, 'rewards/accuracies': 0.375, 'rewards/margins': 0.014622129499912262, 'policy_logps/rejected': -347.2385559082031, 'policy_logps/chosen': -242.89175415039062, 'referece_logps/rejected': -338.5670471191406, 'referece_logps/chosen': -234.36651611328125, 'logits/rejected': -0.6636946201324463, 'logits/chosen': -0.5220241546630859, 'epoch': 0.32}


  5%|▌         | 865/16104 [4:02:54<70:09:07, 16.57s/it]
{'loss': 0.6227, 'learning_rate': 1.9970654256579084e-06, 'rewards/chosen': -0.7114250063896179, 'rewards/rejected': -0.893273651599884, 'rewards/accuracies': 0.5, 'rewards/margins': 0.1818486452102661, 'policy_logps/rejected': -238.5807342529297, 'policy_logps/chosen': -337.7401123046875, 'referece_logps/rejected': -229.64801025390625, 'referece_logps/chosen': -330.6258239746094, 'logits/rejected': -0.9317054748535156, 'logits/chosen': -0.8000344634056091, 'epoch': 0.32}


  5%|▌         | 867/16104 [4:03:28<70:57:24, 16.76s/it]

  5%|▌         | 868/16104 [4:03:39<63:18:16, 14.96s/it]
{'loss': 0.587, 'learning_rate': 1.9970190530089426e-06, 'rewards/chosen': -0.5366321206092834, 'rewards/rejected': -0.6434333324432373, 'rewards/accuracies': 0.625, 'rewards/margins': 0.10680113732814789, 'policy_logps/rejected': -377.340576171875, 'policy_logps/chosen': -457.0212097167969, 'referece_logps/rejected': -370.9062805175781, 'referece_logps/chosen': -451.65484619140625, 'logits/rejected': 0.18932338058948517, 'logits/chosen': 0.33891698718070984, 'epoch': 0.32}


  5%|▌         | 870/16104 [4:04:11<65:06:50, 15.39s/it]

  5%|▌         | 871/16104 [4:04:23<60:26:36, 14.28s/it]
{'loss': 0.5677, 'learning_rate': 1.996972317379188e-06, 'rewards/chosen': -0.8102383613586426, 'rewards/rejected': -1.4592443704605103, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6490060091018677, 'policy_logps/rejected': -318.4569091796875, 'policy_logps/chosen': -396.306884765625, 'referece_logps/rejected': -303.8644714355469, 'referece_logps/chosen': -388.20452880859375, 'logits/rejected': -0.4226762056350708, 'logits/chosen': -0.2770010232925415, 'epoch': 0.32}


  5%|▌         | 873/16104 [4:04:49<57:40:46, 13.63s/it]
{'loss': 0.5888, 'learning_rate': 1.9969409586450876e-06, 'rewards/chosen': -0.6122026443481445, 'rewards/rejected': -1.0568023920059204, 'rewards/accuracies': 0.625, 'rewards/margins': 0.44459980726242065, 'policy_logps/rejected': -293.83404541015625, 'policy_logps/chosen': -243.13803100585938, 'referece_logps/rejected': -283.2659912109375, 'referece_logps/chosen': -237.01600646972656, 'logits/rejected': -0.6214168071746826, 'logits/chosen': -0.4508991241455078, 'epoch': 0.33}


  5%|▌         | 875/16104 [4:05:29<71:21:51, 16.87s/it]
{'loss': 0.6216, 'learning_rate': 1.9969094385988256e-06, 'rewards/chosen': -0.9982115030288696, 'rewards/rejected': -1.1660566329956055, 'rewards/accuracies': 0.375, 'rewards/margins': 0.16784515976905823, 'policy_logps/rejected': -485.4582214355469, 'policy_logps/chosen': -362.400146484375, 'referece_logps/rejected': -473.79766845703125, 'referece_logps/chosen': -352.4180908203125, 'logits/rejected': 0.6947081685066223, 'logits/chosen': 0.7069047689437866, 'epoch': 0.33}


  5%|▌         | 877/16104 [4:06:03<71:40:29, 16.95s/it]
{'loss': 0.5695, 'learning_rate': 1.9968777572455027e-06, 'rewards/chosen': -0.7081291675567627, 'rewards/rejected': -1.5386840105056763, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8305548429489136, 'policy_logps/rejected': -505.40380859375, 'policy_logps/chosen': -432.9245300292969, 'referece_logps/rejected': -490.0169677734375, 'referece_logps/chosen': -425.84320068359375, 'logits/rejected': -0.6389569044113159, 'logits/chosen': -0.5032092928886414, 'epoch': 0.33}


  5%|▌         | 879/16104 [4:06:35<70:43:18, 16.72s/it]
{'loss': 0.6422, 'learning_rate': 1.9968459145902443e-06, 'rewards/chosen': -0.8408750295639038, 'rewards/rejected': -0.8388081789016724, 'rewards/accuracies': 0.5, 'rewards/margins': -0.002066798508167267, 'policy_logps/rejected': -358.08258056640625, 'policy_logps/chosen': -399.34808349609375, 'referece_logps/rejected': -349.6944580078125, 'referece_logps/chosen': -390.9393310546875, 'logits/rejected': -0.49068787693977356, 'logits/chosen': -0.44498661160469055, 'epoch': 0.33}

  5%|▌         | 880/16104 [4:06:50<68:32:37, 16.21s/it]


  5%|▌         | 882/16104 [4:07:25<70:45:55, 16.74s/it]

  5%|▌         | 883/16104 [4:07:45<74:50:09, 17.70s/it]
{'loss': 0.5393, 'learning_rate': 1.9967817453945575e-06, 'rewards/chosen': -0.8667007088661194, 'rewards/rejected': -1.5550674200057983, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6883666515350342, 'policy_logps/rejected': -365.0860900878906, 'policy_logps/chosen': -266.3641357421875, 'referece_logps/rejected': -349.535400390625, 'referece_logps/chosen': -257.6971130371094, 'logits/rejected': -1.056322693824768, 'logits/chosen': -0.9928494691848755, 'epoch': 0.33}


  5%|▌         | 885/16104 [4:08:27<82:19:00, 19.47s/it]

  6%|▌         | 886/16104 [4:08:43<77:53:52, 18.43s/it]
{'loss': 0.5249, 'learning_rate': 1.9967331951187232e-06, 'rewards/chosen': -0.9977626800537109, 'rewards/rejected': -1.6314970254898071, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6337342858314514, 'policy_logps/rejected': -370.90472412109375, 'policy_logps/chosen': -327.75091552734375, 'referece_logps/rejected': -354.5897216796875, 'referece_logps/chosen': -317.7733154296875, 'logits/rejected': -0.6071473956108093, 'logits/chosen': -0.35816141963005066, 'epoch': 0.33}

  6%|▌         | 887/16104 [4:09:01<76:46:08, 18.16s/it]
[2024-04-07 17:16:05,316] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  6%|▌         | 889/16104 [4:09:45<84:28:21, 19.99s/it]

  6%|▌         | 890/16104 [4:10:07<87:12:37, 20.64s/it]

  6%|▌         | 891/16104 [4:10:24<82:17:45, 19.47s/it]
[2024-04-07 17:17:04,634] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5277, 'learning_rate': 1.996651471608415e-06, 'rewards/chosen': -0.9745464324951172, 'rewards/rejected': -1.193312406539917, 'rewards/accuracies': 0.625, 'rewards/margins': 0.21876604855060577, 'policy_logps/rejected': -244.73777770996094, 'policy_logps/chosen': -335.93035888671875, 'referece_logps/rejected': -232.80462646484375, 'referece_logps/chosen': -326.1849365234375, 'logits/rejected': -0.20010876655578613, 'logits/chosen': -0.2729169428348541, 'epoch': 0.33}

  6%|▌         | 892/16104 [4:10:47<86:51:53, 20.56s/it]


  6%|▌         | 894/16104 [4:11:25<84:16:20, 19.95s/it]

  6%|▌         | 895/16104 [4:11:42<79:34:00, 18.83s/it]
{'loss': 0.5694, 'learning_rate': 1.9965853671022763e-06, 'rewards/chosen': -0.6771122217178345, 'rewards/rejected': -0.6539493203163147, 'rewards/accuracies': 0.5, 'rewards/margins': -0.023162826895713806, 'policy_logps/rejected': -234.69483947753906, 'policy_logps/chosen': -300.61273193359375, 'referece_logps/rejected': -228.1553497314453, 'referece_logps/chosen': -293.84161376953125, 'logits/rejected': -0.5832013487815857, 'logits/chosen': -0.5358543992042542, 'epoch': 0.33}

  6%|▌         | 896/16104 [4:11:59<77:20:09, 18.31s/it]
[2024-04-07 17:18:57,569] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 897/16104 [4:12:17<76:43:58, 18.17s/it]

  6%|▌         | 898/16104 [4:12:30<71:08:43, 16.84s/it]

  6%|▌         | 899/16104 [4:12:47<70:21:44, 16.66s/it]

  6%|▌         | 900/16104 [4:13:07<75:35:53, 17.90s/it]


  6%|▌         | 902/16104 [4:13:50<82:40:18, 19.58s/it]
{'loss': 0.6395, 'learning_rate': 1.9964681321668095e-06, 'rewards/chosen': -0.22979775071144104, 'rewards/rejected': -0.9629256129264832, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7331278324127197, 'policy_logps/rejected': -264.9502258300781, 'policy_logps/chosen': -303.0341491699219, 'referece_logps/rejected': -255.32095336914062, 'referece_logps/chosen': -300.7361755371094, 'logits/rejected': -0.13721302151679993, 'logits/chosen': -0.23113049566745758, 'epoch': 0.34}

  6%|▌         | 903/16104 [4:14:03<75:13:28, 17.82s/it]

  6%|▌         | 904/16104 [4:14:26<81:25:07, 19.28s/it]

  6%|▌         | 905/16104 [4:14:43<77:59:26, 18.47s/it]

  6%|▌         | 906/16104 [4:15:02<79:20:21, 18.79s/it]

  6%|▌         | 907/16104 [4:15:17<74:10:46, 17.57s/it]

  6%|▌         | 908/16104 [4:15:33<72:25:10, 17.16s/it]

  6%|▌         | 909/16104 [4:15:49<71:22:09, 16.91s/it]

  6%|▌         | 910/16104 [4:16:06<71:18:03, 16.89s/it]

  6%|▌         | 911/16104 [4:16:19<66:30:40, 15.76s/it]

  6%|▌         | 912/16104 [4:16:38<70:24:59, 16.69s/it]


  6%|▌         | 914/16104 [4:17:08<66:18:39, 15.72s/it]
{'loss': 0.5958, 'learning_rate': 1.9962625629069912e-06, 'rewards/chosen': -1.1229034662246704, 'rewards/rejected': -1.0276615619659424, 'rewards/accuracies': 0.375, 'rewards/margins': -0.09524194896221161, 'policy_logps/rejected': -374.808349609375, 'policy_logps/chosen': -428.4066467285156, 'referece_logps/rejected': -364.53173828125, 'referece_logps/chosen': -417.1776123046875, 'logits/rejected': -0.5637717247009277, 'logits/chosen': -0.39220163226127625, 'epoch': 0.34}

  6%|▌         | 915/16104 [4:17:29<73:09:13, 17.34s/it]

  6%|▌         | 916/16104 [4:17:43<69:01:38, 16.36s/it]

  6%|▌         | 917/16104 [4:18:00<70:18:36, 16.67s/it]
[2024-04-07 17:25:01,587] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 918/16104 [4:18:21<74:50:05, 17.74s/it]

  6%|▌         | 919/16104 [4:18:35<71:07:41, 16.86s/it]

  6%|▌         | 920/16104 [4:18:58<78:00:10, 18.49s/it]

  6%|▌         | 921/16104 [4:19:15<76:04:22, 18.04s/it]
[2024-04-07 17:26:18,135] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 922/16104 [4:19:37<81:39:49, 19.36s/it]

  6%|▌         | 923/16104 [4:19:53<77:37:01, 18.41s/it]

  6%|▌         | 924/16104 [4:20:16<82:54:07, 19.66s/it]


  6%|▌         | 926/16104 [4:20:58<85:39:10, 20.32s/it]
{'loss': 0.5156, 'learning_rate': 1.9960511903637875e-06, 'rewards/chosen': -1.2074331045150757, 'rewards/rejected': -1.4707216024398804, 'rewards/accuracies': 0.375, 'rewards/margins': 0.26328855752944946, 'policy_logps/rejected': -371.4355773925781, 'policy_logps/chosen': -286.130859375, 'referece_logps/rejected': -356.7283935546875, 'referece_logps/chosen': -274.0565490722656, 'logits/rejected': -0.9960858821868896, 'logits/chosen': -0.8045836091041565, 'epoch': 0.35}

  6%|▌         | 927/16104 [4:21:14<79:38:58, 18.89s/it]

  6%|▌         | 928/16104 [4:21:29<75:08:58, 17.83s/it]

  6%|▌         | 929/16104 [4:21:44<71:38:25, 17.00s/it]


  6%|▌         | 931/16104 [4:22:28<81:56:04, 19.44s/it]
{'loss': 0.5842, 'learning_rate': 1.9959614059877362e-06, 'rewards/chosen': -0.6993162035942078, 'rewards/rejected': -1.2032915353775024, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5039753317832947, 'policy_logps/rejected': -528.7901611328125, 'policy_logps/chosen': -435.37060546875, 'referece_logps/rejected': -516.7572631835938, 'referece_logps/chosen': -428.3774108886719, 'logits/rejected': -1.346641182899475, 'logits/chosen': -0.8888338804244995, 'epoch': 0.35}
[2024-04-07 17:29:31,722] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 932/16104 [4:22:51<85:53:07, 20.38s/it]
[2024-04-07 17:29:47,932] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 933/16104 [4:23:07<80:36:33, 19.13s/it]


  6%|▌         | 935/16104 [4:23:34<70:00:04, 16.61s/it]
{'loss': 0.5996, 'learning_rate': 1.9958888532910705e-06, 'rewards/chosen': -0.516845703125, 'rewards/rejected': -1.0749731063842773, 'rewards/accuracies': 1.0, 'rewards/margins': 0.5581275224685669, 'policy_logps/rejected': -303.9480285644531, 'policy_logps/chosen': -345.2630310058594, 'referece_logps/rejected': -293.1982727050781, 'referece_logps/chosen': -340.0946044921875, 'logits/rejected': 0.4682525396347046, 'logits/chosen': 0.3860117495059967, 'epoch': 0.35}

  6%|▌         | 936/16104 [4:23:45<63:07:16, 14.98s/it]

  6%|▌         | 937/16104 [4:24:04<67:46:38, 16.09s/it]

  6%|▌         | 938/16104 [4:24:19<65:55:25, 15.65s/it]

  6%|▌         | 939/16104 [4:24:30<60:13:58, 14.30s/it]

  6%|▌         | 940/16104 [4:24:41<55:58:22, 13.29s/it]

  6%|▌         | 941/16104 [4:25:01<65:10:03, 15.47s/it]

  6%|▌         | 942/16104 [4:25:17<65:55:06, 15.65s/it]

  6%|▌         | 943/16104 [4:25:33<65:45:29, 15.61s/it]

  6%|▌         | 944/16104 [4:25:50<67:17:54, 15.98s/it]

  6%|▌         | 945/16104 [4:26:05<66:18:21, 15.75s/it]

  6%|▌         | 946/16104 [4:26:18<62:12:35, 14.77s/it]

  6%|▌         | 947/16104 [4:26:38<68:59:51, 16.39s/it]


  6%|▌         | 949/16104 [4:27:03<60:25:39, 14.35s/it]

  6%|▌         | 950/16104 [4:27:25<70:05:11, 16.65s/it]

  6%|▌         | 951/16104 [4:27:43<71:39:42, 17.03s/it]
{'loss': 0.6362, 'learning_rate': 1.9955921973035694e-06, 'rewards/chosen': -1.4733116626739502, 'rewards/rejected': -1.9490597248077393, 'rewards/accuracies': 0.625, 'rewards/margins': 0.47574809193611145, 'policy_logps/rejected': -607.3663940429688, 'policy_logps/chosen': -650.8606567382812, 'referece_logps/rejected': -587.875732421875, 'referece_logps/chosen': -636.1275634765625, 'logits/rejected': -0.9373743534088135, 'logits/chosen': -0.8712992668151855, 'epoch': 0.35}

  6%|▌         | 952/16104 [4:27:58<69:15:10, 16.45s/it]

  6%|▌         | 953/16104 [4:28:18<73:35:37, 17.49s/it]

  6%|▌         | 954/16104 [4:28:38<77:12:22, 18.35s/it]
[2024-04-07 17:35:36,355] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 955/16104 [4:28:55<75:58:05, 18.05s/it]

  6%|▌         | 956/16104 [4:29:08<68:53:41, 16.37s/it]

  6%|▌         | 957/16104 [4:29:20<64:00:26, 15.21s/it]


  6%|▌         | 959/16104 [4:29:54<69:38:29, 16.55s/it]
[2024-04-07 17:36:35,538] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▌         | 960/16104 [4:30:05<62:12:29, 14.79s/it]

  6%|▌         | 961/16104 [4:30:26<69:59:32, 16.64s/it]

  6%|▌         | 962/16104 [4:30:44<71:33:26, 17.01s/it]

  6%|▌         | 963/16104 [4:30:58<67:33:01, 16.06s/it]

  6%|▌         | 964/16104 [4:31:14<67:32:29, 16.06s/it]

  6%|▌         | 965/16104 [4:31:29<66:50:22, 15.89s/it]

  6%|▌         | 966/16104 [4:31:40<60:41:08, 14.43s/it]

  6%|▌         | 967/16104 [4:32:02<69:33:27, 16.54s/it]

  6%|▌         | 968/16104 [4:32:20<71:09:12, 16.92s/it]

  6%|▌         | 969/16104 [4:32:36<70:52:29, 16.86s/it]

  6%|▌         | 970/16104 [4:32:59<78:04:44, 18.57s/it]

  6%|▌         | 971/16104 [4:33:20<81:11:37, 19.32s/it]

  6%|▌         | 972/16104 [4:33:41<83:47:03, 19.93s/it]

  6%|▌         | 973/16104 [4:33:56<76:52:22, 18.29s/it]

  6%|▌         | 974/16104 [4:34:10<71:07:35, 16.92s/it]

  6%|▌         | 975/16104 [4:34:25<69:35:52, 16.56s/it]

  6%|▌         | 976/16104 [4:34:38<65:10:58, 15.51s/it]

  6%|▌         | 977/16104 [4:34:49<59:00:44, 14.04s/it]

  6%|▌         | 978/16104 [4:35:00<54:43:07, 13.02s/it]

  6%|▌         | 979/16104 [4:35:10<51:46:35, 12.32s/it]

  6%|▌         | 980/16104 [4:35:22<51:08:15, 12.17s/it]

  6%|▌         | 981/16104 [4:35:33<49:18:08, 11.74s/it]

  6%|▌         | 982/16104 [4:35:50<56:07:55, 13.36s/it]

  6%|▌         | 983/16104 [4:36:03<55:01:43, 13.10s/it]

  6%|▌         | 984/16104 [4:36:18<58:33:52, 13.94s/it]

  6%|▌         | 985/16104 [4:36:35<61:54:44, 14.74s/it]

  6%|▌         | 986/16104 [4:36:47<58:53:28, 14.02s/it]

  6%|▌         | 987/16104 [4:36:58<54:37:03, 13.01s/it]

  6%|▌         | 988/16104 [4:37:22<68:06:36, 16.22s/it]

  6%|▌         | 989/16104 [4:37:37<66:48:57, 15.91s/it]

  6%|▌         | 990/16104 [4:37:53<67:06:00, 15.98s/it]

  6%|▌         | 991/16104 [4:38:06<62:43:44, 14.94s/it]

  6%|▌         | 992/16104 [4:38:16<57:21:16, 13.66s/it]

  6%|▌         | 993/16104 [4:38:38<66:59:01, 15.96s/it]

  6%|▌         | 994/16104 [4:38:52<65:00:39, 15.49s/it]

  6%|▌         | 995/16104 [4:39:12<70:22:15, 16.77s/it]

  6%|▌         | 996/16104 [4:39:32<74:46:56, 17.82s/it]

  6%|▌         | 997/16104 [4:39:54<80:14:11, 19.12s/it]

  6%|▌         | 998/16104 [4:40:08<73:26:43, 17.50s/it]

  6%|▌         | 999/16104 [4:40:22<69:40:20, 16.61s/it]

  6%|▌         | 1000/16104 [4:40:45<76:54:48, 18.33s/it]

  6%|▌         | 1001/16104 [4:41:18<95:03:52, 22.66s/it]

  6%|▌         | 1002/16104 [4:41:35<88:48:31, 21.17s/it]

  6%|▌         | 1003/16104 [4:41:53<84:12:48, 20.08s/it]

  6%|▌         | 1004/16104 [4:42:04<73:29:35, 17.52s/it]

  6%|▌         | 1005/16104 [4:42:22<73:12:28, 17.45s/it]

  6%|▌         | 1006/16104 [4:42:43<78:03:17, 18.61s/it]
[2024-04-07 17:49:23,951] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▋         | 1007/16104 [4:43:04<81:18:03, 19.39s/it]
{'loss': 0.5804, 'learning_rate': 1.99447273120314e-06, 'rewards/chosen': -0.9202919006347656, 'rewards/rejected': -1.5102944374084473, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5900025367736816, 'policy_logps/rejected': -489.5924072265625, 'policy_logps/chosen': -566.371826171875, 'referece_logps/rejected': -474.489501953125, 'referece_logps/chosen': -557.1688232421875, 'logits/rejected': -0.3709120452404022, 'logits/chosen': -0.4390917718410492, 'epoch': 0.38}

  6%|▋         | 1008/16104 [4:43:16<71:34:38, 17.07s/it]


  6%|▋         | 1010/16104 [4:43:59<81:13:37, 19.37s/it]

  6%|▋         | 1011/16104 [4:44:17<78:52:22, 18.81s/it]
[2024-04-07 17:50:57,632] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▋         | 1012/16104 [4:44:33<76:16:37, 18.19s/it]

  6%|▋         | 1013/16104 [4:44:45<68:04:27, 16.24s/it]

  6%|▋         | 1014/16104 [4:45:06<74:31:55, 17.78s/it]

  6%|▋         | 1015/16104 [4:45:27<77:51:05, 18.57s/it]

  6%|▋         | 1016/16104 [4:45:44<76:22:51, 18.22s/it]

  6%|▋         | 1017/16104 [4:45:59<72:11:47, 17.23s/it]

  6%|▋         | 1018/16104 [4:46:15<70:25:33, 16.81s/it]

  6%|▋         | 1019/16104 [4:46:36<75:55:10, 18.12s/it]

  6%|▋         | 1020/16104 [4:46:58<80:15:03, 19.15s/it]

  6%|▋         | 1021/16104 [4:47:18<82:19:02, 19.65s/it]

  6%|▋         | 1022/16104 [4:47:31<73:10:00, 17.46s/it]

  6%|▋         | 1023/16104 [4:47:50<75:50:54, 18.11s/it]

  6%|▋         | 1024/16104 [4:48:13<80:56:37, 19.32s/it]
[2024-04-07 17:54:53,683] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▋         | 1025/16104 [4:48:28<76:23:28, 18.24s/it]
[2024-04-07 17:55:09,387] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▋         | 1026/16104 [4:48:50<80:13:18, 19.15s/it]

  6%|▋         | 1027/16104 [4:49:10<82:19:32, 19.66s/it]

  6%|▋         | 1028/16104 [4:49:31<83:19:30, 19.90s/it]
[2024-04-07 17:56:11,966] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▋         | 1029/16104 [4:49:49<81:30:31, 19.46s/it]

  6%|▋         | 1030/16104 [4:50:06<77:41:27, 18.55s/it]
{'loss': 0.5561, 'learning_rate': 1.993976394922724e-06, 'rewards/chosen': -0.723229169845581, 'rewards/rejected': -1.2074536085128784, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4842243194580078, 'policy_logps/rejected': -390.5286865234375, 'policy_logps/chosen': -472.8883361816406, 'referece_logps/rejected': -378.45416259765625, 'referece_logps/chosen': -465.65606689453125, 'logits/rejected': -0.4745701551437378, 'logits/chosen': -0.5161745548248291, 'epoch': 0.38}
[2024-04-07 17:56:59,323] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  6%|▋         | 1032/16104 [4:50:38<73:43:16, 17.61s/it]

  6%|▋         | 1033/16104 [4:51:00<79:04:23, 18.89s/it]

  6%|▋         | 1034/16104 [4:51:11<68:47:07, 16.43s/it]

  6%|▋         | 1035/16104 [4:51:26<67:30:26, 16.13s/it]

  6%|▋         | 1036/16104 [4:51:42<66:50:24, 15.97s/it]
[2024-04-07 17:58:22,575] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  6%|▋         | 1037/16104 [4:51:53<61:21:30, 14.66s/it]

  6%|▋         | 1038/16104 [4:52:14<68:58:51, 16.48s/it]

  6%|▋         | 1039/16104 [4:52:33<72:16:42, 17.27s/it]

  6%|▋         | 1040/16104 [4:52:51<73:26:41, 17.55s/it]

  6%|▋         | 1041/16104 [4:53:06<70:00:14, 16.73s/it]

  6%|▋         | 1042/16104 [4:53:18<63:40:51, 15.22s/it]

  6%|▋         | 1043/16104 [4:53:34<64:31:16, 15.42s/it]

  6%|▋         | 1044/16104 [4:53:44<58:34:55, 14.00s/it]

  6%|▋         | 1045/16104 [4:53:57<57:00:32, 13.63s/it]

  6%|▋         | 1046/16104 [4:54:15<62:27:28, 14.93s/it]

  7%|▋         | 1047/16104 [4:54:36<70:07:03, 16.76s/it]
{'loss': 0.5492, 'learning_rate': 1.9935958663248603e-06, 'rewards/chosen': -1.1632044315338135, 'rewards/rejected': -1.6078431606292725, 'rewards/accuracies': 0.875, 'rewards/margins': 0.444638729095459, 'policy_logps/rejected': -421.7108459472656, 'policy_logps/chosen': -418.13970947265625, 'referece_logps/rejected': -405.6324462890625, 'referece_logps/chosen': -406.5075988769531, 'logits/rejected': 0.08215516805648804, 'logits/chosen': 0.10772116482257843, 'epoch': 0.39}

  7%|▋         | 1048/16104 [4:54:53<69:55:13, 16.72s/it]


  7%|▋         | 1050/16104 [4:55:22<65:10:32, 15.59s/it]

  7%|▋         | 1051/16104 [4:55:42<70:34:20, 16.88s/it]
[2024-04-07 18:02:23,056] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.636, 'learning_rate': 1.9935046419237316e-06, 'rewards/chosen': -1.2039278745651245, 'rewards/rejected': -1.8336832523345947, 'rewards/accuracies': 0.75, 'rewards/margins': 0.629755437374115, 'policy_logps/rejected': -413.9888610839844, 'policy_logps/chosen': -476.4466552734375, 'referece_logps/rejected': -395.6520690917969, 'referece_logps/chosen': -464.4073486328125, 'logits/rejected': 0.37157776951789856, 'logits/chosen': 0.4326900541782379, 'epoch': 0.39}


  7%|▋         | 1053/16104 [4:56:09<63:33:57, 15.20s/it]

  7%|▋         | 1054/16104 [4:56:25<64:53:30, 15.52s/it]
{'loss': 0.5913, 'learning_rate': 1.9934358016347877e-06, 'rewards/chosen': -1.1703155040740967, 'rewards/rejected': -1.4678560495376587, 'rewards/accuracies': 0.5, 'rewards/margins': 0.29754048585891724, 'policy_logps/rejected': -351.4866943359375, 'policy_logps/chosen': -317.38330078125, 'referece_logps/rejected': -336.80810546875, 'referece_logps/chosen': -305.68017578125, 'logits/rejected': -0.8854295611381531, 'logits/chosen': -0.9366380572319031, 'epoch': 0.39}


  7%|▋         | 1056/16104 [4:57:04<75:10:00, 17.98s/it]
[2024-04-07 18:03:45,447] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  7%|▋         | 1057/16104 [4:57:23<76:12:29, 18.23s/it]

  7%|▋         | 1058/16104 [4:57:36<69:14:04, 16.57s/it]

  7%|▋         | 1059/16104 [4:57:52<68:20:04, 16.35s/it]
[2024-04-07 18:04:32,790] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  7%|▋         | 1060/16104 [4:58:08<67:49:45, 16.23s/it]
{'loss': 0.6551, 'learning_rate': 1.9932970360533473e-06, 'rewards/chosen': -1.0471365451812744, 'rewards/rejected': -1.139646053314209, 'rewards/accuracies': 0.625, 'rewards/margins': 0.09250947088003159, 'policy_logps/rejected': -377.76092529296875, 'policy_logps/chosen': -473.3442687988281, 'referece_logps/rejected': -366.3644104003906, 'referece_logps/chosen': -462.8729248046875, 'logits/rejected': 0.649571418762207, 'logits/chosen': 0.659114420413971, 'epoch': 0.39}


  7%|▋         | 1062/16104 [4:58:33<60:52:20, 14.57s/it]

  7%|▋         | 1063/16104 [4:58:45<58:08:25, 13.92s/it]

  7%|▋         | 1064/16104 [4:59:04<63:53:46, 15.29s/it]

  7%|▋         | 1065/16104 [4:59:22<67:25:31, 16.14s/it]
{'loss': 0.5718, 'learning_rate': 1.99318029309277e-06, 'rewards/chosen': -0.5707165002822876, 'rewards/rejected': -0.7796930074691772, 'rewards/accuracies': 0.625, 'rewards/margins': 0.20897647738456726, 'policy_logps/rejected': -518.21923828125, 'policy_logps/chosen': -382.26513671875, 'referece_logps/rejected': -510.42230224609375, 'referece_logps/chosen': -376.5580139160156, 'logits/rejected': -0.06255125999450684, 'logits/chosen': -0.0485781729221344, 'epoch': 0.4}


  7%|▋         | 1067/16104 [4:59:50<62:35:49, 14.99s/it]

  7%|▋         | 1068/16104 [5:00:09<66:53:52, 16.02s/it]

  7%|▋         | 1069/16104 [5:00:27<69:32:22, 16.65s/it]
{'loss': 0.5607, 'learning_rate': 1.9930861755521917e-06, 'rewards/chosen': -0.9886451959609985, 'rewards/rejected': -1.4798856973648071, 'rewards/accuracies': 0.625, 'rewards/margins': 0.49124041199684143, 'policy_logps/rejected': -297.7059326171875, 'policy_logps/chosen': -325.9588317871094, 'referece_logps/rejected': -282.9070739746094, 'referece_logps/chosen': -316.0723571777344, 'logits/rejected': -0.30367615818977356, 'logits/chosen': -0.29763317108154297, 'epoch': 0.4}


  7%|▋         | 1071/16104 [5:01:07<76:26:32, 18.31s/it]

  7%|▋         | 1072/16104 [5:01:21<71:56:00, 17.23s/it]
{'loss': 0.5424, 'learning_rate': 1.9930151655862993e-06, 'rewards/chosen': -0.6709434390068054, 'rewards/rejected': -0.712904691696167, 'rewards/accuracies': 0.625, 'rewards/margins': 0.041961267590522766, 'policy_logps/rejected': -473.9245300292969, 'policy_logps/chosen': -421.034912109375, 'referece_logps/rejected': -466.7955017089844, 'referece_logps/chosen': -414.325439453125, 'logits/rejected': -0.5163158774375916, 'logits/chosen': -0.27844342589378357, 'epoch': 0.4}
[2024-04-07 18:08:24,139] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  7%|▋         | 1074/16104 [5:02:00<75:48:47, 18.16s/it]

  7%|▋         | 1075/16104 [5:02:18<75:35:42, 18.11s/it]

  7%|▋         | 1076/16104 [5:02:37<75:59:25, 18.20s/it]

  7%|▋         | 1077/16104 [5:02:57<78:09:59, 18.73s/it]

  7%|▋         | 1078/16104 [5:03:21<84:50:13, 20.33s/it]
[2024-04-07 18:10:01,657] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  7%|▋         | 1079/16104 [5:03:41<84:33:17, 20.26s/it]
[2024-04-07 18:10:21,762] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6162, 'learning_rate': 1.992848069787609e-06, 'rewards/chosen': -0.9920986294746399, 'rewards/rejected': -1.445320963859558, 'rewards/accuracies': 0.625, 'rewards/margins': 0.45322224497795105, 'policy_logps/rejected': -354.4002990722656, 'policy_logps/chosen': -412.5913391113281, 'referece_logps/rejected': -339.94708251953125, 'referece_logps/chosen': -402.67034912109375, 'logits/rejected': -0.149745911359787, 'logits/chosen': -0.1505935788154602, 'epoch': 0.4}


  7%|▋         | 1081/16104 [5:04:12<74:50:09, 17.93s/it]

  7%|▋         | 1082/16104 [5:04:30<75:01:27, 17.98s/it]

  7%|▋         | 1083/16104 [5:04:50<76:57:39, 18.44s/it]

  7%|▋         | 1084/16104 [5:05:01<67:13:08, 16.11s/it]
{'loss': 0.5925, 'learning_rate': 1.9927275107521314e-06, 'rewards/chosen': -0.6905228495597839, 'rewards/rejected': -1.177324652671814, 'rewards/accuracies': 0.75, 'rewards/margins': 0.48680180311203003, 'policy_logps/rejected': -491.1922302246094, 'policy_logps/chosen': -532.6901245117188, 'referece_logps/rejected': -479.4189758300781, 'referece_logps/chosen': -525.784912109375, 'logits/rejected': -0.19129550457000732, 'logits/chosen': -0.3313003182411194, 'epoch': 0.4}


  7%|▋         | 1086/16104 [5:05:31<64:37:17, 15.49s/it]

  7%|▋         | 1087/16104 [5:05:49<67:16:49, 16.13s/it]
{'loss': 0.6863, 'learning_rate': 1.9926546934318465e-06, 'rewards/chosen': -0.5066614151000977, 'rewards/rejected': -0.9975132942199707, 'rewards/accuracies': 0.875, 'rewards/margins': 0.4908519685268402, 'policy_logps/rejected': -261.4449157714844, 'policy_logps/chosen': -330.3493347167969, 'referece_logps/rejected': -251.4697723388672, 'referece_logps/chosen': -325.2826843261719, 'logits/rejected': -1.0598732233047485, 'logits/chosen': -1.147656798362732, 'epoch': 0.4}


  7%|▋         | 1089/16104 [5:06:26<71:49:32, 17.22s/it]

  7%|▋         | 1090/16104 [5:06:42<70:06:12, 16.81s/it]

  7%|▋         | 1091/16104 [5:07:02<74:50:12, 17.95s/it]

  7%|▋         | 1092/16104 [5:07:21<75:37:59, 18.14s/it]

  7%|▋         | 1093/16104 [5:07:40<77:17:06, 18.53s/it]

  7%|▋         | 1094/16104 [5:08:02<81:08:38, 19.46s/it]

  7%|▋         | 1095/16104 [5:08:19<78:05:16, 18.73s/it]

  7%|▋         | 1096/16104 [5:08:40<80:49:33, 19.39s/it]

  7%|▋         | 1097/16104 [5:08:53<72:57:48, 17.50s/it]
{'loss': 0.5536, 'learning_rate': 1.9924093591283767e-06, 'rewards/chosen': -0.4937858581542969, 'rewards/rejected': -0.6463232636451721, 'rewards/accuracies': 0.625, 'rewards/margins': 0.15253734588623047, 'policy_logps/rejected': -382.72454833984375, 'policy_logps/chosen': -330.61090087890625, 'referece_logps/rejected': -376.2613525390625, 'referece_logps/chosen': -325.67303466796875, 'logits/rejected': -0.9743874073028564, 'logits/chosen': -0.8986457586288452, 'epoch': 0.41}

  7%|▋         | 1098/16104 [5:09:14<76:59:45, 18.47s/it]
{'loss': 0.5903, 'learning_rate': 1.9923846048855753e-06, 'rewards/chosen': -1.5553265810012817, 'rewards/rejected': -1.65336012840271, 'rewards/accuracies': 0.5, 'rewards/margins': 0.09803350269794464, 'policy_logps/rejected': -508.6424255371094, 'policy_logps/chosen': -638.8892211914062, 'referece_logps/rejected': -492.1088562011719, 'referece_logps/chosen': -623.3359985351562, 'logits/rejected': 1.0453983545303345, 'logits/chosen': 0.8321441411972046, 'epoch': 0.41}


  7%|▋         | 1100/16104 [5:09:43<69:28:23, 16.67s/it]

  7%|▋         | 1101/16104 [5:10:03<73:34:16, 17.65s/it]

  7%|▋         | 1102/16104 [5:10:14<64:48:11, 15.55s/it]

  7%|▋         | 1103/16104 [5:10:30<65:21:24, 15.68s/it]

  7%|▋         | 1104/16104 [5:10:43<62:01:19, 14.89s/it]

  7%|▋         | 1105/16104 [5:10:56<60:29:59, 14.52s/it]
{'loss': 0.6048, 'learning_rate': 1.992210201217858e-06, 'rewards/chosen': -0.8500236868858337, 'rewards/rejected': -0.9897940158843994, 'rewards/accuracies': 0.5, 'rewards/margins': 0.13977038860321045, 'policy_logps/rejected': -471.7170715332031, 'policy_logps/chosen': -494.1588134765625, 'referece_logps/rejected': -461.8191223144531, 'referece_logps/chosen': -485.6585998535156, 'logits/rejected': 0.43656495213508606, 'logits/chosen': 0.6018056869506836, 'epoch': 0.41}


  7%|▋         | 1107/16104 [5:11:27<63:44:52, 15.30s/it]

  7%|▋         | 1108/16104 [5:11:41<62:12:32, 14.93s/it]

  7%|▋         | 1109/16104 [5:12:03<70:35:10, 16.95s/it]
{'loss': 0.5756, 'learning_rate': 1.9921096589501605e-06, 'rewards/chosen': -0.513280987739563, 'rewards/rejected': -0.8508956432342529, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3376147150993347, 'policy_logps/rejected': -608.0482788085938, 'policy_logps/chosen': -343.87176513671875, 'referece_logps/rejected': -599.539306640625, 'referece_logps/chosen': -338.7389221191406, 'logits/rejected': -0.814520537853241, 'logits/chosen': -0.2180953472852707, 'epoch': 0.41}

  7%|▋         | 1110/16104 [5:12:14<62:52:23, 15.10s/it]


  7%|▋         | 1112/16104 [5:12:47<66:06:55, 15.88s/it]
{'loss': 0.5789, 'learning_rate': 1.9920338308534707e-06, 'rewards/chosen': -1.3704655170440674, 'rewards/rejected': -1.436968207359314, 'rewards/accuracies': 0.375, 'rewards/margins': 0.0665026605129242, 'policy_logps/rejected': -424.2946472167969, 'policy_logps/chosen': -347.7276916503906, 'referece_logps/rejected': -409.9249267578125, 'referece_logps/chosen': -334.0230712890625, 'logits/rejected': -0.018384739756584167, 'logits/chosen': -0.08709916472434998, 'epoch': 0.41}

  7%|▋         | 1113/16104 [5:12:58<59:46:16, 14.35s/it]


  7%|▋         | 1115/16104 [5:13:21<52:49:02, 12.69s/it]

  7%|▋         | 1116/16104 [5:13:37<57:44:22, 13.87s/it]

  7%|▋         | 1117/16104 [5:13:49<54:58:44, 13.21s/it]

  7%|▋         | 1118/16104 [5:13:59<51:49:35, 12.45s/it]

  7%|▋         | 1119/16104 [5:14:18<58:54:30, 14.15s/it]

  7%|▋         | 1120/16104 [5:14:31<57:23:52, 13.79s/it]

  7%|▋         | 1121/16104 [5:14:51<65:44:44, 15.80s/it]

  7%|▋         | 1122/16104 [5:15:13<73:01:26, 17.55s/it]
[2024-04-07 18:21:53,719] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5623, 'learning_rate': 1.9917784622672805e-06, 'rewards/chosen': -1.0435700416564941, 'rewards/rejected': -2.073485851287842, 'rewards/accuracies': 0.875, 'rewards/margins': 1.029915690422058, 'policy_logps/rejected': -386.4285583496094, 'policy_logps/chosen': -450.29840087890625, 'referece_logps/rejected': -365.6936950683594, 'referece_logps/chosen': -439.8626708984375, 'logits/rejected': 0.4281504154205322, 'logits/chosen': 0.4580691456794739, 'epoch': 0.42}
[2024-04-07 18:22:13,300] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  7%|▋         | 1124/16104 [5:15:49<73:49:49, 17.74s/it]

  7%|▋         | 1125/16104 [5:16:08<74:53:36, 18.00s/it]

  7%|▋         | 1126/16104 [5:16:24<72:21:10, 17.39s/it]
{'loss': 0.4568, 'learning_rate': 1.9916751914369443e-06, 'rewards/chosen': -0.5745573043823242, 'rewards/rejected': -1.7278207540512085, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1532634496688843, 'policy_logps/rejected': -441.72137451171875, 'policy_logps/chosen': -444.600830078125, 'referece_logps/rejected': -424.44317626953125, 'referece_logps/chosen': -438.855224609375, 'logits/rejected': -0.383831262588501, 'logits/chosen': -0.3860340714454651, 'epoch': 0.42}


  7%|▋         | 1128/16104 [5:16:59<74:36:14, 17.93s/it]
{'loss': 0.5483, 'learning_rate': 1.991623315327408e-06, 'rewards/chosen': -0.7412182092666626, 'rewards/rejected': -1.4443608522415161, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7031426429748535, 'policy_logps/rejected': -375.8113098144531, 'policy_logps/chosen': -420.45501708984375, 'referece_logps/rejected': -361.3677062988281, 'referece_logps/chosen': -413.0428161621094, 'logits/rejected': -0.8810538053512573, 'logits/chosen': -0.5720669627189636, 'epoch': 0.42}

  7%|▋         | 1129/16104 [5:17:18<75:54:27, 18.25s/it]


  7%|▋         | 1131/16104 [5:17:41<61:22:05, 14.75s/it]

  7%|▋         | 1132/16104 [5:17:52<56:08:36, 13.50s/it]

  7%|▋         | 1133/16104 [5:18:07<58:38:46, 14.10s/it]
{'loss': 0.5507, 'learning_rate': 1.991492923095678e-06, 'rewards/chosen': -1.1516910791397095, 'rewards/rejected': -1.532199740409851, 'rewards/accuracies': 0.625, 'rewards/margins': 0.38050854206085205, 'policy_logps/rejected': -344.5528259277344, 'policy_logps/chosen': -410.04327392578125, 'referece_logps/rejected': -329.2308349609375, 'referece_logps/chosen': -398.5263366699219, 'logits/rejected': 0.536957323551178, 'logits/chosen': 0.5670439600944519, 'epoch': 0.42}

  7%|▋         | 1134/16104 [5:18:30<69:34:41, 16.73s/it]

  7%|▋         | 1135/16104 [5:18:51<74:16:38, 17.86s/it]

  7%|▋         | 1136/16104 [5:19:09<74:24:18, 17.90s/it]


  7%|▋         | 1138/16104 [5:19:51<81:57:09, 19.71s/it]

  7%|▋         | 1139/16104 [5:20:12<82:54:26, 19.94s/it]

  7%|▋         | 1140/16104 [5:20:35<87:13:07, 20.98s/it]

  7%|▋         | 1141/16104 [5:20:46<74:19:48, 17.88s/it]

  7%|▋         | 1142/16104 [5:21:06<77:20:15, 18.61s/it]

  7%|▋         | 1143/16104 [5:21:23<75:43:40, 18.22s/it]

  7%|▋         | 1144/16104 [5:21:46<81:02:28, 19.50s/it]

  7%|▋         | 1145/16104 [5:21:58<71:40:15, 17.25s/it]

  7%|▋         | 1146/16104 [5:22:11<66:44:00, 16.06s/it]
{'loss': 0.6001, 'learning_rate': 1.9911492110296137e-06, 'rewards/chosen': -1.1433261632919312, 'rewards/rejected': -1.592090368270874, 'rewards/accuracies': 0.5, 'rewards/margins': 0.44876405596733093, 'policy_logps/rejected': -454.7857971191406, 'policy_logps/chosen': -322.720703125, 'referece_logps/rejected': -438.8648986816406, 'referece_logps/chosen': -311.2874450683594, 'logits/rejected': 0.03548893332481384, 'logits/chosen': 0.1270529329776764, 'epoch': 0.43}

  7%|▋         | 1147/16104 [5:22:25<63:36:37, 15.31s/it]


  7%|▋         | 1149/16104 [5:23:01<70:52:02, 17.06s/it]

  7%|▋         | 1150/16104 [5:23:16<68:04:06, 16.39s/it]
{'loss': 0.6637, 'learning_rate': 1.9910420901736194e-06, 'rewards/chosen': -0.9945657849311829, 'rewards/rejected': -1.5803779363632202, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5858121514320374, 'policy_logps/rejected': -412.6972351074219, 'policy_logps/chosen': -429.6242370605469, 'referece_logps/rejected': -396.89337158203125, 'referece_logps/chosen': -419.6785888671875, 'logits/rejected': -1.4082845449447632, 'logits/chosen': -1.1538405418395996, 'epoch': 0.43}


  7%|▋         | 1152/16104 [5:23:46<64:48:35, 15.60s/it]
{'loss': 0.5503, 'learning_rate': 1.9909882892047586e-06, 'rewards/chosen': -1.0583091974258423, 'rewards/rejected': -1.267243504524231, 'rewards/accuracies': 0.625, 'rewards/margins': 0.20893436670303345, 'policy_logps/rejected': -298.8953552246094, 'policy_logps/chosen': -431.45489501953125, 'referece_logps/rejected': -286.2229309082031, 'referece_logps/chosen': -420.871826171875, 'logits/rejected': -0.6402207612991333, 'logits/chosen': -0.5335803031921387, 'epoch': 0.43}


  7%|▋         | 1154/16104 [5:24:26<74:15:54, 17.88s/it]

  7%|▋         | 1155/16104 [5:24:46<77:42:52, 18.72s/it]
{'loss': 0.558, 'learning_rate': 1.9909072870998624e-06, 'rewards/chosen': -0.4779777526855469, 'rewards/rejected': -1.6432099342346191, 'rewards/accuracies': 0.625, 'rewards/margins': 1.1652321815490723, 'policy_logps/rejected': -355.49774169921875, 'policy_logps/chosen': -357.0623779296875, 'referece_logps/rejected': -339.065673828125, 'referece_logps/chosen': -352.2825927734375, 'logits/rejected': -0.6820802092552185, 'logits/chosen': -0.6781136989593506, 'epoch': 0.43}

  7%|▋         | 1156/16104 [5:24:59<69:54:59, 16.84s/it]


  7%|▋         | 1158/16104 [5:25:30<66:13:53, 15.95s/it]

  7%|▋         | 1159/16104 [5:25:50<71:51:46, 17.31s/it]

  7%|▋         | 1160/16104 [5:26:09<74:05:35, 17.85s/it]
{'loss': 0.5311, 'learning_rate': 1.990771481926986e-06, 'rewards/chosen': -0.3917921185493469, 'rewards/rejected': -0.9822869896888733, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5904948711395264, 'policy_logps/rejected': -410.4674987792969, 'policy_logps/chosen': -414.8063659667969, 'referece_logps/rejected': -400.6446533203125, 'referece_logps/chosen': -410.888427734375, 'logits/rejected': -0.6455383896827698, 'logits/chosen': -0.6064285039901733, 'epoch': 0.43}


  7%|▋         | 1162/16104 [5:26:50<79:20:04, 19.11s/it]
{'loss': 0.5194, 'learning_rate': 1.990716879300812e-06, 'rewards/chosen': -0.5855177640914917, 'rewards/rejected': -1.9951454401016235, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4096276760101318, 'policy_logps/rejected': -357.4217529296875, 'policy_logps/chosen': -297.8868713378906, 'referece_logps/rejected': -337.4703063964844, 'referece_logps/chosen': -292.0317077636719, 'logits/rejected': 0.06959861516952515, 'logits/chosen': 0.3489900231361389, 'epoch': 0.43}
[2024-04-07 18:33:52,244] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  7%|▋         | 1164/16104 [5:27:32<83:30:59, 20.12s/it]
[2024-04-07 18:34:13,421] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  7%|▋         | 1165/16104 [5:27:44<73:01:26, 17.60s/it]

  7%|▋         | 1166/16104 [5:28:06<78:52:22, 19.01s/it]

  7%|▋         | 1167/16104 [5:28:28<82:06:08, 19.79s/it]

  7%|▋         | 1168/16104 [5:28:44<77:57:20, 18.79s/it]
{'loss': 0.4666, 'learning_rate': 1.9905521096273925e-06, 'rewards/chosen': -0.2419523149728775, 'rewards/rejected': -0.9884121417999268, 'rewards/accuracies': 1.0, 'rewards/margins': 0.7464598417282104, 'policy_logps/rejected': -372.43096923828125, 'policy_logps/chosen': -477.1448974609375, 'referece_logps/rejected': -362.5468444824219, 'referece_logps/chosen': -474.7253723144531, 'logits/rejected': -0.5172756314277649, 'logits/chosen': -0.45059528946876526, 'epoch': 0.44}


  7%|▋         | 1170/16104 [5:29:26<81:36:24, 19.67s/it]

  7%|▋         | 1171/16104 [5:29:42<77:36:38, 18.71s/it]
{'loss': 0.5996, 'learning_rate': 1.9904691838360617e-06, 'rewards/chosen': -0.6736963391304016, 'rewards/rejected': -0.9817118048667908, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3080155551433563, 'policy_logps/rejected': -291.8898010253906, 'policy_logps/chosen': -315.69366455078125, 'referece_logps/rejected': -282.0726623535156, 'referece_logps/chosen': -308.9566650390625, 'logits/rejected': -1.2719107866287231, 'logits/chosen': -1.2235863208770752, 'epoch': 0.44}

  7%|▋         | 1172/16104 [5:29:53<68:25:38, 16.50s/it]


  7%|▋         | 1174/16104 [5:30:28<72:04:14, 17.38s/it]

  7%|▋         | 1175/16104 [5:30:46<72:43:17, 17.54s/it]
{'loss': 0.5077, 'learning_rate': 1.9903580551920957e-06, 'rewards/chosen': -0.5167862176895142, 'rewards/rejected': -1.296486496925354, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7797002792358398, 'policy_logps/rejected': -383.2934875488281, 'policy_logps/chosen': -402.5324401855469, 'referece_logps/rejected': -370.3285827636719, 'referece_logps/chosen': -397.36456298828125, 'logits/rejected': -0.6482829451560974, 'logits/chosen': -0.4767859876155853, 'epoch': 0.44}


  7%|▋         | 1177/16104 [5:31:20<71:56:09, 17.35s/it]
{'loss': 0.5493, 'learning_rate': 1.9903022504951095e-06, 'rewards/chosen': -0.560558557510376, 'rewards/rejected': -1.0438528060913086, 'rewards/accuracies': 0.875, 'rewards/margins': 0.48329418897628784, 'policy_logps/rejected': -299.47442626953125, 'policy_logps/chosen': -389.0218505859375, 'referece_logps/rejected': -289.035888671875, 'referece_logps/chosen': -383.416259765625, 'logits/rejected': -0.10441690683364868, 'logits/chosen': -0.11682304739952087, 'epoch': 0.44}


  7%|▋         | 1179/16104 [5:31:53<70:13:40, 16.94s/it]
{'loss': 0.6381, 'learning_rate': 1.990246285560152e-06, 'rewards/chosen': -0.864152729511261, 'rewards/rejected': -1.3986141681671143, 'rewards/accuracies': 0.75, 'rewards/margins': 0.534461498260498, 'policy_logps/rejected': -846.21435546875, 'policy_logps/chosen': -475.39312744140625, 'referece_logps/rejected': -832.228271484375, 'referece_logps/chosen': -466.7515869140625, 'logits/rejected': -1.0198181867599487, 'logits/chosen': -0.8055949807167053, 'epoch': 0.44}

  7%|▋         | 1180/16104 [5:32:07<66:53:01, 16.13s/it]

  7%|▋         | 1181/16104 [5:32:22<65:02:31, 15.69s/it]

  7%|▋         | 1182/16104 [5:32:33<60:14:18, 14.53s/it]


  7%|▋         | 1184/16104 [5:32:56<52:59:32, 12.79s/it]

  7%|▋         | 1185/16104 [5:33:13<58:10:14, 14.04s/it]

  7%|▋         | 1186/16104 [5:33:32<65:07:20, 15.72s/it]
{'loss': 0.6428, 'learning_rate': 1.990049146544751e-06, 'rewards/chosen': -0.7264291644096375, 'rewards/rejected': -0.6010412573814392, 'rewards/accuracies': 0.5, 'rewards/margins': -0.12538793683052063, 'policy_logps/rejected': -358.3187255859375, 'policy_logps/chosen': -344.5431213378906, 'referece_logps/rejected': -352.30828857421875, 'referece_logps/chosen': -337.2788391113281, 'logits/rejected': -0.6347763538360596, 'logits/chosen': -0.5262843370437622, 'epoch': 0.44}


  7%|▋         | 1188/16104 [5:34:06<66:54:55, 16.15s/it]

  7%|▋         | 1189/16104 [5:34:22<66:20:00, 16.01s/it]

  7%|▋         | 1190/16104 [5:34:38<66:18:08, 16.00s/it]
{'loss': 0.5973, 'learning_rate': 1.9899356145701226e-06, 'rewards/chosen': -0.9368311762809753, 'rewards/rejected': -1.065519094467163, 'rewards/accuracies': 0.5, 'rewards/margins': 0.12868797779083252, 'policy_logps/rejected': -361.5316162109375, 'policy_logps/chosen': -386.9316101074219, 'referece_logps/rejected': -350.87640380859375, 'referece_logps/chosen': -377.56329345703125, 'logits/rejected': -0.6337840557098389, 'logits/chosen': -0.7177083492279053, 'epoch': 0.44}


  7%|▋         | 1192/16104 [5:35:00<55:57:17, 13.51s/it]
{'loss': 0.4996, 'learning_rate': 1.989878608310239e-06, 'rewards/chosen': -0.5826361179351807, 'rewards/rejected': -1.2992109060287476, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7165748476982117, 'policy_logps/rejected': -348.72833251953125, 'policy_logps/chosen': -325.1209411621094, 'referece_logps/rejected': -335.73626708984375, 'referece_logps/chosen': -319.2945861816406, 'logits/rejected': -0.8901638984680176, 'logits/chosen': -0.8840367197990417, 'epoch': 0.44}


  7%|▋         | 1194/16104 [5:35:37<66:25:18, 16.04s/it]
{'loss': 0.627, 'learning_rate': 1.9898214418809326e-06, 'rewards/chosen': -0.7815545797348022, 'rewards/rejected': -0.9647834300994873, 'rewards/accuracies': 0.625, 'rewards/margins': 0.1832287460565567, 'policy_logps/rejected': -348.1165771484375, 'policy_logps/chosen': -469.8365478515625, 'referece_logps/rejected': -338.46875, 'referece_logps/chosen': -462.02093505859375, 'logits/rejected': -1.480290412902832, 'logits/chosen': -1.6910041570663452, 'epoch': 0.44}


  7%|▋         | 1196/16104 [5:36:14<73:03:57, 17.64s/it]
{'loss': 0.6482, 'learning_rate': 1.9897641152914534e-06, 'rewards/chosen': -1.0414681434631348, 'rewards/rejected': -0.8388965725898743, 'rewards/accuracies': 0.5, 'rewards/margins': -0.20257166028022766, 'policy_logps/rejected': -386.5176086425781, 'policy_logps/chosen': -495.6033935546875, 'referece_logps/rejected': -378.128662109375, 'referece_logps/chosen': -485.188720703125, 'logits/rejected': -1.1820898056030273, 'logits/chosen': -1.1136304140090942, 'epoch': 0.45}


  7%|▋         | 1198/16104 [5:36:49<71:48:15, 17.34s/it]
{'loss': 0.6278, 'learning_rate': 1.9897066285510768e-06, 'rewards/chosen': -0.5883128643035889, 'rewards/rejected': -0.7067752480506897, 'rewards/accuracies': 0.5, 'rewards/margins': 0.11846238374710083, 'policy_logps/rejected': -331.75616455078125, 'policy_logps/chosen': -403.0195617675781, 'referece_logps/rejected': -324.68841552734375, 'referece_logps/chosen': -397.1364440917969, 'logits/rejected': -0.2091800421476364, 'logits/chosen': -0.29790014028549194, 'epoch': 0.45}


  7%|▋         | 1200/16104 [5:37:27<75:45:07, 18.30s/it]

  7%|▋         | 1201/16104 [5:37:48<80:01:49, 19.33s/it]
{'loss': 0.6101, 'learning_rate': 1.9896200981779343e-06, 'rewards/chosen': -0.7488828897476196, 'rewards/rejected': -0.7502139806747437, 'rewards/accuracies': 0.5, 'rewards/margins': 0.0013310499489307404, 'policy_logps/rejected': -524.66455078125, 'policy_logps/chosen': -358.5037841796875, 'referece_logps/rejected': -517.1624145507812, 'referece_logps/chosen': -351.0149841308594, 'logits/rejected': -0.3466172218322754, 'logits/chosen': -0.14232315123081207, 'epoch': 0.45}

  7%|▋         | 1202/16104 [5:38:10<82:34:18, 19.95s/it]


  7%|▋         | 1204/16104 [5:38:36<68:16:33, 16.50s/it]

  7%|▋         | 1205/16104 [5:38:47<61:00:31, 14.74s/it]
{'loss': 0.5306, 'learning_rate': 1.9895041639059718e-06, 'rewards/chosen': -0.48110392689704895, 'rewards/rejected': -1.0297622680664062, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5486583709716797, 'policy_logps/rejected': -642.223876953125, 'policy_logps/chosen': -323.6321105957031, 'referece_logps/rejected': -631.92626953125, 'referece_logps/chosen': -318.8210754394531, 'logits/rejected': -0.32662591338157654, 'logits/chosen': 0.0801311731338501, 'epoch': 0.45}

  7%|▋         | 1206/16104 [5:38:58<56:15:27, 13.59s/it]

  7%|▋         | 1207/16104 [5:39:16<61:57:49, 14.97s/it]

  8%|▊         | 1208/16104 [5:39:28<58:21:38, 14.10s/it]


  8%|▊         | 1210/16104 [5:39:55<57:58:58, 14.01s/it]
{'loss': 0.6126, 'learning_rate': 1.98935834546269e-06, 'rewards/chosen': -0.708028256893158, 'rewards/rejected': -1.0901074409484863, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3820793032646179, 'policy_logps/rejected': -386.12261962890625, 'policy_logps/chosen': -437.7760314941406, 'referece_logps/rejected': -375.2215270996094, 'referece_logps/chosen': -430.6957702636719, 'logits/rejected': -0.6312152743339539, 'logits/chosen': -0.5216175317764282, 'epoch': 0.45}


  8%|▊         | 1212/16104 [5:40:31<66:28:15, 16.07s/it]

  8%|▊         | 1213/16104 [5:40:49<68:05:43, 16.46s/it]
{'loss': 0.5752, 'learning_rate': 1.989270374131553e-06, 'rewards/chosen': -1.0043001174926758, 'rewards/rejected': -0.974956214427948, 'rewards/accuracies': 0.375, 'rewards/margins': -0.02934398129582405, 'policy_logps/rejected': -540.87841796875, 'policy_logps/chosen': -406.0103759765625, 'referece_logps/rejected': -531.12890625, 'referece_logps/chosen': -395.96734619140625, 'logits/rejected': 0.26053673028945923, 'logits/chosen': 0.3817972242832184, 'epoch': 0.45}


  8%|▊         | 1215/16104 [5:41:27<72:35:03, 17.55s/it]

  8%|▊         | 1216/16104 [5:41:49<78:08:30, 18.90s/it]

  8%|▊         | 1217/16104 [5:42:01<69:49:21, 16.88s/it]

  8%|▊         | 1218/16104 [5:42:17<68:57:22, 16.68s/it]
{'loss': 0.5061, 'learning_rate': 1.9891229549071822e-06, 'rewards/chosen': -0.7922069430351257, 'rewards/rejected': -1.5455472469329834, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7533403038978577, 'policy_logps/rejected': -461.77923583984375, 'policy_logps/chosen': -433.94561767578125, 'referece_logps/rejected': -446.32373046875, 'referece_logps/chosen': -426.0235290527344, 'logits/rejected': -0.8653420209884644, 'logits/chosen': -0.7791125178337097, 'epoch': 0.45}

  8%|▊         | 1219/16104 [5:42:34<68:49:43, 16.65s/it]

  8%|▊         | 1220/16104 [5:42:50<68:36:27, 16.59s/it]


  8%|▊         | 1222/16104 [5:43:29<75:03:55, 18.16s/it]
{'loss': 0.6061, 'learning_rate': 1.9890042993083585e-06, 'rewards/chosen': -0.6814861297607422, 'rewards/rejected': -1.516993761062622, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8355074524879456, 'policy_logps/rejected': -307.31951904296875, 'policy_logps/chosen': -468.129150390625, 'referece_logps/rejected': -292.1495361328125, 'referece_logps/chosen': -461.31427001953125, 'logits/rejected': 0.16480019688606262, 'logits/chosen': 0.252297043800354, 'epoch': 0.46}

  8%|▊         | 1223/16104 [5:43:45<71:19:16, 17.25s/it]

  8%|▊         | 1224/16104 [5:43:59<67:27:24, 16.32s/it]
[2024-04-07 18:50:55,086] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1225/16104 [5:44:14<66:14:18, 16.03s/it]

  8%|▊         | 1226/16104 [5:44:29<64:18:33, 15.56s/it]

  8%|▊         | 1227/16104 [5:44:44<64:49:33, 15.69s/it]

  8%|▊         | 1228/16104 [5:45:04<69:35:29, 16.84s/it]


  8%|▊         | 1230/16104 [5:45:39<73:01:31, 17.67s/it]
{'loss': 0.5314, 'learning_rate': 1.9887650678525593e-06, 'rewards/chosen': -1.2642379999160767, 'rewards/rejected': -1.7007966041564941, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4365585446357727, 'policy_logps/rejected': -401.4634094238281, 'policy_logps/chosen': -442.2420959472656, 'referece_logps/rejected': -384.4554443359375, 'referece_logps/chosen': -429.5997009277344, 'logits/rejected': -0.054705336689949036, 'logits/chosen': -0.040141522884368896, 'epoch': 0.46}

  8%|▊         | 1231/16104 [5:45:53<68:18:09, 16.53s/it]

  8%|▊         | 1232/16104 [5:46:11<70:03:48, 16.96s/it]

  8%|▊         | 1233/16104 [5:46:24<65:11:54, 15.78s/it]

  8%|▊         | 1234/16104 [5:46:36<60:42:41, 14.70s/it]

  8%|▊         | 1235/16104 [5:46:51<60:35:04, 14.67s/it]

  8%|▊         | 1236/16104 [5:47:05<59:32:58, 14.42s/it]
[2024-04-07 18:54:06,884] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1237/16104 [5:47:26<67:55:55, 16.45s/it]

  8%|▊         | 1238/16104 [5:47:47<73:09:39, 17.72s/it]

  8%|▊         | 1239/16104 [5:48:07<76:09:14, 18.44s/it]


  8%|▊         | 1241/16104 [5:48:40<70:53:37, 17.17s/it]
{'loss': 0.6697, 'learning_rate': 1.9884319450102292e-06, 'rewards/chosen': -0.8315060138702393, 'rewards/rejected': -0.7144616842269897, 'rewards/accuracies': 0.375, 'rewards/margins': -0.11704425513744354, 'policy_logps/rejected': -465.9341735839844, 'policy_logps/chosen': -348.9701232910156, 'referece_logps/rejected': -458.7895812988281, 'referece_logps/chosen': -340.6550598144531, 'logits/rejected': -0.45347246527671814, 'logits/chosen': -0.3632858395576477, 'epoch': 0.46}


  8%|▊         | 1243/16104 [5:49:20<77:21:43, 18.74s/it]
{'loss': 0.6296, 'learning_rate': 1.9883708573829016e-06, 'rewards/chosen': -0.9241013526916504, 'rewards/rejected': -1.5802695751190186, 'rewards/accuracies': 1.0, 'rewards/margins': 0.6561681628227234, 'policy_logps/rejected': -337.56854248046875, 'policy_logps/chosen': -562.9893188476562, 'referece_logps/rejected': -321.7658386230469, 'referece_logps/chosen': -553.7482299804688, 'logits/rejected': -0.7270892262458801, 'logits/chosen': -0.9305112957954407, 'epoch': 0.46}

  8%|▊         | 1244/16104 [5:49:38<76:49:07, 18.61s/it]

  8%|▊         | 1245/16104 [5:49:49<67:00:04, 16.23s/it]

  8%|▊         | 1246/16104 [5:50:07<69:15:24, 16.78s/it]


  8%|▊         | 1248/16104 [5:50:38<67:16:50, 16.30s/it]
{'loss': 0.7166, 'learning_rate': 1.9882174386623897e-06, 'rewards/chosen': -0.7820404171943665, 'rewards/rejected': -0.8886368274688721, 'rewards/accuracies': 0.5, 'rewards/margins': 0.10659636557102203, 'policy_logps/rejected': -496.5434265136719, 'policy_logps/chosen': -374.04913330078125, 'referece_logps/rejected': -487.65704345703125, 'referece_logps/chosen': -366.22869873046875, 'logits/rejected': -0.8019366264343262, 'logits/chosen': -0.7020436525344849, 'epoch': 0.46}


  8%|▊         | 1250/16104 [5:51:04<60:03:57, 14.56s/it]
{'loss': 0.6094, 'learning_rate': 1.9881557913393728e-06, 'rewards/chosen': -0.6862882375717163, 'rewards/rejected': -1.479346752166748, 'rewards/accuracies': 0.875, 'rewards/margins': 0.793058454990387, 'policy_logps/rejected': -433.80731201171875, 'policy_logps/chosen': -339.1025085449219, 'referece_logps/rejected': -419.0138244628906, 'referece_logps/chosen': -332.2395935058594, 'logits/rejected': -0.3435647785663605, 'logits/chosen': -0.1517203152179718, 'epoch': 0.47}

  8%|▊         | 1251/16104 [5:51:20<62:27:46, 15.14s/it]

  8%|▊         | 1252/16104 [5:51:34<61:09:46, 14.83s/it]


  8%|▊         | 1254/16104 [5:52:02<59:00:59, 14.31s/it]
{'loss': 0.5936, 'learning_rate': 1.9880320170313638e-06, 'rewards/chosen': -0.5153263211250305, 'rewards/rejected': -1.0186491012573242, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5033227801322937, 'policy_logps/rejected': -235.14356994628906, 'policy_logps/chosen': -350.910400390625, 'referece_logps/rejected': -224.9570770263672, 'referece_logps/chosen': -345.75714111328125, 'logits/rejected': -0.31486761569976807, 'logits/chosen': -0.49349069595336914, 'epoch': 0.47}

  8%|▊         | 1255/16104 [5:52:18<61:48:27, 14.98s/it]

  8%|▊         | 1256/16104 [5:52:39<69:04:52, 16.75s/it]

  8%|▊         | 1257/16104 [5:52:58<71:57:27, 17.45s/it]

  8%|▊         | 1258/16104 [5:53:11<66:06:10, 16.03s/it]

  8%|▊         | 1259/16104 [5:53:27<65:52:04, 15.97s/it]


  8%|▊         | 1261/16104 [5:53:48<54:40:38, 13.26s/it]
{'loss': 0.5104, 'learning_rate': 1.9878138732860092e-06, 'rewards/chosen': -0.5526734590530396, 'rewards/rejected': -1.0472627878189087, 'rewards/accuracies': 0.875, 'rewards/margins': 0.49458932876586914, 'policy_logps/rejected': -334.3992919921875, 'policy_logps/chosen': -408.43634033203125, 'referece_logps/rejected': -323.9266662597656, 'referece_logps/chosen': -402.9096374511719, 'logits/rejected': -0.6579268574714661, 'logits/chosen': -0.7077975273132324, 'epoch': 0.47}


  8%|▊         | 1263/16104 [5:54:12<52:07:56, 12.65s/it]
{'loss': 0.5412, 'learning_rate': 1.987751186853169e-06, 'rewards/chosen': -0.4299464821815491, 'rewards/rejected': -0.8552468419075012, 'rewards/accuracies': 0.75, 'rewards/margins': 0.42530035972595215, 'policy_logps/rejected': -308.1029052734375, 'policy_logps/chosen': -506.0352783203125, 'referece_logps/rejected': -299.5505065917969, 'referece_logps/chosen': -501.7358093261719, 'logits/rejected': -0.41247040033340454, 'logits/chosen': -0.47297945618629456, 'epoch': 0.47}

  8%|▊         | 1264/16104 [5:54:27<54:53:08, 13.31s/it]

  8%|▊         | 1265/16104 [5:54:45<60:35:41, 14.70s/it]

  8%|▊         | 1266/16104 [5:55:03<64:20:18, 15.61s/it]


  8%|▊         | 1268/16104 [5:55:32<62:07:40, 15.08s/it]

  8%|▊         | 1269/16104 [5:55:50<65:18:30, 15.85s/it]
{'loss': 0.5442, 'learning_rate': 1.987562168644204e-06, 'rewards/chosen': -0.8052213191986084, 'rewards/rejected': -0.8912011981010437, 'rewards/accuracies': 0.625, 'rewards/margins': 0.08597972989082336, 'policy_logps/rejected': -380.0531921386719, 'policy_logps/chosen': -499.44696044921875, 'referece_logps/rejected': -371.14117431640625, 'referece_logps/chosen': -491.394775390625, 'logits/rejected': -1.3115274906158447, 'logits/chosen': -1.3553029298782349, 'epoch': 0.47}

  8%|▊         | 1270/16104 [5:56:03<61:19:03, 14.88s/it]

  8%|▊         | 1271/16104 [5:56:18<61:37:06, 14.95s/it]

  8%|▊         | 1272/16104 [5:56:33<61:37:43, 14.96s/it]


  8%|▊         | 1274/16104 [5:57:10<69:00:50, 16.75s/it]
{'loss': 0.6079, 'learning_rate': 1.987403554870521e-06, 'rewards/chosen': -0.979134738445282, 'rewards/rejected': -1.3033686876296997, 'rewards/accuracies': 0.625, 'rewards/margins': 0.32423391938209534, 'policy_logps/rejected': -280.2326354980469, 'policy_logps/chosen': -445.2993469238281, 'referece_logps/rejected': -267.198974609375, 'referece_logps/chosen': -435.50799560546875, 'logits/rejected': -1.1888298988342285, 'logits/chosen': -1.1337816715240479, 'epoch': 0.47}

  8%|▊         | 1275/16104 [5:57:23<64:31:35, 15.66s/it]

  8%|▊         | 1276/16104 [5:57:41<67:47:41, 16.46s/it]

  8%|▊         | 1277/16104 [5:57:59<69:13:09, 16.81s/it]

  8%|▊         | 1278/16104 [5:58:12<64:04:24, 15.56s/it]

  8%|▊         | 1279/16104 [5:58:33<70:46:37, 17.19s/it]

  8%|▊         | 1280/16104 [5:58:47<67:48:00, 16.47s/it]

  8%|▊         | 1281/16104 [5:59:08<72:13:10, 17.54s/it]

  8%|▊         | 1282/16104 [5:59:27<74:46:21, 18.16s/it]

  8%|▊         | 1283/16104 [5:59:39<67:32:07, 16.40s/it]

  8%|▊         | 1284/16104 [5:59:51<61:34:54, 14.96s/it]


  8%|▊         | 1286/16104 [6:00:28<68:53:41, 16.74s/it]
{'loss': 0.6138, 'learning_rate': 1.9870188080134863e-06, 'rewards/chosen': -1.0948946475982666, 'rewards/rejected': -1.5517462491989136, 'rewards/accuracies': 0.875, 'rewards/margins': 0.4568517804145813, 'policy_logps/rejected': -427.8021240234375, 'policy_logps/chosen': -447.75360107421875, 'referece_logps/rejected': -412.28466796875, 'referece_logps/chosen': -436.8046875, 'logits/rejected': -0.07790010422468185, 'logits/chosen': -0.19320440292358398, 'epoch': 0.48}

  8%|▊         | 1287/16104 [6:00:45<69:01:51, 16.77s/it]

  8%|▊         | 1288/16104 [6:01:01<67:57:37, 16.51s/it]

  8%|▊         | 1289/16104 [6:01:22<73:03:18, 17.75s/it]

  8%|▊         | 1290/16104 [6:01:34<65:55:04, 16.02s/it]


  8%|▊         | 1292/16104 [6:02:14<75:25:21, 18.33s/it]

  8%|▊         | 1293/16104 [6:02:30<72:39:36, 17.66s/it]
{'loss': 0.6463, 'learning_rate': 1.9867917170793315e-06, 'rewards/chosen': -0.908071756362915, 'rewards/rejected': -1.6262258291244507, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7181541919708252, 'policy_logps/rejected': -417.7453918457031, 'policy_logps/chosen': -309.0721435546875, 'referece_logps/rejected': -401.48309326171875, 'referece_logps/chosen': -299.991455078125, 'logits/rejected': -0.776668906211853, 'logits/chosen': -0.6354473233222961, 'epoch': 0.48}


  8%|▊         | 1295/16104 [6:03:04<72:06:04, 17.53s/it]

  8%|▊         | 1296/16104 [6:03:17<65:34:21, 15.94s/it]
{'loss': 0.5996, 'learning_rate': 1.9866937936046907e-06, 'rewards/chosen': -0.9112504720687866, 'rewards/rejected': -0.8698724508285522, 'rewards/accuracies': 0.5, 'rewards/margins': -0.04137800633907318, 'policy_logps/rejected': -396.1531066894531, 'policy_logps/chosen': -275.138427734375, 'referece_logps/rejected': -387.4543762207031, 'referece_logps/chosen': -266.02593994140625, 'logits/rejected': -0.8077671527862549, 'logits/chosen': -0.9261637330055237, 'epoch': 0.48}
[2024-04-07 19:10:19,269] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1297/16104 [6:03:38<72:39:00, 17.66s/it]

  8%|▊         | 1298/16104 [6:03:58<75:17:12, 18.31s/it]
[2024-04-07 19:11:01,318] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1299/16104 [6:04:20<80:08:26, 19.49s/it]

  8%|▊         | 1300/16104 [6:04:32<70:41:50, 17.19s/it]

  8%|▊         | 1301/16104 [6:04:54<76:08:31, 18.52s/it]

  8%|▊         | 1302/16104 [6:05:12<75:25:31, 18.34s/it]

  8%|▊         | 1303/16104 [6:05:26<70:17:33, 17.10s/it]

  8%|▊         | 1304/16104 [6:05:40<66:20:20, 16.14s/it]


  8%|▊         | 1306/16104 [6:06:09<63:30:06, 15.45s/it]
{'loss': 0.5447, 'learning_rate': 1.986364787844757e-06, 'rewards/chosen': -0.7513015866279602, 'rewards/rejected': -1.0437953472137451, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2924938499927521, 'policy_logps/rejected': -419.0289001464844, 'policy_logps/chosen': -323.149169921875, 'referece_logps/rejected': -408.5909423828125, 'referece_logps/chosen': -315.6361083984375, 'logits/rejected': 0.1302955001592636, 'logits/chosen': 0.20695027709007263, 'epoch': 0.49}
[2024-04-07 19:13:11,036] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1307/16104 [6:06:30<70:48:16, 17.23s/it]
[2024-04-07 19:13:28,398] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  8%|▊         | 1309/16104 [6:07:05<71:21:58, 17.37s/it]
{'loss': 0.4749, 'learning_rate': 1.9862653080018506e-06, 'rewards/chosen': -0.3869010806083679, 'rewards/rejected': -1.2993019819259644, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9124009013175964, 'policy_logps/rejected': -405.83331298828125, 'policy_logps/chosen': -327.86712646484375, 'referece_logps/rejected': -392.84027099609375, 'referece_logps/chosen': -323.9981384277344, 'logits/rejected': -0.6045818328857422, 'logits/chosen': -0.41177111864089966, 'epoch': 0.49}

  8%|▊         | 1310/16104 [6:07:17<64:49:42, 15.78s/it]


  8%|▊         | 1312/16104 [6:07:43<59:22:02, 14.45s/it]
{'loss': 0.596, 'learning_rate': 1.9861654690932284e-06, 'rewards/chosen': -0.6307868957519531, 'rewards/rejected': -1.3474342823028564, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7166473865509033, 'policy_logps/rejected': -334.6681213378906, 'policy_logps/chosen': -372.36016845703125, 'referece_logps/rejected': -321.19378662109375, 'referece_logps/chosen': -366.0522766113281, 'logits/rejected': -0.924921452999115, 'logits/chosen': -1.015685796737671, 'epoch': 0.49}


  8%|▊         | 1314/16104 [6:08:11<58:14:19, 14.18s/it]
{'loss': 0.5532, 'learning_rate': 1.9860987103578046e-06, 'rewards/chosen': -0.6183086037635803, 'rewards/rejected': -1.5376843214035034, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9193757772445679, 'policy_logps/rejected': -301.50830078125, 'policy_logps/chosen': -349.434326171875, 'referece_logps/rejected': -286.1314697265625, 'referece_logps/chosen': -343.2512512207031, 'logits/rejected': -1.483038067817688, 'logits/chosen': -1.363243818283081, 'epoch': 0.49}
[2024-04-07 19:15:16,804] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1315/16104 [6:08:36<71:12:55, 17.34s/it]

  8%|▊         | 1316/16104 [6:08:53<71:36:14, 17.43s/it]

  8%|▊         | 1317/16104 [6:09:11<72:06:11, 17.55s/it]


  8%|▊         | 1319/16104 [6:09:49<73:58:16, 18.01s/it]
{'loss': 0.5302, 'learning_rate': 1.9859311154775265e-06, 'rewards/chosen': -0.5087054967880249, 'rewards/rejected': -1.0705580711364746, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5618526339530945, 'policy_logps/rejected': -249.441162109375, 'policy_logps/chosen': -420.2733154296875, 'referece_logps/rejected': -238.7355499267578, 'referece_logps/chosen': -415.18621826171875, 'logits/rejected': 0.308962881565094, 'logits/chosen': 0.2231384813785553, 'epoch': 0.49}

  8%|▊         | 1320/16104 [6:10:00<65:06:51, 15.86s/it]


  8%|▊         | 1322/16104 [6:10:29<61:47:20, 15.05s/it]
{'loss': 0.5957, 'learning_rate': 1.985830079946433e-06, 'rewards/chosen': -1.4382660388946533, 'rewards/rejected': -1.340219259262085, 'rewards/accuracies': 0.5, 'rewards/margins': -0.09804663062095642, 'policy_logps/rejected': -258.03692626953125, 'policy_logps/chosen': -308.9871520996094, 'referece_logps/rejected': -244.63470458984375, 'referece_logps/chosen': -294.6044921875, 'logits/rejected': -0.4408799111843109, 'logits/chosen': -0.4678811728954315, 'epoch': 0.49}

  8%|▊         | 1323/16104 [6:10:50<69:47:09, 17.00s/it]

  8%|▊         | 1324/16104 [6:11:06<67:44:57, 16.50s/it]


  8%|▊         | 1326/16104 [6:11:33<60:29:46, 14.74s/it]
{'loss': 0.5693, 'learning_rate': 1.985694807611164e-06, 'rewards/chosen': -0.4108417332172394, 'rewards/rejected': -1.025543212890625, 'rewards/accuracies': 0.875, 'rewards/margins': 0.614701509475708, 'policy_logps/rejected': -421.4510498046875, 'policy_logps/chosen': -295.9623107910156, 'referece_logps/rejected': -411.1955871582031, 'referece_logps/chosen': -291.8539123535156, 'logits/rejected': -0.5246634483337402, 'logits/chosen': -0.40473172068595886, 'epoch': 0.49}

  8%|▊         | 1327/16104 [6:11:54<67:58:51, 16.56s/it]

  8%|▊         | 1328/16104 [6:12:06<62:42:59, 15.28s/it]


  8%|▊         | 1330/16104 [6:12:33<58:16:24, 14.20s/it]
{'loss': 0.6087, 'learning_rate': 1.985558897306104e-06, 'rewards/chosen': -0.6850070953369141, 'rewards/rejected': -0.8751359581947327, 'rewards/accuracies': 0.625, 'rewards/margins': 0.1901288777589798, 'policy_logps/rejected': -308.0079345703125, 'policy_logps/chosen': -281.3819580078125, 'referece_logps/rejected': -299.2566223144531, 'referece_logps/chosen': -274.5318908691406, 'logits/rejected': -0.36812764406204224, 'logits/chosen': -0.20949608087539673, 'epoch': 0.5}


  8%|▊         | 1332/16104 [6:12:55<51:18:17, 12.50s/it]
{'loss': 0.7232, 'learning_rate': 1.9854907029423752e-06, 'rewards/chosen': -0.8949925303459167, 'rewards/rejected': -1.0444576740264893, 'rewards/accuracies': 0.625, 'rewards/margins': 0.14946524798870087, 'policy_logps/rejected': -230.28456115722656, 'policy_logps/chosen': -339.4759826660156, 'referece_logps/rejected': -219.83998107910156, 'referece_logps/chosen': -330.5260925292969, 'logits/rejected': -1.9532911777496338, 'logits/chosen': -2.045504093170166, 'epoch': 0.5}


  8%|▊         | 1334/16104 [6:13:19<50:08:14, 12.22s/it]
{'loss': 0.5533, 'learning_rate': 1.9854223491192183e-06, 'rewards/chosen': -0.6390470266342163, 'rewards/rejected': -1.3094234466552734, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6703763604164124, 'policy_logps/rejected': -340.859130859375, 'policy_logps/chosen': -365.5225524902344, 'referece_logps/rejected': -327.764892578125, 'referece_logps/chosen': -359.132080078125, 'logits/rejected': -0.8436145782470703, 'logits/chosen': -0.8591892123222351, 'epoch': 0.5}

  8%|▊         | 1335/16104 [6:13:36<55:40:34, 13.57s/it]

  8%|▊         | 1336/16104 [6:13:59<66:57:44, 16.32s/it]

  8%|▊         | 1337/16104 [6:14:12<62:55:02, 15.34s/it]

  8%|▊         | 1338/16104 [6:14:24<59:23:27, 14.48s/it]


  8%|▊         | 1340/16104 [6:14:55<61:36:19, 15.02s/it]
{'loss': 0.5459, 'learning_rate': 1.9852163310039062e-06, 'rewards/chosen': -0.6239408254623413, 'rewards/rejected': -1.3667511940002441, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7428103089332581, 'policy_logps/rejected': -376.11846923828125, 'policy_logps/chosen': -337.1073913574219, 'referece_logps/rejected': -362.4509582519531, 'referece_logps/chosen': -330.86798095703125, 'logits/rejected': -0.8451792001724243, 'logits/chosen': -0.9333547949790955, 'epoch': 0.5}


  8%|▊         | 1342/16104 [6:15:37<74:21:20, 18.13s/it]

  8%|▊         | 1343/16104 [6:15:50<68:01:34, 16.59s/it]

  8%|▊         | 1344/16104 [6:16:12<74:23:03, 18.14s/it]

  8%|▊         | 1345/16104 [6:16:28<71:52:51, 17.53s/it]

  8%|▊         | 1346/16104 [6:16:39<63:27:42, 15.48s/it]

  8%|▊         | 1347/16104 [6:16:52<60:37:50, 14.79s/it]

  8%|▊         | 1348/16104 [6:17:04<56:38:59, 13.82s/it]

  8%|▊         | 1349/16104 [6:17:19<58:54:27, 14.37s/it]

  8%|▊         | 1350/16104 [6:17:41<68:18:53, 16.67s/it]

  8%|▊         | 1351/16104 [6:18:00<70:14:50, 17.14s/it]

  8%|▊         | 1352/16104 [6:18:13<65:06:12, 15.89s/it]

  8%|▊         | 1353/16104 [6:18:32<69:21:15, 16.93s/it]

  8%|▊         | 1354/16104 [6:18:53<74:39:35, 18.22s/it]
[2024-04-07 19:25:34,259] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  8%|▊         | 1356/16104 [6:19:20<64:02:01, 15.63s/it]
[2024-04-07 19:25:49,615] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6279, 'learning_rate': 1.9846950094108006e-06, 'rewards/chosen': -0.6809534430503845, 'rewards/rejected': -1.2128933668136597, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5319399833679199, 'policy_logps/rejected': -262.7540588378906, 'policy_logps/chosen': -304.9380798339844, 'referece_logps/rejected': -250.62513732910156, 'referece_logps/chosen': -298.1285705566406, 'logits/rejected': 0.30514541268348694, 'logits/chosen': 0.4674561023712158, 'epoch': 0.5}

  8%|▊         | 1357/16104 [6:19:31<58:36:36, 14.31s/it]

  8%|▊         | 1358/16104 [6:19:43<54:55:02, 13.41s/it]

  8%|▊         | 1359/16104 [6:19:53<51:37:10, 12.60s/it]

  8%|▊         | 1360/16104 [6:20:08<54:10:38, 13.23s/it]

  8%|▊         | 1361/16104 [6:20:29<63:27:21, 15.49s/it]
{'loss': 0.6136, 'learning_rate': 1.984483971048769e-06, 'rewards/chosen': -1.0211999416351318, 'rewards/rejected': -1.4760209321975708, 'rewards/accuracies': 0.625, 'rewards/margins': 0.45482105016708374, 'policy_logps/rejected': -426.39385986328125, 'policy_logps/chosen': -427.8947448730469, 'referece_logps/rejected': -411.63360595703125, 'referece_logps/chosen': -417.6827697753906, 'logits/rejected': -0.02406095713376999, 'logits/chosen': -0.054154835641384125, 'epoch': 0.51}


  8%|▊         | 1363/16104 [6:20:55<58:43:25, 14.34s/it]

  8%|▊         | 1364/16104 [6:21:15<66:08:04, 16.15s/it]

  8%|▊         | 1365/16104 [6:21:28<62:47:23, 15.34s/it]
{'loss': 0.5038, 'learning_rate': 1.984342482305783e-06, 'rewards/chosen': -0.8266764879226685, 'rewards/rejected': -1.625864028930664, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7991876006126404, 'policy_logps/rejected': -378.04449462890625, 'policy_logps/chosen': -361.57080078125, 'referece_logps/rejected': -361.785888671875, 'referece_logps/chosen': -353.3040466308594, 'logits/rejected': -0.18200349807739258, 'logits/chosen': -0.2613820433616638, 'epoch': 0.51}

  8%|▊         | 1366/16104 [6:21:44<63:00:15, 15.39s/it]

  8%|▊         | 1367/16104 [6:22:03<68:01:56, 16.62s/it]

  8%|▊         | 1368/16104 [6:22:21<69:18:06, 16.93s/it]

  9%|▊         | 1369/16104 [6:22:42<74:17:59, 18.15s/it]

  9%|▊         | 1370/16104 [6:23:04<79:12:31, 19.35s/it]

  9%|▊         | 1371/16104 [6:23:21<75:45:03, 18.51s/it]

  9%|▊         | 1372/16104 [6:23:39<75:26:57, 18.44s/it]
{'loss': 0.5108, 'learning_rate': 1.9840933440521723e-06, 'rewards/chosen': -1.3508751392364502, 'rewards/rejected': -2.233964204788208, 'rewards/accuracies': 1.0, 'rewards/margins': 0.8830888867378235, 'policy_logps/rejected': -376.1922607421875, 'policy_logps/chosen': -397.2522888183594, 'referece_logps/rejected': -353.8526916503906, 'referece_logps/chosen': -383.7435302734375, 'logits/rejected': 0.49531251192092896, 'logits/chosen': 0.4408687353134155, 'epoch': 0.51}
[2024-04-07 19:30:43,281] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  9%|▊         | 1374/16104 [6:24:24<84:07:38, 20.56s/it]

  9%|▊         | 1375/16104 [6:24:39<77:07:42, 18.85s/it]

  9%|▊         | 1376/16104 [6:24:54<71:44:13, 17.53s/it]

  9%|▊         | 1377/16104 [6:25:12<73:02:38, 17.86s/it]
[2024-04-07 19:31:53,446] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▊         | 1378/16104 [6:25:33<75:54:25, 18.56s/it]

  9%|▊         | 1379/16104 [6:25:53<77:57:12, 19.06s/it]

  9%|▊         | 1380/16104 [6:26:14<80:37:45, 19.71s/it]

  9%|▊         | 1381/16104 [6:26:36<83:22:04, 20.38s/it]

  9%|▊         | 1382/16104 [6:26:48<72:39:30, 17.77s/it]

  9%|▊         | 1383/16104 [6:27:12<80:19:31, 19.64s/it]
[2024-04-07 19:33:52,743] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▊         | 1384/16104 [6:27:29<77:33:31, 18.97s/it]

  9%|▊         | 1385/16104 [6:27:43<71:31:28, 17.49s/it]

  9%|▊         | 1386/16104 [6:27:55<64:23:03, 15.75s/it]

  9%|▊         | 1387/16104 [6:28:10<63:13:16, 15.46s/it]

  9%|▊         | 1388/16104 [6:28:29<68:35:12, 16.78s/it]

  9%|▊         | 1389/16104 [6:28:51<74:10:44, 18.15s/it]
[2024-04-07 19:35:31,855] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▊         | 1390/16104 [6:29:09<74:28:36, 18.22s/it]
[2024-04-07 19:35:50,249] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.511, 'learning_rate': 1.9834437471537834e-06, 'rewards/chosen': -0.4998195469379425, 'rewards/rejected': -1.683707594871521, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1838881969451904, 'policy_logps/rejected': -506.87445068359375, 'policy_logps/chosen': -327.98614501953125, 'referece_logps/rejected': -490.0373840332031, 'referece_logps/chosen': -322.9879150390625, 'logits/rejected': -0.6773126125335693, 'logits/chosen': -0.599015474319458, 'epoch': 0.52}


  9%|▊         | 1392/16104 [6:29:51<79:29:22, 19.45s/it]
[2024-04-07 19:36:31,732] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4688, 'learning_rate': 1.9833707739230564e-06, 'rewards/chosen': -0.9723103046417236, 'rewards/rejected': -2.018857002258301, 'rewards/accuracies': 1.0, 'rewards/margins': 1.0465469360351562, 'policy_logps/rejected': -542.9654541015625, 'policy_logps/chosen': -440.7992858886719, 'referece_logps/rejected': -522.7769165039062, 'referece_logps/chosen': -431.076171875, 'logits/rejected': 0.08944416046142578, 'logits/chosen': -0.1528153419494629, 'epoch': 0.52}
[2024-04-07 19:36:53,617] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  9%|▊         | 1394/16104 [6:30:34<83:38:58, 20.47s/it]

  9%|▊         | 1395/16104 [6:30:52<81:07:34, 19.86s/it]

  9%|▊         | 1396/16104 [6:31:14<83:05:00, 20.34s/it]

  9%|▊         | 1397/16104 [6:31:31<79:58:05, 19.57s/it]

  9%|▊         | 1398/16104 [6:31:51<79:55:17, 19.56s/it]

  9%|▊         | 1399/16104 [6:32:12<81:55:37, 20.06s/it]
[2024-04-07 19:38:53,186] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▊         | 1400/16104 [6:32:29<78:17:35, 19.17s/it]

  9%|▊         | 1401/16104 [6:32:49<79:22:10, 19.43s/it]

  9%|▊         | 1402/16104 [6:33:08<78:57:43, 19.34s/it]

  9%|▊         | 1403/16104 [6:33:28<79:15:42, 19.41s/it]

  9%|▊         | 1404/16104 [6:33:48<80:36:20, 19.74s/it]

  9%|▊         | 1405/16104 [6:34:02<73:15:56, 17.94s/it]

  9%|▊         | 1406/16104 [6:34:24<78:12:59, 19.16s/it]

  9%|▊         | 1407/16104 [6:34:38<71:25:09, 17.49s/it]

  9%|▊         | 1408/16104 [6:34:58<74:23:05, 18.22s/it]
{'loss': 0.5768, 'learning_rate': 1.982781260883765e-06, 'rewards/chosen': -1.0946557521820068, 'rewards/rejected': -1.263162612915039, 'rewards/accuracies': 0.625, 'rewards/margins': 0.16850675642490387, 'policy_logps/rejected': -392.0467834472656, 'policy_logps/chosen': -360.3017883300781, 'referece_logps/rejected': -379.4151611328125, 'referece_logps/chosen': -349.3552551269531, 'logits/rejected': -0.39917612075805664, 'logits/chosen': -0.3723917603492737, 'epoch': 0.52}


  9%|▉         | 1410/16104 [6:35:25<64:06:22, 15.71s/it]

  9%|▉         | 1411/16104 [6:35:38<60:22:48, 14.79s/it]

  9%|▉         | 1412/16104 [6:35:54<62:06:21, 15.22s/it]

  9%|▉         | 1413/16104 [6:36:07<58:43:01, 14.39s/it]

  9%|▉         | 1414/16104 [6:36:17<54:10:33, 13.28s/it]

  9%|▉         | 1415/16104 [6:36:31<54:43:11, 13.41s/it]
{'loss': 0.5871, 'learning_rate': 1.9825201482700107e-06, 'rewards/chosen': -0.9171397686004639, 'rewards/rejected': -1.059987187385559, 'rewards/accuracies': 0.625, 'rewards/margins': 0.14284747838974, 'policy_logps/rejected': -266.421875, 'policy_logps/chosen': -345.88909912109375, 'referece_logps/rejected': -255.822021484375, 'referece_logps/chosen': -336.71771240234375, 'logits/rejected': -0.06831979751586914, 'logits/chosen': -0.04932170361280441, 'epoch': 0.53}
[2024-04-07 19:43:36,058] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  9%|▉         | 1417/16104 [6:37:12<67:35:53, 16.57s/it]
[2024-04-07 19:43:52,714] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1418/16104 [6:37:22<60:26:55, 14.82s/it]

  9%|▉         | 1419/16104 [6:37:33<55:28:11, 13.60s/it]

  9%|▉         | 1420/16104 [6:37:48<56:42:47, 13.90s/it]

  9%|▉         | 1421/16104 [6:37:58<52:46:03, 12.94s/it]

  9%|▉         | 1422/16104 [6:38:12<52:55:40, 12.98s/it]

  9%|▉         | 1423/16104 [6:38:24<52:28:02, 12.87s/it]

  9%|▉         | 1424/16104 [6:38:41<56:51:28, 13.94s/it]

  9%|▉         | 1425/16104 [6:39:01<64:10:51, 15.74s/it]

  9%|▉         | 1426/16104 [6:39:18<66:29:14, 16.31s/it]

  9%|▉         | 1427/16104 [6:39:30<61:24:48, 15.06s/it]

  9%|▉         | 1428/16104 [6:39:42<57:33:46, 14.12s/it]

  9%|▉         | 1429/16104 [6:39:53<53:24:23, 13.10s/it]

  9%|▉         | 1430/16104 [6:40:14<62:42:27, 15.38s/it]

  9%|▉         | 1431/16104 [6:40:28<60:52:19, 14.93s/it]
{'loss': 0.6379, 'learning_rate': 1.981916007255773e-06, 'rewards/chosen': -0.6564210057258606, 'rewards/rejected': -1.5380926132202148, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8816716074943542, 'policy_logps/rejected': -313.8023681640625, 'policy_logps/chosen': -377.332275390625, 'referece_logps/rejected': -298.42144775390625, 'referece_logps/chosen': -370.7680969238281, 'logits/rejected': -0.5133161544799805, 'logits/chosen': -0.4144648015499115, 'epoch': 0.53}


  9%|▉         | 1433/16104 [6:41:00<65:31:52, 16.08s/it]
[2024-04-07 19:47:41,323] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1434/16104 [6:41:20<70:07:57, 17.21s/it]

  9%|▉         | 1435/16104 [6:41:37<69:21:49, 17.02s/it]
[2024-04-07 19:48:17,756] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1436/16104 [6:41:47<61:38:46, 15.13s/it]

  9%|▉         | 1437/16104 [6:41:59<56:51:12, 13.95s/it]

  9%|▉         | 1438/16104 [6:42:18<63:23:53, 15.56s/it]

  9%|▉         | 1439/16104 [6:42:36<65:51:14, 16.17s/it]

  9%|▉         | 1440/16104 [6:42:48<61:03:00, 14.99s/it]
{'loss': 0.5925, 'learning_rate': 1.9815717090051804e-06, 'rewards/chosen': -0.5213456749916077, 'rewards/rejected': -1.1919060945510864, 'rewards/accuracies': 0.875, 'rewards/margins': 0.670560359954834, 'policy_logps/rejected': -335.6052551269531, 'policy_logps/chosen': -335.67340087890625, 'referece_logps/rejected': -323.6861877441406, 'referece_logps/chosen': -330.4599304199219, 'logits/rejected': -0.1009349375963211, 'logits/chosen': 0.053111836314201355, 'epoch': 0.54}

  9%|▉         | 1441/16104 [6:43:07<66:39:25, 16.37s/it]

  9%|▉         | 1442/16104 [6:43:26<68:54:15, 16.92s/it]


  9%|▉         | 1444/16104 [6:43:50<59:03:38, 14.50s/it]

  9%|▉         | 1445/16104 [6:44:12<68:54:19, 16.92s/it]

  9%|▉         | 1446/16104 [6:44:32<72:25:48, 17.79s/it]

  9%|▉         | 1447/16104 [6:44:47<68:45:53, 16.89s/it]

  9%|▉         | 1448/16104 [6:45:01<64:49:06, 15.92s/it]

  9%|▉         | 1449/16104 [6:45:17<65:40:37, 16.13s/it]

  9%|▉         | 1450/16104 [6:45:36<69:13:17, 17.01s/it]
[2024-04-07 19:52:17,391] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1451/16104 [6:45:53<68:52:08, 16.92s/it]

  9%|▉         | 1452/16104 [6:46:08<66:31:49, 16.35s/it]

  9%|▉         | 1453/16104 [6:46:22<63:28:40, 15.60s/it]

  9%|▉         | 1454/16104 [6:46:44<71:54:36, 17.67s/it]

  9%|▉         | 1455/16104 [6:46:56<64:15:50, 15.79s/it]

  9%|▉         | 1456/16104 [6:47:11<62:59:00, 15.48s/it]

  9%|▉         | 1457/16104 [6:47:31<68:52:44, 16.93s/it]

  9%|▉         | 1458/16104 [6:47:52<73:48:23, 18.14s/it]
[2024-04-07 19:54:32,921] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1459/16104 [6:48:06<69:15:41, 17.03s/it]
[2024-04-07 19:54:47,343] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1460/16104 [6:48:26<73:08:18, 17.98s/it]

  9%|▉         | 1461/16104 [6:48:44<72:34:49, 17.84s/it]
{'loss': 0.6583, 'learning_rate': 1.9807558409003376e-06, 'rewards/chosen': -1.5852558612823486, 'rewards/rejected': -1.152001976966858, 'rewards/accuracies': 0.25, 'rewards/margins': -0.43325385451316833, 'policy_logps/rejected': -465.4136047363281, 'policy_logps/chosen': -446.4476623535156, 'referece_logps/rejected': -453.89361572265625, 'referece_logps/chosen': -430.5951232910156, 'logits/rejected': -0.4761481285095215, 'logits/chosen': -0.05989360064268112, 'epoch': 0.54}


  9%|▉         | 1463/16104 [6:49:25<78:35:13, 19.32s/it]

  9%|▉         | 1464/16104 [6:49:47<81:24:58, 20.02s/it]
{'loss': 0.5854, 'learning_rate': 1.9806378597330256e-06, 'rewards/chosen': -0.6529264450073242, 'rewards/rejected': -0.9877021908760071, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3347756862640381, 'policy_logps/rejected': -262.0683288574219, 'policy_logps/chosen': -312.4931945800781, 'referece_logps/rejected': -252.1913299560547, 'referece_logps/chosen': -305.9639587402344, 'logits/rejected': 0.3113771677017212, 'logits/chosen': 0.39877456426620483, 'epoch': 0.55}


  9%|▉         | 1466/16104 [6:50:21<76:20:32, 18.78s/it]

  9%|▉         | 1467/16104 [6:50:37<72:34:24, 17.85s/it]

  9%|▉         | 1468/16104 [6:50:49<66:05:03, 16.25s/it]

  9%|▉         | 1469/16104 [6:51:10<71:45:32, 17.65s/it]
[2024-04-07 19:57:51,375] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1470/16104 [6:51:23<66:15:12, 16.30s/it]

  9%|▉         | 1471/16104 [6:51:36<62:09:39, 15.29s/it]

  9%|▉         | 1472/16104 [6:51:53<63:57:32, 15.74s/it]

  9%|▉         | 1473/16104 [6:52:14<70:24:55, 17.33s/it]

  9%|▉         | 1474/16104 [6:52:36<75:33:30, 18.59s/it]
{'loss': 0.5313, 'learning_rate': 1.9802420109618028e-06, 'rewards/chosen': -1.2204687595367432, 'rewards/rejected': -1.3461726903915405, 'rewards/accuracies': 0.625, 'rewards/margins': 0.12570400536060333, 'policy_logps/rejected': -278.93408203125, 'policy_logps/chosen': -278.74041748046875, 'referece_logps/rejected': -265.4723815917969, 'referece_logps/chosen': -266.5357360839844, 'logits/rejected': -0.9223209619522095, 'logits/chosen': -0.8510808348655701, 'epoch': 0.55}


  9%|▉         | 1476/16104 [6:53:06<69:08:12, 17.01s/it]

  9%|▉         | 1477/16104 [6:53:21<66:40:23, 16.41s/it]

  9%|▉         | 1478/16104 [6:53:39<68:28:34, 16.85s/it]

  9%|▉         | 1479/16104 [6:53:56<68:12:02, 16.79s/it]

  9%|▉         | 1480/16104 [6:54:15<71:26:48, 17.59s/it]
{'loss': 0.65, 'learning_rate': 1.9800025982747034e-06, 'rewards/chosen': -1.5907756090164185, 'rewards/rejected': -2.1555991172790527, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5648233890533447, 'policy_logps/rejected': -366.7120361328125, 'policy_logps/chosen': -547.9369506835938, 'referece_logps/rejected': -345.1560363769531, 'referece_logps/chosen': -532.0291748046875, 'logits/rejected': 0.2846255600452423, 'logits/chosen': 0.28851965069770813, 'epoch': 0.55}


  9%|▉         | 1482/16104 [6:54:45<65:28:46, 16.12s/it]
{'loss': 0.6103, 'learning_rate': 1.9799224768855993e-06, 'rewards/chosen': -0.44292259216308594, 'rewards/rejected': -0.7149332165718079, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2720106244087219, 'policy_logps/rejected': -314.89227294921875, 'policy_logps/chosen': -317.79803466796875, 'referece_logps/rejected': -307.7429504394531, 'referece_logps/chosen': -313.36883544921875, 'logits/rejected': -0.6369136571884155, 'logits/chosen': -0.5696525573730469, 'epoch': 0.55}

  9%|▉         | 1483/16104 [6:54:57<59:28:07, 14.64s/it]

  9%|▉         | 1484/16104 [6:55:12<60:36:38, 14.92s/it]

  9%|▉         | 1485/16104 [6:55:33<67:29:02, 16.62s/it]


  9%|▉         | 1487/16104 [6:56:12<73:44:40, 18.16s/it]
{'loss': 0.6281, 'learning_rate': 1.9797214797480436e-06, 'rewards/chosen': -0.7547967433929443, 'rewards/rejected': -1.000201940536499, 'rewards/accuracies': 0.5, 'rewards/margins': 0.24540522694587708, 'policy_logps/rejected': -411.55157470703125, 'policy_logps/chosen': -387.8835144042969, 'referece_logps/rejected': -401.549560546875, 'referece_logps/chosen': -380.3355407714844, 'logits/rejected': -0.5449970364570618, 'logits/chosen': -0.5992878675460815, 'epoch': 0.55}


  9%|▉         | 1489/16104 [6:56:43<69:47:37, 17.19s/it]

  9%|▉         | 1490/16104 [6:57:01<70:50:57, 17.45s/it]

  9%|▉         | 1491/16104 [6:57:16<67:29:51, 16.63s/it]

  9%|▉         | 1492/16104 [6:57:36<71:30:30, 17.62s/it]
{'loss': 0.5247, 'learning_rate': 1.979519491823514e-06, 'rewards/chosen': -0.646919310092926, 'rewards/rejected': -1.6529979705810547, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0060787200927734, 'policy_logps/rejected': -464.3613586425781, 'policy_logps/chosen': -442.594970703125, 'referece_logps/rejected': -447.8314208984375, 'referece_logps/chosen': -436.1257629394531, 'logits/rejected': -0.9033952951431274, 'logits/chosen': -0.8183687925338745, 'epoch': 0.56}

  9%|▉         | 1493/16104 [6:57:49<66:00:37, 16.26s/it]


  9%|▉         | 1495/16104 [6:58:27<72:53:15, 17.96s/it]
{'loss': 0.6293, 'learning_rate': 1.9793978235759836e-06, 'rewards/chosen': -0.9796453714370728, 'rewards/rejected': -1.1901894807815552, 'rewards/accuracies': 0.625, 'rewards/margins': 0.21054404973983765, 'policy_logps/rejected': -409.768798828125, 'policy_logps/chosen': -355.72430419921875, 'referece_logps/rejected': -397.8668518066406, 'referece_logps/chosen': -345.92791748046875, 'logits/rejected': 0.319085955619812, 'logits/chosen': 0.2706516683101654, 'epoch': 0.56}


  9%|▉         | 1497/16104 [6:59:00<70:19:54, 17.33s/it]

  9%|▉         | 1498/16104 [6:59:20<73:57:56, 18.23s/it]

  9%|▉         | 1499/16104 [6:59:40<76:07:33, 18.76s/it]
{'loss': 0.5775, 'learning_rate': 1.979235044596176e-06, 'rewards/chosen': -0.7856605648994446, 'rewards/rejected': -0.702950119972229, 'rewards/accuracies': 0.375, 'rewards/margins': -0.08271046727895737, 'policy_logps/rejected': -197.1223602294922, 'policy_logps/chosen': -416.834228515625, 'referece_logps/rejected': -190.09286499023438, 'referece_logps/chosen': -408.9776306152344, 'logits/rejected': -0.4901063144207001, 'logits/chosen': -0.4517291486263275, 'epoch': 0.56}


  9%|▉         | 1501/16104 [7:00:36<98:03:55, 24.18s/it]

  9%|▉         | 1502/16104 [7:00:58<95:31:23, 23.55s/it]
{'loss': 0.4682, 'learning_rate': 1.979112544431613e-06, 'rewards/chosen': -0.6304987072944641, 'rewards/rejected': -0.9735367298126221, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3430379629135132, 'policy_logps/rejected': -379.2825622558594, 'policy_logps/chosen': -383.2132263183594, 'referece_logps/rejected': -369.5472106933594, 'referece_logps/chosen': -376.9082336425781, 'logits/rejected': -0.16076712310314178, 'logits/chosen': -0.07784846425056458, 'epoch': 0.56}


  9%|▉         | 1504/16104 [7:01:29<78:30:31, 19.36s/it]

  9%|▉         | 1505/16104 [7:01:46<74:53:31, 18.47s/it]
{'loss': 0.5897, 'learning_rate': 1.978989687805412e-06, 'rewards/chosen': -0.5060101747512817, 'rewards/rejected': -0.8399823904037476, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3339722454547882, 'policy_logps/rejected': -324.5997009277344, 'policy_logps/chosen': -319.9897155761719, 'referece_logps/rejected': -316.1999206542969, 'referece_logps/chosen': -314.9295959472656, 'logits/rejected': -0.3101924657821655, 'logits/chosen': -0.4250047504901886, 'epoch': 0.56}


  9%|▉         | 1507/16104 [7:02:24<76:20:30, 18.83s/it]

  9%|▉         | 1508/16104 [7:02:40<72:42:36, 17.93s/it]
{'loss': 0.5207, 'learning_rate': 1.9788664747623017e-06, 'rewards/chosen': -0.8091444373130798, 'rewards/rejected': -1.048338770866394, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23919439315795898, 'policy_logps/rejected': -372.8964538574219, 'policy_logps/chosen': -450.0048828125, 'referece_logps/rejected': -362.4130554199219, 'referece_logps/chosen': -441.9134521484375, 'logits/rejected': -0.7858083248138428, 'logits/chosen': -0.867088794708252, 'epoch': 0.56}

  9%|▉         | 1509/16104 [7:02:59<73:48:49, 18.21s/it]
[2024-04-07 20:10:02,058] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


  9%|▉         | 1511/16104 [7:03:38<76:19:12, 18.83s/it]
[2024-04-07 20:10:19,430] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

  9%|▉         | 1512/16104 [7:03:58<77:10:59, 19.04s/it]
{'loss': 0.5748, 'learning_rate': 1.978701636356069e-06, 'rewards/chosen': -0.7172243595123291, 'rewards/rejected': -1.1761119365692139, 'rewards/accuracies': 0.75, 'rewards/margins': 0.45888763666152954, 'policy_logps/rejected': -221.10458374023438, 'policy_logps/chosen': -346.6156005859375, 'referece_logps/rejected': -209.3434600830078, 'referece_logps/chosen': -339.443359375, 'logits/rejected': -0.16385583579540253, 'logits/chosen': -0.048327505588531494, 'epoch': 0.56}

  9%|▉         | 1513/16104 [7:04:17<77:40:30, 19.16s/it]

  9%|▉         | 1514/16104 [7:04:29<68:49:49, 16.98s/it]


  9%|▉         | 1516/16104 [7:04:58<63:58:05, 15.79s/it]
{'loss': 0.5297, 'learning_rate': 1.9785361645062255e-06, 'rewards/chosen': -0.6899192333221436, 'rewards/rejected': -1.1929771900177002, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5030579566955566, 'policy_logps/rejected': -403.8138427734375, 'policy_logps/chosen': -352.7842102050781, 'referece_logps/rejected': -391.884033203125, 'referece_logps/chosen': -345.88507080078125, 'logits/rejected': -0.7721549272537231, 'logits/chosen': -0.6460846662521362, 'epoch': 0.56}

  9%|▉         | 1517/16104 [7:05:13<62:58:13, 15.54s/it]


  9%|▉         | 1519/16104 [7:05:44<63:41:06, 15.72s/it]

  9%|▉         | 1520/16104 [7:06:02<66:38:10, 16.45s/it]

  9%|▉         | 1521/16104 [7:06:20<67:28:14, 16.66s/it]

  9%|▉         | 1522/16104 [7:06:38<69:43:30, 17.21s/it]

  9%|▉         | 1523/16104 [7:06:58<72:39:44, 17.94s/it]

  9%|▉         | 1524/16104 [7:07:12<68:12:50, 16.84s/it]

  9%|▉         | 1525/16104 [7:07:31<70:11:11, 17.33s/it]
{'loss': 0.5829, 'learning_rate': 1.9781615373712737e-06, 'rewards/chosen': -0.9284902811050415, 'rewards/rejected': -1.915297508239746, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9868071675300598, 'policy_logps/rejected': -425.89984130859375, 'policy_logps/chosen': -469.81793212890625, 'referece_logps/rejected': -406.7468566894531, 'referece_logps/chosen': -460.5329895019531, 'logits/rejected': -1.2674857378005981, 'logits/chosen': -1.2835246324539185, 'epoch': 0.57}


  9%|▉         | 1527/16104 [7:08:04<70:20:19, 17.37s/it]

  9%|▉         | 1528/16104 [7:08:23<72:13:27, 17.84s/it]

  9%|▉         | 1529/16104 [7:08:44<76:06:49, 18.80s/it]

 10%|▉         | 1530/16104 [7:08:56<67:49:07, 16.75s/it]
{'loss': 0.5143, 'learning_rate': 1.9779520262132657e-06, 'rewards/chosen': -0.7402651309967041, 'rewards/rejected': -1.1254404783248901, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3851754069328308, 'policy_logps/rejected': -469.2127685546875, 'policy_logps/chosen': -561.6500244140625, 'referece_logps/rejected': -457.9583740234375, 'referece_logps/chosen': -554.2473754882812, 'logits/rejected': -0.353985458612442, 'logits/chosen': -0.4086257219314575, 'epoch': 0.57}


 10%|▉         | 1532/16104 [7:09:39<77:44:44, 19.21s/it]
{'loss': 0.4929, 'learning_rate': 1.977867944818854e-06, 'rewards/chosen': -0.7016053795814514, 'rewards/rejected': -1.6300458908081055, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9284403324127197, 'policy_logps/rejected': -397.1959228515625, 'policy_logps/chosen': -448.10760498046875, 'referece_logps/rejected': -380.89544677734375, 'referece_logps/chosen': -441.091552734375, 'logits/rejected': -0.5346510410308838, 'logits/chosen': -0.7160155773162842, 'epoch': 0.57}


 10%|▉         | 1534/16104 [7:10:18<79:18:41, 19.60s/it]
{'loss': 0.5883, 'learning_rate': 1.97778370519843e-06, 'rewards/chosen': -0.7052513957023621, 'rewards/rejected': -1.8733454942703247, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1680941581726074, 'policy_logps/rejected': -414.5335998535156, 'policy_logps/chosen': -510.2021179199219, 'referece_logps/rejected': -395.8001403808594, 'referece_logps/chosen': -503.1495361328125, 'logits/rejected': -0.14113333821296692, 'logits/chosen': -0.2336626499891281, 'epoch': 0.57}


 10%|▉         | 1536/16104 [7:10:53<75:22:48, 18.63s/it]
[2024-04-07 20:17:33,596] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|▉         | 1537/16104 [7:11:10<74:24:50, 18.39s/it]

 10%|▉         | 1538/16104 [7:11:23<67:19:33, 16.64s/it]
{'loss': 0.534, 'learning_rate': 1.9776147513340954e-06, 'rewards/chosen': -0.4439801573753357, 'rewards/rejected': -0.8208621740341187, 'rewards/accuracies': 0.75, 'rewards/margins': 0.37688207626342773, 'policy_logps/rejected': -381.53875732421875, 'policy_logps/chosen': -396.6907958984375, 'referece_logps/rejected': -373.33013916015625, 'referece_logps/chosen': -392.2509765625, 'logits/rejected': -1.3667742013931274, 'logits/chosen': -1.4426699876785278, 'epoch': 0.57}


 10%|▉         | 1540/16104 [7:11:57<69:33:00, 17.19s/it]
{'loss': 0.6093, 'learning_rate': 1.977530037117522e-06, 'rewards/chosen': -0.758920431137085, 'rewards/rejected': -1.1592421531677246, 'rewards/accuracies': 0.5, 'rewards/margins': 0.40032169222831726, 'policy_logps/rejected': -289.2657165527344, 'policy_logps/chosen': -582.8604736328125, 'referece_logps/rejected': -277.6733093261719, 'referece_logps/chosen': -575.2713012695312, 'logits/rejected': -0.19276461005210876, 'logits/chosen': -0.3789213001728058, 'epoch': 0.57}


 10%|▉         | 1542/16104 [7:12:31<70:00:21, 17.31s/it]
{'loss': 0.5963, 'learning_rate': 1.9774451647296124e-06, 'rewards/chosen': -0.9766210317611694, 'rewards/rejected': -1.5004770755767822, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5238560438156128, 'policy_logps/rejected': -352.338134765625, 'policy_logps/chosen': -241.80859375, 'referece_logps/rejected': -337.3333740234375, 'referece_logps/chosen': -232.04238891601562, 'logits/rejected': -0.8973723649978638, 'logits/chosen': -0.8137309551239014, 'epoch': 0.57}

 10%|▉         | 1543/16104 [7:12:43<64:18:45, 15.90s/it]


 10%|▉         | 1545/16104 [7:13:20<69:34:37, 17.20s/it]

 10%|▉         | 1546/16104 [7:13:32<62:52:58, 15.55s/it]

 10%|▉         | 1547/16104 [7:13:57<73:46:43, 18.25s/it]
{'loss': 0.5132, 'learning_rate': 1.97723229185043e-06, 'rewards/chosen': -0.8959622383117676, 'rewards/rejected': -1.339103102684021, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4431409239768982, 'policy_logps/rejected': -406.2306823730469, 'policy_logps/chosen': -452.1002197265625, 'referece_logps/rejected': -392.8396301269531, 'referece_logps/chosen': -443.14056396484375, 'logits/rejected': -0.3830055594444275, 'logits/chosen': -0.4138321578502655, 'epoch': 0.58}


 10%|▉         | 1549/16104 [7:14:30<71:10:25, 17.60s/it]
{'loss': 0.5911, 'learning_rate': 1.9771468659711594e-06, 'rewards/chosen': -0.8679821491241455, 'rewards/rejected': -1.4923923015594482, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6244102120399475, 'policy_logps/rejected': -327.9436340332031, 'policy_logps/chosen': -333.0424499511719, 'referece_logps/rejected': -313.01971435546875, 'referece_logps/chosen': -324.3626403808594, 'logits/rejected': 0.699070930480957, 'logits/chosen': 0.7678717970848083, 'epoch': 0.58}
[2024-04-07 20:21:32,626] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|▉         | 1550/16104 [7:14:52<75:27:10, 18.66s/it]

 10%|▉         | 1551/16104 [7:15:16<82:06:16, 20.31s/it]
[2024-04-07 20:22:18,827] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|▉         | 1552/16104 [7:15:38<84:12:26, 20.83s/it]
[2024-04-07 20:22:40,656] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 10%|▉         | 1554/16104 [7:16:19<83:33:11, 20.67s/it]

 10%|▉         | 1555/16104 [7:16:37<80:24:12, 19.90s/it]
{'loss': 0.5846, 'learning_rate': 1.97688963973275e-06, 'rewards/chosen': -0.28090840578079224, 'rewards/rejected': -1.0403372049331665, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7594289183616638, 'policy_logps/rejected': -379.4118347167969, 'policy_logps/chosen': -395.9603271484375, 'referece_logps/rejected': -369.00848388671875, 'referece_logps/chosen': -393.1512451171875, 'logits/rejected': -0.7901545763015747, 'logits/chosen': -0.8359028100967407, 'epoch': 0.58}

 10%|▉         | 1556/16104 [7:17:00<83:12:51, 20.59s/it]

 10%|▉         | 1557/16104 [7:17:16<77:49:35, 19.26s/it]


 10%|▉         | 1559/16104 [7:17:47<70:40:44, 17.49s/it]
{'loss': 0.5768, 'learning_rate': 1.9767173652121113e-06, 'rewards/chosen': -0.674193263053894, 'rewards/rejected': -1.2916300296783447, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6174367666244507, 'policy_logps/rejected': -313.21466064453125, 'policy_logps/chosen': -322.66119384765625, 'referece_logps/rejected': -300.2983093261719, 'referece_logps/chosen': -315.9192810058594, 'logits/rejected': -0.10162900388240814, 'logits/chosen': -0.17687579989433289, 'epoch': 0.58}

 10%|▉         | 1560/16104 [7:18:03<69:05:43, 17.10s/it]

 10%|▉         | 1561/16104 [7:18:20<68:09:50, 16.87s/it]

 10%|▉         | 1562/16104 [7:18:32<62:44:59, 15.53s/it]


 10%|▉         | 1564/16104 [7:18:57<56:21:40, 13.95s/it]
{'loss': 0.646, 'learning_rate': 1.9765011331003554e-06, 'rewards/chosen': -0.7192246317863464, 'rewards/rejected': -1.171525239944458, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4523006081581116, 'policy_logps/rejected': -338.02447509765625, 'policy_logps/chosen': -397.1053771972656, 'referece_logps/rejected': -326.3092346191406, 'referece_logps/chosen': -389.9131164550781, 'logits/rejected': -1.0934622287750244, 'logits/chosen': -1.3885188102722168, 'epoch': 0.58}


 10%|▉         | 1566/16104 [7:19:21<52:18:57, 12.95s/it]

 10%|▉         | 1567/16104 [7:19:33<51:11:51, 12.68s/it]

 10%|▉         | 1568/16104 [7:19:53<60:44:14, 15.04s/it]
[2024-04-07 20:26:34,385] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.68, 'learning_rate': 1.9763274363786377e-06, 'rewards/chosen': -0.70094895362854, 'rewards/rejected': -1.2762784957885742, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5753295421600342, 'policy_logps/rejected': -458.63885498046875, 'policy_logps/chosen': -553.0510864257812, 'referece_logps/rejected': -445.8760681152344, 'referece_logps/chosen': -546.0416259765625, 'logits/rejected': -0.2159261703491211, 'logits/chosen': -0.18404006958007812, 'epoch': 0.58}


 10%|▉         | 1570/16104 [7:20:17<53:31:35, 13.26s/it]

 10%|▉         | 1571/16104 [7:20:29<51:50:24, 12.84s/it]
[2024-04-07 20:27:09,610] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|▉         | 1572/16104 [7:20:47<58:43:43, 14.55s/it]

 10%|▉         | 1573/16104 [7:21:03<60:15:15, 14.93s/it]
{'loss': 0.6019, 'learning_rate': 1.97610942687054e-06, 'rewards/chosen': -0.9695024490356445, 'rewards/rejected': -0.8127664923667908, 'rewards/accuracies': 0.375, 'rewards/margins': -0.15673598647117615, 'policy_logps/rejected': -475.44287109375, 'policy_logps/chosen': -590.4117431640625, 'referece_logps/rejected': -467.3152160644531, 'referece_logps/chosen': -580.7166748046875, 'logits/rejected': -0.38856232166290283, 'logits/chosen': -0.252221941947937, 'epoch': 0.59}
[2024-04-07 20:28:05,270] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 10%|▉         | 1575/16104 [7:21:35<60:27:38, 14.98s/it]
{'loss': 0.5696, 'learning_rate': 1.976021946657366e-06, 'rewards/chosen': -0.6207212209701538, 'rewards/rejected': -1.1158086061477661, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4950873851776123, 'policy_logps/rejected': -364.4116516113281, 'policy_logps/chosen': -434.67962646484375, 'referece_logps/rejected': -353.2535400390625, 'referece_logps/chosen': -428.47247314453125, 'logits/rejected': -0.19399549067020416, 'logits/chosen': -0.24781890213489532, 'epoch': 0.59}

 10%|▉         | 1576/16104 [7:21:56<67:40:57, 16.77s/it]


 10%|▉         | 1578/16104 [7:22:33<70:34:09, 17.49s/it]

 10%|▉         | 1579/16104 [7:22:53<73:12:02, 18.14s/it]

 10%|▉         | 1580/16104 [7:23:13<75:59:14, 18.83s/it]
{'loss': 0.5816, 'learning_rate': 1.9758025552234497e-06, 'rewards/chosen': -0.9198877215385437, 'rewards/rejected': -1.2767325639724731, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3568447530269623, 'policy_logps/rejected': -321.3963317871094, 'policy_logps/chosen': -382.85614013671875, 'referece_logps/rejected': -308.6290283203125, 'referece_logps/chosen': -373.6572265625, 'logits/rejected': -0.8533269166946411, 'logits/chosen': -0.7198678255081177, 'epoch': 0.59}


 10%|▉         | 1582/16104 [7:23:55<79:57:23, 19.82s/it]

 10%|▉         | 1583/16104 [7:24:15<80:48:26, 20.03s/it]

 10%|▉         | 1584/16104 [7:24:33<78:06:54, 19.37s/it]

 10%|▉         | 1585/16104 [7:24:53<78:35:26, 19.49s/it]
{'loss': 0.5834, 'learning_rate': 1.9755821769657462e-06, 'rewards/chosen': -0.8450314402580261, 'rewards/rejected': -1.9699686765670776, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1249372959136963, 'policy_logps/rejected': -436.84906005859375, 'policy_logps/chosen': -354.230224609375, 'referece_logps/rejected': -417.1493835449219, 'referece_logps/chosen': -345.7799072265625, 'logits/rejected': 0.6184993386268616, 'logits/chosen': 0.6284505128860474, 'epoch': 0.59}


 10%|▉         | 1587/16104 [7:25:23<69:53:22, 17.33s/it]

 10%|▉         | 1588/16104 [7:25:39<68:01:40, 16.87s/it]

 10%|▉         | 1589/16104 [7:25:58<70:01:47, 17.37s/it]
{'loss': 0.4996, 'learning_rate': 1.9754051639961907e-06, 'rewards/chosen': -0.7526289820671082, 'rewards/rejected': -1.3065050840377808, 'rewards/accuracies': 1.0, 'rewards/margins': 0.5538763403892517, 'policy_logps/rejected': -489.0444641113281, 'policy_logps/chosen': -550.0875244140625, 'referece_logps/rejected': -475.97943115234375, 'referece_logps/chosen': -542.5611572265625, 'logits/rejected': 0.23977971076965332, 'logits/chosen': 0.034611523151397705, 'epoch': 0.59}


 10%|▉         | 1591/16104 [7:26:38<74:36:20, 18.51s/it]

 10%|▉         | 1592/16104 [7:26:56<74:11:19, 18.40s/it]
{'loss': 0.5953, 'learning_rate': 1.9752719899655294e-06, 'rewards/chosen': -1.5226173400878906, 'rewards/rejected': -2.3485705852508545, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8259531855583191, 'policy_logps/rejected': -466.61566162109375, 'policy_logps/chosen': -343.2342224121094, 'referece_logps/rejected': -443.1299743652344, 'referece_logps/chosen': -328.0080261230469, 'logits/rejected': -0.2090262472629547, 'logits/chosen': -0.18172964453697205, 'epoch': 0.59}

 10%|▉         | 1593/16104 [7:27:16<76:28:09, 18.97s/it]

 10%|▉         | 1594/16104 [7:27:29<68:43:07, 17.05s/it]

 10%|▉         | 1595/16104 [7:27:49<72:42:50, 18.04s/it]

 10%|▉         | 1596/16104 [7:28:07<73:14:26, 18.17s/it]

 10%|▉         | 1597/16104 [7:28:19<65:34:53, 16.27s/it]


 10%|▉         | 1599/16104 [7:28:48<61:45:35, 15.33s/it]
{'loss': 0.6247, 'learning_rate': 1.9749598698424994e-06, 'rewards/chosen': -0.5849847197532654, 'rewards/rejected': -0.6770302057266235, 'rewards/accuracies': 0.625, 'rewards/margins': 0.09204547852277756, 'policy_logps/rejected': -315.7220458984375, 'policy_logps/chosen': -279.77972412109375, 'referece_logps/rejected': -308.95172119140625, 'referece_logps/chosen': -273.92987060546875, 'logits/rejected': -0.34133997559547424, 'logits/chosen': -0.22050797939300537, 'epoch': 0.6}


 10%|▉         | 1601/16104 [7:29:12<54:51:25, 13.62s/it]

 10%|▉         | 1602/16104 [7:29:28<57:17:11, 14.22s/it]
{'loss': 0.6016, 'learning_rate': 1.9748255124563745e-06, 'rewards/chosen': -0.529092013835907, 'rewards/rejected': -1.94214928150177, 'rewards/accuracies': 0.625, 'rewards/margins': 1.413057565689087, 'policy_logps/rejected': -438.3097839355469, 'policy_logps/chosen': -436.3642578125, 'referece_logps/rejected': -418.88824462890625, 'referece_logps/chosen': -431.0733337402344, 'logits/rejected': -0.883803129196167, 'logits/chosen': -0.8954644203186035, 'epoch': 0.6}

 10%|▉         | 1603/16104 [7:29:49<66:05:04, 16.41s/it]


 10%|▉         | 1605/16104 [7:30:22<66:40:52, 16.56s/it]

 10%|▉         | 1606/16104 [7:30:42<70:46:18, 17.57s/it]

 10%|▉         | 1607/16104 [7:30:54<64:14:35, 15.95s/it]
{'loss': 0.594, 'learning_rate': 1.974600794835105e-06, 'rewards/chosen': -0.7255004644393921, 'rewards/rejected': -1.4191679954528809, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6936675310134888, 'policy_logps/rejected': -356.8016052246094, 'policy_logps/chosen': -298.8834533691406, 'referece_logps/rejected': -342.60992431640625, 'referece_logps/chosen': -291.6284484863281, 'logits/rejected': -0.7349176406860352, 'logits/chosen': -0.6702779531478882, 'epoch': 0.6}

 10%|▉         | 1608/16104 [7:31:08<62:15:11, 15.46s/it]


 10%|▉         | 1610/16104 [7:31:38<59:53:21, 14.88s/it]
{'loss': 0.5684, 'learning_rate': 1.9744654911556997e-06, 'rewards/chosen': -0.7988579869270325, 'rewards/rejected': -1.1135731935501099, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3147152066230774, 'policy_logps/rejected': -274.4353332519531, 'policy_logps/chosen': -250.9435272216797, 'referece_logps/rejected': -263.29962158203125, 'referece_logps/chosen': -242.9549560546875, 'logits/rejected': -1.0750948190689087, 'logits/chosen': -0.9286926984786987, 'epoch': 0.6}

 10%|█         | 1611/16104 [7:31:58<65:36:41, 16.30s/it]

 10%|█         | 1612/16104 [7:32:08<58:51:57, 14.62s/it]

 10%|█         | 1613/16104 [7:32:19<54:07:33, 13.45s/it]

 10%|█         | 1614/16104 [7:32:37<59:45:48, 14.85s/it]


 10%|█         | 1616/16104 [7:33:06<60:11:35, 14.96s/it]
{'loss': 0.4525, 'learning_rate': 1.974193819536869e-06, 'rewards/chosen': -0.5823177099227905, 'rewards/rejected': -2.192633867263794, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6103163957595825, 'policy_logps/rejected': -379.6097717285156, 'policy_logps/chosen': -489.12689208984375, 'referece_logps/rejected': -357.6834716796875, 'referece_logps/chosen': -483.3037109375, 'logits/rejected': -1.003306269645691, 'logits/chosen': -0.7302236557006836, 'epoch': 0.6}

 10%|█         | 1617/16104 [7:33:24<63:19:38, 15.74s/it]

 10%|█         | 1618/16104 [7:33:38<61:12:31, 15.21s/it]

 10%|█         | 1619/16104 [7:33:54<62:10:45, 15.45s/it]

 10%|█         | 1620/16104 [7:34:09<62:15:43, 15.48s/it]


 10%|█         | 1622/16104 [7:34:42<63:53:09, 15.88s/it]

 10%|█         | 1623/16104 [7:35:02<68:58:24, 17.15s/it]
{'loss': 0.4799, 'learning_rate': 1.973875076284537e-06, 'rewards/chosen': -1.0133923292160034, 'rewards/rejected': -1.8634922504425049, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8500999212265015, 'policy_logps/rejected': -399.2338562011719, 'policy_logps/chosen': -295.12445068359375, 'referece_logps/rejected': -380.598876953125, 'referece_logps/chosen': -284.99053955078125, 'logits/rejected': -0.8736404180526733, 'logits/chosen': -0.736099362373352, 'epoch': 0.6}

 10%|█         | 1624/16104 [7:35:15<63:37:22, 15.82s/it]

 10%|█         | 1625/16104 [7:35:28<59:42:10, 14.84s/it]

 10%|█         | 1626/16104 [7:35:47<65:20:32, 16.25s/it]

 10%|█         | 1627/16104 [7:36:00<60:48:11, 15.12s/it]


 10%|█         | 1629/16104 [7:36:38<68:59:09, 17.16s/it]
{'loss': 0.5475, 'learning_rate': 1.973600331354334e-06, 'rewards/chosen': -0.7666634917259216, 'rewards/rejected': -1.6367592811584473, 'rewards/accuracies': 1.0, 'rewards/margins': 0.8700956702232361, 'policy_logps/rejected': -375.960205078125, 'policy_logps/chosen': -423.53314208984375, 'referece_logps/rejected': -359.5926818847656, 'referece_logps/chosen': -415.86651611328125, 'logits/rejected': -0.18819603323936462, 'logits/chosen': -0.08422321081161499, 'epoch': 0.61}
[2024-04-07 20:43:40,208] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|█         | 1630/16104 [7:36:59<73:41:41, 18.33s/it]
[2024-04-07 20:43:54,235] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|█         | 1631/16104 [7:37:13<68:30:01, 17.04s/it]

 10%|█         | 1632/16104 [7:37:28<65:14:13, 16.23s/it]

 10%|█         | 1633/16104 [7:37:47<68:49:59, 17.12s/it]

 10%|█         | 1634/16104 [7:38:07<73:01:30, 18.17s/it]

 10%|█         | 1635/16104 [7:38:23<69:43:42, 17.35s/it]


 10%|█         | 1637/16104 [7:38:58<72:02:22, 17.93s/it]
{'loss': 0.5874, 'learning_rate': 1.973231799353677e-06, 'rewards/chosen': -0.9152967929840088, 'rewards/rejected': -1.7753435373306274, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8600466847419739, 'policy_logps/rejected': -325.0014343261719, 'policy_logps/chosen': -301.95147705078125, 'referece_logps/rejected': -307.2480163574219, 'referece_logps/chosen': -292.79852294921875, 'logits/rejected': -0.9174941778182983, 'logits/chosen': -0.8680194020271301, 'epoch': 0.61}

 10%|█         | 1638/16104 [7:39:16<71:30:31, 17.80s/it]
[2024-04-07 20:46:18,240] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 10%|█         | 1639/16104 [7:39:37<75:38:12, 18.82s/it]

 10%|█         | 1640/16104 [7:39:51<70:10:27, 17.47s/it]

 10%|█         | 1641/16104 [7:40:10<71:26:21, 17.78s/it]

 10%|█         | 1642/16104 [7:40:27<71:03:11, 17.69s/it]

 10%|█         | 1643/16104 [7:40:46<71:32:03, 17.81s/it]


 10%|█         | 1645/16104 [7:41:15<65:48:00, 16.38s/it]

 10%|█         | 1646/16104 [7:41:35<70:28:32, 17.55s/it]

 10%|█         | 1647/16104 [7:41:48<65:37:04, 16.34s/it]

 10%|█         | 1648/16104 [7:42:05<65:39:50, 16.35s/it]
{'loss': 0.5435, 'learning_rate': 1.9727209539928694e-06, 'rewards/chosen': -0.809558093547821, 'rewards/rejected': -1.3454852104187012, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5359269976615906, 'policy_logps/rejected': -369.1820373535156, 'policy_logps/chosen': -315.7875671386719, 'referece_logps/rejected': -355.7271728515625, 'referece_logps/chosen': -307.69195556640625, 'logits/rejected': -1.3820923566818237, 'logits/chosen': -1.2998478412628174, 'epoch': 0.61}

 10%|█         | 1649/16104 [7:42:20<63:57:00, 15.93s/it]

 10%|█         | 1650/16104 [7:42:40<69:02:16, 17.20s/it]


 10%|█         | 1652/16104 [7:43:17<72:17:24, 18.01s/it]
{'loss': 0.5334, 'learning_rate': 1.972534011462784e-06, 'rewards/chosen': -0.5903854966163635, 'rewards/rejected': -0.9958082437515259, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4054226577281952, 'policy_logps/rejected': -355.653076171875, 'policy_logps/chosen': -394.27227783203125, 'referece_logps/rejected': -345.69500732421875, 'referece_logps/chosen': -388.3684387207031, 'logits/rejected': -0.6244250535964966, 'logits/chosen': -0.65297931432724, 'epoch': 0.62}


 10%|█         | 1654/16104 [7:43:49<67:06:38, 16.72s/it]

 10%|█         | 1655/16104 [7:44:09<70:45:19, 17.63s/it]

 10%|█         | 1656/16104 [7:44:29<73:56:48, 18.43s/it]

 10%|█         | 1657/16104 [7:44:45<71:09:09, 17.73s/it]
{'loss': 0.6295, 'learning_rate': 1.9722994481478744e-06, 'rewards/chosen': -1.181156039237976, 'rewards/rejected': -1.3328968286514282, 'rewards/accuracies': 0.625, 'rewards/margins': 0.15174081921577454, 'policy_logps/rejected': -348.5432434082031, 'policy_logps/chosen': -454.2912902832031, 'referece_logps/rejected': -335.21429443359375, 'referece_logps/chosen': -442.47967529296875, 'logits/rejected': -0.4864021837711334, 'logits/chosen': -0.502478837966919, 'epoch': 0.62}

 10%|█         | 1658/16104 [7:45:02<70:28:52, 17.56s/it]

 10%|█         | 1659/16104 [7:45:19<69:55:13, 17.43s/it]

 10%|█         | 1660/16104 [7:45:36<68:57:51, 17.19s/it]

 10%|█         | 1661/16104 [7:45:47<61:06:47, 15.23s/it]


 10%|█         | 1663/16104 [7:46:17<61:01:34, 15.21s/it]
{'loss': 0.5798, 'learning_rate': 1.972016674259857e-06, 'rewards/chosen': -0.6731083393096924, 'rewards/rejected': -1.0321528911590576, 'rewards/accuracies': 0.875, 'rewards/margins': 0.3590445816516876, 'policy_logps/rejected': -522.92236328125, 'policy_logps/chosen': -474.83831787109375, 'referece_logps/rejected': -512.6008911132812, 'referece_logps/chosen': -468.10723876953125, 'logits/rejected': -0.5307920575141907, 'logits/chosen': -0.6024298667907715, 'epoch': 0.62}

 10%|█         | 1664/16104 [7:46:38<67:43:31, 16.88s/it]


 10%|█         | 1666/16104 [7:47:03<60:10:53, 15.01s/it]
{'loss': 0.6766, 'learning_rate': 1.9718747564726715e-06, 'rewards/chosen': -1.129339575767517, 'rewards/rejected': -1.0567890405654907, 'rewards/accuracies': 0.5, 'rewards/margins': -0.07255056500434875, 'policy_logps/rejected': -381.2113952636719, 'policy_logps/chosen': -479.61737060546875, 'referece_logps/rejected': -370.64349365234375, 'referece_logps/chosen': -468.3239440917969, 'logits/rejected': 0.2664879560470581, 'logits/chosen': 0.21553650498390198, 'epoch': 0.62}

 10%|█         | 1667/16104 [7:47:16<57:34:13, 14.36s/it]

 10%|█         | 1668/16104 [7:47:28<54:30:31, 13.59s/it]

 10%|█         | 1669/16104 [7:47:48<61:51:51, 15.43s/it]

 10%|█         | 1670/16104 [7:47:58<56:12:37, 14.02s/it]

 10%|█         | 1671/16104 [7:48:15<59:58:58, 14.96s/it]

 10%|█         | 1672/16104 [7:48:26<54:52:25, 13.69s/it]

 10%|█         | 1673/16104 [7:48:37<51:09:46, 12.76s/it]

 10%|█         | 1674/16104 [7:48:48<48:42:31, 12.15s/it]

 10%|█         | 1675/16104 [7:48:58<47:01:06, 11.73s/it]

 10%|█         | 1676/16104 [7:49:14<51:48:46, 12.93s/it]

 10%|█         | 1677/16104 [7:49:29<54:10:10, 13.52s/it]

 10%|█         | 1678/16104 [7:49:48<60:41:52, 15.15s/it]

 10%|█         | 1679/16104 [7:50:03<60:33:46, 15.11s/it]

 10%|█         | 1680/16104 [7:50:19<61:40:01, 15.39s/it]

 10%|█         | 1681/16104 [7:50:33<59:53:33, 14.95s/it]

 10%|█         | 1682/16104 [7:50:50<62:08:45, 15.51s/it]

 10%|█         | 1683/16104 [7:51:06<63:27:42, 15.84s/it]

 10%|█         | 1684/16104 [7:51:18<59:03:20, 14.74s/it]

 10%|█         | 1685/16104 [7:51:39<65:44:52, 16.42s/it]

 10%|█         | 1686/16104 [7:52:00<71:45:43, 17.92s/it]

 10%|█         | 1687/16104 [7:52:18<71:56:44, 17.97s/it]

 10%|█         | 1688/16104 [7:52:38<74:03:03, 18.49s/it]


 10%|█         | 1690/16104 [7:53:20<77:32:14, 19.37s/it]
{'loss': 0.5111, 'learning_rate': 1.9707266807845467e-06, 'rewards/chosen': -0.31273162364959717, 'rewards/rejected': -1.2626439332962036, 'rewards/accuracies': 0.625, 'rewards/margins': 0.949912428855896, 'policy_logps/rejected': -225.75360107421875, 'policy_logps/chosen': -230.95849609375, 'referece_logps/rejected': -213.12718200683594, 'referece_logps/chosen': -227.83120727539062, 'logits/rejected': -0.38241514563560486, 'logits/chosen': -0.32623210549354553, 'epoch': 0.63}


 11%|█         | 1692/16104 [7:53:52<72:35:08, 18.13s/it]
[2024-04-07 21:00:32,558] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5011, 'learning_rate': 1.9706299864814865e-06, 'rewards/chosen': -1.0261178016662598, 'rewards/rejected': -1.711155891418457, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6850382089614868, 'policy_logps/rejected': -469.8934326171875, 'policy_logps/chosen': -380.21160888671875, 'referece_logps/rejected': -452.7818603515625, 'referece_logps/chosen': -369.950439453125, 'logits/rejected': -0.0024893879890441895, 'logits/chosen': 0.032619670033454895, 'epoch': 0.63}
[2024-04-07 21:00:47,794] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 1693/16104 [7:54:07<69:06:17, 17.26s/it]

 11%|█         | 1694/16104 [7:54:22<67:09:33, 16.78s/it]

 11%|█         | 1695/16104 [7:54:36<63:42:03, 15.92s/it]


 11%|█         | 1697/16104 [7:55:19<75:19:18, 18.82s/it]

 11%|█         | 1698/16104 [7:55:31<67:02:21, 16.75s/it]
{'loss': 0.5697, 'learning_rate': 1.970338961305864e-06, 'rewards/chosen': -0.670169472694397, 'rewards/rejected': -1.6232277154922485, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9530582427978516, 'policy_logps/rejected': -350.9254150390625, 'policy_logps/chosen': -414.0108337402344, 'referece_logps/rejected': -334.693115234375, 'referece_logps/chosen': -407.30914306640625, 'logits/rejected': -1.281154751777649, 'logits/chosen': -1.257807970046997, 'epoch': 0.63}

 11%|█         | 1699/16104 [7:55:45<63:38:21, 15.90s/it]
[2024-04-07 21:02:47,797] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 1700/16104 [7:56:07<70:13:50, 17.55s/it]
[2024-04-07 21:03:09,386] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 1701/16104 [7:56:28<75:04:15, 18.76s/it]

 11%|█         | 1702/16104 [7:56:48<76:39:58, 19.16s/it]

 11%|█         | 1703/16104 [7:57:05<73:59:25, 18.50s/it]

 11%|█         | 1704/16104 [7:57:20<69:46:13, 17.44s/it]

 11%|█         | 1705/16104 [7:57:39<71:37:55, 17.91s/it]

 11%|█         | 1706/16104 [7:57:59<73:58:31, 18.50s/it]

 11%|█         | 1707/16104 [7:58:22<79:08:50, 19.79s/it]

 11%|█         | 1708/16104 [7:58:40<76:39:18, 19.17s/it]

 11%|█         | 1709/16104 [7:58:53<69:43:27, 17.44s/it]

 11%|█         | 1710/16104 [7:59:12<71:57:37, 18.00s/it]

 11%|█         | 1711/16104 [7:59:31<72:15:28, 18.07s/it]
[2024-04-07 21:06:32,299] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 1712/16104 [7:59:51<75:13:11, 18.82s/it]

 11%|█         | 1713/16104 [8:00:10<74:44:22, 18.70s/it]

 11%|█         | 1714/16104 [8:00:29<75:58:27, 19.01s/it]

 11%|█         | 1715/16104 [8:00:49<76:37:48, 19.17s/it]


 11%|█         | 1717/16104 [8:01:25<72:41:08, 18.19s/it]

 11%|█         | 1718/16104 [8:01:43<72:42:44, 18.20s/it]

 11%|█         | 1719/16104 [8:02:00<71:18:57, 17.85s/it]

 11%|█         | 1720/16104 [8:02:22<76:33:32, 19.16s/it]

 11%|█         | 1721/16104 [8:02:38<72:32:13, 18.16s/it]

 11%|█         | 1722/16104 [8:02:54<70:17:30, 17.59s/it]

 11%|█         | 1723/16104 [8:03:09<67:38:23, 16.93s/it]

 11%|█         | 1724/16104 [8:03:26<67:22:55, 16.87s/it]

 11%|█         | 1725/16104 [8:03:38<61:52:48, 15.49s/it]

 11%|█         | 1726/16104 [8:03:54<62:11:03, 15.57s/it]

 11%|█         | 1727/16104 [8:04:09<60:44:26, 15.21s/it]

 11%|█         | 1728/16104 [8:04:22<58:35:26, 14.67s/it]

 11%|█         | 1729/16104 [8:04:33<53:49:27, 13.48s/it]

 11%|█         | 1730/16104 [8:04:50<58:03:42, 14.54s/it]

 11%|█         | 1731/16104 [8:05:08<62:12:04, 15.58s/it]

 11%|█         | 1732/16104 [8:05:20<58:49:02, 14.73s/it]

 11%|█         | 1733/16104 [8:05:32<55:28:35, 13.90s/it]

 11%|█         | 1734/16104 [8:05:48<57:37:29, 14.44s/it]

 11%|█         | 1735/16104 [8:05:59<52:58:42, 13.27s/it]

 11%|█         | 1736/16104 [8:06:12<52:44:34, 13.22s/it]

 11%|█         | 1737/16104 [8:06:32<60:32:30, 15.17s/it]

 11%|█         | 1738/16104 [8:06:54<69:47:36, 17.49s/it]

 11%|█         | 1739/16104 [8:07:12<69:59:48, 17.54s/it]

 11%|█         | 1740/16104 [8:07:28<68:38:39, 17.20s/it]

 11%|█         | 1741/16104 [8:07:46<69:05:47, 17.32s/it]

 11%|█         | 1742/16104 [8:07:59<63:31:55, 15.93s/it]

 11%|█         | 1743/16104 [8:08:20<69:57:16, 17.54s/it]

 11%|█         | 1744/16104 [8:08:38<70:46:25, 17.74s/it]

 11%|█         | 1745/16104 [8:08:58<73:12:21, 18.35s/it]

 11%|█         | 1746/16104 [8:09:18<74:40:38, 18.72s/it]

 11%|█         | 1747/16104 [8:09:32<69:01:44, 17.31s/it]

 11%|█         | 1748/16104 [8:09:49<68:33:36, 17.19s/it]

 11%|█         | 1749/16104 [8:10:00<61:17:36, 15.37s/it]

 11%|█         | 1750/16104 [8:10:10<55:40:38, 13.96s/it]
{'loss': 0.5954, 'learning_rate': 1.967757597150499e-06, 'rewards/chosen': -0.8461872339248657, 'rewards/rejected': -1.897043228149414, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0508559942245483, 'policy_logps/rejected': -328.1187744140625, 'policy_logps/chosen': -449.9299011230469, 'referece_logps/rejected': -309.1483154296875, 'referece_logps/chosen': -441.4680480957031, 'logits/rejected': -1.0027666091918945, 'logits/chosen': -1.0819191932678223, 'epoch': 0.65}


 11%|█         | 1752/16104 [8:10:43<61:21:36, 15.39s/it]

 11%|█         | 1753/16104 [8:11:00<64:12:16, 16.11s/it]

 11%|█         | 1754/16104 [8:11:16<64:03:38, 16.07s/it]

 11%|█         | 1755/16104 [8:11:30<61:05:35, 15.33s/it]

 11%|█         | 1756/16104 [8:11:41<55:33:03, 13.94s/it]

 11%|█         | 1757/16104 [8:11:51<51:36:40, 12.95s/it]

 11%|█         | 1758/16104 [8:12:07<54:33:48, 13.69s/it]

 11%|█         | 1759/16104 [8:12:17<50:57:38, 12.79s/it]

 11%|█         | 1760/16104 [8:12:36<57:22:15, 14.40s/it]

 11%|█         | 1761/16104 [8:12:48<54:43:14, 13.73s/it]

 11%|█         | 1762/16104 [8:13:02<55:44:40, 13.99s/it]

 11%|█         | 1763/16104 [8:13:27<68:51:58, 17.29s/it]

 11%|█         | 1764/16104 [8:13:45<69:12:23, 17.37s/it]

 11%|█         | 1765/16104 [8:14:02<68:50:07, 17.28s/it]

 11%|█         | 1766/16104 [8:14:13<60:53:02, 15.29s/it]

 11%|█         | 1767/16104 [8:14:23<55:21:41, 13.90s/it]

 11%|█         | 1768/16104 [8:14:35<52:43:35, 13.24s/it]

 11%|█         | 1769/16104 [8:14:47<51:07:13, 12.84s/it]

 11%|█         | 1770/16104 [8:15:00<50:56:47, 12.80s/it]

 11%|█         | 1771/16104 [8:15:19<59:04:45, 14.84s/it]

 11%|█         | 1772/16104 [8:15:31<55:46:24, 14.01s/it]

 11%|█         | 1773/16104 [8:15:42<52:31:21, 13.19s/it]

 11%|█         | 1774/16104 [8:15:56<52:19:06, 13.14s/it]

 11%|█         | 1775/16104 [8:16:09<52:49:09, 13.27s/it]

 11%|█         | 1776/16104 [8:16:30<62:30:46, 15.71s/it]

 11%|█         | 1777/16104 [8:16:47<63:45:58, 16.02s/it]

 11%|█         | 1778/16104 [8:17:05<65:23:08, 16.43s/it]

 11%|█         | 1779/16104 [8:17:24<68:27:10, 17.20s/it]

 11%|█         | 1780/16104 [8:17:47<76:15:23, 19.17s/it]

 11%|█         | 1781/16104 [8:18:11<81:19:11, 20.44s/it]

 11%|█         | 1782/16104 [8:18:31<81:25:21, 20.47s/it]

 11%|█         | 1783/16104 [8:18:53<83:00:08, 20.87s/it]

 11%|█         | 1784/16104 [8:19:13<81:31:21, 20.49s/it]

 11%|█         | 1785/16104 [8:19:32<80:27:58, 20.23s/it]

 11%|█         | 1786/16104 [8:19:44<70:32:49, 17.74s/it]

 11%|█         | 1787/16104 [8:20:03<71:43:13, 18.03s/it]

 11%|█         | 1788/16104 [8:20:18<68:40:39, 17.27s/it]

 11%|█         | 1789/16104 [8:20:32<64:00:57, 16.10s/it]

 11%|█         | 1790/16104 [8:20:50<66:47:53, 16.80s/it]

 11%|█         | 1791/16104 [8:21:02<60:36:47, 15.25s/it]

 11%|█         | 1792/16104 [8:21:18<62:04:49, 15.62s/it]

 11%|█         | 1793/16104 [8:21:34<62:04:25, 15.61s/it]

 11%|█         | 1794/16104 [8:21:54<66:52:41, 16.82s/it]

 11%|█         | 1795/16104 [8:22:12<68:50:03, 17.32s/it]

 11%|█         | 1796/16104 [8:22:33<72:46:08, 18.31s/it]
[2024-04-07 21:29:13,797] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 1797/16104 [8:22:48<68:47:35, 17.31s/it]

 11%|█         | 1798/16104 [8:23:09<73:24:39, 18.47s/it]

 11%|█         | 1799/16104 [8:23:29<74:57:58, 18.87s/it]

 11%|█         | 1800/16104 [8:23:40<66:06:17, 16.64s/it]

 11%|█         | 1801/16104 [8:23:53<61:42:41, 15.53s/it]

 11%|█         | 1802/16104 [8:24:14<67:35:36, 17.01s/it]
[2024-04-07 21:30:54,608] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 11%|█         | 1803/16104 [8:24:26<62:28:37, 15.73s/it]

 11%|█         | 1804/16104 [8:24:45<66:31:36, 16.75s/it]

 11%|█         | 1805/16104 [8:24:58<61:14:56, 15.42s/it]

 11%|█         | 1806/16104 [8:25:19<68:27:33, 17.24s/it]

 11%|█         | 1807/16104 [8:25:39<71:11:24, 17.93s/it]

 11%|█         | 1808/16104 [8:26:03<78:42:44, 19.82s/it]
[2024-04-07 21:32:44,038] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5658, 'learning_rate': 1.964753517049252e-06, 'rewards/chosen': -0.5551601052284241, 'rewards/rejected': -1.0762317180633545, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5210716128349304, 'policy_logps/rejected': -524.7235107421875, 'policy_logps/chosen': -484.99591064453125, 'referece_logps/rejected': -513.961181640625, 'referece_logps/chosen': -479.4443359375, 'logits/rejected': 0.2508701682090759, 'logits/chosen': 0.24049334228038788, 'epoch': 0.67}


 11%|█         | 1810/16104 [8:26:27<62:38:16, 15.78s/it]

 11%|█         | 1811/16104 [8:26:41<60:41:55, 15.29s/it]

 11%|█▏        | 1812/16104 [8:26:53<56:27:51, 14.22s/it]

 11%|█▏        | 1813/16104 [8:27:16<67:16:52, 16.95s/it]

 11%|█▏        | 1814/16104 [8:27:35<69:05:04, 17.40s/it]

 11%|█▏        | 1815/16104 [8:27:53<70:01:14, 17.64s/it]

 11%|█▏        | 1816/16104 [8:28:11<70:24:11, 17.74s/it]

 11%|█▏        | 1817/16104 [8:28:31<73:29:33, 18.52s/it]
{'loss': 0.5541, 'learning_rate': 1.964275589921878e-06, 'rewards/chosen': -0.5550219416618347, 'rewards/rejected': -1.0383152961730957, 'rewards/accuracies': 0.75, 'rewards/margins': 0.483293354511261, 'policy_logps/rejected': -317.7411193847656, 'policy_logps/chosen': -433.4918518066406, 'referece_logps/rejected': -307.35797119140625, 'referece_logps/chosen': -427.94171142578125, 'logits/rejected': 0.3362720012664795, 'logits/chosen': 0.2881402373313904, 'epoch': 0.68}


 11%|█▏        | 1819/16104 [8:29:03<68:11:16, 17.18s/it]

 11%|█▏        | 1820/16104 [8:29:22<70:18:21, 17.72s/it]

 11%|█▏        | 1821/16104 [8:29:40<70:45:37, 17.84s/it]
{'loss': 0.4984, 'learning_rate': 1.9640621635987024e-06, 'rewards/chosen': -0.5127213001251221, 'rewards/rejected': -1.29874587059021, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7860245704650879, 'policy_logps/rejected': -497.15435791015625, 'policy_logps/chosen': -405.1591796875, 'referece_logps/rejected': -484.1669006347656, 'referece_logps/chosen': -400.031982421875, 'logits/rejected': -0.3540424406528473, 'logits/chosen': -0.21301814913749695, 'epoch': 0.68}

 11%|█▏        | 1822/16104 [8:29:54<66:41:40, 16.81s/it]


 11%|█▏        | 1824/16104 [8:30:35<73:37:17, 18.56s/it]
{'loss': 0.5088, 'learning_rate': 1.963901684369406e-06, 'rewards/chosen': -1.1287962198257446, 'rewards/rejected': -1.6071339845657349, 'rewards/accuracies': 0.75, 'rewards/margins': 0.47833773493766785, 'policy_logps/rejected': -368.25006103515625, 'policy_logps/chosen': -333.81005859375, 'referece_logps/rejected': -352.1786804199219, 'referece_logps/chosen': -322.5220947265625, 'logits/rejected': 0.5333676338195801, 'logits/chosen': 0.5107836723327637, 'epoch': 0.68}


 11%|█▏        | 1826/16104 [8:31:07<69:31:00, 17.53s/it]
{'loss': 0.5477, 'learning_rate': 1.963794503255219e-06, 'rewards/chosen': -0.7016988396644592, 'rewards/rejected': -1.3397490978240967, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6380500793457031, 'policy_logps/rejected': -439.81011962890625, 'policy_logps/chosen': -370.0066833496094, 'referece_logps/rejected': -426.41265869140625, 'referece_logps/chosen': -362.9897155761719, 'logits/rejected': -0.7442284822463989, 'logits/chosen': -0.5711770057678223, 'epoch': 0.68}


 11%|█▏        | 1828/16104 [8:31:46<72:51:40, 18.37s/it]

 11%|█▏        | 1829/16104 [8:32:00<67:39:47, 17.06s/it]

 11%|█▏        | 1830/16104 [8:32:13<63:23:15, 15.99s/it]

 11%|█▏        | 1831/16104 [8:32:30<64:22:19, 16.24s/it]

 11%|█▏        | 1832/16104 [8:32:47<65:31:21, 16.53s/it]

 11%|█▏        | 1833/16104 [8:33:06<67:55:07, 17.13s/it]

 11%|█▏        | 1834/16104 [8:33:21<66:05:00, 16.67s/it]
{'loss': 0.5822, 'learning_rate': 1.963364219483991e-06, 'rewards/chosen': -0.6638454794883728, 'rewards/rejected': -1.344316005706787, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6804705858230591, 'policy_logps/rejected': -351.61492919921875, 'policy_logps/chosen': -404.9986572265625, 'referece_logps/rejected': -338.1717529296875, 'referece_logps/chosen': -398.3601989746094, 'logits/rejected': -0.4771682024002075, 'logits/chosen': -0.4846791625022888, 'epoch': 0.68}

 11%|█▏        | 1835/16104 [8:33:37<64:29:46, 16.27s/it]


 11%|█▏        | 1837/16104 [8:34:15<69:07:15, 17.44s/it]

 11%|█▏        | 1838/16104 [8:34:37<74:36:57, 18.83s/it]
{'loss': 0.523, 'learning_rate': 1.963148142253457e-06, 'rewards/chosen': -0.6112964153289795, 'rewards/rejected': -1.644408106803894, 'rewards/accuracies': 0.625, 'rewards/margins': 1.033111572265625, 'policy_logps/rejected': -295.6214294433594, 'policy_logps/chosen': -281.2516174316406, 'referece_logps/rejected': -279.1773376464844, 'referece_logps/chosen': -275.1386413574219, 'logits/rejected': -0.6586945056915283, 'logits/chosen': -0.5137690305709839, 'epoch': 0.68}

 11%|█▏        | 1839/16104 [8:34:57<75:26:52, 19.04s/it]

 11%|█▏        | 1840/16104 [8:35:13<71:50:11, 18.13s/it]


 11%|█▏        | 1842/16104 [8:35:54<77:37:27, 19.59s/it]
{'loss': 0.5494, 'learning_rate': 1.9629314416459777e-06, 'rewards/chosen': -0.7991981506347656, 'rewards/rejected': -1.0084010362625122, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2092028707265854, 'policy_logps/rejected': -267.76080322265625, 'policy_logps/chosen': -377.16986083984375, 'referece_logps/rejected': -257.67681884765625, 'referece_logps/chosen': -369.17791748046875, 'logits/rejected': -0.3916604816913605, 'logits/chosen': -0.3893396556377411, 'epoch': 0.69}


 11%|█▏        | 1844/16104 [8:36:29<74:35:18, 18.83s/it]

 11%|█▏        | 1845/16104 [8:36:46<71:39:16, 18.09s/it]

 11%|█▏        | 1846/16104 [8:37:04<72:06:54, 18.21s/it]

 11%|█▏        | 1847/16104 [8:37:24<73:33:03, 18.57s/it]
{'loss': 0.5978, 'learning_rate': 1.9626596894765065e-06, 'rewards/chosen': -0.5862035751342773, 'rewards/rejected': -1.6889907121658325, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1027871370315552, 'policy_logps/rejected': -531.7481079101562, 'policy_logps/chosen': -437.9055480957031, 'referece_logps/rejected': -514.8582153320312, 'referece_logps/chosen': -432.04351806640625, 'logits/rejected': -1.0505058765411377, 'logits/chosen': -1.0404375791549683, 'epoch': 0.69}


 11%|█▏        | 1849/16104 [8:38:04<76:01:26, 19.20s/it]

 11%|█▏        | 1850/16104 [8:38:22<74:40:40, 18.86s/it]

 11%|█▏        | 1851/16104 [8:38:32<65:01:08, 16.42s/it]
{'loss': 0.5671, 'learning_rate': 1.96244158678432e-06, 'rewards/chosen': -0.7405000329017639, 'rewards/rejected': -1.0547878742218018, 'rewards/accuracies': 0.5, 'rewards/margins': 0.31428778171539307, 'policy_logps/rejected': -295.8044738769531, 'policy_logps/chosen': -294.6681823730469, 'referece_logps/rejected': -285.256591796875, 'referece_logps/chosen': -287.2631530761719, 'logits/rejected': -0.3760482966899872, 'logits/chosen': -0.2730675935745239, 'epoch': 0.69}


 12%|█▏        | 1853/16104 [8:39:05<64:23:17, 16.27s/it]

 12%|█▏        | 1854/16104 [8:39:16<57:42:14, 14.58s/it]

 12%|█▏        | 1855/16104 [8:39:28<54:32:36, 13.78s/it]

 12%|█▏        | 1856/16104 [8:39:43<56:20:38, 14.24s/it]
{'loss': 0.6221, 'learning_rate': 1.96216808245492e-06, 'rewards/chosen': -0.5442386865615845, 'rewards/rejected': -1.077146053314209, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5329073667526245, 'policy_logps/rejected': -367.2393493652344, 'policy_logps/chosen': -278.7002258300781, 'referece_logps/rejected': -356.4678649902344, 'referece_logps/chosen': -273.2578430175781, 'logits/rejected': -0.29331767559051514, 'logits/chosen': -0.23198358714580536, 'epoch': 0.69}


 12%|█▏        | 1858/16104 [8:40:17<60:07:41, 15.19s/it]

 12%|█▏        | 1859/16104 [8:40:30<57:47:06, 14.60s/it]

 12%|█▏        | 1860/16104 [8:40:40<53:06:31, 13.42s/it]

 12%|█▏        | 1861/16104 [8:40:56<56:03:30, 14.17s/it]

 12%|█▏        | 1862/16104 [8:41:12<57:41:50, 14.58s/it]
[2024-04-07 21:47:52,934] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 1863/16104 [8:41:28<59:21:44, 15.01s/it]

 12%|█▏        | 1864/16104 [8:41:41<57:40:15, 14.58s/it]

 12%|█▏        | 1865/16104 [8:41:54<55:34:57, 14.05s/it]

 12%|█▏        | 1866/16104 [8:42:12<59:51:35, 15.14s/it]
{'loss': 0.5938, 'learning_rate': 1.9616181549677398e-06, 'rewards/chosen': -1.1930755376815796, 'rewards/rejected': -1.8348013162612915, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6417255401611328, 'policy_logps/rejected': -355.02001953125, 'policy_logps/chosen': -465.2890625, 'referece_logps/rejected': -336.6719970703125, 'referece_logps/chosen': -453.3583068847656, 'logits/rejected': -0.5672374367713928, 'logits/chosen': -0.6335445642471313, 'epoch': 0.7}


 12%|█▏        | 1868/16104 [8:42:48<64:11:02, 16.23s/it]
{'loss': 0.6655, 'learning_rate': 1.9615077026089527e-06, 'rewards/chosen': -1.3161729574203491, 'rewards/rejected': -1.3026983737945557, 'rewards/accuracies': 0.375, 'rewards/margins': -0.013474620878696442, 'policy_logps/rejected': -414.3354187011719, 'policy_logps/chosen': -518.0804443359375, 'referece_logps/rejected': -401.3084411621094, 'referece_logps/chosen': -504.918701171875, 'logits/rejected': -0.8312300443649292, 'logits/chosen': -0.8045549392700195, 'epoch': 0.7}


 12%|█▏        | 1870/16104 [8:43:25<68:25:07, 17.30s/it]

 12%|█▏        | 1871/16104 [8:43:40<66:06:14, 16.72s/it]

 12%|█▏        | 1872/16104 [8:43:58<67:46:32, 17.14s/it]

 12%|█▏        | 1873/16104 [8:44:10<62:09:42, 15.72s/it]

 12%|█▏        | 1874/16104 [8:44:32<68:35:21, 17.35s/it]
{'loss': 0.5161, 'learning_rate': 1.9611754121313567e-06, 'rewards/chosen': -0.5832803249359131, 'rewards/rejected': -1.165292501449585, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5820122957229614, 'policy_logps/rejected': -249.3979949951172, 'policy_logps/chosen': -268.1856384277344, 'referece_logps/rejected': -237.74508666992188, 'referece_logps/chosen': -262.3528137207031, 'logits/rejected': -0.29489606618881226, 'logits/chosen': -0.24486896395683289, 'epoch': 0.7}


 12%|█▏        | 1876/16104 [8:45:08<71:01:43, 17.97s/it]

 12%|█▏        | 1877/16104 [8:45:23<67:16:10, 17.02s/it]

 12%|█▏        | 1878/16104 [8:45:40<67:54:26, 17.18s/it]
{'loss': 0.5481, 'learning_rate': 1.960953107491218e-06, 'rewards/chosen': -0.49378538131713867, 'rewards/rejected': -1.6284897327423096, 'rewards/accuracies': 0.75, 'rewards/margins': 1.134704351425171, 'policy_logps/rejected': -322.0323486328125, 'policy_logps/chosen': -298.0585632324219, 'referece_logps/rejected': -305.7474365234375, 'referece_logps/chosen': -293.12066650390625, 'logits/rejected': -0.5445886850357056, 'logits/chosen': -0.5557652711868286, 'epoch': 0.7}


 12%|█▏        | 1880/16104 [8:46:16<70:50:15, 17.93s/it]
[2024-04-07 21:52:56,925] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 1881/16104 [8:46:32<68:31:36, 17.34s/it]
{'loss': 0.6381, 'learning_rate': 1.9607859708444364e-06, 'rewards/chosen': -0.7478277087211609, 'rewards/rejected': -1.620167851448059, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8723400235176086, 'policy_logps/rejected': -447.74334716796875, 'policy_logps/chosen': -520.3482055664062, 'referece_logps/rejected': -431.54168701171875, 'referece_logps/chosen': -512.8699340820312, 'logits/rejected': -0.44292619824409485, 'logits/chosen': -0.47612667083740234, 'epoch': 0.7}


 12%|█▏        | 1883/16104 [8:47:02<65:03:01, 16.47s/it]
{'loss': 0.5594, 'learning_rate': 1.9606743520819575e-06, 'rewards/chosen': -0.7412390112876892, 'rewards/rejected': -1.1123089790344238, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3710700273513794, 'policy_logps/rejected': -507.98651123046875, 'policy_logps/chosen': -369.0116271972656, 'referece_logps/rejected': -496.8633728027344, 'referece_logps/chosen': -361.5992736816406, 'logits/rejected': 0.27553075551986694, 'logits/chosen': 0.1903257519006729, 'epoch': 0.7}

 12%|█▏        | 1884/16104 [8:47:17<63:59:13, 16.20s/it]


 12%|█▏        | 1886/16104 [8:47:42<56:35:01, 14.33s/it]

 12%|█▏        | 1887/16104 [8:47:57<56:49:37, 14.39s/it]

 12%|█▏        | 1888/16104 [8:48:14<60:44:41, 15.38s/it]

 12%|█▏        | 1889/16104 [8:48:30<61:04:13, 15.47s/it]

 12%|█▏        | 1890/16104 [8:48:41<55:22:48, 14.03s/it]
{'loss': 0.7796, 'learning_rate': 1.9602824624108006e-06, 'rewards/chosen': -0.7750076055526733, 'rewards/rejected': -1.2379775047302246, 'rewards/accuracies': 0.625, 'rewards/margins': 0.46296992897987366, 'policy_logps/rejected': -293.97674560546875, 'policy_logps/chosen': -229.93763732910156, 'referece_logps/rejected': -281.59698486328125, 'referece_logps/chosen': -222.18756103515625, 'logits/rejected': -1.0916156768798828, 'logits/chosen': -0.9246907830238342, 'epoch': 0.7}


 12%|█▏        | 1892/16104 [8:49:05<51:49:29, 13.13s/it]
{'loss': 0.6051, 'learning_rate': 1.9601701442930666e-06, 'rewards/chosen': -0.9495830535888672, 'rewards/rejected': -1.1134910583496094, 'rewards/accuracies': 0.75, 'rewards/margins': 0.16390801966190338, 'policy_logps/rejected': -557.5054931640625, 'policy_logps/chosen': -534.2476196289062, 'referece_logps/rejected': -546.37060546875, 'referece_logps/chosen': -524.7518310546875, 'logits/rejected': 0.18178081512451172, 'logits/chosen': 0.16022755205631256, 'epoch': 0.7}


 12%|█▏        | 1894/16104 [8:49:30<51:04:34, 12.94s/it]

 12%|█▏        | 1895/16104 [8:49:51<60:18:29, 15.28s/it]
[2024-04-07 21:56:31,640] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 1896/16104 [8:50:09<64:04:09, 16.23s/it]

 12%|█▏        | 1897/16104 [8:50:31<70:20:53, 17.83s/it]
[2024-04-07 21:57:11,641] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 1898/16104 [8:50:52<74:36:03, 18.90s/it]
[2024-04-07 21:57:33,063] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4304, 'learning_rate': 1.959832257838397e-06, 'rewards/chosen': -0.5791592597961426, 'rewards/rejected': -1.9898885488510132, 'rewards/accuracies': 1.0, 'rewards/margins': 1.410729169845581, 'policy_logps/rejected': -385.87396240234375, 'policy_logps/chosen': -434.72119140625, 'referece_logps/rejected': -365.9750671386719, 'referece_logps/chosen': -428.92962646484375, 'logits/rejected': 0.5482301712036133, 'logits/chosen': 0.5954681634902954, 'epoch': 0.71}

 12%|█▏        | 1899/16104 [8:51:09<72:52:50, 18.47s/it]


 12%|█▏        | 1901/16104 [8:51:38<63:56:19, 16.21s/it]
{'loss': 0.5715, 'learning_rate': 1.959662790416768e-06, 'rewards/chosen': -1.376341700553894, 'rewards/rejected': -1.619979977607727, 'rewards/accuracies': 0.5, 'rewards/margins': 0.24363835155963898, 'policy_logps/rejected': -432.69097900390625, 'policy_logps/chosen': -266.09075927734375, 'referece_logps/rejected': -416.4911804199219, 'referece_logps/chosen': -252.32733154296875, 'logits/rejected': -0.9997296333312988, 'logits/chosen': -0.952231228351593, 'epoch': 0.71}

 12%|█▏        | 1902/16104 [8:51:54<63:09:15, 16.01s/it]


 12%|█▏        | 1904/16104 [8:52:28<65:58:51, 16.73s/it]

 12%|█▏        | 1905/16104 [8:52:48<69:58:05, 17.74s/it]

 12%|█▏        | 1906/16104 [8:53:10<75:04:13, 19.03s/it]
{'loss': 0.4741, 'learning_rate': 1.9593795683431524e-06, 'rewards/chosen': -1.2569741010665894, 'rewards/rejected': -1.376258373260498, 'rewards/accuracies': 0.625, 'rewards/margins': 0.11928434669971466, 'policy_logps/rejected': -373.8128356933594, 'policy_logps/chosen': -426.21478271484375, 'referece_logps/rejected': -360.0502624511719, 'referece_logps/chosen': -413.6450500488281, 'logits/rejected': -0.6461445093154907, 'logits/chosen': -0.654102623462677, 'epoch': 0.71}


 12%|█▏        | 1908/16104 [8:53:41<67:09:23, 17.03s/it]
{'loss': 0.5205, 'learning_rate': 1.9592660078373463e-06, 'rewards/chosen': -0.8771352171897888, 'rewards/rejected': -1.3828922510147095, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5057570338249207, 'policy_logps/rejected': -381.49713134765625, 'policy_logps/chosen': -434.61334228515625, 'referece_logps/rejected': -367.668212890625, 'referece_logps/chosen': -425.84197998046875, 'logits/rejected': -0.5464118719100952, 'logits/chosen': -0.6659765839576721, 'epoch': 0.71}


 12%|█▏        | 1910/16104 [8:54:19<70:25:46, 17.86s/it]

 12%|█▏        | 1911/16104 [8:54:35<68:58:03, 17.49s/it]
{'loss': 0.523, 'learning_rate': 1.959095376054226e-06, 'rewards/chosen': -0.8823087811470032, 'rewards/rejected': -1.1090240478515625, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2267152965068817, 'policy_logps/rejected': -465.67138671875, 'policy_logps/chosen': -431.789306640625, 'referece_logps/rejected': -454.5810852050781, 'referece_logps/chosen': -422.96624755859375, 'logits/rejected': -0.5414069890975952, 'logits/chosen': -0.6329253315925598, 'epoch': 0.71}


 12%|█▏        | 1913/16104 [8:54:59<57:53:45, 14.69s/it]
{'loss': 0.5339, 'learning_rate': 1.9589814275427138e-06, 'rewards/chosen': -0.5924642086029053, 'rewards/rejected': -1.0738247632980347, 'rewards/accuracies': 0.75, 'rewards/margins': 0.48136067390441895, 'policy_logps/rejected': -403.71124267578125, 'policy_logps/chosen': -347.71368408203125, 'referece_logps/rejected': -392.9729919433594, 'referece_logps/chosen': -341.7890319824219, 'logits/rejected': 0.1662806123495102, 'logits/chosen': 0.2266865074634552, 'epoch': 0.71}

 12%|█▏        | 1914/16104 [8:55:12<55:59:40, 14.21s/it]


 12%|█▏        | 1916/16104 [8:55:40<55:21:52, 14.05s/it]

 12%|█▏        | 1917/16104 [8:56:04<66:51:44, 16.97s/it]
{'loss': 0.4643, 'learning_rate': 1.958753065028037e-06, 'rewards/chosen': -0.2431587278842926, 'rewards/rejected': -1.7200498580932617, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4768913984298706, 'policy_logps/rejected': -328.5479431152344, 'policy_logps/chosen': -366.0240478515625, 'referece_logps/rejected': -311.34747314453125, 'referece_logps/chosen': -363.59246826171875, 'logits/rejected': 0.0745081752538681, 'logits/chosen': 0.017582550644874573, 'epoch': 0.71}

 12%|█▏        | 1918/16104 [8:56:24<69:52:08, 17.73s/it]

 12%|█▏        | 1919/16104 [8:56:42<70:28:17, 17.88s/it]

 12%|█▏        | 1920/16104 [8:56:54<63:42:18, 16.17s/it]

 12%|█▏        | 1921/16104 [8:57:16<70:04:30, 17.79s/it]

 12%|█▏        | 1922/16104 [8:57:34<70:32:21, 17.91s/it]

 12%|█▏        | 1923/16104 [8:57:52<71:16:40, 18.09s/it]


 12%|█▏        | 1925/16104 [8:58:29<70:16:00, 17.84s/it]
{'loss': 0.6139, 'learning_rate': 1.958294478549907e-06, 'rewards/chosen': -0.9454233050346375, 'rewards/rejected': -0.8974322080612183, 'rewards/accuracies': 0.375, 'rewards/margins': -0.047991082072257996, 'policy_logps/rejected': -286.2658996582031, 'policy_logps/chosen': -309.8232116699219, 'referece_logps/rejected': -277.29156494140625, 'referece_logps/chosen': -300.3689270019531, 'logits/rejected': -0.6671643853187561, 'logits/chosen': -0.778049111366272, 'epoch': 0.72}

 12%|█▏        | 1926/16104 [8:58:48<71:58:00, 18.27s/it]


 12%|█▏        | 1928/16104 [8:59:22<67:50:22, 17.23s/it]

 12%|█▏        | 1929/16104 [8:59:41<70:28:13, 17.90s/it]
{'loss': 0.5014, 'learning_rate': 1.9580642548832653e-06, 'rewards/chosen': -1.4345391988754272, 'rewards/rejected': -2.7333457469940186, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2988064289093018, 'policy_logps/rejected': -385.5091247558594, 'policy_logps/chosen': -360.7880859375, 'referece_logps/rejected': -358.1756286621094, 'referece_logps/chosen': -346.44268798828125, 'logits/rejected': -0.9654268026351929, 'logits/chosen': -0.9873939752578735, 'epoch': 0.72}


 12%|█▏        | 1931/16104 [9:00:14<67:35:08, 17.17s/it]
{'loss': 0.5327, 'learning_rate': 1.9579489105081746e-06, 'rewards/chosen': -1.012980580329895, 'rewards/rejected': -1.512765884399414, 'rewards/accuracies': 0.75, 'rewards/margins': 0.49978524446487427, 'policy_logps/rejected': -334.24365234375, 'policy_logps/chosen': -281.1492919921875, 'referece_logps/rejected': -319.115966796875, 'referece_logps/chosen': -271.0195007324219, 'logits/rejected': -1.447556495666504, 'logits/chosen': -1.3132952451705933, 'epoch': 0.72}


 12%|█▏        | 1933/16104 [9:00:49<68:38:34, 17.44s/it]

 12%|█▏        | 1934/16104 [9:01:05<66:42:20, 16.95s/it]
{'loss': 0.4921, 'learning_rate': 1.9577756033208093e-06, 'rewards/chosen': -1.2006120681762695, 'rewards/rejected': -1.9306912422180176, 'rewards/accuracies': 0.75, 'rewards/margins': 0.730079174041748, 'policy_logps/rejected': -278.14471435546875, 'policy_logps/chosen': -301.52764892578125, 'referece_logps/rejected': -258.8377990722656, 'referece_logps/chosen': -289.52154541015625, 'logits/rejected': -0.08468613028526306, 'logits/chosen': -0.05262000858783722, 'epoch': 0.72}


 12%|█▏        | 1936/16104 [9:01:39<67:49:39, 17.23s/it]
{'loss': 0.5723, 'learning_rate': 1.957659871473343e-06, 'rewards/chosen': -1.122028112411499, 'rewards/rejected': -1.1239935159683228, 'rewards/accuracies': 0.375, 'rewards/margins': 0.0019653141498565674, 'policy_logps/rejected': -236.579345703125, 'policy_logps/chosen': -191.41502380371094, 'referece_logps/rejected': -225.3394317626953, 'referece_logps/chosen': -180.19473266601562, 'logits/rejected': -0.4718547463417053, 'logits/chosen': -0.45088887214660645, 'epoch': 0.72}


 12%|█▏        | 1938/16104 [9:02:06<60:28:48, 15.37s/it]
{'loss': 0.6063, 'learning_rate': 1.9575439846696755e-06, 'rewards/chosen': -0.8044797778129578, 'rewards/rejected': -0.979856550693512, 'rewards/accuracies': 0.625, 'rewards/margins': 0.17537672817707062, 'policy_logps/rejected': -281.1514892578125, 'policy_logps/chosen': -276.3680114746094, 'referece_logps/rejected': -271.3529357910156, 'referece_logps/chosen': -268.32318115234375, 'logits/rejected': -0.44904398918151855, 'logits/chosen': -0.40987253189086914, 'epoch': 0.72}


 12%|█▏        | 1940/16104 [9:02:42<66:25:30, 16.88s/it]
{'loss': 0.637, 'learning_rate': 1.9574279429285574e-06, 'rewards/chosen': -0.5408302545547485, 'rewards/rejected': -1.2975558042526245, 'rewards/accuracies': 0.875, 'rewards/margins': 0.756725549697876, 'policy_logps/rejected': -227.12191772460938, 'policy_logps/chosen': -381.02703857421875, 'referece_logps/rejected': -214.1463623046875, 'referece_logps/chosen': -375.61871337890625, 'logits/rejected': -0.29965803027153015, 'logits/chosen': -0.3904365301132202, 'epoch': 0.72}

 12%|█▏        | 1941/16104 [9:03:03<71:23:20, 18.15s/it]

 12%|█▏        | 1942/16104 [9:03:25<75:52:15, 19.29s/it]

 12%|█▏        | 1943/16104 [9:03:39<69:24:56, 17.65s/it]


 12%|█▏        | 1945/16104 [9:04:16<72:12:03, 18.36s/it]
[2024-04-07 22:10:56,902] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 1946/16104 [9:04:28<64:45:16, 16.47s/it]
{'loss': 0.469, 'learning_rate': 1.9570788882683925e-06, 'rewards/chosen': -0.442565381526947, 'rewards/rejected': -1.3517186641693115, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9091533422470093, 'policy_logps/rejected': -343.3970947265625, 'policy_logps/chosen': -373.18621826171875, 'referece_logps/rejected': -329.8798828125, 'referece_logps/chosen': -368.7605895996094, 'logits/rejected': -0.39067667722702026, 'logits/chosen': -0.34650933742523193, 'epoch': 0.73}
[2024-04-07 22:11:29,866] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 12%|█▏        | 1948/16104 [9:05:08<71:05:03, 18.08s/it]
{'loss': 0.6115, 'learning_rate': 1.956962226965489e-06, 'rewards/chosen': -1.147573709487915, 'rewards/rejected': -1.6003116369247437, 'rewards/accuracies': 0.5, 'rewards/margins': 0.45273810625076294, 'policy_logps/rejected': -282.5660705566406, 'policy_logps/chosen': -319.8646240234375, 'referece_logps/rejected': -266.5629577636719, 'referece_logps/chosen': -308.3889465332031, 'logits/rejected': -0.3490985929965973, 'logits/chosen': -0.4425131678581238, 'epoch': 0.73}


 12%|█▏        | 1950/16104 [9:05:40<66:21:13, 16.88s/it]
{'loss': 0.5869, 'learning_rate': 1.956845410819268e-06, 'rewards/chosen': -1.0872559547424316, 'rewards/rejected': -0.9928680658340454, 'rewards/accuracies': 0.375, 'rewards/margins': -0.09438790380954742, 'policy_logps/rejected': -309.7943115234375, 'policy_logps/chosen': -330.18798828125, 'referece_logps/rejected': -299.8656311035156, 'referece_logps/chosen': -319.3154296875, 'logits/rejected': -0.4568082094192505, 'logits/chosen': -0.4088302552700043, 'epoch': 0.73}

 12%|█▏        | 1951/16104 [9:05:57<66:09:08, 16.83s/it]


 12%|█▏        | 1953/16104 [9:06:30<63:43:27, 16.21s/it]

 12%|█▏        | 1954/16104 [9:06:50<68:31:45, 17.44s/it]
{'loss': 0.6497, 'learning_rate': 1.956611314072505e-06, 'rewards/chosen': -0.9080301523208618, 'rewards/rejected': -1.3174591064453125, 'rewards/accuracies': 0.625, 'rewards/margins': 0.40942901372909546, 'policy_logps/rejected': -501.9980773925781, 'policy_logps/chosen': -633.5018310546875, 'referece_logps/rejected': -488.8234558105469, 'referece_logps/chosen': -624.421630859375, 'logits/rejected': -0.06965763121843338, 'logits/chosen': -0.16846813261508942, 'epoch': 0.73}

 12%|█▏        | 1955/16104 [9:07:05<65:32:19, 16.68s/it]


 12%|█▏        | 1957/16104 [9:07:40<67:54:10, 17.28s/it]

 12%|█▏        | 1958/16104 [9:08:02<73:14:36, 18.64s/it]
{'loss': 0.6214, 'learning_rate': 1.9563765981796176e-06, 'rewards/chosen': -1.2569999694824219, 'rewards/rejected': -1.010903239250183, 'rewards/accuracies': 0.375, 'rewards/margins': -0.24609680473804474, 'policy_logps/rejected': -276.58856201171875, 'policy_logps/chosen': -269.81243896484375, 'referece_logps/rejected': -266.4795227050781, 'referece_logps/chosen': -257.2424621582031, 'logits/rejected': 0.3688149154186249, 'logits/chosen': 0.3018975257873535, 'epoch': 0.73}

 12%|█▏        | 1959/16104 [9:08:17<68:50:02, 17.52s/it]

 12%|█▏        | 1960/16104 [9:08:31<65:12:40, 16.60s/it]

 12%|█▏        | 1961/16104 [9:08:43<59:51:33, 15.24s/it]


 12%|█▏        | 1963/16104 [9:09:12<56:53:10, 14.48s/it]
{'loss': 0.5124, 'learning_rate': 1.9560823328707423e-06, 'rewards/chosen': -1.2928754091262817, 'rewards/rejected': -1.701791524887085, 'rewards/accuracies': 0.5, 'rewards/margins': 0.40891626477241516, 'policy_logps/rejected': -369.52606201171875, 'policy_logps/chosen': -475.59552001953125, 'referece_logps/rejected': -352.5081787109375, 'referece_logps/chosen': -462.666748046875, 'logits/rejected': -1.1288220882415771, 'logits/chosen': -1.0446735620498657, 'epoch': 0.73}


 12%|█▏        | 1965/16104 [9:09:38<54:26:50, 13.86s/it]
{'loss': 0.5384, 'learning_rate': 1.9559643560038606e-06, 'rewards/chosen': -0.5576349496841431, 'rewards/rejected': -1.028816819190979, 'rewards/accuracies': 0.875, 'rewards/margins': 0.4711818993091583, 'policy_logps/rejected': -416.85772705078125, 'policy_logps/chosen': -436.6258544921875, 'referece_logps/rejected': -406.56951904296875, 'referece_logps/chosen': -431.0495300292969, 'logits/rejected': 0.07012169808149338, 'logits/chosen': -0.002506941556930542, 'epoch': 0.73}

 12%|█▏        | 1966/16104 [9:09:59<63:30:57, 16.17s/it]

 12%|█▏        | 1967/16104 [9:10:11<57:56:51, 14.76s/it]


 12%|█▏        | 1969/16104 [9:10:50<67:55:59, 17.30s/it]

 12%|█▏        | 1970/16104 [9:11:06<66:32:48, 16.95s/it]
{'loss': 0.5087, 'learning_rate': 1.955668737145362e-06, 'rewards/chosen': -1.229734182357788, 'rewards/rejected': -0.9831377863883972, 'rewards/accuracies': 0.25, 'rewards/margins': -0.24659642577171326, 'policy_logps/rejected': -302.5040283203125, 'policy_logps/chosen': -362.90521240234375, 'referece_logps/rejected': -292.6726379394531, 'referece_logps/chosen': -350.6078796386719, 'logits/rejected': 0.23504140973091125, 'logits/chosen': 0.18985041975975037, 'epoch': 0.73}

 12%|█▏        | 1971/16104 [9:11:23<66:04:36, 16.83s/it]

 12%|█▏        | 1972/16104 [9:11:37<63:37:26, 16.21s/it]

 12%|█▏        | 1973/16104 [9:11:51<60:28:30, 15.41s/it]

 12%|█▏        | 1974/16104 [9:12:11<66:24:42, 16.92s/it]

 12%|█▏        | 1975/16104 [9:12:33<71:57:14, 18.33s/it]

 12%|█▏        | 1976/16104 [9:12:51<71:09:32, 18.13s/it]

 12%|█▏        | 1977/16104 [9:13:05<66:41:09, 16.99s/it]

 12%|█▏        | 1978/16104 [9:13:25<69:54:21, 17.82s/it]

 12%|█▏        | 1979/16104 [9:13:44<71:21:07, 18.19s/it]


 12%|█▏        | 1981/16104 [9:14:20<71:41:33, 18.27s/it]

 12%|█▏        | 1982/16104 [9:14:40<73:18:08, 18.69s/it]

 12%|█▏        | 1983/16104 [9:15:00<75:02:02, 19.13s/it]

 12%|█▏        | 1984/16104 [9:15:13<67:04:21, 17.10s/it]
{'loss': 0.5746, 'learning_rate': 1.9548358637187266e-06, 'rewards/chosen': -1.0577538013458252, 'rewards/rejected': -2.0648558139801025, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0071018934249878, 'policy_logps/rejected': -328.2364501953125, 'policy_logps/chosen': -505.08197021484375, 'referece_logps/rejected': -307.5878601074219, 'referece_logps/chosen': -494.5043640136719, 'logits/rejected': -0.37587952613830566, 'logits/chosen': -0.4682832360267639, 'epoch': 0.74}

 12%|█▏        | 1985/16104 [9:15:27<64:21:58, 16.41s/it]

 12%|█▏        | 1986/16104 [9:15:47<68:26:22, 17.45s/it]


 12%|█▏        | 1988/16104 [9:16:19<65:31:06, 16.71s/it]

 12%|█▏        | 1989/16104 [9:16:30<59:24:54, 15.15s/it]
[2024-04-07 22:23:11,359] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 12%|█▏        | 1990/16104 [9:16:41<53:57:49, 13.76s/it]

 12%|█▏        | 1991/16104 [9:16:52<51:27:16, 13.13s/it]
{'loss': 0.664, 'learning_rate': 1.954416587668341e-06, 'rewards/chosen': -0.9110167026519775, 'rewards/rejected': -0.8382339477539062, 'rewards/accuracies': 0.25, 'rewards/margins': -0.0727827250957489, 'policy_logps/rejected': -358.0142517089844, 'policy_logps/chosen': -390.7870178222656, 'referece_logps/rejected': -349.63189697265625, 'referece_logps/chosen': -381.67681884765625, 'logits/rejected': 0.7219936847686768, 'logits/chosen': 0.6519595980644226, 'epoch': 0.74}

 12%|█▏        | 1992/16104 [9:17:12<59:06:03, 15.08s/it]

 12%|█▏        | 1993/16104 [9:17:26<57:18:51, 14.62s/it]


 12%|█▏        | 1995/16104 [9:17:50<52:08:43, 13.31s/it]

 12%|█▏        | 1996/16104 [9:18:09<58:11:58, 14.85s/it]
{'loss': 0.5335, 'learning_rate': 1.9541159464911657e-06, 'rewards/chosen': -0.3763134777545929, 'rewards/rejected': -0.6491066813468933, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2727932333946228, 'policy_logps/rejected': -218.95205688476562, 'policy_logps/chosen': -374.1107482910156, 'referece_logps/rejected': -212.46099853515625, 'referece_logps/chosen': -370.34765625, 'logits/rejected': -0.8069751262664795, 'logits/chosen': -0.7671712636947632, 'epoch': 0.74}

 12%|█▏        | 1997/16104 [9:18:22<56:17:01, 14.36s/it]

 12%|█▏        | 1998/16104 [9:18:40<60:58:24, 15.56s/it]


 12%|█▏        | 2000/16104 [9:19:17<65:24:10, 16.69s/it]
{'loss': 0.6728, 'learning_rate': 1.953874738812387e-06, 'rewards/chosen': -1.221676230430603, 'rewards/rejected': -1.1878072023391724, 'rewards/accuracies': 0.375, 'rewards/margins': -0.0338691771030426, 'policy_logps/rejected': -435.22216796875, 'policy_logps/chosen': -621.2321166992188, 'referece_logps/rejected': -423.3440856933594, 'referece_logps/chosen': -609.015380859375, 'logits/rejected': -0.8441427946090698, 'logits/chosen': -0.9203734397888184, 'epoch': 0.75}


 12%|█▏        | 2002/16104 [9:20:00<72:48:18, 18.59s/it]
{'loss': 0.4692, 'learning_rate': 1.9537539034476243e-06, 'rewards/chosen': -0.9087948203086853, 'rewards/rejected': -2.0298047065734863, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1210098266601562, 'policy_logps/rejected': -234.3208770751953, 'policy_logps/chosen': -309.45477294921875, 'referece_logps/rejected': -214.02284240722656, 'referece_logps/chosen': -300.3667907714844, 'logits/rejected': -1.0510222911834717, 'logits/chosen': -1.1402859687805176, 'epoch': 0.75}


 12%|█▏        | 2004/16104 [9:20:29<63:18:36, 16.16s/it]

 12%|█▏        | 2005/16104 [9:20:45<63:12:13, 16.14s/it]
{'loss': 0.5381, 'learning_rate': 1.9535723610487453e-06, 'rewards/chosen': -1.0016261339187622, 'rewards/rejected': -1.2850908041000366, 'rewards/accuracies': 0.625, 'rewards/margins': 0.28346478939056396, 'policy_logps/rejected': -522.6163330078125, 'policy_logps/chosen': -442.7274169921875, 'referece_logps/rejected': -509.7654113769531, 'referece_logps/chosen': -432.711181640625, 'logits/rejected': -0.6587241888046265, 'logits/chosen': -0.5927062630653381, 'epoch': 0.75}


 12%|█▏        | 2007/16104 [9:21:08<54:03:51, 13.81s/it]
{'loss': 0.656, 'learning_rate': 1.9534511399102274e-06, 'rewards/chosen': -0.8872266411781311, 'rewards/rejected': -0.8517308235168457, 'rewards/accuracies': 0.375, 'rewards/margins': -0.03549584746360779, 'policy_logps/rejected': -288.3281555175781, 'policy_logps/chosen': -411.0413513183594, 'referece_logps/rejected': -279.8108215332031, 'referece_logps/chosen': -402.1690368652344, 'logits/rejected': -0.6425289511680603, 'logits/chosen': -0.6733654141426086, 'epoch': 0.75}

 12%|█▏        | 2008/16104 [9:21:22<54:07:51, 13.82s/it]

 12%|█▏        | 2009/16104 [9:21:40<58:35:44, 14.97s/it]

 12%|█▏        | 2010/16104 [9:21:59<63:48:25, 16.30s/it]


 12%|█▏        | 2012/16104 [9:22:29<61:27:32, 15.70s/it]
{'loss': 0.604, 'learning_rate': 1.9531474121529077e-06, 'rewards/chosen': -0.7548158168792725, 'rewards/rejected': -1.2295829057693481, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4747669994831085, 'policy_logps/rejected': -251.09579467773438, 'policy_logps/chosen': -332.5731201171875, 'referece_logps/rejected': -238.7999725341797, 'referece_logps/chosen': -325.02496337890625, 'logits/rejected': -0.5501950979232788, 'logits/chosen': -0.4890652596950531, 'epoch': 0.75}

 12%|█▎        | 2013/16104 [9:22:48<66:18:29, 16.94s/it]


 13%|█▎        | 2015/16104 [9:23:21<66:07:27, 16.90s/it]
{'loss': 0.6239, 'learning_rate': 1.95296471280069e-06, 'rewards/chosen': -1.2550053596496582, 'rewards/rejected': -1.349277377128601, 'rewards/accuracies': 0.75, 'rewards/margins': 0.09427201747894287, 'policy_logps/rejected': -332.67529296875, 'policy_logps/chosen': -361.0633239746094, 'referece_logps/rejected': -319.18255615234375, 'referece_logps/chosen': -348.5132751464844, 'logits/rejected': -1.1069270372390747, 'logits/chosen': -1.1976714134216309, 'epoch': 0.75}

 13%|█▎        | 2016/16104 [9:23:42<71:22:17, 18.24s/it]
[2024-04-07 22:30:39,096] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 13%|█▎        | 2018/16104 [9:24:19<73:03:41, 18.67s/it]

 13%|█▎        | 2019/16104 [9:24:31<64:43:39, 16.54s/it]
{'loss': 0.5528, 'learning_rate': 1.9527205739882045e-06, 'rewards/chosen': -0.7421112060546875, 'rewards/rejected': -1.3430581092834473, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6009469032287598, 'policy_logps/rejected': -537.1605224609375, 'policy_logps/chosen': -520.337890625, 'referece_logps/rejected': -523.7299194335938, 'referece_logps/chosen': -512.916748046875, 'logits/rejected': -0.012055650353431702, 'logits/chosen': -0.014477599412202835, 'epoch': 0.75}

 13%|█▎        | 2020/16104 [9:24:50<67:58:19, 17.37s/it]

 13%|█▎        | 2021/16104 [9:25:02<61:52:38, 15.82s/it]


 13%|█▎        | 2023/16104 [9:25:35<62:36:53, 16.01s/it]

 13%|█▎        | 2024/16104 [9:25:47<57:51:48, 14.79s/it]
{'loss': 0.5806, 'learning_rate': 1.9524145333581313e-06, 'rewards/chosen': -0.7784120440483093, 'rewards/rejected': -1.1321625709533691, 'rewards/accuracies': 0.75, 'rewards/margins': 0.35375064611434937, 'policy_logps/rejected': -391.1766662597656, 'policy_logps/chosen': -452.30963134765625, 'referece_logps/rejected': -379.85504150390625, 'referece_logps/chosen': -444.5254821777344, 'logits/rejected': -0.23140431940555573, 'logits/chosen': -0.2898724675178528, 'epoch': 0.75}


 13%|█▎        | 2026/16104 [9:26:11<52:52:52, 13.52s/it]

 13%|█▎        | 2027/16104 [9:26:31<59:57:15, 15.33s/it]
{'loss': 0.4898, 'learning_rate': 1.9522304466378673e-06, 'rewards/chosen': -0.291797935962677, 'rewards/rejected': -1.2380050420761108, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9462071061134338, 'policy_logps/rejected': -271.93353271484375, 'policy_logps/chosen': -308.409423828125, 'referece_logps/rejected': -259.5534973144531, 'referece_logps/chosen': -305.491455078125, 'logits/rejected': 0.35661786794662476, 'logits/chosen': 0.36171433329582214, 'epoch': 0.76}

 13%|█▎        | 2028/16104 [9:26:46<59:37:09, 15.25s/it]


 13%|█▎        | 2030/16104 [9:27:20<62:07:44, 15.89s/it]

 13%|█▎        | 2031/16104 [9:27:38<64:39:01, 16.54s/it]
[2024-04-07 22:34:18,633] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5653, 'learning_rate': 1.95198445841724e-06, 'rewards/chosen': -0.997482419013977, 'rewards/rejected': -1.4708280563354492, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4733456075191498, 'policy_logps/rejected': -449.7561340332031, 'policy_logps/chosen': -459.04150390625, 'referece_logps/rejected': -435.0478515625, 'referece_logps/chosen': -449.0666198730469, 'logits/rejected': -0.007903516292572021, 'logits/chosen': -0.03885796666145325, 'epoch': 0.76}

 13%|█▎        | 2032/16104 [9:27:48<57:47:15, 14.78s/it]

 13%|█▎        | 2033/16104 [9:28:01<54:55:44, 14.05s/it]

 13%|█▎        | 2034/16104 [9:28:19<60:13:33, 15.41s/it]

 13%|█▎        | 2035/16104 [9:28:39<65:14:04, 16.69s/it]

 13%|█▎        | 2036/16104 [9:28:50<58:20:17, 14.93s/it]

 13%|█▎        | 2037/16104 [9:29:11<65:59:09, 16.89s/it]

 13%|█▎        | 2038/16104 [9:29:25<62:16:58, 15.94s/it]


 13%|█▎        | 2040/16104 [9:29:50<55:36:23, 14.23s/it]
{'loss': 0.555, 'learning_rate': 1.9514287323601314e-06, 'rewards/chosen': -0.8518424034118652, 'rewards/rejected': -1.3526942729949951, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5008518099784851, 'policy_logps/rejected': -421.2796325683594, 'policy_logps/chosen': -414.9462890625, 'referece_logps/rejected': -407.7527160644531, 'referece_logps/chosen': -406.4278869628906, 'logits/rejected': -0.06334071606397629, 'logits/chosen': -0.09891417622566223, 'epoch': 0.76}

 13%|█▎        | 2041/16104 [9:30:01<52:33:21, 13.45s/it]

 13%|█▎        | 2042/16104 [9:30:19<57:19:12, 14.67s/it]

 13%|█▎        | 2043/16104 [9:30:35<58:50:32, 15.07s/it]

 13%|█▎        | 2044/16104 [9:30:55<65:16:13, 16.71s/it]

 13%|█▎        | 2045/16104 [9:31:16<70:17:01, 18.00s/it]

 13%|█▎        | 2046/16104 [9:31:33<68:49:40, 17.63s/it]

 13%|█▎        | 2047/16104 [9:31:45<61:49:57, 15.84s/it]


 13%|█▎        | 2049/16104 [9:32:12<57:07:20, 14.63s/it]
{'loss': 0.6585, 'learning_rate': 1.9508698888576703e-06, 'rewards/chosen': -0.7421138286590576, 'rewards/rejected': -0.999907374382019, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2577934265136719, 'policy_logps/rejected': -454.0692138671875, 'policy_logps/chosen': -380.2518005371094, 'referece_logps/rejected': -444.07012939453125, 'referece_logps/chosen': -372.83062744140625, 'logits/rejected': -0.7192853689193726, 'logits/chosen': -0.5600696206092834, 'epoch': 0.76}

 13%|█▎        | 2050/16104 [9:32:31<62:56:01, 16.12s/it]

 13%|█▎        | 2051/16104 [9:32:44<59:08:27, 15.15s/it]
[2024-04-07 22:39:47,134] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 2052/16104 [9:33:06<66:54:51, 17.14s/it]

 13%|█▎        | 2053/16104 [9:33:17<59:27:03, 15.23s/it]

 13%|█▎        | 2054/16104 [9:33:28<54:09:47, 13.88s/it]

 13%|█▎        | 2055/16104 [9:33:38<50:27:33, 12.93s/it]

 13%|█▎        | 2056/16104 [9:33:52<51:45:10, 13.26s/it]

 13%|█▎        | 2057/16104 [9:34:04<50:12:09, 12.87s/it]

 13%|█▎        | 2058/16104 [9:34:21<54:50:07, 14.05s/it]

 13%|█▎        | 2059/16104 [9:34:41<61:52:34, 15.86s/it]

 13%|█▎        | 2060/16104 [9:34:59<64:35:12, 16.56s/it]

 13%|█▎        | 2061/16104 [9:35:17<65:40:00, 16.83s/it]


 13%|█▎        | 2063/16104 [9:35:50<65:12:35, 16.72s/it]
{'loss': 0.6012, 'learning_rate': 1.9499943846559465e-06, 'rewards/chosen': -1.2678009271621704, 'rewards/rejected': -1.4940917491912842, 'rewards/accuracies': 0.625, 'rewards/margins': 0.22629082202911377, 'policy_logps/rejected': -328.9361572265625, 'policy_logps/chosen': -376.06854248046875, 'referece_logps/rejected': -313.9952087402344, 'referece_logps/chosen': -363.3905334472656, 'logits/rejected': -0.25479915738105774, 'logits/chosen': -0.38747066259384155, 'epoch': 0.77}

 13%|█▎        | 2064/16104 [9:36:11<70:39:07, 18.12s/it]

 13%|█▎        | 2065/16104 [9:36:25<65:26:05, 16.78s/it]

 13%|█▎        | 2066/16104 [9:36:41<65:00:18, 16.67s/it]

 13%|█▎        | 2067/16104 [9:36:57<63:28:15, 16.28s/it]

 13%|█▎        | 2068/16104 [9:37:10<60:15:47, 15.46s/it]

 13%|█▎        | 2069/16104 [9:37:31<65:54:02, 16.90s/it]

 13%|█▎        | 2070/16104 [9:37:48<66:02:05, 16.94s/it]

 13%|█▎        | 2071/16104 [9:37:58<58:45:45, 15.07s/it]


 13%|█▎        | 2073/16104 [9:38:32<60:39:31, 15.56s/it]
{'loss': 0.5766, 'learning_rate': 1.9493644126316007e-06, 'rewards/chosen': -0.6210132837295532, 'rewards/rejected': -1.0958664417266846, 'rewards/accuracies': 0.625, 'rewards/margins': 0.47485315799713135, 'policy_logps/rejected': -338.9623718261719, 'policy_logps/chosen': -283.6646423339844, 'referece_logps/rejected': -328.0036926269531, 'referece_logps/chosen': -277.45452880859375, 'logits/rejected': -0.36697420477867126, 'logits/chosen': -0.25972825288772583, 'epoch': 0.77}

 13%|█▎        | 2074/16104 [9:38:43<54:59:56, 14.11s/it]


 13%|█▎        | 2076/16104 [9:39:04<48:14:07, 12.38s/it]
{'loss': 0.6974, 'learning_rate': 1.9491746720402408e-06, 'rewards/chosen': -0.7069110870361328, 'rewards/rejected': -1.3717782497406006, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6648672819137573, 'policy_logps/rejected': -400.6132507324219, 'policy_logps/chosen': -423.576416015625, 'referece_logps/rejected': -386.8955078125, 'referece_logps/chosen': -416.50726318359375, 'logits/rejected': -0.123354971408844, 'logits/chosen': -0.15231168270111084, 'epoch': 0.77}

 13%|█▎        | 2077/16104 [9:39:22<54:25:43, 13.97s/it]

 13%|█▎        | 2078/16104 [9:39:35<52:51:23, 13.57s/it]

 13%|█▎        | 2079/16104 [9:39:52<56:52:47, 14.60s/it]


 13%|█▎        | 2081/16104 [9:40:26<63:38:51, 16.34s/it]
{'loss': 0.5677, 'learning_rate': 1.9488576698393116e-06, 'rewards/chosen': -0.6104449033737183, 'rewards/rejected': -1.2902311086654663, 'rewards/accuracies': 1.0, 'rewards/margins': 0.6797861456871033, 'policy_logps/rejected': -398.012451171875, 'policy_logps/chosen': -531.1912231445312, 'referece_logps/rejected': -385.1101379394531, 'referece_logps/chosen': -525.0868530273438, 'logits/rejected': -0.08751904964447021, 'logits/chosen': -0.08809757977724075, 'epoch': 0.78}

 13%|█▎        | 2082/16104 [9:40:46<67:28:55, 17.33s/it]


 13%|█▎        | 2084/16104 [9:41:22<69:55:51, 17.96s/it]
{'loss': 0.4628, 'learning_rate': 1.9486670079024026e-06, 'rewards/chosen': -0.9577878713607788, 'rewards/rejected': -1.6440349817276, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6862470507621765, 'policy_logps/rejected': -307.9857177734375, 'policy_logps/chosen': -233.27337646484375, 'referece_logps/rejected': -291.5453796386719, 'referece_logps/chosen': -223.6954803466797, 'logits/rejected': -0.9572343230247498, 'logits/chosen': -0.879572868347168, 'epoch': 0.78}

 13%|█▎        | 2085/16104 [9:41:35<63:58:21, 16.43s/it]

 13%|█▎        | 2086/16104 [9:41:54<66:12:04, 17.00s/it]

 13%|█▎        | 2087/16104 [9:42:14<69:43:18, 17.91s/it]
[2024-04-07 22:49:16,951] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 2088/16104 [9:42:36<74:49:29, 19.22s/it]

 13%|█▎        | 2089/16104 [9:42:48<66:16:10, 17.02s/it]

 13%|█▎        | 2090/16104 [9:43:04<65:14:00, 16.76s/it]

 13%|█▎        | 2091/16104 [9:43:25<70:33:10, 18.13s/it]

 13%|█▎        | 2092/16104 [9:43:36<62:01:42, 15.94s/it]

 13%|█▎        | 2093/16104 [9:43:49<58:20:13, 14.99s/it]

 13%|█▎        | 2094/16104 [9:44:03<57:04:25, 14.67s/it]

 13%|█▎        | 2095/16104 [9:44:13<52:25:24, 13.47s/it]

 13%|█▎        | 2096/16104 [9:44:24<49:12:06, 12.64s/it]

 13%|█▎        | 2097/16104 [9:44:44<57:24:41, 14.76s/it]


 13%|█▎        | 2099/16104 [9:45:21<63:53:33, 16.42s/it]

 13%|█▎        | 2100/16104 [9:45:34<60:36:54, 15.58s/it]

 13%|█▎        | 2101/16104 [9:45:54<65:35:26, 16.86s/it]

 13%|█▎        | 2102/16104 [9:46:14<68:48:19, 17.69s/it]

 13%|█▎        | 2103/16104 [9:46:26<62:35:40, 16.09s/it]

 13%|█▎        | 2104/16104 [9:46:39<58:48:26, 15.12s/it]

 13%|█▎        | 2105/16104 [9:46:59<65:00:32, 16.72s/it]

 13%|█▎        | 2106/16104 [9:47:13<61:43:40, 15.88s/it]

 13%|█▎        | 2107/16104 [9:47:29<61:13:30, 15.75s/it]

 13%|█▎        | 2108/16104 [9:47:39<55:11:04, 14.19s/it]

 13%|█▎        | 2109/16104 [9:47:55<56:48:38, 14.61s/it]

 13%|█▎        | 2110/16104 [9:48:15<63:44:42, 16.40s/it]

 13%|█▎        | 2111/16104 [9:48:35<67:34:45, 17.39s/it]

 13%|█▎        | 2112/16104 [9:48:48<61:50:21, 15.91s/it]

 13%|█▎        | 2113/16104 [9:49:00<57:48:03, 14.87s/it]

 13%|█▎        | 2114/16104 [9:49:18<61:54:48, 15.93s/it]

 13%|█▎        | 2115/16104 [9:49:35<62:41:55, 16.14s/it]

 13%|█▎        | 2116/16104 [9:49:52<64:12:11, 16.52s/it]

 13%|█▎        | 2117/16104 [9:50:05<59:35:49, 15.34s/it]

 13%|█▎        | 2118/16104 [9:50:26<66:31:11, 17.12s/it]

 13%|█▎        | 2119/16104 [9:50:46<70:04:43, 18.04s/it]

 13%|█▎        | 2120/16104 [9:51:01<66:05:41, 17.02s/it]

 13%|█▎        | 2121/16104 [9:51:13<59:46:04, 15.39s/it]

 13%|█▎        | 2122/16104 [9:51:27<58:49:04, 15.14s/it]

 13%|█▎        | 2123/16104 [9:51:41<56:45:04, 14.61s/it]

 13%|█▎        | 2124/16104 [9:51:58<60:05:59, 15.48s/it]

 13%|█▎        | 2125/16104 [9:52:19<66:37:07, 17.16s/it]
[2024-04-07 22:59:00,235] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 2126/16104 [9:52:39<69:43:11, 17.96s/it]
[2024-04-07 22:59:20,059] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 13%|█▎        | 2127/16104 [9:52:54<66:50:42, 17.22s/it]

 13%|█▎        | 2128/16104 [9:53:10<65:17:15, 16.82s/it]

 13%|█▎        | 2129/16104 [9:53:28<66:02:08, 17.01s/it]

 13%|█▎        | 2130/16104 [9:53:47<68:58:55, 17.77s/it]

 13%|█▎        | 2131/16104 [9:54:04<67:07:38, 17.29s/it]

 13%|█▎        | 2132/16104 [9:54:25<71:24:42, 18.40s/it]

 13%|█▎        | 2133/16104 [9:54:36<63:24:27, 16.34s/it]

 13%|█▎        | 2134/16104 [9:54:51<61:24:52, 15.83s/it]

 13%|█▎        | 2135/16104 [9:55:07<61:23:54, 15.82s/it]

 13%|█▎        | 2136/16104 [9:55:19<57:39:28, 14.86s/it]

 13%|█▎        | 2137/16104 [9:55:34<57:45:14, 14.89s/it]

 13%|█▎        | 2138/16104 [9:55:47<55:23:46, 14.28s/it]

 13%|█▎        | 2139/16104 [9:56:07<61:32:56, 15.87s/it]

 13%|█▎        | 2140/16104 [9:56:19<57:23:03, 14.79s/it]

 13%|█▎        | 2141/16104 [9:56:32<55:29:56, 14.31s/it]

 13%|█▎        | 2142/16104 [9:56:51<60:51:45, 15.69s/it]

 13%|█▎        | 2143/16104 [9:57:10<65:11:29, 16.81s/it]

 13%|█▎        | 2144/16104 [9:57:24<61:40:00, 15.90s/it]

 13%|█▎        | 2145/16104 [9:57:37<57:57:28, 14.95s/it]

 13%|█▎        | 2146/16104 [9:57:49<54:57:18, 14.17s/it]

 13%|█▎        | 2147/16104 [9:58:00<51:19:11, 13.24s/it]

 13%|█▎        | 2148/16104 [9:58:13<50:47:40, 13.10s/it]

 13%|█▎        | 2149/16104 [9:58:32<57:01:29, 14.71s/it]

 13%|█▎        | 2150/16104 [9:58:52<64:17:06, 16.58s/it]

 13%|█▎        | 2151/16104 [9:59:11<66:34:07, 17.18s/it]
[2024-04-07 23:05:52,069] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5219, 'learning_rate': 1.944319031326083e-06, 'rewards/chosen': -1.2449589967727661, 'rewards/rejected': -1.9877327680587769, 'rewards/accuracies': 0.625, 'rewards/margins': 0.742773711681366, 'policy_logps/rejected': -384.66143798828125, 'policy_logps/chosen': -321.92523193359375, 'referece_logps/rejected': -364.78411865234375, 'referece_logps/chosen': -309.4756164550781, 'logits/rejected': -0.3677743673324585, 'logits/chosen': -0.3996348977088928, 'epoch': 0.8}

 13%|█▎        | 2152/16104 [9:59:32<70:50:46, 18.28s/it]


 13%|█▎        | 2154/16104 [10:00:03<64:14:28, 16.58s/it]

 13%|█▎        | 2155/16104 [10:00:23<68:12:57, 17.61s/it]

 13%|█▎        | 2156/16104 [10:00:43<70:26:01, 18.18s/it]

 13%|█▎        | 2157/16104 [10:01:00<68:50:28, 17.77s/it]

 13%|█▎        | 2158/16104 [10:01:19<70:59:15, 18.32s/it]

 13%|█▎        | 2159/16104 [10:01:38<71:10:12, 18.37s/it]

 13%|█▎        | 2160/16104 [10:01:55<70:03:47, 18.09s/it]
{'loss': 0.5588, 'learning_rate': 1.9437218930543827e-06, 'rewards/chosen': -1.063308596611023, 'rewards/rejected': -1.6954684257507324, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6321597099304199, 'policy_logps/rejected': -274.7160949707031, 'policy_logps/chosen': -237.0872039794922, 'referece_logps/rejected': -257.76141357421875, 'referece_logps/chosen': -226.4541015625, 'logits/rejected': -0.5905554294586182, 'logits/chosen': -0.4929369390010834, 'epoch': 0.8}


 13%|█▎        | 2162/16104 [10:02:28<65:36:53, 16.94s/it]

 13%|█▎        | 2163/16104 [10:02:49<70:05:34, 18.10s/it]

 13%|█▎        | 2164/16104 [10:03:10<73:02:00, 18.86s/it]

 13%|█▎        | 2165/16104 [10:03:26<69:39:59, 17.99s/it]

 13%|█▎        | 2166/16104 [10:03:43<69:01:37, 17.83s/it]

 13%|█▎        | 2167/16104 [10:04:05<73:12:51, 18.91s/it]
{'loss': 0.6075, 'learning_rate': 1.94325531426327e-06, 'rewards/chosen': -0.7890177369117737, 'rewards/rejected': -0.6228945255279541, 'rewards/accuracies': 0.25, 'rewards/margins': -0.1661231964826584, 'policy_logps/rejected': -512.1752319335938, 'policy_logps/chosen': -444.7860107421875, 'referece_logps/rejected': -505.9462890625, 'referece_logps/chosen': -436.8958435058594, 'logits/rejected': -0.5952133536338806, 'logits/chosen': -0.5735412240028381, 'epoch': 0.81}


 13%|█▎        | 2169/16104 [10:04:31<61:34:30, 15.91s/it]

 13%|█▎        | 2170/16104 [10:04:43<57:34:23, 14.87s/it]

 13%|█▎        | 2171/16104 [10:04:59<58:23:49, 15.09s/it]

 13%|█▎        | 2172/16104 [10:05:12<56:03:51, 14.49s/it]

 13%|█▎        | 2173/16104 [10:05:23<52:38:59, 13.61s/it]

 13%|█▎        | 2174/16104 [10:05:35<49:41:55, 12.84s/it]
{'loss': 0.5166, 'learning_rate': 1.9427868658107862e-06, 'rewards/chosen': -0.7211313247680664, 'rewards/rejected': -1.8726844787597656, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1515532732009888, 'policy_logps/rejected': -317.89703369140625, 'policy_logps/chosen': -371.405029296875, 'referece_logps/rejected': -299.1701965332031, 'referece_logps/chosen': -364.1937255859375, 'logits/rejected': 0.36495107412338257, 'logits/chosen': 0.2654881477355957, 'epoch': 0.81}


 14%|█▎        | 2176/16104 [10:06:07<54:43:08, 14.14s/it]

 14%|█▎        | 2177/16104 [10:06:24<58:25:56, 15.10s/it]

 14%|█▎        | 2178/16104 [10:06:43<63:35:22, 16.44s/it]

 14%|█▎        | 2179/16104 [10:07:03<67:13:57, 17.38s/it]

 14%|█▎        | 2180/16104 [10:07:25<73:06:08, 18.90s/it]

 14%|█▎        | 2181/16104 [10:07:38<65:22:54, 16.91s/it]
{'loss': 0.5539, 'learning_rate': 1.94231654862546e-06, 'rewards/chosen': -0.5153616070747375, 'rewards/rejected': -1.429370641708374, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9140090942382812, 'policy_logps/rejected': -325.4758605957031, 'policy_logps/chosen': -366.90924072265625, 'referece_logps/rejected': -311.1821594238281, 'referece_logps/chosen': -361.7555847167969, 'logits/rejected': -0.9997305870056152, 'logits/chosen': -0.847813606262207, 'epoch': 0.81}


 14%|█▎        | 2183/16104 [10:08:18<72:25:41, 18.73s/it]
[2024-04-07 23:14:59,155] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5644, 'learning_rate': 1.942181829180517e-06, 'rewards/chosen': -0.9279180765151978, 'rewards/rejected': -1.5092582702636719, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5813400745391846, 'policy_logps/rejected': -629.59130859375, 'policy_logps/chosen': -548.01220703125, 'referece_logps/rejected': -614.498779296875, 'referece_logps/chosen': -538.7330322265625, 'logits/rejected': -0.39469340443611145, 'logits/chosen': -0.1873471438884735, 'epoch': 0.81}

 14%|█▎        | 2184/16104 [10:08:31<65:07:43, 16.84s/it]

 14%|█▎        | 2185/16104 [10:08:50<68:18:17, 17.67s/it]

 14%|█▎        | 2186/16104 [10:09:01<60:15:14, 15.59s/it]

 14%|█▎        | 2187/16104 [10:09:20<63:48:44, 16.51s/it]

 14%|█▎        | 2188/16104 [10:09:35<62:24:51, 16.15s/it]

 14%|█▎        | 2189/16104 [10:09:55<66:59:05, 17.33s/it]
{'loss': 0.5563, 'learning_rate': 1.941776756222542e-06, 'rewards/chosen': -0.8972305059432983, 'rewards/rejected': -1.073791742324829, 'rewards/accuracies': 0.625, 'rewards/margins': 0.176561176776886, 'policy_logps/rejected': -352.39361572265625, 'policy_logps/chosen': -334.3150329589844, 'referece_logps/rejected': -341.65570068359375, 'referece_logps/chosen': -325.3427429199219, 'logits/rejected': 0.15242642164230347, 'logits/chosen': 0.29146772623062134, 'epoch': 0.82}
[2024-04-07 23:16:55,702] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 14%|█▎        | 2191/16104 [10:10:27<63:22:01, 16.40s/it]

 14%|█▎        | 2192/16104 [10:10:44<63:55:51, 16.54s/it]

 14%|█▎        | 2193/16104 [10:11:04<67:56:25, 17.58s/it]

 14%|█▎        | 2194/16104 [10:11:20<65:58:47, 17.08s/it]

 14%|█▎        | 2195/16104 [10:11:42<71:29:12, 18.50s/it]
[2024-04-07 23:18:22,855] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▎        | 2196/16104 [10:11:55<65:12:46, 16.88s/it]

 14%|█▎        | 2197/16104 [10:12:13<66:40:44, 17.26s/it]

 14%|█▎        | 2198/16104 [10:12:31<67:33:46, 17.49s/it]

 14%|█▎        | 2199/16104 [10:12:49<68:18:26, 17.68s/it]

 14%|█▎        | 2200/16104 [10:13:00<60:23:07, 15.63s/it]
{'loss': 0.4744, 'learning_rate': 1.9410305608661742e-06, 'rewards/chosen': -0.803533136844635, 'rewards/rejected': -1.4177650213241577, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6142318844795227, 'policy_logps/rejected': -457.3024597167969, 'policy_logps/chosen': -560.7411499023438, 'referece_logps/rejected': -443.12481689453125, 'referece_logps/chosen': -552.705810546875, 'logits/rejected': -1.224879503250122, 'logits/chosen': -1.3067320585250854, 'epoch': 0.82}

 14%|█▎        | 2201/16104 [10:13:13<56:51:58, 14.72s/it]


 14%|█▎        | 2203/16104 [10:13:48<63:40:45, 16.49s/it]
{'loss': 0.525, 'learning_rate': 1.9408262534941518e-06, 'rewards/chosen': -1.619844675064087, 'rewards/rejected': -2.5617973804473877, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9419525861740112, 'policy_logps/rejected': -356.10955810546875, 'policy_logps/chosen': -445.4728698730469, 'referece_logps/rejected': -330.4915771484375, 'referece_logps/chosen': -429.2744445800781, 'logits/rejected': -0.5458919405937195, 'logits/chosen': -0.5060351490974426, 'epoch': 0.82}


 14%|█▎        | 2205/16104 [10:14:25<66:41:05, 17.27s/it]

 14%|█▎        | 2206/16104 [10:14:48<73:08:27, 18.95s/it]

 14%|█▎        | 2207/16104 [10:15:06<72:22:55, 18.75s/it]

 14%|█▎        | 2208/16104 [10:15:24<71:32:19, 18.53s/it]

 14%|█▎        | 2209/16104 [10:15:44<73:24:47, 19.02s/it]
{'loss': 0.5359, 'learning_rate': 1.9404166112559173e-06, 'rewards/chosen': -1.2200335264205933, 'rewards/rejected': -1.9430906772613525, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7230569124221802, 'policy_logps/rejected': -314.98260498046875, 'policy_logps/chosen': -329.6139221191406, 'referece_logps/rejected': -295.55169677734375, 'referece_logps/chosen': -317.41357421875, 'logits/rejected': -1.3137940168380737, 'logits/chosen': -1.21047842502594, 'epoch': 0.82}


 14%|█▎        | 2211/16104 [10:16:22<73:27:25, 19.03s/it]
{'loss': 0.6518, 'learning_rate': 1.9402797594814512e-06, 'rewards/chosen': -1.1700257062911987, 'rewards/rejected': -1.612714409828186, 'rewards/accuracies': 0.75, 'rewards/margins': 0.44268864393234253, 'policy_logps/rejected': -364.9201965332031, 'policy_logps/chosen': -404.908203125, 'referece_logps/rejected': -348.79302978515625, 'referece_logps/chosen': -393.2079772949219, 'logits/rejected': 0.19079644978046417, 'logits/chosen': 0.17167922854423523, 'epoch': 0.82}


 14%|█▎        | 2213/16104 [10:16:52<66:15:54, 17.17s/it]

 14%|█▎        | 2214/16104 [10:17:10<66:17:31, 17.18s/it]
{'loss': 0.595, 'learning_rate': 1.940074196556725e-06, 'rewards/chosen': -0.26996058225631714, 'rewards/rejected': -1.0279505252838135, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7579900026321411, 'policy_logps/rejected': -387.6097412109375, 'policy_logps/chosen': -456.02435302734375, 'referece_logps/rejected': -377.3302001953125, 'referece_logps/chosen': -453.3247375488281, 'logits/rejected': -0.36692503094673157, 'logits/chosen': -0.2549320459365845, 'epoch': 0.82}


 14%|█▍        | 2216/16104 [10:17:42<64:07:48, 16.62s/it]

 14%|█▍        | 2217/16104 [10:18:01<67:37:52, 17.53s/it]

 14%|█▍        | 2218/16104 [10:18:12<59:42:22, 15.48s/it]

 14%|█▍        | 2219/16104 [10:18:23<54:12:18, 14.05s/it]

 14%|█▍        | 2220/16104 [10:18:45<64:18:40, 16.68s/it]

 14%|█▍        | 2221/16104 [10:19:01<63:37:03, 16.50s/it]

 14%|█▍        | 2222/16104 [10:19:14<58:42:37, 15.23s/it]

 14%|█▍        | 2223/16104 [10:19:36<66:45:59, 17.32s/it]

 14%|█▍        | 2224/16104 [10:19:47<59:04:29, 15.32s/it]
{'loss': 0.6448, 'learning_rate': 1.939386515429904e-06, 'rewards/chosen': -0.6905995011329651, 'rewards/rejected': -1.0339924097061157, 'rewards/accuracies': 0.5, 'rewards/margins': 0.34339281916618347, 'policy_logps/rejected': -354.25238037109375, 'policy_logps/chosen': -351.9858093261719, 'referece_logps/rejected': -343.9124450683594, 'referece_logps/chosen': -345.079833984375, 'logits/rejected': -0.09148766100406647, 'logits/chosen': 0.004551224410533905, 'epoch': 0.83}


 14%|█▍        | 2226/16104 [10:20:18<60:42:54, 15.75s/it]
{'loss': 0.582, 'learning_rate': 1.9392485231170734e-06, 'rewards/chosen': -0.9010910391807556, 'rewards/rejected': -1.2788400650024414, 'rewards/accuracies': 0.75, 'rewards/margins': 0.37774908542633057, 'policy_logps/rejected': -240.57693481445312, 'policy_logps/chosen': -395.2539978027344, 'referece_logps/rejected': -227.7885284423828, 'referece_logps/chosen': -386.24310302734375, 'logits/rejected': 0.1942191869020462, 'logits/chosen': 0.3019380271434784, 'epoch': 0.83}
[2024-04-07 23:27:20,097] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 14%|█▍        | 2228/16104 [10:20:59<70:26:45, 18.28s/it]

 14%|█▍        | 2229/16104 [10:21:19<71:23:26, 18.52s/it]

 14%|█▍        | 2230/16104 [10:21:40<74:33:00, 19.34s/it]
{'loss': 0.626, 'learning_rate': 1.938972082582424e-06, 'rewards/chosen': -0.682246208190918, 'rewards/rejected': -1.4634796380996704, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7812334299087524, 'policy_logps/rejected': -334.73309326171875, 'policy_logps/chosen': -250.23304748535156, 'referece_logps/rejected': -320.0982971191406, 'referece_logps/chosen': -243.41058349609375, 'logits/rejected': -0.10547419637441635, 'logits/chosen': -0.13953381776809692, 'epoch': 0.83}
[2024-04-07 23:28:38,172] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 14%|█▍        | 2232/16104 [10:22:17<73:20:08, 19.03s/it]

 14%|█▍        | 2233/16104 [10:22:36<73:37:23, 19.11s/it]

 14%|█▍        | 2234/16104 [10:22:56<74:08:49, 19.25s/it]

 14%|█▍        | 2235/16104 [10:23:06<64:11:14, 16.66s/it]

 14%|█▍        | 2236/16104 [10:23:26<67:43:38, 17.58s/it]
{'loss': 0.5571, 'learning_rate': 1.938556282343637e-06, 'rewards/chosen': -1.262712001800537, 'rewards/rejected': -1.800248146057129, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5375361442565918, 'policy_logps/rejected': -454.2153625488281, 'policy_logps/chosen': -410.9019775390625, 'referece_logps/rejected': -436.212890625, 'referece_logps/chosen': -398.2748718261719, 'logits/rejected': -0.520408034324646, 'logits/chosen': -0.6383641958236694, 'epoch': 0.83}


 14%|█▍        | 2238/16104 [10:23:50<56:13:15, 14.60s/it]

 14%|█▍        | 2239/16104 [10:24:07<59:07:29, 15.35s/it]
{'loss': 0.5204, 'learning_rate': 1.9383478696416495e-06, 'rewards/chosen': -0.26559096574783325, 'rewards/rejected': -0.7700141668319702, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5044232606887817, 'policy_logps/rejected': -443.4925537109375, 'policy_logps/chosen': -333.7922058105469, 'referece_logps/rejected': -435.7924499511719, 'referece_logps/chosen': -331.13629150390625, 'logits/rejected': 0.24718528985977173, 'logits/chosen': 0.3969672918319702, 'epoch': 0.83}
[2024-04-07 23:31:10,600] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 14%|█▍        | 2241/16104 [10:24:46<65:52:11, 17.11s/it]
[2024-04-07 23:31:26,807] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 2242/16104 [10:24:57<58:56:40, 15.31s/it]

 14%|█▍        | 2243/16104 [10:25:12<59:15:54, 15.39s/it]

 14%|█▍        | 2244/16104 [10:25:31<62:32:44, 16.25s/it]

 14%|█▍        | 2245/16104 [10:25:42<56:33:41, 14.69s/it]

 14%|█▍        | 2246/16104 [10:26:03<63:48:08, 16.57s/it]

 14%|█▍        | 2247/16104 [10:26:17<60:59:15, 15.84s/it]

 14%|█▍        | 2248/16104 [10:26:28<55:42:30, 14.47s/it]
{'loss': 0.5912, 'learning_rate': 1.9377205821161947e-06, 'rewards/chosen': -0.9725233316421509, 'rewards/rejected': -1.6353940963745117, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6628708243370056, 'policy_logps/rejected': -310.82830810546875, 'policy_logps/chosen': -391.95257568359375, 'referece_logps/rejected': -294.474365234375, 'referece_logps/chosen': -382.2273254394531, 'logits/rejected': -0.28293082118034363, 'logits/chosen': -0.26029664278030396, 'epoch': 0.84}

 14%|█▍        | 2249/16104 [10:26:42<54:25:12, 14.14s/it]


 14%|█▍        | 2251/16104 [10:27:14<57:53:22, 15.04s/it]

 14%|█▍        | 2252/16104 [10:27:35<64:20:06, 16.72s/it]

 14%|█▍        | 2253/16104 [10:27:51<63:37:15, 16.54s/it]
{'loss': 0.578, 'learning_rate': 1.937370761278389e-06, 'rewards/chosen': -0.7217962145805359, 'rewards/rejected': -1.3670467138290405, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6452504396438599, 'policy_logps/rejected': -485.72015380859375, 'policy_logps/chosen': -447.4480895996094, 'referece_logps/rejected': -472.04974365234375, 'referece_logps/chosen': -440.2301025390625, 'logits/rejected': 0.3118191063404083, 'logits/chosen': 0.2408532202243805, 'epoch': 0.84}


 14%|█▍        | 2255/16104 [10:28:18<57:34:50, 14.97s/it]

 14%|█▍        | 2256/16104 [10:28:29<53:04:28, 13.80s/it]
{'loss': 0.5064, 'learning_rate': 1.9371604137332207e-06, 'rewards/chosen': -0.5362910032272339, 'rewards/rejected': -1.2997082471847534, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7634171843528748, 'policy_logps/rejected': -213.3899688720703, 'policy_logps/chosen': -305.9794921875, 'referece_logps/rejected': -200.39292907714844, 'referece_logps/chosen': -300.6166076660156, 'logits/rejected': -0.5029190182685852, 'logits/chosen': -0.6227171421051025, 'epoch': 0.84}


 14%|█▍        | 2258/16104 [10:28:55<51:42:59, 13.45s/it]
[2024-04-07 23:35:35,645] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 2259/16104 [10:29:05<48:31:54, 12.62s/it]

 14%|█▍        | 2260/16104 [10:29:16<46:22:12, 12.06s/it]
{'loss': 0.5219, 'learning_rate': 1.9368794196155757e-06, 'rewards/chosen': -0.6153222322463989, 'rewards/rejected': -1.5995910167694092, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9842686057090759, 'policy_logps/rejected': -457.30511474609375, 'policy_logps/chosen': -491.50543212890625, 'referece_logps/rejected': -441.3091735839844, 'referece_logps/chosen': -485.3522033691406, 'logits/rejected': 0.4046032428741455, 'logits/chosen': 0.4587883949279785, 'epoch': 0.84}


 14%|█▍        | 2262/16104 [10:29:47<53:10:17, 13.83s/it]

 14%|█▍        | 2263/16104 [10:30:06<60:08:50, 15.64s/it]
[2024-04-07 23:36:47,471] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 2264/16104 [10:30:23<60:51:03, 15.83s/it]

 14%|█▍        | 2265/16104 [10:30:41<63:36:00, 16.54s/it]
{'loss': 0.533, 'learning_rate': 1.9365273242749147e-06, 'rewards/chosen': -0.6912400126457214, 'rewards/rejected': -1.0383726358413696, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3471325933933258, 'policy_logps/rejected': -279.5115661621094, 'policy_logps/chosen': -391.7752380371094, 'referece_logps/rejected': -269.1278381347656, 'referece_logps/chosen': -384.86285400390625, 'logits/rejected': 0.13108821213245392, 'logits/chosen': 0.13891364634037018, 'epoch': 0.84}
[2024-04-07 23:37:43,447] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 14%|█▍        | 2267/16104 [10:31:15<63:09:28, 16.43s/it]
[2024-04-07 23:37:56,146] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 2268/16104 [10:31:35<67:21:11, 17.52s/it]
{'loss': 0.5882, 'learning_rate': 1.936315612437308e-06, 'rewards/chosen': -0.8852126598358154, 'rewards/rejected': -1.2987892627716064, 'rewards/accuracies': 0.625, 'rewards/margins': 0.41357651352882385, 'policy_logps/rejected': -391.77081298828125, 'policy_logps/chosen': -275.0023193359375, 'referece_logps/rejected': -378.78289794921875, 'referece_logps/chosen': -266.1501770019531, 'logits/rejected': -1.0688157081604004, 'logits/chosen': -0.9520167112350464, 'epoch': 0.85}

 14%|█▍        | 2269/16104 [10:31:54<69:24:17, 18.06s/it]


 14%|█▍        | 2271/16104 [10:32:36<73:59:16, 19.26s/it]
[2024-04-07 23:39:16,591] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6237, 'learning_rate': 1.936103559718975e-06, 'rewards/chosen': -0.7985859513282776, 'rewards/rejected': -1.6036003828048706, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8050143122673035, 'policy_logps/rejected': -390.3913879394531, 'policy_logps/chosen': -430.1517333984375, 'referece_logps/rejected': -374.3553771972656, 'referece_logps/chosen': -422.16583251953125, 'logits/rejected': -0.8549275398254395, 'logits/chosen': -0.7922313213348389, 'epoch': 0.85}


 14%|█▍        | 2273/16104 [10:33:11<72:23:06, 18.84s/it]

 14%|█▍        | 2274/16104 [10:33:31<73:25:16, 19.11s/it]
{'loss': 0.4589, 'learning_rate': 1.9358911661971155e-06, 'rewards/chosen': -0.6812063455581665, 'rewards/rejected': -1.737524151802063, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0563175678253174, 'policy_logps/rejected': -505.2386474609375, 'policy_logps/chosen': -359.3695068359375, 'referece_logps/rejected': -487.8634033203125, 'referece_logps/chosen': -352.55743408203125, 'logits/rejected': -0.2016918659210205, 'logits/chosen': -0.2832285761833191, 'epoch': 0.85}

 14%|█▍        | 2275/16104 [10:33:50<73:03:31, 19.02s/it]


 14%|█▍        | 2277/16104 [10:34:30<74:47:28, 19.47s/it]
{'loss': 0.5302, 'learning_rate': 1.9356784319490557e-06, 'rewards/chosen': -0.7099093794822693, 'rewards/rejected': -1.633984088897705, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9240748286247253, 'policy_logps/rejected': -530.24853515625, 'policy_logps/chosen': -548.1285400390625, 'referece_logps/rejected': -513.90869140625, 'referece_logps/chosen': -541.0294189453125, 'logits/rejected': -1.143755316734314, 'logits/chosen': -1.2005679607391357, 'epoch': 0.85}


 14%|█▍        | 2279/16104 [10:35:02<66:55:51, 17.43s/it]
{'loss': 0.5906, 'learning_rate': 1.9355364198629233e-06, 'rewards/chosen': -1.1403937339782715, 'rewards/rejected': -1.36116361618042, 'rewards/accuracies': 0.25, 'rewards/margins': 0.22076979279518127, 'policy_logps/rejected': -268.5800476074219, 'policy_logps/chosen': -278.8052062988281, 'referece_logps/rejected': -254.96841430664062, 'referece_logps/chosen': -267.4012451171875, 'logits/rejected': -1.2110226154327393, 'logits/chosen': -1.3407354354858398, 'epoch': 0.85}


 14%|█▍        | 2281/16104 [10:35:37<68:57:32, 17.96s/it]

 14%|█▍        | 2282/16104 [10:35:57<71:16:06, 18.56s/it]
{'loss': 0.4549, 'learning_rate': 1.935323117910033e-06, 'rewards/chosen': -0.6418124437332153, 'rewards/rejected': -1.472461462020874, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8306490778923035, 'policy_logps/rejected': -475.13946533203125, 'policy_logps/chosen': -422.414794921875, 'referece_logps/rejected': -460.41485595703125, 'referece_logps/chosen': -415.9966735839844, 'logits/rejected': -0.20360654592514038, 'logits/chosen': -0.41394859552383423, 'epoch': 0.85}

 14%|█▍        | 2283/16104 [10:36:18<74:09:06, 19.31s/it]


 14%|█▍        | 2285/16104 [10:36:51<67:23:13, 17.56s/it]
{'loss': 0.5506, 'learning_rate': 1.9351094754377492e-06, 'rewards/chosen': -0.6407448053359985, 'rewards/rejected': -1.138484239578247, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4977394938468933, 'policy_logps/rejected': -330.99359130859375, 'policy_logps/chosen': -360.4871826171875, 'referece_logps/rejected': -319.6087341308594, 'referece_logps/chosen': -354.0797424316406, 'logits/rejected': -0.8514096736907959, 'logits/chosen': -0.8526614308357239, 'epoch': 0.85}

 14%|█▍        | 2286/16104 [10:37:09<67:21:30, 17.55s/it]
[2024-04-07 23:44:01,399] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 2287/16104 [10:37:20<60:22:36, 15.73s/it]


 14%|█▍        | 2289/16104 [10:37:56<64:46:00, 16.88s/it]

 14%|█▍        | 2290/16104 [10:38:08<59:07:47, 15.41s/it]

 14%|█▍        | 2291/16104 [10:38:22<57:32:52, 15.00s/it]

 14%|█▍        | 2292/16104 [10:38:34<54:01:22, 14.08s/it]
{'loss': 0.4971, 'learning_rate': 1.9346096525308113e-06, 'rewards/chosen': -0.7543753385543823, 'rewards/rejected': -1.569355845451355, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8149805068969727, 'policy_logps/rejected': -383.5177001953125, 'policy_logps/chosen': -328.2132263183594, 'referece_logps/rejected': -367.8241271972656, 'referece_logps/chosen': -320.66949462890625, 'logits/rejected': -1.21956205368042, 'logits/chosen': -1.2517311573028564, 'epoch': 0.85}

 14%|█▍        | 2293/16104 [10:38:50<57:07:29, 14.89s/it]


 14%|█▍        | 2295/16104 [10:39:28<64:43:32, 16.87s/it]
{'loss': 0.5093, 'learning_rate': 1.934394875556323e-06, 'rewards/chosen': -0.9638106822967529, 'rewards/rejected': -1.652764916419983, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6889541745185852, 'policy_logps/rejected': -354.04156494140625, 'policy_logps/chosen': -389.2228088378906, 'referece_logps/rejected': -337.5139465332031, 'referece_logps/chosen': -379.584716796875, 'logits/rejected': -0.9013583660125732, 'logits/chosen': -0.9181110262870789, 'epoch': 0.86}
[2024-04-07 23:46:31,982] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 14%|█▍        | 2297/16104 [10:40:06<67:14:44, 17.53s/it]

 14%|█▍        | 2298/16104 [10:40:18<60:50:42, 15.87s/it]
{'loss': 0.6694, 'learning_rate': 1.9341797584003824e-06, 'rewards/chosen': -0.5078576803207397, 'rewards/rejected': -1.192630410194397, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6847727298736572, 'policy_logps/rejected': -438.09210205078125, 'policy_logps/chosen': -579.3545532226562, 'referece_logps/rejected': -426.1658020019531, 'referece_logps/chosen': -574.2760009765625, 'logits/rejected': -0.2937505841255188, 'logits/chosen': -0.6420938968658447, 'epoch': 0.86}

 14%|█▍        | 2299/16104 [10:40:28<54:54:22, 14.32s/it]

 14%|█▍        | 2300/16104 [10:40:45<57:47:30, 15.07s/it]


 14%|█▍        | 2302/16104 [10:41:17<59:18:39, 15.47s/it]

 14%|█▍        | 2303/16104 [10:41:31<57:43:49, 15.06s/it]
{'loss': 0.5525, 'learning_rate': 1.9338204740611337e-06, 'rewards/chosen': -1.0396775007247925, 'rewards/rejected': -1.2552086114883423, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2155310958623886, 'policy_logps/rejected': -333.986572265625, 'policy_logps/chosen': -305.9432678222656, 'referece_logps/rejected': -321.4344787597656, 'referece_logps/chosen': -295.5464782714844, 'logits/rejected': -0.7322738766670227, 'logits/chosen': -0.8320640325546265, 'epoch': 0.86}

 14%|█▍        | 2304/16104 [10:41:48<59:56:28, 15.64s/it]

 14%|█▍        | 2305/16104 [10:42:05<60:47:35, 15.86s/it]


 14%|█▍        | 2307/16104 [10:42:39<62:04:35, 16.20s/it]
{'loss': 0.6057, 'learning_rate': 1.9335323666276354e-06, 'rewards/chosen': -1.2100666761398315, 'rewards/rejected': -1.4074360132217407, 'rewards/accuracies': 0.75, 'rewards/margins': 0.19736942648887634, 'policy_logps/rejected': -224.01223754882812, 'policy_logps/chosen': -488.38763427734375, 'referece_logps/rejected': -209.93789672851562, 'referece_logps/chosen': -476.2869873046875, 'logits/rejected': -0.17804165184497833, 'logits/chosen': -0.2285398244857788, 'epoch': 0.86}

 14%|█▍        | 2308/16104 [10:42:57<63:30:01, 16.57s/it]


 14%|█▍        | 2310/16104 [10:43:24<57:00:08, 14.88s/it]
{'loss': 0.4944, 'learning_rate': 1.933315889530293e-06, 'rewards/chosen': -0.8214256763458252, 'rewards/rejected': -1.5524507761001587, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7310250997543335, 'policy_logps/rejected': -299.23431396484375, 'policy_logps/chosen': -337.1377258300781, 'referece_logps/rejected': -283.70977783203125, 'referece_logps/chosen': -328.9234619140625, 'logits/rejected': -1.039522647857666, 'logits/chosen': -0.8323010206222534, 'epoch': 0.86}


 14%|█▍        | 2312/16104 [10:43:56<58:34:48, 15.29s/it]

 14%|█▍        | 2313/16104 [10:44:13<60:52:47, 15.89s/it]

 14%|█▍        | 2314/16104 [10:44:24<54:45:37, 14.30s/it]

 14%|█▍        | 2315/16104 [10:44:46<63:20:03, 16.54s/it]

 14%|█▍        | 2316/16104 [10:44:58<58:12:53, 15.20s/it]

 14%|█▍        | 2317/16104 [10:45:18<63:19:21, 16.53s/it]
{'loss': 0.558, 'learning_rate': 1.9328094550393837e-06, 'rewards/chosen': -1.753912329673767, 'rewards/rejected': -1.448854684829712, 'rewards/accuracies': 0.25, 'rewards/margins': -0.3050575852394104, 'policy_logps/rejected': -437.4713439941406, 'policy_logps/chosen': -536.74658203125, 'referece_logps/rejected': -422.9828186035156, 'referece_logps/chosen': -519.2074584960938, 'logits/rejected': -0.4540504813194275, 'logits/chosen': -0.5057109594345093, 'epoch': 0.86}

 14%|█▍        | 2318/16104 [10:45:35<63:58:56, 16.71s/it]


 14%|█▍        | 2320/16104 [10:46:10<65:06:02, 17.00s/it]

 14%|█▍        | 2321/16104 [10:46:24<61:20:22, 16.02s/it]
{'loss': 0.595, 'learning_rate': 1.9325192336935645e-06, 'rewards/chosen': -0.7042286992073059, 'rewards/rejected': -1.2828971147537231, 'rewards/accuracies': 0.875, 'rewards/margins': 0.578668475151062, 'policy_logps/rejected': -250.0787353515625, 'policy_logps/chosen': -471.8062744140625, 'referece_logps/rejected': -237.249755859375, 'referece_logps/chosen': -464.7639465332031, 'logits/rejected': -0.6468072533607483, 'logits/chosen': -0.8250057697296143, 'epoch': 0.86}

 14%|█▍        | 2322/16104 [10:46:39<60:03:31, 15.69s/it]


 14%|█▍        | 2324/16104 [10:47:12<61:35:15, 16.09s/it]

 14%|█▍        | 2325/16104 [10:47:28<62:21:31, 16.29s/it]
{'loss': 0.6602, 'learning_rate': 1.932228408794702e-06, 'rewards/chosen': -0.7093645334243774, 'rewards/rejected': -0.7562833428382874, 'rewards/accuracies': 0.25, 'rewards/margins': 0.04691889137029648, 'policy_logps/rejected': -451.8564453125, 'policy_logps/chosen': -458.45123291015625, 'referece_logps/rejected': -444.2936096191406, 'referece_logps/chosen': -451.3575439453125, 'logits/rejected': -0.7331172823905945, 'logits/chosen': -0.789914608001709, 'epoch': 0.87}


 14%|█▍        | 2327/16104 [10:48:02<63:21:22, 16.56s/it]

 14%|█▍        | 2328/16104 [10:48:18<63:07:04, 16.49s/it]
[2024-04-07 23:54:59,275] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.6408, 'learning_rate': 1.932009894152089e-06, 'rewards/chosen': -0.7279238104820251, 'rewards/rejected': -1.0785855054855347, 'rewards/accuracies': 0.875, 'rewards/margins': 0.35066166520118713, 'policy_logps/rejected': -360.8740539550781, 'policy_logps/chosen': -285.569580078125, 'referece_logps/rejected': -350.08819580078125, 'referece_logps/chosen': -278.29034423828125, 'logits/rejected': -0.3405885696411133, 'logits/chosen': -0.20888327062129974, 'epoch': 0.87}

 14%|█▍        | 2329/16104 [10:48:38<66:26:46, 17.37s/it]
[2024-04-07 23:55:38,420] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 14%|█▍        | 2330/16104 [10:48:57<69:10:36, 18.08s/it]

 14%|█▍        | 2331/16104 [10:49:13<66:53:55, 17.49s/it]

 14%|█▍        | 2332/16104 [10:49:31<66:55:02, 17.49s/it]


 14%|█▍        | 2334/16104 [10:50:06<66:00:26, 17.26s/it]

 14%|█▍        | 2335/16104 [10:50:25<67:13:36, 17.58s/it]
{'loss': 0.6303, 'learning_rate': 1.9314987072392065e-06, 'rewards/chosen': -1.0765621662139893, 'rewards/rejected': -1.4713712930679321, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3948090672492981, 'policy_logps/rejected': -357.1435852050781, 'policy_logps/chosen': -445.22509765625, 'referece_logps/rejected': -342.4298095703125, 'referece_logps/chosen': -434.4595031738281, 'logits/rejected': 0.08626112341880798, 'logits/chosen': -0.004486635327339172, 'epoch': 0.87}


 15%|█▍        | 2337/16104 [10:51:04<71:41:32, 18.75s/it]
{'loss': 0.5395, 'learning_rate': 1.931352314664114e-06, 'rewards/chosen': -0.605645477771759, 'rewards/rejected': -1.125511884689331, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5198664665222168, 'policy_logps/rejected': -325.4343566894531, 'policy_logps/chosen': -367.05938720703125, 'referece_logps/rejected': -314.1792297363281, 'referece_logps/chosen': -361.0029602050781, 'logits/rejected': -0.47295477986335754, 'logits/chosen': -0.5190591216087341, 'epoch': 0.87}

 15%|█▍        | 2338/16104 [10:51:25<74:22:50, 19.45s/it]

 15%|█▍        | 2339/16104 [10:51:43<72:51:35, 19.06s/it]

 15%|█▍        | 2340/16104 [10:51:56<65:20:06, 17.09s/it]


 15%|█▍        | 2342/16104 [10:52:27<63:31:13, 16.62s/it]

 15%|█▍        | 2343/16104 [10:52:43<62:50:00, 16.44s/it]

 15%|█▍        | 2344/16104 [10:52:58<61:52:27, 16.19s/it]
{'loss': 0.5902, 'learning_rate': 1.930838754048781e-06, 'rewards/chosen': -1.0961651802062988, 'rewards/rejected': -1.5715352296829224, 'rewards/accuracies': 0.875, 'rewards/margins': 0.4753698706626892, 'policy_logps/rejected': -375.0982666015625, 'policy_logps/chosen': -321.19970703125, 'referece_logps/rejected': -359.3829345703125, 'referece_logps/chosen': -310.2380676269531, 'logits/rejected': -0.8125940561294556, 'logits/chosen': -0.7433396577835083, 'epoch': 0.87}
[2024-04-08 00:00:00,185] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 2345/16104 [10:53:19<67:05:20, 17.55s/it]
[2024-04-08 00:00:12,964] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 15%|█▍        | 2347/16104 [10:53:47<60:12:53, 15.76s/it]
{'loss': 0.5183, 'learning_rate': 1.9306180917714864e-06, 'rewards/chosen': -0.9748528003692627, 'rewards/rejected': -1.9222722053527832, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9474194645881653, 'policy_logps/rejected': -321.77978515625, 'policy_logps/chosen': -257.19708251953125, 'referece_logps/rejected': -302.5570373535156, 'referece_logps/chosen': -247.44857788085938, 'logits/rejected': -0.6113603115081787, 'logits/chosen': -0.5343517065048218, 'epoch': 0.87}

 15%|█▍        | 2348/16104 [10:54:00<57:11:24, 14.97s/it]

 15%|█▍        | 2349/16104 [10:54:13<55:26:51, 14.51s/it]


 15%|█▍        | 2351/16104 [10:54:46<60:43:07, 15.89s/it]
{'loss': 0.5129, 'learning_rate': 1.9303233483834022e-06, 'rewards/chosen': -0.5457294583320618, 'rewards/rejected': -1.3133437633514404, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7676143646240234, 'policy_logps/rejected': -334.7623596191406, 'policy_logps/chosen': -388.8868103027344, 'referece_logps/rejected': -321.62896728515625, 'referece_logps/chosen': -383.42950439453125, 'logits/rejected': -0.3736667335033417, 'logits/chosen': -0.3648081421852112, 'epoch': 0.88}

 15%|█▍        | 2352/16104 [10:54:59<57:34:14, 15.07s/it]


 15%|█▍        | 2354/16104 [10:55:34<61:11:38, 16.02s/it]
{'loss': 0.4789, 'learning_rate': 1.9301018956828963e-06, 'rewards/chosen': -0.2836671769618988, 'rewards/rejected': -1.1899601221084595, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9062929749488831, 'policy_logps/rejected': -251.48069763183594, 'policy_logps/chosen': -286.1957702636719, 'referece_logps/rejected': -239.58111572265625, 'referece_logps/chosen': -283.35906982421875, 'logits/rejected': -0.24775098264217377, 'logits/chosen': -0.2957235276699066, 'epoch': 0.88}


 15%|█▍        | 2356/16104 [10:56:11<65:03:22, 17.04s/it]

 15%|█▍        | 2357/16104 [10:56:31<68:04:55, 17.83s/it]

 15%|█▍        | 2358/16104 [10:56:52<72:36:25, 19.02s/it]
[2024-04-08 00:03:33,346] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 2359/16104 [10:57:15<76:29:45, 20.04s/it]
[2024-04-08 00:03:55,762] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 2360/16104 [10:57:35<76:40:07, 20.08s/it]

 15%|█▍        | 2361/16104 [10:57:51<72:03:53, 18.88s/it]

 15%|█▍        | 2362/16104 [10:58:13<75:48:34, 19.86s/it]
{'loss': 0.5297, 'learning_rate': 1.9295096998992424e-06, 'rewards/chosen': -1.0633759498596191, 'rewards/rejected': -1.351779580116272, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2884036898612976, 'policy_logps/rejected': -378.748291015625, 'policy_logps/chosen': -412.859619140625, 'referece_logps/rejected': -365.23052978515625, 'referece_logps/chosen': -402.225830078125, 'logits/rejected': -0.2649669647216797, 'logits/chosen': -0.3017849028110504, 'epoch': 0.88}

 15%|█▍        | 2363/16104 [10:58:31<74:03:38, 19.40s/it]

 15%|█▍        | 2364/16104 [10:58:44<65:59:55, 17.29s/it]

 15%|█▍        | 2365/16104 [10:58:58<61:55:34, 16.23s/it]

 15%|█▍        | 2366/16104 [10:59:08<55:32:50, 14.56s/it]
[2024-04-08 00:06:09,230] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 15%|█▍        | 2368/16104 [10:59:45<62:29:05, 16.38s/it]
{'loss': 0.484, 'learning_rate': 1.9290639737640647e-06, 'rewards/chosen': -1.0188336372375488, 'rewards/rejected': -1.838313341140747, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8194796442985535, 'policy_logps/rejected': -475.6839904785156, 'policy_logps/chosen': -608.7784423828125, 'referece_logps/rejected': -457.30084228515625, 'referece_logps/chosen': -598.590087890625, 'logits/rejected': -1.4067059755325317, 'logits/chosen': -1.557174563407898, 'epoch': 0.88}

 15%|█▍        | 2369/16104 [11:00:00<60:29:26, 15.85s/it]
[2024-04-08 00:06:56,648] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 2370/16104 [11:00:16<60:34:44, 15.88s/it]


 15%|█▍        | 2372/16104 [11:00:47<59:43:32, 15.66s/it]
{'loss': 0.6038, 'learning_rate': 1.9287660713213066e-06, 'rewards/chosen': -0.6551646590232849, 'rewards/rejected': -1.0748486518859863, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4196839928627014, 'policy_logps/rejected': -325.20880126953125, 'policy_logps/chosen': -425.2508544921875, 'referece_logps/rejected': -314.4603271484375, 'referece_logps/chosen': -418.6992492675781, 'logits/rejected': 0.4091123938560486, 'logits/chosen': 0.40379422903060913, 'epoch': 0.88}


 15%|█▍        | 2374/16104 [11:01:13<54:24:37, 14.27s/it]
{'loss': 0.5318, 'learning_rate': 1.9286168946664033e-06, 'rewards/chosen': -1.5117835998535156, 'rewards/rejected': -1.637080430984497, 'rewards/accuracies': 0.5, 'rewards/margins': 0.12529680132865906, 'policy_logps/rejected': -591.9201049804688, 'policy_logps/chosen': -468.63531494140625, 'referece_logps/rejected': -575.5492553710938, 'referece_logps/chosen': -453.5174865722656, 'logits/rejected': 0.2281665802001953, 'logits/chosen': 0.31468892097473145, 'epoch': 0.88}


 15%|█▍        | 2376/16104 [11:01:41<54:34:30, 14.31s/it]
{'loss': 0.6208, 'learning_rate': 1.9284675677546602e-06, 'rewards/chosen': -0.49112775921821594, 'rewards/rejected': -0.8832377195358276, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3921099007129669, 'policy_logps/rejected': -428.1350402832031, 'policy_logps/chosen': -431.6651611328125, 'referece_logps/rejected': -419.30267333984375, 'referece_logps/chosen': -426.7539367675781, 'logits/rejected': -0.5655272603034973, 'logits/chosen': -0.4854849576950073, 'epoch': 0.89}

 15%|█▍        | 2377/16104 [11:01:52<50:20:23, 13.20s/it]
[2024-04-08 00:08:48,683] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 15%|█▍        | 2379/16104 [11:02:28<60:14:52, 15.80s/it]
[2024-04-08 00:09:08,635] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5138, 'learning_rate': 1.92824329570833e-06, 'rewards/chosen': -1.10810387134552, 'rewards/rejected': -1.9064477682113647, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7983436584472656, 'policy_logps/rejected': -404.7493896484375, 'policy_logps/chosen': -374.55743408203125, 'referece_logps/rejected': -385.6849670410156, 'referece_logps/chosen': -363.47637939453125, 'logits/rejected': -0.27791309356689453, 'logits/chosen': -0.1383306384086609, 'epoch': 0.89}

 15%|█▍        | 2380/16104 [11:02:41<56:57:59, 14.94s/it]


 15%|█▍        | 2382/16104 [11:03:17<62:43:25, 16.46s/it]

 15%|█▍        | 2383/16104 [11:03:34<62:40:25, 16.44s/it]
{'loss': 0.5456, 'learning_rate': 1.9279437406399987e-06, 'rewards/chosen': -0.7719122767448425, 'rewards/rejected': -1.4599065780639648, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6879943609237671, 'policy_logps/rejected': -336.2456970214844, 'policy_logps/chosen': -304.3182678222656, 'referece_logps/rejected': -321.6466369628906, 'referece_logps/chosen': -296.5991516113281, 'logits/rejected': -0.7755286693572998, 'logits/chosen': -0.8152257800102234, 'epoch': 0.89}


 15%|█▍        | 2385/16104 [11:04:14<69:03:42, 18.12s/it]
{'loss': 0.5873, 'learning_rate': 1.9277937378718307e-06, 'rewards/chosen': -0.8090062141418457, 'rewards/rejected': -0.9681756496429443, 'rewards/accuracies': 0.625, 'rewards/margins': 0.15916946530342102, 'policy_logps/rejected': -315.08062744140625, 'policy_logps/chosen': -541.1548461914062, 'referece_logps/rejected': -305.39886474609375, 'referece_logps/chosen': -533.0647583007812, 'logits/rejected': -1.2569773197174072, 'logits/chosen': -1.3374310731887817, 'epoch': 0.89}

 15%|█▍        | 2386/16104 [11:04:34<71:36:33, 18.79s/it]

 15%|█▍        | 2387/16104 [11:04:52<71:02:28, 18.64s/it]


 15%|█▍        | 2389/16104 [11:05:29<71:48:47, 18.85s/it]
{'loss': 0.5337, 'learning_rate': 1.9274932819888464e-06, 'rewards/chosen': -0.5824440121650696, 'rewards/rejected': -1.3844741582870483, 'rewards/accuracies': 0.75, 'rewards/margins': 0.802030086517334, 'policy_logps/rejected': -421.5992126464844, 'policy_logps/chosen': -573.9451293945312, 'referece_logps/rejected': -407.7544860839844, 'referece_logps/chosen': -568.1206665039062, 'logits/rejected': -0.23646774888038635, 'logits/chosen': -0.19394341111183167, 'epoch': 0.89}

 15%|█▍        | 2390/16104 [11:05:47<69:53:18, 18.35s/it]


 15%|█▍        | 2392/16104 [11:06:28<73:57:17, 19.42s/it]
{'loss': 0.5309, 'learning_rate': 1.9272675461190166e-06, 'rewards/chosen': -0.5440157651901245, 'rewards/rejected': -1.2340301275253296, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6900144219398499, 'policy_logps/rejected': -373.58380126953125, 'policy_logps/chosen': -393.0436706542969, 'referece_logps/rejected': -361.24346923828125, 'referece_logps/chosen': -387.6035461425781, 'logits/rejected': -0.8073207139968872, 'logits/chosen': -0.8264912962913513, 'epoch': 0.89}

 15%|█▍        | 2393/16104 [11:06:46<72:41:27, 19.09s/it]

 15%|█▍        | 2394/16104 [11:07:03<70:00:43, 18.38s/it]

 15%|█▍        | 2395/16104 [11:07:15<62:44:43, 16.48s/it]

 15%|█▍        | 2396/16104 [11:07:34<66:11:53, 17.38s/it]


 15%|█▍        | 2398/16104 [11:08:12<69:38:45, 18.29s/it]
[2024-04-08 00:14:52,758] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5197, 'learning_rate': 1.926815061701762e-06, 'rewards/chosen': -0.8894974589347839, 'rewards/rejected': -1.538316249847412, 'rewards/accuracies': 0.875, 'rewards/margins': 0.648818850517273, 'policy_logps/rejected': -369.0107421875, 'policy_logps/chosen': -366.0986328125, 'referece_logps/rejected': -353.6275634765625, 'referece_logps/chosen': -357.2036437988281, 'logits/rejected': -0.4998537003993988, 'logits/chosen': -0.5404055118560791, 'epoch': 0.89}


 15%|█▍        | 2400/16104 [11:08:50<71:57:51, 18.90s/it]
[2024-04-08 00:15:30,847] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5833, 'learning_rate': 1.9266639335995304e-06, 'rewards/chosen': -1.0106449127197266, 'rewards/rejected': -2.547771692276001, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5371267795562744, 'policy_logps/rejected': -326.1136474609375, 'policy_logps/chosen': -508.5497741699219, 'referece_logps/rejected': -300.63592529296875, 'referece_logps/chosen': -498.44329833984375, 'logits/rejected': -0.6694260239601135, 'logits/chosen': -0.6716858148574829, 'epoch': 0.89}

 15%|█▍        | 2401/16104 [11:09:03<65:37:26, 17.24s/it]

 15%|█▍        | 2402/16104 [11:09:22<66:56:22, 17.59s/it]


 15%|█▍        | 2404/16104 [11:09:58<67:03:11, 17.62s/it]
{'loss': 0.5405, 'learning_rate': 1.9263612275970332e-06, 'rewards/chosen': -0.7558879852294922, 'rewards/rejected': -1.4859076738357544, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7300198078155518, 'policy_logps/rejected': -326.2373046875, 'policy_logps/chosen': -423.176513671875, 'referece_logps/rejected': -311.37823486328125, 'referece_logps/chosen': -415.61767578125, 'logits/rejected': -0.0009524822235107422, 'logits/chosen': -0.008908569812774658, 'epoch': 0.9}

 15%|█▍        | 2405/16104 [11:10:10<61:10:36, 16.08s/it]

 15%|█▍        | 2406/16104 [11:10:29<63:56:30, 16.80s/it]


 15%|█▍        | 2408/16104 [11:11:02<64:08:54, 16.86s/it]
{'loss': 0.5254, 'learning_rate': 1.9260579220271306e-06, 'rewards/chosen': -0.9461246728897095, 'rewards/rejected': -1.2558003664016724, 'rewards/accuracies': 0.75, 'rewards/margins': 0.30967575311660767, 'policy_logps/rejected': -481.27471923828125, 'policy_logps/chosen': -504.7389831542969, 'referece_logps/rejected': -468.71673583984375, 'referece_logps/chosen': -495.27777099609375, 'logits/rejected': -0.5349684357643127, 'logits/chosen': -0.4191593527793884, 'epoch': 0.9}

 15%|█▍        | 2409/16104 [11:11:15<59:40:34, 15.69s/it]

 15%|█▍        | 2410/16104 [11:11:29<57:37:29, 15.15s/it]


 15%|█▍        | 2412/16104 [11:12:00<57:59:24, 15.25s/it]

 15%|█▍        | 2413/16104 [11:12:16<58:56:18, 15.50s/it]
{'loss': 0.5556, 'learning_rate': 1.9256779472221884e-06, 'rewards/chosen': -1.1363835334777832, 'rewards/rejected': -1.456279993057251, 'rewards/accuracies': 0.625, 'rewards/margins': 0.31989648938179016, 'policy_logps/rejected': -408.38922119140625, 'policy_logps/chosen': -440.60162353515625, 'referece_logps/rejected': -393.82635498046875, 'referece_logps/chosen': -429.23779296875, 'logits/rejected': 0.1358429193496704, 'logits/chosen': 0.15379922091960907, 'epoch': 0.9}
[2024-04-08 00:19:18,720] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▍        | 2414/16104 [11:12:38<66:08:16, 17.39s/it]

 15%|█▍        | 2415/16104 [11:12:55<66:03:57, 17.37s/it]

 15%|█▌        | 2416/16104 [11:13:19<73:12:41, 19.25s/it]


 15%|█▌        | 2418/16104 [11:13:52<67:49:49, 17.84s/it]
{'loss': 0.4858, 'learning_rate': 1.925297036284201e-06, 'rewards/chosen': -0.847362220287323, 'rewards/rejected': -1.9467583894729614, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0993962287902832, 'policy_logps/rejected': -281.4583740234375, 'policy_logps/chosen': -294.5179748535156, 'referece_logps/rejected': -261.99078369140625, 'referece_logps/chosen': -286.04437255859375, 'logits/rejected': -0.6491707563400269, 'logits/chosen': -0.6080847978591919, 'epoch': 0.9}

 15%|█▌        | 2419/16104 [11:14:11<69:13:49, 18.21s/it]

 15%|█▌        | 2420/16104 [11:14:31<70:54:47, 18.66s/it]

 15%|█▌        | 2421/16104 [11:14:49<69:50:09, 18.37s/it]

 15%|█▌        | 2422/16104 [11:15:06<68:04:59, 17.91s/it]

 15%|█▌        | 2423/16104 [11:15:25<70:04:34, 18.44s/it]


 15%|█▌        | 2425/16104 [11:16:00<66:30:30, 17.50s/it]
{'loss': 0.4827, 'learning_rate': 1.9247621890011292e-06, 'rewards/chosen': -0.7436245083808899, 'rewards/rejected': -1.1402915716171265, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3966670632362366, 'policy_logps/rejected': -277.96435546875, 'policy_logps/chosen': -412.656494140625, 'referece_logps/rejected': -266.5614318847656, 'referece_logps/chosen': -405.2202453613281, 'logits/rejected': 0.3792336583137512, 'logits/chosen': 0.3345436155796051, 'epoch': 0.9}

 15%|█▌        | 2426/16104 [11:16:11<59:13:02, 15.59s/it]

 15%|█▌        | 2427/16104 [11:16:28<60:59:24, 16.05s/it]

 15%|█▌        | 2428/16104 [11:16:46<62:13:17, 16.38s/it]


 15%|█▌        | 2430/16104 [11:17:24<68:35:07, 18.06s/it]
{'loss': 0.5388, 'learning_rate': 1.9243790329173052e-06, 'rewards/chosen': -0.5483607053756714, 'rewards/rejected': -1.4813534021377563, 'rewards/accuracies': 0.75, 'rewards/margins': 0.932992696762085, 'policy_logps/rejected': -341.7742004394531, 'policy_logps/chosen': -310.7160949707031, 'referece_logps/rejected': -326.9606628417969, 'referece_logps/chosen': -305.23248291015625, 'logits/rejected': -0.9560940265655518, 'logits/chosen': -0.7894865274429321, 'epoch': 0.91}

 15%|█▌        | 2431/16104 [11:17:36<61:02:51, 16.07s/it]

 15%|█▌        | 2432/16104 [11:17:57<67:11:04, 17.69s/it]


 15%|█▌        | 2434/16104 [11:18:26<62:12:29, 16.38s/it]
{'loss': 0.5217, 'learning_rate': 1.924071834961604e-06, 'rewards/chosen': -0.5354694724082947, 'rewards/rejected': -1.0616968870162964, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5262273550033569, 'policy_logps/rejected': -310.851806640625, 'policy_logps/chosen': -448.58905029296875, 'referece_logps/rejected': -300.23480224609375, 'referece_logps/chosen': -443.2344055175781, 'logits/rejected': -0.33334121108055115, 'logits/chosen': -0.4180912375450134, 'epoch': 0.91}

 15%|█▌        | 2435/16104 [11:18:42<61:04:07, 16.08s/it]

 15%|█▌        | 2436/16104 [11:18:58<61:31:33, 16.21s/it]


 15%|█▌        | 2438/16104 [11:19:32<64:32:18, 17.00s/it]
{'loss': 0.5828, 'learning_rate': 1.923764038920257e-06, 'rewards/chosen': -0.7096256613731384, 'rewards/rejected': -1.4038920402526855, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6942663192749023, 'policy_logps/rejected': -366.6393737792969, 'policy_logps/chosen': -462.8058776855469, 'referece_logps/rejected': -352.6004638671875, 'referece_logps/chosen': -455.70965576171875, 'logits/rejected': -0.5740761160850525, 'logits/chosen': -0.5600755214691162, 'epoch': 0.91}
[2024-04-08 00:26:35,070] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▌        | 2439/16104 [11:19:54<69:52:20, 18.41s/it]

 15%|█▌        | 2440/16104 [11:20:07<63:28:08, 16.72s/it]

 15%|█▌        | 2441/16104 [11:20:25<65:37:53, 17.29s/it]

 15%|█▌        | 2442/16104 [11:20:42<64:15:54, 16.93s/it]


 15%|█▌        | 2444/16104 [11:21:21<69:20:48, 18.28s/it]
{'loss': 0.592, 'learning_rate': 1.9233012238835394e-06, 'rewards/chosen': -0.6534391641616821, 'rewards/rejected': -1.5974342823028564, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9439951181411743, 'policy_logps/rejected': -467.679931640625, 'policy_logps/chosen': -401.15692138671875, 'referece_logps/rejected': -451.70562744140625, 'referece_logps/chosen': -394.62249755859375, 'logits/rejected': -1.4917672872543335, 'logits/chosen': -1.382744550704956, 'epoch': 0.91}

 15%|█▌        | 2445/16104 [11:21:37<67:19:41, 17.75s/it]

 15%|█▌        | 2446/16104 [11:21:58<70:16:53, 18.52s/it]

 15%|█▌        | 2447/16104 [11:22:18<72:01:22, 18.99s/it]

 15%|█▌        | 2448/16104 [11:22:34<69:11:14, 18.24s/it]


 15%|█▌        | 2450/16104 [11:23:17<75:07:18, 19.81s/it]
{'loss': 0.4293, 'learning_rate': 1.922837064276424e-06, 'rewards/chosen': -0.6775791049003601, 'rewards/rejected': -1.9012553691864014, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2236762046813965, 'policy_logps/rejected': -343.7186584472656, 'policy_logps/chosen': -495.2041320800781, 'referece_logps/rejected': -324.7060852050781, 'referece_logps/chosen': -488.42828369140625, 'logits/rejected': -0.6935087442398071, 'logits/chosen': -0.7651264667510986, 'epoch': 0.91}

 15%|█▌        | 2451/16104 [11:23:31<69:02:11, 18.20s/it]

 15%|█▌        | 2452/16104 [11:23:50<69:32:58, 18.34s/it]

 15%|█▌        | 2453/16104 [11:24:06<67:28:31, 17.79s/it]


 15%|█▌        | 2455/16104 [11:24:35<61:44:35, 16.29s/it]
{'loss': 0.5368, 'learning_rate': 1.922449237989038e-06, 'rewards/chosen': -0.9216188788414001, 'rewards/rejected': -1.8238052129745483, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9021862745285034, 'policy_logps/rejected': -285.06134033203125, 'policy_logps/chosen': -267.63653564453125, 'referece_logps/rejected': -266.82330322265625, 'referece_logps/chosen': -258.42034912109375, 'logits/rejected': -0.7328802347183228, 'logits/chosen': -0.5589535236358643, 'epoch': 0.91}


 15%|█▌        | 2457/16104 [11:25:11<64:47:22, 17.09s/it]
{'loss': 0.5828, 'learning_rate': 1.9222938462490846e-06, 'rewards/chosen': -1.2856045961380005, 'rewards/rejected': -1.8847236633300781, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5991191267967224, 'policy_logps/rejected': -346.55865478515625, 'policy_logps/chosen': -247.0544891357422, 'referece_logps/rejected': -327.7113952636719, 'referece_logps/chosen': -234.19842529296875, 'logits/rejected': -1.1364917755126953, 'logits/chosen': -1.109128475189209, 'epoch': 0.92}

 15%|█▌        | 2458/16104 [11:25:23<59:24:16, 15.67s/it]


 15%|█▌        | 2460/16104 [11:26:07<71:28:33, 18.86s/it]
{'loss': 0.5068, 'learning_rate': 1.922060478833783e-06, 'rewards/chosen': -0.5236296057701111, 'rewards/rejected': -0.9228708744049072, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3992413878440857, 'policy_logps/rejected': -336.8324890136719, 'policy_logps/chosen': -441.81365966796875, 'referece_logps/rejected': -327.60382080078125, 'referece_logps/chosen': -436.5773620605469, 'logits/rejected': -0.07410266995429993, 'logits/chosen': -0.001940906047821045, 'epoch': 0.92}

 15%|█▌        | 2461/16104 [11:26:19<64:07:17, 16.92s/it]

 15%|█▌        | 2462/16104 [11:26:38<66:03:37, 17.43s/it]

 15%|█▌        | 2463/16104 [11:26:59<70:35:37, 18.63s/it]


 15%|█▌        | 2465/16104 [11:27:35<68:59:48, 18.21s/it]
{'loss': 0.5109, 'learning_rate': 1.921670787203809e-06, 'rewards/chosen': -0.4509052336215973, 'rewards/rejected': -1.5903804302215576, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1394752264022827, 'policy_logps/rejected': -347.68109130859375, 'policy_logps/chosen': -520.73974609375, 'referece_logps/rejected': -331.7773132324219, 'referece_logps/chosen': -516.230712890625, 'logits/rejected': 0.20911920070648193, 'logits/chosen': 0.15201839804649353, 'epoch': 0.92}

 15%|█▌        | 2466/16104 [11:27:49<64:37:50, 17.06s/it]

 15%|█▌        | 2467/16104 [11:28:03<60:30:36, 15.97s/it]

 15%|█▌        | 2468/16104 [11:28:24<66:40:22, 17.60s/it]


 15%|█▌        | 2470/16104 [11:28:55<62:16:30, 16.44s/it]
{'loss': 0.4799, 'learning_rate': 1.921280163493209e-06, 'rewards/chosen': -0.7923561334609985, 'rewards/rejected': -1.9084144830703735, 'rewards/accuracies': 0.875, 'rewards/margins': 1.116058349609375, 'policy_logps/rejected': -251.4615936279297, 'policy_logps/chosen': -384.9958190917969, 'referece_logps/rejected': -232.3774871826172, 'referece_logps/chosen': -377.072265625, 'logits/rejected': -0.3342393934726715, 'logits/chosen': -0.3023292124271393, 'epoch': 0.92}

 15%|█▌        | 2471/16104 [11:29:10<61:04:28, 16.13s/it]

 15%|█▌        | 2472/16104 [11:29:28<63:15:25, 16.71s/it]

 15%|█▌        | 2473/16104 [11:29:41<58:22:30, 15.42s/it]

 15%|█▌        | 2474/16104 [11:29:53<55:10:29, 14.57s/it]

 15%|█▌        | 2475/16104 [11:30:13<61:04:49, 16.13s/it]

 15%|█▌        | 2476/16104 [11:30:27<58:03:19, 15.34s/it]

 15%|█▌        | 2477/16104 [11:30:37<52:42:39, 13.93s/it]
[2024-04-08 00:37:37,984] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▌        | 2478/16104 [11:30:57<59:13:10, 15.65s/it]

 15%|█▌        | 2479/16104 [11:31:08<53:35:25, 14.16s/it]

 15%|█▌        | 2480/16104 [11:31:25<57:21:29, 15.16s/it]

 15%|█▌        | 2481/16104 [11:31:43<60:57:53, 16.11s/it]

 15%|█▌        | 2482/16104 [11:32:00<61:15:16, 16.19s/it]


 15%|█▌        | 2484/16104 [11:32:32<60:05:08, 15.88s/it]

 15%|█▌        | 2485/16104 [11:32:51<63:33:06, 16.80s/it]

 15%|█▌        | 2486/16104 [11:33:03<57:26:55, 15.19s/it]

 15%|█▌        | 2487/16104 [11:33:23<63:03:01, 16.67s/it]

 15%|█▌        | 2488/16104 [11:33:43<67:22:00, 17.81s/it]

 15%|█▌        | 2489/16104 [11:33:57<63:01:15, 16.66s/it]

 15%|█▌        | 2490/16104 [11:34:18<67:42:19, 17.90s/it]

 15%|█▌        | 2491/16104 [11:34:39<70:51:00, 18.74s/it]
[2024-04-08 00:41:19,632] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 15%|█▌        | 2492/16104 [11:34:57<70:22:43, 18.61s/it]

 15%|█▌        | 2493/16104 [11:35:16<70:22:57, 18.62s/it]

 15%|█▌        | 2494/16104 [11:35:32<68:00:55, 17.99s/it]

 15%|█▌        | 2495/16104 [11:35:46<63:39:58, 16.84s/it]

 15%|█▌        | 2496/16104 [11:35:59<59:19:42, 15.70s/it]

 16%|█▌        | 2497/16104 [11:36:16<60:24:14, 15.98s/it]

 16%|█▌        | 2498/16104 [11:36:28<56:18:01, 14.90s/it]

 16%|█▌        | 2499/16104 [11:36:51<64:45:08, 17.13s/it]
[2024-04-08 00:43:31,662] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 16%|█▌        | 2500/16104 [11:37:06<62:25:33, 16.52s/it]

 16%|█▌        | 2501/16104 [11:37:34<75:50:03, 20.07s/it]

 16%|█▌        | 2502/16104 [11:37:50<71:34:47, 18.94s/it]

 16%|█▌        | 2503/16104 [11:38:12<75:04:36, 19.87s/it]

 16%|█▌        | 2504/16104 [11:38:32<74:33:18, 19.74s/it]

 16%|█▌        | 2505/16104 [11:38:48<70:22:24, 18.63s/it]

 16%|█▌        | 2506/16104 [11:39:08<71:33:50, 18.95s/it]

 16%|█▌        | 2507/16104 [11:39:28<73:20:30, 19.42s/it]

 16%|█▌        | 2508/16104 [11:39:41<66:29:34, 17.61s/it]

 16%|█▌        | 2509/16104 [11:39:59<66:47:53, 17.69s/it]

 16%|█▌        | 2510/16104 [11:40:19<68:58:29, 18.27s/it]

 16%|█▌        | 2511/16104 [11:40:36<67:51:45, 17.97s/it]

 16%|█▌        | 2512/16104 [11:40:55<68:33:25, 18.16s/it]

 16%|█▌        | 2513/16104 [11:41:11<65:58:50, 17.48s/it]

 16%|█▌        | 2514/16104 [11:41:26<63:58:15, 16.95s/it]

 16%|█▌        | 2515/16104 [11:41:40<59:52:49, 15.86s/it]

 16%|█▌        | 2516/16104 [11:42:01<66:05:11, 17.51s/it]

 16%|█▌        | 2517/16104 [11:42:13<59:16:14, 15.70s/it]

 16%|█▌        | 2518/16104 [11:42:25<55:20:26, 14.66s/it]

 16%|█▌        | 2519/16104 [11:42:37<52:30:37, 13.92s/it]

 16%|█▌        | 2520/16104 [11:42:56<58:49:25, 15.59s/it]

 16%|█▌        | 2521/16104 [11:43:10<56:28:30, 14.97s/it]

 16%|█▌        | 2522/16104 [11:43:30<61:43:11, 16.36s/it]

 16%|█▌        | 2523/16104 [11:43:50<66:15:10, 17.56s/it]

 16%|█▌        | 2524/16104 [11:44:12<71:25:23, 18.93s/it]

 16%|█▌        | 2525/16104 [11:44:34<75:16:13, 19.96s/it]

 16%|█▌        | 2526/16104 [11:44:46<65:43:57, 17.43s/it]

 16%|█▌        | 2527/16104 [11:45:02<64:20:33, 17.06s/it]

 16%|█▌        | 2528/16104 [11:45:22<66:59:09, 17.76s/it]

 16%|█▌        | 2529/16104 [11:45:43<71:05:07, 18.85s/it]

 16%|█▌        | 2530/16104 [11:45:55<63:09:35, 16.75s/it]

 16%|█▌        | 2531/16104 [11:46:07<58:13:57, 15.45s/it]

 16%|█▌        | 2532/16104 [11:46:23<58:15:29, 15.45s/it]

 16%|█▌        | 2533/16104 [11:46:39<59:32:22, 15.79s/it]

 16%|█▌        | 2534/16104 [11:46:51<54:52:15, 14.56s/it]

 16%|█▌        | 2535/16104 [11:47:02<50:59:54, 13.53s/it]

 16%|█▌        | 2536/16104 [11:47:15<49:44:49, 13.20s/it]
{'loss': 0.6532, 'learning_rate': 1.916036764862183e-06, 'rewards/chosen': -0.5539394617080688, 'rewards/rejected': -0.9858904480934143, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4319509267807007, 'policy_logps/rejected': -220.4833526611328, 'policy_logps/chosen': -330.616943359375, 'referece_logps/rejected': -210.62445068359375, 'referece_logps/chosen': -325.07757568359375, 'logits/rejected': -0.015652542933821678, 'logits/chosen': 0.01657252013683319, 'epoch': 0.94}

 16%|█▌        | 2537/16104 [11:47:35<57:25:01, 15.24s/it]


 16%|█▌        | 2539/16104 [11:48:13<64:32:01, 17.13s/it]

 16%|█▌        | 2540/16104 [11:48:30<64:32:54, 17.13s/it]

 16%|█▌        | 2541/16104 [11:48:46<63:34:16, 16.87s/it]

 16%|█▌        | 2542/16104 [11:49:02<61:56:37, 16.44s/it]

 16%|█▌        | 2543/16104 [11:49:15<58:31:48, 15.54s/it]

 16%|█▌        | 2544/16104 [11:49:26<52:54:06, 14.04s/it]

 16%|█▌        | 2545/16104 [11:49:45<59:23:56, 15.77s/it]

 16%|█▌        | 2546/16104 [11:49:58<55:39:46, 14.78s/it]

 16%|█▌        | 2547/16104 [11:50:09<51:57:53, 13.80s/it]

 16%|█▌        | 2548/16104 [11:50:31<61:18:26, 16.28s/it]

 16%|█▌        | 2549/16104 [11:50:52<66:05:12, 17.55s/it]

 16%|█▌        | 2550/16104 [11:51:13<70:17:01, 18.67s/it]

 16%|█▌        | 2551/16104 [11:51:28<66:21:40, 17.63s/it]

 16%|█▌        | 2552/16104 [11:51:39<58:32:41, 15.55s/it]

 16%|█▌        | 2553/16104 [11:51:52<55:47:07, 14.82s/it]

 16%|█▌        | 2554/16104 [11:52:08<57:19:58, 15.23s/it]

 16%|█▌        | 2555/16104 [11:52:32<66:22:54, 17.64s/it]

 16%|█▌        | 2556/16104 [11:52:48<65:28:24, 17.40s/it]

 16%|█▌        | 2557/16104 [11:53:09<69:03:28, 18.35s/it]

 16%|█▌        | 2558/16104 [11:53:31<72:42:09, 19.32s/it]

 16%|█▌        | 2559/16104 [11:53:51<73:54:14, 19.64s/it]

 16%|█▌        | 2560/16104 [11:54:14<77:47:20, 20.68s/it]

 16%|█▌        | 2561/16104 [11:54:32<75:05:47, 19.96s/it]

 16%|█▌        | 2562/16104 [11:54:49<71:29:32, 19.01s/it]

 16%|█▌        | 2563/16104 [11:55:10<73:57:42, 19.66s/it]

 16%|█▌        | 2564/16104 [11:55:23<66:29:01, 17.68s/it]

 16%|█▌        | 2565/16104 [11:55:43<68:55:26, 18.33s/it]

 16%|█▌        | 2566/16104 [11:55:55<61:42:49, 16.41s/it]

 16%|█▌        | 2567/16104 [11:56:11<60:50:12, 16.18s/it]

 16%|█▌        | 2568/16104 [11:56:24<57:43:18, 15.35s/it]

 16%|█▌        | 2569/16104 [11:56:35<52:13:54, 13.89s/it]

 16%|█▌        | 2570/16104 [11:56:54<58:39:45, 15.60s/it]

 16%|█▌        | 2571/16104 [11:57:09<57:32:07, 15.31s/it]

 16%|█▌        | 2572/16104 [11:57:24<57:19:44, 15.25s/it]

 16%|█▌        | 2573/16104 [11:57:38<56:05:07, 14.92s/it]

 16%|█▌        | 2574/16104 [11:57:53<55:48:15, 14.85s/it]
{'loss': 0.4776, 'learning_rate': 1.9129445576913886e-06, 'rewards/chosen': -1.2568057775497437, 'rewards/rejected': -1.490566611289978, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23376086354255676, 'policy_logps/rejected': -472.63836669921875, 'policy_logps/chosen': -422.79547119140625, 'referece_logps/rejected': -457.732666015625, 'referece_logps/chosen': -410.22735595703125, 'logits/rejected': 0.11684352159500122, 'logits/chosen': 0.11704525351524353, 'epoch': 0.96}


 16%|█▌        | 2576/16104 [11:58:26<58:16:01, 15.51s/it]
{'loss': 0.5493, 'learning_rate': 1.9127803311492646e-06, 'rewards/chosen': -0.5718555450439453, 'rewards/rejected': -0.8103256225585938, 'rewards/accuracies': 0.625, 'rewards/margins': 0.23847007751464844, 'policy_logps/rejected': -362.0771484375, 'policy_logps/chosen': -387.86871337890625, 'referece_logps/rejected': -353.9739074707031, 'referece_logps/chosen': -382.1501770019531, 'logits/rejected': -0.26581498980522156, 'logits/chosen': -0.3232591152191162, 'epoch': 0.96}


 16%|█▌        | 2578/16104 [11:59:02<63:01:58, 16.78s/it]

 16%|█▌        | 2579/16104 [11:59:18<61:31:37, 16.38s/it]

 16%|█▌        | 2580/16104 [11:59:36<63:26:37, 16.89s/it]

 16%|█▌        | 2581/16104 [11:59:54<64:59:35, 17.30s/it]

 16%|█▌        | 2582/16104 [12:00:09<62:09:14, 16.55s/it]

 16%|█▌        | 2583/16104 [12:00:29<65:44:42, 17.50s/it]

 16%|█▌        | 2584/16104 [12:00:47<66:44:57, 17.77s/it]

 16%|█▌        | 2585/16104 [12:01:05<66:29:29, 17.71s/it]

 16%|█▌        | 2586/16104 [12:01:25<69:16:08, 18.45s/it]

 16%|█▌        | 2587/16104 [12:01:49<76:00:03, 20.24s/it]
{'loss': 0.5215, 'learning_rate': 1.9118744458443824e-06, 'rewards/chosen': -1.0492801666259766, 'rewards/rejected': -1.6276352405548096, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5783551335334778, 'policy_logps/rejected': -345.8467712402344, 'policy_logps/chosen': -295.66741943359375, 'referece_logps/rejected': -329.5704040527344, 'referece_logps/chosen': -285.1746826171875, 'logits/rejected': -0.7166218757629395, 'logits/chosen': -0.6169341802597046, 'epoch': 0.96}


 16%|█▌        | 2589/16104 [12:02:24<70:52:44, 18.88s/it]
{'loss': 0.5146, 'learning_rate': 1.9117092597649043e-06, 'rewards/chosen': -0.6947206854820251, 'rewards/rejected': -1.4230490922927856, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7283283472061157, 'policy_logps/rejected': -437.4466552734375, 'policy_logps/chosen': -363.1114196777344, 'referece_logps/rejected': -423.21624755859375, 'referece_logps/chosen': -356.1642150878906, 'logits/rejected': -0.5131374597549438, 'logits/chosen': -0.11424489319324493, 'epoch': 0.96}


 16%|█▌        | 2591/16104 [12:02:52<62:12:59, 16.58s/it]

 16%|█▌        | 2592/16104 [12:03:04<57:05:34, 15.21s/it]

 16%|█▌        | 2593/16104 [12:03:23<60:35:29, 16.14s/it]

 16%|█▌        | 2594/16104 [12:03:45<67:30:39, 17.99s/it]

 16%|█▌        | 2595/16104 [12:04:01<65:18:13, 17.40s/it]
{'loss': 0.5286, 'learning_rate': 1.9112128165071156e-06, 'rewards/chosen': -0.47075673937797546, 'rewards/rejected': -1.2739297151565552, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8031728863716125, 'policy_logps/rejected': -584.0728759765625, 'policy_logps/chosen': -587.3639526367188, 'referece_logps/rejected': -571.3336181640625, 'referece_logps/chosen': -582.6563720703125, 'logits/rejected': 0.626906156539917, 'logits/chosen': 0.6588386297225952, 'epoch': 0.97}


 16%|█▌        | 2597/16104 [12:04:29<58:33:09, 15.61s/it]

 16%|█▌        | 2598/16104 [12:04:48<62:29:47, 16.66s/it]
{'loss': 0.5442, 'learning_rate': 1.9109640972205298e-06, 'rewards/chosen': -1.2892658710479736, 'rewards/rejected': -2.04093337059021, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7516677379608154, 'policy_logps/rejected': -395.35064697265625, 'policy_logps/chosen': -280.8136291503906, 'referece_logps/rejected': -374.94134521484375, 'referece_logps/chosen': -267.92095947265625, 'logits/rejected': -1.0725274085998535, 'logits/chosen': -1.0561010837554932, 'epoch': 0.97}

 16%|█▌        | 2599/16104 [12:05:02<59:24:11, 15.83s/it]


 16%|█▌        | 2601/16104 [12:05:44<69:07:07, 18.43s/it]
{'loss': 0.5271, 'learning_rate': 1.9107150462828424e-06, 'rewards/chosen': -0.6933515667915344, 'rewards/rejected': -2.0250067710876465, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3316550254821777, 'policy_logps/rejected': -444.81634521484375, 'policy_logps/chosen': -407.2080993652344, 'referece_logps/rejected': -424.5662841796875, 'referece_logps/chosen': -400.27459716796875, 'logits/rejected': 0.2979016900062561, 'logits/chosen': 0.3911416828632355, 'epoch': 0.97}

 16%|█▌        | 2602/16104 [12:06:04<70:13:53, 18.73s/it]


 16%|█▌        | 2604/16104 [12:06:47<76:00:39, 20.27s/it]
{'loss': 0.5725, 'learning_rate': 1.9104656637847246e-06, 'rewards/chosen': -0.6127342581748962, 'rewards/rejected': -0.7045342922210693, 'rewards/accuracies': 0.5, 'rewards/margins': 0.09180009365081787, 'policy_logps/rejected': -384.1427917480469, 'policy_logps/chosen': -371.0126647949219, 'referece_logps/rejected': -377.0975036621094, 'referece_logps/chosen': -364.88531494140625, 'logits/rejected': -0.0854567214846611, 'logits/chosen': -0.13826580345630646, 'epoch': 0.97}

 16%|█▌        | 2605/16104 [12:07:02<69:50:47, 18.63s/it]

 16%|█▌        | 2606/16104 [12:07:16<64:47:13, 17.28s/it]

 16%|█▌        | 2607/16104 [12:07:36<67:56:24, 18.12s/it]

 16%|█▌        | 2608/16104 [12:07:56<69:44:41, 18.60s/it]

 16%|█▌        | 2609/16104 [12:08:14<68:41:38, 18.33s/it]


 16%|█▌        | 2611/16104 [12:08:53<71:27:15, 19.06s/it]
[2024-04-08 01:15:33,994] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 16%|█▌        | 2612/16104 [12:09:15<74:58:51, 20.01s/it]

 16%|█▌        | 2613/16104 [12:09:35<74:50:10, 19.97s/it]
{'loss': 0.5137, 'learning_rate': 1.9097155278363123e-06, 'rewards/chosen': -0.47429561614990234, 'rewards/rejected': -1.3796812295913696, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9053854942321777, 'policy_logps/rejected': -491.70489501953125, 'policy_logps/chosen': -414.8915710449219, 'referece_logps/rejected': -477.9080810546875, 'referece_logps/chosen': -410.14862060546875, 'logits/rejected': 0.30075374245643616, 'logits/chosen': 0.3870748281478882, 'epoch': 0.97}


 16%|█▌        | 2615/16104 [12:10:09<69:16:31, 18.49s/it]
{'loss': 0.4614, 'learning_rate': 1.909548426076487e-06, 'rewards/chosen': -0.7549501657485962, 'rewards/rejected': -0.9421546459197998, 'rewards/accuracies': 0.75, 'rewards/margins': 0.1872044801712036, 'policy_logps/rejected': -257.4500732421875, 'policy_logps/chosen': -377.33526611328125, 'referece_logps/rejected': -248.02854919433594, 'referece_logps/chosen': -369.7857666015625, 'logits/rejected': 0.21866756677627563, 'logits/chosen': 0.2668325901031494, 'epoch': 0.97}


 16%|█▋        | 2617/16104 [12:10:47<70:35:21, 18.84s/it]

 16%|█▋        | 2618/16104 [12:11:01<64:59:45, 17.35s/it]
{'loss': 0.6224, 'learning_rate': 1.90929749749878e-06, 'rewards/chosen': -0.7945276498794556, 'rewards/rejected': -1.099985957145691, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3054583668708801, 'policy_logps/rejected': -470.0420837402344, 'policy_logps/chosen': -441.3553466796875, 'referece_logps/rejected': -459.042236328125, 'referece_logps/chosen': -433.4100036621094, 'logits/rejected': -0.7715815305709839, 'logits/chosen': -0.8376044034957886, 'epoch': 0.98}


 16%|█▋        | 2620/16104 [12:11:31<61:01:06, 16.29s/it]

 16%|█▋        | 2621/16104 [12:11:52<66:14:04, 17.68s/it]

 16%|█▋        | 2622/16104 [12:12:10<66:42:52, 17.81s/it]

 16%|█▋        | 2623/16104 [12:12:32<71:07:16, 18.99s/it]
[2024-04-08 01:19:12,723] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5331, 'learning_rate': 1.908878547593662e-06, 'rewards/chosen': -0.6566998958587646, 'rewards/rejected': -1.5431123971939087, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8864123225212097, 'policy_logps/rejected': -575.035888671875, 'policy_logps/chosen': -488.4223937988281, 'referece_logps/rejected': -559.604736328125, 'referece_logps/chosen': -481.85540771484375, 'logits/rejected': -0.3731570243835449, 'logits/chosen': -0.1470373570919037, 'epoch': 0.98}
[2024-04-08 01:19:29,245] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 16%|█▋        | 2624/16104 [12:12:48<68:20:27, 18.25s/it]


 16%|█▋        | 2626/16104 [12:13:23<67:59:29, 18.16s/it]

 16%|█▋        | 2627/16104 [12:13:44<70:52:16, 18.93s/it]
[2024-04-08 01:20:25,023] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5521, 'learning_rate': 1.9085427258655884e-06, 'rewards/chosen': -0.9003819227218628, 'rewards/rejected': -1.3475556373596191, 'rewards/accuracies': 0.625, 'rewards/margins': 0.44717368483543396, 'policy_logps/rejected': -440.0731506347656, 'policy_logps/chosen': -295.4941711425781, 'referece_logps/rejected': -426.59759521484375, 'referece_logps/chosen': -286.4903869628906, 'logits/rejected': -0.5744683742523193, 'logits/chosen': -0.5048044919967651, 'epoch': 0.98}
[2024-04-08 01:20:41,321] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 16%|█▋        | 2629/16104 [12:14:18<67:10:27, 17.95s/it]

 16%|█▋        | 2630/16104 [12:14:33<63:59:51, 17.10s/it]

 16%|█▋        | 2631/16104 [12:14:48<61:24:24, 16.41s/it]

 16%|█▋        | 2632/16104 [12:15:03<60:21:39, 16.13s/it]

 16%|█▋        | 2633/16104 [12:15:14<54:12:32, 14.49s/it]
{'loss': 0.5877, 'learning_rate': 1.9080378907763245e-06, 'rewards/chosen': -0.7695451974868774, 'rewards/rejected': -1.4955694675445557, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7260242104530334, 'policy_logps/rejected': -323.3445739746094, 'policy_logps/chosen': -303.970703125, 'referece_logps/rejected': -308.3888854980469, 'referece_logps/chosen': -296.2752685546875, 'logits/rejected': -0.842413604259491, 'logits/chosen': -0.7051331996917725, 'epoch': 0.98}

 16%|█▋        | 2634/16104 [12:15:31<57:01:54, 15.24s/it]


 16%|█▋        | 2636/16104 [12:16:08<62:41:06, 16.76s/it]

 16%|█▋        | 2637/16104 [12:16:27<66:02:56, 17.66s/it]
{'loss': 0.5376, 'learning_rate': 1.907700599369714e-06, 'rewards/chosen': -1.105735182762146, 'rewards/rejected': -1.4456379413604736, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3399026691913605, 'policy_logps/rejected': -378.7943115234375, 'policy_logps/chosen': -291.0731506347656, 'referece_logps/rejected': -364.3379211425781, 'referece_logps/chosen': -280.01580810546875, 'logits/rejected': -0.9124047160148621, 'logits/chosen': -0.8284674286842346, 'epoch': 0.98}


 16%|█▋        | 2639/16104 [12:16:51<54:39:13, 14.61s/it]
{'loss': 0.5684, 'learning_rate': 1.9075317333441065e-06, 'rewards/chosen': -0.44187507033348083, 'rewards/rejected': -1.0746984481811523, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6328233480453491, 'policy_logps/rejected': -318.8106689453125, 'policy_logps/chosen': -253.78485107421875, 'referece_logps/rejected': -308.063720703125, 'referece_logps/chosen': -249.3660888671875, 'logits/rejected': -0.9736236333847046, 'logits/chosen': -1.0448799133300781, 'epoch': 0.98}


 16%|█▋        | 2641/16104 [12:17:20<53:32:17, 14.32s/it]
{'loss': 0.4881, 'learning_rate': 1.9073627204733885e-06, 'rewards/chosen': -0.8922613859176636, 'rewards/rejected': -1.758506178855896, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8662447333335876, 'policy_logps/rejected': -244.77980041503906, 'policy_logps/chosen': -338.7703857421875, 'referece_logps/rejected': -227.19473266601562, 'referece_logps/chosen': -329.8477478027344, 'logits/rejected': -0.08450010418891907, 'logits/chosen': -0.15721234679222107, 'epoch': 0.98}
[2024-04-08 01:24:23,870] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 16%|█▋        | 2642/16104 [12:17:43<63:25:22, 16.96s/it]


 16%|█▋        | 2644/16104 [12:18:14<62:20:07, 16.67s/it]
{'loss': 0.5754, 'learning_rate': 1.9071089258925572e-06, 'rewards/chosen': -1.0855815410614014, 'rewards/rejected': -1.6230719089508057, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5374903678894043, 'policy_logps/rejected': -368.86614990234375, 'policy_logps/chosen': -553.299560546875, 'referece_logps/rejected': -352.6354675292969, 'referece_logps/chosen': -542.4436645507812, 'logits/rejected': -0.8617587089538574, 'logits/chosen': -0.8926305770874023, 'epoch': 0.99}


 16%|█▋        | 2646/16104 [12:18:48<62:18:03, 16.67s/it]

 16%|█▋        | 2647/16104 [12:19:04<61:28:00, 16.44s/it]

 16%|█▋        | 2648/16104 [12:19:23<65:07:21, 17.42s/it]

 16%|█▋        | 2649/16104 [12:19:40<64:09:49, 17.17s/it]

 16%|█▋        | 2650/16104 [12:19:54<61:20:18, 16.41s/it]

 16%|█▋        | 2651/16104 [12:20:12<62:25:02, 16.70s/it]

 16%|█▋        | 2652/16104 [12:20:30<63:42:31, 17.05s/it]
{'loss': 0.5461, 'learning_rate': 1.9064305260513658e-06, 'rewards/chosen': -0.8528740406036377, 'rewards/rejected': -1.0455186367034912, 'rewards/accuracies': 0.25, 'rewards/margins': 0.19264470040798187, 'policy_logps/rejected': -292.34796142578125, 'policy_logps/chosen': -302.0859680175781, 'referece_logps/rejected': -281.89276123046875, 'referece_logps/chosen': -293.5572204589844, 'logits/rejected': -0.2925024926662445, 'logits/chosen': -0.2452240288257599, 'epoch': 0.99}


 16%|█▋        | 2654/16104 [12:21:06<64:57:32, 17.39s/it]

 16%|█▋        | 2655/16104 [12:21:18<58:55:10, 15.77s/it]

 16%|█▋        | 2656/16104 [12:21:29<53:31:48, 14.33s/it]

 16%|█▋        | 2657/16104 [12:21:43<54:06:37, 14.49s/it]
{'loss': 0.5139, 'learning_rate': 1.9060053343703367e-06, 'rewards/chosen': -1.686082363128662, 'rewards/rejected': -1.6112393140792847, 'rewards/accuracies': 0.5, 'rewards/margins': -0.07484312355518341, 'policy_logps/rejected': -245.2220458984375, 'policy_logps/chosen': -261.77178955078125, 'referece_logps/rejected': -229.1096649169922, 'referece_logps/chosen': -244.91094970703125, 'logits/rejected': -0.6543125510215759, 'logits/chosen': -0.7279787659645081, 'epoch': 0.99}
[2024-04-08 01:28:46,040] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 17%|█▋        | 2659/16104 [12:22:26<67:11:49, 17.99s/it]

 17%|█▋        | 2660/16104 [12:22:43<66:23:58, 17.78s/it]
{'loss': 0.5033, 'learning_rate': 1.9057497795398061e-06, 'rewards/chosen': -1.0298266410827637, 'rewards/rejected': -1.9021369218826294, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8723105192184448, 'policy_logps/rejected': -506.626708984375, 'policy_logps/chosen': -382.77117919921875, 'referece_logps/rejected': -487.6053771972656, 'referece_logps/chosen': -372.472900390625, 'logits/rejected': 0.42481285333633423, 'logits/chosen': 0.5211422443389893, 'epoch': 0.99}


 17%|█▋        | 2662/16104 [12:23:20<66:05:44, 17.70s/it]
[2024-04-08 01:30:00,971] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 17%|█▋        | 2663/16104 [12:23:43<71:34:12, 19.17s/it]
{'loss': 0.4764, 'learning_rate': 1.9054938949565305e-06, 'rewards/chosen': -0.32740098237991333, 'rewards/rejected': -1.3869049549102783, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0595039129257202, 'policy_logps/rejected': -260.3957824707031, 'policy_logps/chosen': -275.4053649902344, 'referece_logps/rejected': -246.5267333984375, 'referece_logps/chosen': -272.1313781738281, 'logits/rejected': 0.3715035617351532, 'logits/chosen': 0.4403567910194397, 'epoch': 0.99}


 17%|█▋        | 2665/16104 [12:24:06<56:58:43, 15.26s/it]

 17%|█▋        | 2666/16104 [12:24:22<58:26:21, 15.66s/it]
{'loss': 0.5885, 'learning_rate': 1.9052376807136685e-06, 'rewards/chosen': -1.2493267059326172, 'rewards/rejected': -2.5926313400268555, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3433046340942383, 'policy_logps/rejected': -416.80108642578125, 'policy_logps/chosen': -409.5371398925781, 'referece_logps/rejected': -390.8747863769531, 'referece_logps/chosen': -397.0439147949219, 'logits/rejected': -0.5680031776428223, 'logits/chosen': -0.5631669759750366, 'epoch': 0.99}

 17%|█▋        | 2667/16104 [12:24:37<57:01:12, 15.28s/it]
[2024-04-08 01:31:36,042] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 17%|█▋        | 2669/16104 [12:25:10<59:13:07, 15.87s/it]
{'loss': 0.5422, 'learning_rate': 1.9049811369044994e-06, 'rewards/chosen': -0.9195146560668945, 'rewards/rejected': -2.6591780185699463, 'rewards/accuracies': 1.0, 'rewards/margins': 1.7396636009216309, 'policy_logps/rejected': -408.0790710449219, 'policy_logps/chosen': -441.4073486328125, 'referece_logps/rejected': -381.4872741699219, 'referece_logps/chosen': -432.21221923828125, 'logits/rejected': 0.2620062232017517, 'logits/chosen': 0.3727604150772095, 'epoch': 0.99}

 17%|█▋        | 2670/16104 [12:25:29<62:36:42, 16.78s/it]

 17%|█▋        | 2671/16104 [12:25:49<65:54:08, 17.66s/it]


 17%|█▋        | 2673/16104 [12:26:21<63:33:23, 17.04s/it]

 17%|█▋        | 2674/16104 [12:26:40<66:34:52, 17.85s/it]

 17%|█▋        | 2675/16104 [12:26:54<61:58:10, 16.61s/it]

 17%|█▋        | 2676/16104 [12:27:09<59:48:57, 16.04s/it]

 17%|█▋        | 2677/16104 [12:27:20<55:02:16, 14.76s/it]
{'loss': 0.4761, 'learning_rate': 1.9042954095776637e-06, 'rewards/chosen': -1.43746018409729, 'rewards/rejected': -2.9197280406951904, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4822678565979004, 'policy_logps/rejected': -252.47630310058594, 'policy_logps/chosen': -365.4898681640625, 'referece_logps/rejected': -223.27902221679688, 'referece_logps/chosen': -351.1152648925781, 'logits/rejected': -1.0142459869384766, 'logits/chosen': -0.9920992851257324, 'epoch': 1.0}
[2024-04-08 01:34:20,124] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 17%|█▋        | 2679/16104 [12:28:03<67:45:06, 18.17s/it]
[2024-04-08 01:34:43,575] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5287, 'learning_rate': 1.9041236118729218e-06, 'rewards/chosen': -1.4221380949020386, 'rewards/rejected': -2.8717329502105713, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4495947360992432, 'policy_logps/rejected': -386.84564208984375, 'policy_logps/chosen': -411.83392333984375, 'referece_logps/rejected': -358.1282958984375, 'referece_logps/chosen': -397.6125793457031, 'logits/rejected': -0.3461951017379761, 'logits/chosen': -0.33120429515838623, 'epoch': 1.0}
[2024-04-08 01:34:56,644] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 17%|█▋        | 2680/16104 [12:28:16<62:02:31, 16.64s/it]

 17%|█▋        | 2681/16104 [12:28:31<61:04:10, 16.38s/it]

 17%|█▋        | 2682/16104 [12:28:52<65:31:20, 17.57s/it]


 17%|█▋        | 2684/16104 [12:29:27<64:03:10, 17.18s/it]

 17%|█▋        | 2685/16104 [12:29:50<70:52:10, 19.01s/it]
{'loss': 0.5378, 'learning_rate': 1.9036073411080915e-06, 'rewards/chosen': -1.0285558700561523, 'rewards/rejected': -1.6617237329483032, 'rewards/accuracies': 0.375, 'rewards/margins': 0.6331678628921509, 'policy_logps/rejected': -340.9785461425781, 'policy_logps/chosen': -469.1449890136719, 'referece_logps/rejected': -324.361328125, 'referece_logps/chosen': -458.85943603515625, 'logits/rejected': -1.0211259126663208, 'logits/chosen': -0.9150139689445496, 'epoch': 1.0}

 17%|█▋        | 2686/16104 [12:30:05<66:20:54, 17.80s/it]

 17%|█▋        | 2687/16104 [12:30:26<69:14:16, 18.58s/it]


 17%|█▋        | 2689/16104 [12:30:57<65:16:38, 17.52s/it]

 17%|█▋        | 2690/16104 [12:31:11<60:51:23, 16.33s/it]
{'loss': 0.6219, 'learning_rate': 1.9031761102443288e-06, 'rewards/chosen': -1.0300968885421753, 'rewards/rejected': -1.3850822448730469, 'rewards/accuracies': 0.875, 'rewards/margins': 0.3549853265285492, 'policy_logps/rejected': -439.1208190917969, 'policy_logps/chosen': -360.92138671875, 'referece_logps/rejected': -425.2699890136719, 'referece_logps/chosen': -350.6203918457031, 'logits/rejected': 0.3238491415977478, 'logits/chosen': 0.4217027425765991, 'epoch': 1.0}


 17%|█▋        | 2692/16104 [12:31:32<50:17:52, 13.50s/it]

 17%|█▋        | 2693/16104 [12:31:50<55:27:12, 14.89s/it]
{'loss': 0.5013, 'learning_rate': 1.902916933277133e-06, 'rewards/chosen': -1.2688504457473755, 'rewards/rejected': -1.556182861328125, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2873324453830719, 'policy_logps/rejected': -268.1582336425781, 'policy_logps/chosen': -422.4992980957031, 'referece_logps/rejected': -252.59637451171875, 'referece_logps/chosen': -409.8107604980469, 'logits/rejected': -0.448891282081604, 'logits/chosen': -0.477365106344223, 'epoch': 1.0}

 17%|█▋        | 2694/16104 [12:32:06<55:50:19, 14.99s/it]

 17%|█▋        | 2695/16104 [12:32:26<62:00:39, 16.65s/it]

 17%|█▋        | 2696/16104 [12:32:37<55:57:19, 15.02s/it]
[2024-04-08 01:39:39,041] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 17%|█▋        | 2697/16104 [12:32:58<62:10:24, 16.69s/it]

 17%|█▋        | 2698/16104 [12:33:10<57:04:39, 15.33s/it]

 17%|█▋        | 2699/16104 [12:33:28<59:28:47, 15.97s/it]

 17%|█▋        | 2700/16104 [12:33:42<57:44:47, 15.51s/it]

 17%|█▋        | 2701/16104 [12:33:54<53:44:25, 14.43s/it]


 17%|█▋        | 2703/16104 [12:34:23<54:29:35, 14.64s/it]

 17%|█▋        | 2704/16104 [12:34:33<50:02:02, 13.44s/it]
{'loss': 0.4191, 'learning_rate': 1.9019638060554052e-06, 'rewards/chosen': -0.5784242749214172, 'rewards/rejected': -1.4259099960327148, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8474858403205872, 'policy_logps/rejected': -295.6888427734375, 'policy_logps/chosen': -549.4055786132812, 'referece_logps/rejected': -281.4297180175781, 'referece_logps/chosen': -543.621337890625, 'logits/rejected': -0.11965084820985794, 'logits/chosen': -0.05777197331190109, 'epoch': 1.01}

 17%|█▋        | 2705/16104 [12:34:52<55:16:35, 14.85s/it]

 17%|█▋        | 2706/16104 [12:35:04<52:53:51, 14.21s/it]

 17%|█▋        | 2707/16104 [12:35:20<54:06:01, 14.54s/it]


 17%|█▋        | 2709/16104 [12:35:43<48:17:20, 12.98s/it]

 17%|█▋        | 2710/16104 [12:35:55<47:55:38, 12.88s/it]
{'loss': 0.4993, 'learning_rate': 1.9014420573935407e-06, 'rewards/chosen': -0.46087127923965454, 'rewards/rejected': -1.2111289501190186, 'rewards/accuracies': 0.75, 'rewards/margins': 0.750257670879364, 'policy_logps/rejected': -545.2147216796875, 'policy_logps/chosen': -339.331298828125, 'referece_logps/rejected': -533.1034545898438, 'referece_logps/chosen': -334.7225646972656, 'logits/rejected': -1.1202963590621948, 'logits/chosen': -0.9537737369537354, 'epoch': 1.01}

 17%|█▋        | 2711/16104 [12:36:06<45:44:45, 12.30s/it]


 17%|█▋        | 2713/16104 [12:36:47<60:15:20, 16.20s/it]
{'loss': 0.5333, 'learning_rate': 1.9011806907384162e-06, 'rewards/chosen': -0.6515002846717834, 'rewards/rejected': -1.3830045461654663, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7315042614936829, 'policy_logps/rejected': -310.583984375, 'policy_logps/chosen': -457.2320556640625, 'referece_logps/rejected': -296.7539367675781, 'referece_logps/chosen': -450.7170104980469, 'logits/rejected': -0.968100368976593, 'logits/chosen': -1.1482007503509521, 'epoch': 1.01}


 17%|█▋        | 2715/16104 [12:37:11<53:21:11, 14.35s/it]

 17%|█▋        | 2716/16104 [12:37:31<59:35:15, 16.02s/it]

 17%|█▋        | 2717/16104 [12:37:49<61:27:47, 16.53s/it]
{'loss': 0.5275, 'learning_rate': 1.9008316915202554e-06, 'rewards/chosen': -0.7778133153915405, 'rewards/rejected': -1.6945024728775024, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9166892170906067, 'policy_logps/rejected': -267.46978759765625, 'policy_logps/chosen': -371.81915283203125, 'referece_logps/rejected': -250.5247802734375, 'referece_logps/chosen': -364.041015625, 'logits/rejected': -0.12952956557273865, 'logits/chosen': -0.18929392099380493, 'epoch': 1.01}


 17%|█▋        | 2719/16104 [12:38:29<67:05:19, 18.04s/it]
{'loss': 0.5131, 'learning_rate': 1.900656973255557e-06, 'rewards/chosen': -1.0185401439666748, 'rewards/rejected': -1.8092817068099976, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7907415628433228, 'policy_logps/rejected': -533.1685791015625, 'policy_logps/chosen': -480.9569091796875, 'referece_logps/rejected': -515.0758056640625, 'referece_logps/chosen': -470.7715148925781, 'logits/rejected': -0.8448474407196045, 'logits/chosen': -0.7933303713798523, 'epoch': 1.01}

 17%|█▋        | 2720/16104 [12:38:42<61:15:50, 16.48s/it]


 17%|█▋        | 2722/16104 [12:39:11<58:04:51, 15.62s/it]
{'loss': 0.5552, 'learning_rate': 1.9003946226184897e-06, 'rewards/chosen': -0.6804944276809692, 'rewards/rejected': -1.494317650794983, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8138231039047241, 'policy_logps/rejected': -492.3629455566406, 'policy_logps/chosen': -426.1622009277344, 'referece_logps/rejected': -477.4197692871094, 'referece_logps/chosen': -419.35723876953125, 'logits/rejected': 0.06122617796063423, 'logits/chosen': 0.030104592442512512, 'epoch': 1.01}


 17%|█▋        | 2724/16104 [12:39:43<58:57:04, 15.86s/it]

 17%|█▋        | 2725/16104 [12:39:55<54:27:46, 14.65s/it]
{'loss': 0.7195, 'learning_rate': 1.9001319441783081e-06, 'rewards/chosen': -0.9420850276947021, 'rewards/rejected': -1.1976133584976196, 'rewards/accuracies': 0.5, 'rewards/margins': 0.25552815198898315, 'policy_logps/rejected': -411.638671875, 'policy_logps/chosen': -574.4857788085938, 'referece_logps/rejected': -399.6625061035156, 'referece_logps/chosen': -565.06494140625, 'logits/rejected': -0.6400801539421082, 'logits/chosen': -0.7862217426300049, 'epoch': 1.02}

 17%|█▋        | 2726/16104 [12:40:14<58:48:42, 15.83s/it]


 17%|█▋        | 2728/16104 [12:40:46<57:13:19, 15.40s/it]
{'loss': 0.6257, 'learning_rate': 1.8998689380306448e-06, 'rewards/chosen': -0.546006441116333, 'rewards/rejected': -0.6038045883178711, 'rewards/accuracies': 0.625, 'rewards/margins': 0.05779819190502167, 'policy_logps/rejected': -388.6719055175781, 'policy_logps/chosen': -476.0000305175781, 'referece_logps/rejected': -382.6338195800781, 'referece_logps/chosen': -470.53997802734375, 'logits/rejected': -0.2765168845653534, 'logits/chosen': -0.38685864210128784, 'epoch': 1.02}

 17%|█▋        | 2729/16104 [12:41:07<63:39:22, 17.13s/it]

 17%|█▋        | 2730/16104 [12:41:30<70:10:35, 18.89s/it]


 17%|█▋        | 2732/16104 [12:41:55<59:13:00, 15.94s/it]

 17%|█▋        | 2733/16104 [12:42:11<59:07:44, 15.92s/it]
{'loss': 0.5929, 'learning_rate': 1.8994298664724768e-06, 'rewards/chosen': -0.8138317465782166, 'rewards/rejected': -1.625910997390747, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8120793104171753, 'policy_logps/rejected': -283.7163391113281, 'policy_logps/chosen': -300.65283203125, 'referece_logps/rejected': -267.45721435546875, 'referece_logps/chosen': -292.5145263671875, 'logits/rejected': -0.47132354974746704, 'logits/chosen': -0.5487572550773621, 'epoch': 1.02}


 17%|█▋        | 2735/16104 [12:42:42<57:48:25, 15.57s/it]
{'loss': 0.5491, 'learning_rate': 1.899253983139532e-06, 'rewards/chosen': -0.9031139612197876, 'rewards/rejected': -1.1157500743865967, 'rewards/accuracies': 0.5, 'rewards/margins': 0.21263615787029266, 'policy_logps/rejected': -410.53131103515625, 'policy_logps/chosen': -295.6646728515625, 'referece_logps/rejected': -399.373779296875, 'referece_logps/chosen': -286.633544921875, 'logits/rejected': -0.12328828871250153, 'logits/chosen': -0.1749928742647171, 'epoch': 1.02}


 17%|█▋        | 2737/16104 [12:43:09<55:21:26, 14.91s/it]
{'loss': 0.5004, 'learning_rate': 1.8990779543008752e-06, 'rewards/chosen': -0.8426164984703064, 'rewards/rejected': -1.4372905492782593, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5946740508079529, 'policy_logps/rejected': -356.0263671875, 'policy_logps/chosen': -324.1236267089844, 'referece_logps/rejected': -341.6534423828125, 'referece_logps/chosen': -315.6974792480469, 'logits/rejected': -0.17715701460838318, 'logits/chosen': -0.05290544033050537, 'epoch': 1.02}


 17%|█▋        | 2739/16104 [12:43:48<64:24:19, 17.35s/it]
{'loss': 0.5044, 'learning_rate': 1.8989017799849893e-06, 'rewards/chosen': -1.0528022050857544, 'rewards/rejected': -2.1057815551757812, 'rewards/accuracies': 0.75, 'rewards/margins': 1.052979588508606, 'policy_logps/rejected': -409.4309387207031, 'policy_logps/chosen': -549.250732421875, 'referece_logps/rejected': -388.3731384277344, 'referece_logps/chosen': -538.72265625, 'logits/rejected': -1.3520499467849731, 'logits/chosen': -1.4912331104278564, 'epoch': 1.02}


 17%|█▋        | 2741/16104 [12:44:17<60:11:26, 16.22s/it]
{'loss': 0.5815, 'learning_rate': 1.8987254602203803e-06, 'rewards/chosen': -0.9348663687705994, 'rewards/rejected': -1.424062728881836, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4891963303089142, 'policy_logps/rejected': -255.4224090576172, 'policy_logps/chosen': -293.25079345703125, 'referece_logps/rejected': -241.18179321289062, 'referece_logps/chosen': -283.9021301269531, 'logits/rejected': -0.7237350344657898, 'logits/chosen': -0.5557724237442017, 'epoch': 1.02}


 17%|█▋        | 2743/16104 [12:44:53<63:05:51, 17.00s/it]

 17%|█▋        | 2744/16104 [12:45:05<57:30:44, 15.50s/it]
{'loss': 0.5928, 'learning_rate': 1.898460707919527e-06, 'rewards/chosen': -0.49375200271606445, 'rewards/rejected': -0.9719823598861694, 'rewards/accuracies': 0.75, 'rewards/margins': 0.478230357170105, 'policy_logps/rejected': -414.9158630371094, 'policy_logps/chosen': -387.2644958496094, 'referece_logps/rejected': -405.196044921875, 'referece_logps/chosen': -382.32696533203125, 'logits/rejected': -1.5038189888000488, 'logits/chosen': -1.5356099605560303, 'epoch': 1.02}

 17%|█▋        | 2745/16104 [12:45:19<55:22:40, 14.92s/it]

 17%|█▋        | 2746/16104 [12:45:39<60:43:51, 16.37s/it]

 17%|█▋        | 2747/16104 [12:45:57<62:15:46, 16.78s/it]


 17%|█▋        | 2749/16104 [12:46:32<64:59:44, 17.52s/it]
{'loss': 0.506, 'learning_rate': 1.8980187272456653e-06, 'rewards/chosen': -0.3926651179790497, 'rewards/rejected': -1.1840332746505737, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7913682460784912, 'policy_logps/rejected': -356.11785888671875, 'policy_logps/chosen': -285.0077209472656, 'referece_logps/rejected': -344.27752685546875, 'referece_logps/chosen': -281.0810546875, 'logits/rejected': -0.7493862509727478, 'logits/chosen': -0.5152627229690552, 'epoch': 1.02}

 17%|█▋        | 2750/16104 [12:46:53<68:32:08, 18.48s/it]

 17%|█▋        | 2751/16104 [12:47:11<68:40:59, 18.52s/it]

 17%|█▋        | 2752/16104 [12:47:26<65:00:58, 17.53s/it]


 17%|█▋        | 2754/16104 [12:47:58<61:15:08, 16.52s/it]
{'loss': 0.4847, 'learning_rate': 1.8975758384103767e-06, 'rewards/chosen': -0.8777406811714172, 'rewards/rejected': -1.3025853633880615, 'rewards/accuracies': 0.75, 'rewards/margins': 0.42484456300735474, 'policy_logps/rejected': -355.8708801269531, 'policy_logps/chosen': -369.7533874511719, 'referece_logps/rejected': -342.8450927734375, 'referece_logps/chosen': -360.9759521484375, 'logits/rejected': -0.9758933186531067, 'logits/chosen': -0.9315427541732788, 'epoch': 1.03}


 17%|█▋        | 2756/16104 [12:48:26<56:40:38, 15.29s/it]

 17%|█▋        | 2757/16104 [12:48:44<59:29:31, 16.05s/it]
{'loss': 0.5731, 'learning_rate': 1.897309669378003e-06, 'rewards/chosen': -0.72271329164505, 'rewards/rejected': -1.0570348501205444, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3343215882778168, 'policy_logps/rejected': -434.81585693359375, 'policy_logps/chosen': -468.57952880859375, 'referece_logps/rejected': -424.24554443359375, 'referece_logps/chosen': -461.3524169921875, 'logits/rejected': -1.0323736667633057, 'logits/chosen': -0.8262802362442017, 'epoch': 1.03}

 17%|█▋        | 2758/16104 [12:49:02<62:24:49, 16.84s/it]


 17%|█▋        | 2760/16104 [12:49:28<55:19:23, 14.93s/it]
{'loss': 0.4833, 'learning_rate': 1.8970431736656415e-06, 'rewards/chosen': -0.537204921245575, 'rewards/rejected': -1.4269769191741943, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8897719383239746, 'policy_logps/rejected': -305.56787109375, 'policy_logps/chosen': -283.60693359375, 'referece_logps/rejected': -291.2981262207031, 'referece_logps/chosen': -278.2348937988281, 'logits/rejected': -1.2903684377670288, 'logits/chosen': -1.1571886539459229, 'epoch': 1.03}


 17%|█▋        | 2762/16104 [12:50:04<61:38:57, 16.63s/it]
{'loss': 0.4594, 'learning_rate': 1.896865328416426e-06, 'rewards/chosen': -0.9466601014137268, 'rewards/rejected': -1.7121988534927368, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7655388116836548, 'policy_logps/rejected': -316.6858215332031, 'policy_logps/chosen': -319.6497802734375, 'referece_logps/rejected': -299.5638732910156, 'referece_logps/chosen': -310.18316650390625, 'logits/rejected': -0.3747956454753876, 'logits/chosen': -0.3934496343135834, 'epoch': 1.03}

 17%|█▋        | 2763/16104 [12:50:23<64:04:49, 17.29s/it]

 17%|█▋        | 2764/16104 [12:50:45<68:47:54, 18.57s/it]


 17%|█▋        | 2766/16104 [12:51:20<66:15:24, 17.88s/it]
{'loss': 0.5642, 'learning_rate': 1.8965092025891636e-06, 'rewards/chosen': -0.9060202240943909, 'rewards/rejected': -0.635117769241333, 'rewards/accuracies': 0.25, 'rewards/margins': -0.27090245485305786, 'policy_logps/rejected': -375.5488586425781, 'policy_logps/chosen': -354.162841796875, 'referece_logps/rejected': -369.1976623535156, 'referece_logps/chosen': -345.10260009765625, 'logits/rejected': -0.11569362133741379, 'logits/chosen': -0.11556565016508102, 'epoch': 1.03}
[2024-04-08 01:58:22,747] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 17%|█▋        | 2767/16104 [12:51:42<70:35:05, 19.05s/it]
[2024-04-08 01:58:41,711] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 17%|█▋        | 2769/16104 [12:52:20<71:10:59, 19.22s/it]

 17%|█▋        | 2770/16104 [12:52:32<62:54:53, 16.99s/it]
{'loss': 0.5119, 'learning_rate': 1.8961524965155775e-06, 'rewards/chosen': -0.848918616771698, 'rewards/rejected': -1.5113707780838013, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6624521017074585, 'policy_logps/rejected': -367.4209899902344, 'policy_logps/chosen': -376.26519775390625, 'referece_logps/rejected': -352.3072509765625, 'referece_logps/chosen': -367.7760314941406, 'logits/rejected': -0.2765626311302185, 'logits/chosen': -0.3278388977050781, 'epoch': 1.03}


 17%|█▋        | 2772/16104 [12:52:58<56:14:12, 15.19s/it]

 17%|█▋        | 2773/16104 [12:53:18<61:15:35, 16.54s/it]

 17%|█▋        | 2774/16104 [12:53:40<67:52:18, 18.33s/it]

 17%|█▋        | 2775/16104 [12:53:58<67:34:15, 18.25s/it]

 17%|█▋        | 2776/16104 [12:54:16<66:54:49, 18.07s/it]
{'loss': 0.4921, 'learning_rate': 1.8956163499484734e-06, 'rewards/chosen': -0.16482700407505035, 'rewards/rejected': -1.705607295036316, 'rewards/accuracies': 0.625, 'rewards/margins': 1.5407803058624268, 'policy_logps/rejected': -429.6475830078125, 'policy_logps/chosen': -492.394775390625, 'referece_logps/rejected': -412.5915222167969, 'referece_logps/chosen': -490.74652099609375, 'logits/rejected': -0.3857506215572357, 'logits/chosen': -0.43680351972579956, 'epoch': 1.03}


 17%|█▋        | 2778/16104 [12:54:46<62:36:22, 16.91s/it]
{'loss': 0.5405, 'learning_rate': 1.8954373445532917e-06, 'rewards/chosen': -0.5296376943588257, 'rewards/rejected': -0.8156128525733948, 'rewards/accuracies': 0.75, 'rewards/margins': 0.28597506880760193, 'policy_logps/rejected': -307.4813537597656, 'policy_logps/chosen': -475.7746887207031, 'referece_logps/rejected': -299.32525634765625, 'referece_logps/chosen': -470.4783020019531, 'logits/rejected': -0.18005815148353577, 'logits/chosen': -0.2357296347618103, 'epoch': 1.04}

 17%|█▋        | 2779/16104 [12:55:07<67:17:06, 18.18s/it]
[2024-04-08 02:02:10,116] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 17%|█▋        | 2780/16104 [12:55:29<71:08:15, 19.22s/it]


 17%|█▋        | 2782/16104 [12:56:09<71:41:17, 19.37s/it]

 17%|█▋        | 2783/16104 [12:56:22<65:28:16, 17.69s/it]
{'loss': 0.5648, 'learning_rate': 1.8949891972430874e-06, 'rewards/chosen': -1.186072587966919, 'rewards/rejected': -1.550112009048462, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3640393614768982, 'policy_logps/rejected': -503.6871643066406, 'policy_logps/chosen': -680.931396484375, 'referece_logps/rejected': -488.1860046386719, 'referece_logps/chosen': -669.0706787109375, 'logits/rejected': -0.20464235544204712, 'logits/chosen': -0.2579631209373474, 'epoch': 1.04}

 17%|█▋        | 2784/16104 [12:56:38<62:54:04, 17.00s/it]


 17%|█▋        | 2786/16104 [12:57:09<60:38:39, 16.39s/it]
{'loss': 0.4953, 'learning_rate': 1.894719874381035e-06, 'rewards/chosen': -0.7267497777938843, 'rewards/rejected': -1.8608747720718384, 'rewards/accuracies': 0.75, 'rewards/margins': 1.134124994277954, 'policy_logps/rejected': -354.49908447265625, 'policy_logps/chosen': -306.49334716796875, 'referece_logps/rejected': -335.8903503417969, 'referece_logps/chosen': -299.225830078125, 'logits/rejected': -1.0937942266464233, 'logits/chosen': -1.0498416423797607, 'epoch': 1.04}


 17%|█▋        | 2788/16104 [12:57:40<59:25:39, 16.07s/it]

 17%|█▋        | 2789/16104 [12:57:59<61:52:56, 16.73s/it]
{'loss': 0.4293, 'learning_rate': 1.8944502257818512e-06, 'rewards/chosen': -1.1232662200927734, 'rewards/rejected': -2.0659046173095703, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9426383972167969, 'policy_logps/rejected': -288.6404724121094, 'policy_logps/chosen': -340.3343505859375, 'referece_logps/rejected': -267.9814147949219, 'referece_logps/chosen': -329.1017150878906, 'logits/rejected': 0.3255855441093445, 'logits/chosen': 0.22935862839221954, 'epoch': 1.04}

 17%|█▋        | 2790/16104 [12:58:10<55:41:23, 15.06s/it]


 17%|█▋        | 2792/16104 [12:58:48<62:54:58, 17.01s/it]
{'loss': 0.4526, 'learning_rate': 1.8941802515437067e-06, 'rewards/chosen': -1.0846959352493286, 'rewards/rejected': -2.222104072570801, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1374082565307617, 'policy_logps/rejected': -388.9881591796875, 'policy_logps/chosen': -292.81463623046875, 'referece_logps/rejected': -366.76708984375, 'referece_logps/chosen': -281.9676513671875, 'logits/rejected': -1.026469349861145, 'logits/chosen': -0.9770247340202332, 'epoch': 1.04}

 17%|█▋        | 2793/16104 [12:59:00<56:49:00, 15.37s/it]

 17%|█▋        | 2794/16104 [12:59:18<59:30:57, 16.10s/it]


 17%|█▋        | 2796/16104 [12:59:44<53:32:27, 14.48s/it]
{'loss': 0.498, 'learning_rate': 1.8938197795132503e-06, 'rewards/chosen': -1.041378140449524, 'rewards/rejected': -1.4055066108703613, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3641284108161926, 'policy_logps/rejected': -475.98028564453125, 'policy_logps/chosen': -683.8624267578125, 'referece_logps/rejected': -461.92523193359375, 'referece_logps/chosen': -673.4485473632812, 'logits/rejected': -0.3372986614704132, 'logits/chosen': -0.5137268900871277, 'epoch': 1.04}


 17%|█▋        | 2798/16104 [13:00:25<63:40:28, 17.23s/it]
[2024-04-08 02:07:05,701] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5168, 'learning_rate': 1.8936393265438065e-06, 'rewards/chosen': -0.795511782169342, 'rewards/rejected': -1.8515064716339111, 'rewards/accuracies': 0.5, 'rewards/margins': 1.0559947490692139, 'policy_logps/rejected': -414.3260803222656, 'policy_logps/chosen': -418.7667541503906, 'referece_logps/rejected': -395.81103515625, 'referece_logps/chosen': -410.8116760253906, 'logits/rejected': -0.7639225125312805, 'logits/chosen': -0.7864148020744324, 'epoch': 1.04}
[2024-04-08 02:07:27,394] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 17%|█▋        | 2799/16104 [13:00:46<68:37:15, 18.57s/it]

 17%|█▋        | 2800/16104 [13:01:03<66:50:17, 18.09s/it]

 17%|█▋        | 2801/16104 [13:01:25<71:14:18, 19.28s/it]

 17%|█▋        | 2802/16104 [13:01:39<65:10:42, 17.64s/it]

 17%|█▋        | 2803/16104 [13:02:00<68:25:17, 18.52s/it]

 17%|█▋        | 2804/16104 [13:02:21<71:47:35, 19.43s/it]

 17%|█▋        | 2805/16104 [13:02:37<67:51:26, 18.37s/it]

 17%|█▋        | 2806/16104 [13:02:54<65:50:51, 17.83s/it]

 17%|█▋        | 2807/16104 [13:03:07<61:16:18, 16.59s/it]

 17%|█▋        | 2808/16104 [13:03:27<64:01:51, 17.34s/it]

 17%|█▋        | 2809/16104 [13:03:44<63:44:16, 17.26s/it]

 17%|█▋        | 2810/16104 [13:04:00<62:13:05, 16.85s/it]

 17%|█▋        | 2811/16104 [13:04:21<67:46:15, 18.35s/it]

 17%|█▋        | 2812/16104 [13:04:44<72:39:13, 19.68s/it]

 17%|█▋        | 2813/16104 [13:04:58<66:13:17, 17.94s/it]

 17%|█▋        | 2814/16104 [13:05:16<65:49:14, 17.83s/it]


 17%|█▋        | 2816/16104 [13:05:55<69:35:14, 18.85s/it]
{'loss': 0.4673, 'learning_rate': 1.8920087464554424e-06, 'rewards/chosen': -0.5064924359321594, 'rewards/rejected': -2.1517333984375, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6452410221099854, 'policy_logps/rejected': -307.5885314941406, 'policy_logps/chosen': -365.0798034667969, 'referece_logps/rejected': -286.0711975097656, 'referece_logps/chosen': -360.0148620605469, 'logits/rejected': -0.5499063730239868, 'logits/chosen': -0.6621555089950562, 'epoch': 1.05}

 17%|█▋        | 2817/16104 [13:06:06<61:01:34, 16.53s/it]

 17%|█▋        | 2818/16104 [13:06:26<63:55:51, 17.32s/it]

 18%|█▊        | 2819/16104 [13:06:43<63:52:56, 17.31s/it]

 18%|█▊        | 2820/16104 [13:06:58<61:02:17, 16.54s/it]

 18%|█▊        | 2821/16104 [13:07:16<63:29:28, 17.21s/it]

 18%|█▊        | 2822/16104 [13:07:35<65:20:32, 17.71s/it]

 18%|█▊        | 2823/16104 [13:07:49<60:57:32, 16.52s/it]

 18%|█▊        | 2824/16104 [13:08:10<66:23:52, 18.00s/it]

 18%|█▊        | 2825/16104 [13:08:22<58:59:32, 15.99s/it]

 18%|█▊        | 2826/16104 [13:08:34<54:22:23, 14.74s/it]

 18%|█▊        | 2827/16104 [13:08:50<55:56:53, 15.17s/it]

 18%|█▊        | 2828/16104 [13:09:00<51:00:19, 13.83s/it]

 18%|█▊        | 2829/16104 [13:09:11<47:32:36, 12.89s/it]

 18%|█▊        | 2830/16104 [13:09:23<46:43:25, 12.67s/it]

 18%|█▊        | 2831/16104 [13:09:43<54:56:20, 14.90s/it]

 18%|█▊        | 2832/16104 [13:09:59<55:55:15, 15.17s/it]

 18%|█▊        | 2833/16104 [13:10:17<58:26:32, 15.85s/it]

 18%|█▊        | 2834/16104 [13:10:36<62:36:38, 16.99s/it]

 18%|█▊        | 2835/16104 [13:10:58<68:20:31, 18.54s/it]

 18%|█▊        | 2836/16104 [13:11:10<60:33:00, 16.43s/it]

 18%|█▊        | 2837/16104 [13:11:26<60:24:01, 16.39s/it]

 18%|█▊        | 2838/16104 [13:11:47<65:37:56, 17.81s/it]

 18%|█▊        | 2839/16104 [13:12:01<60:33:10, 16.43s/it]

 18%|█▊        | 2840/16104 [13:12:17<60:14:41, 16.35s/it]

 18%|█▊        | 2841/16104 [13:12:37<64:14:38, 17.44s/it]

 18%|█▊        | 2842/16104 [13:12:50<59:41:31, 16.20s/it]

 18%|█▊        | 2843/16104 [13:13:08<61:33:39, 16.71s/it]

 18%|█▊        | 2844/16104 [13:13:23<60:02:11, 16.30s/it]

 18%|█▊        | 2845/16104 [13:13:40<60:33:11, 16.44s/it]

 18%|█▊        | 2846/16104 [13:14:01<64:58:01, 17.64s/it]

 18%|█▊        | 2847/16104 [13:14:16<62:09:51, 16.88s/it]

 18%|█▊        | 2848/16104 [13:14:27<56:11:57, 15.26s/it]

 18%|█▊        | 2849/16104 [13:14:47<61:32:56, 16.72s/it]

 18%|█▊        | 2850/16104 [13:15:07<64:58:04, 17.65s/it]

 18%|█▊        | 2851/16104 [13:15:25<64:57:51, 17.65s/it]

 18%|█▊        | 2852/16104 [13:15:37<59:18:09, 16.11s/it]

 18%|█▊        | 2853/16104 [13:15:55<61:02:25, 16.58s/it]


 18%|█▊        | 2855/16104 [13:16:32<64:44:46, 17.59s/it]
{'loss': 0.4562, 'learning_rate': 1.8884357450597655e-06, 'rewards/chosen': -0.8625640869140625, 'rewards/rejected': -1.6877368688583374, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8251727819442749, 'policy_logps/rejected': -381.8616027832031, 'policy_logps/chosen': -380.6911926269531, 'referece_logps/rejected': -364.9842529296875, 'referece_logps/chosen': -372.0655517578125, 'logits/rejected': -1.0088074207305908, 'logits/chosen': -1.0041327476501465, 'epoch': 1.06}

 18%|█▊        | 2856/16104 [13:16:49<64:27:10, 17.51s/it]

 18%|█▊        | 2857/16104 [13:17:00<57:06:21, 15.52s/it]

 18%|█▊        | 2858/16104 [13:17:20<61:19:02, 16.66s/it]

 18%|█▊        | 2859/16104 [13:17:37<62:00:55, 16.86s/it]

 18%|█▊        | 2860/16104 [13:17:49<57:07:31, 15.53s/it]

 18%|█▊        | 2861/16104 [13:18:02<54:20:55, 14.77s/it]

 18%|█▊        | 2862/16104 [13:18:15<51:30:21, 14.00s/it]

 18%|█▊        | 2863/16104 [13:18:29<51:42:45, 14.06s/it]


 18%|█▊        | 2865/16104 [13:18:52<47:33:20, 12.93s/it]
{'loss': 0.5356, 'learning_rate': 1.8875107770392256e-06, 'rewards/chosen': -0.8341627717018127, 'rewards/rejected': -1.235068917274475, 'rewards/accuracies': 0.625, 'rewards/margins': 0.40090614557266235, 'policy_logps/rejected': -367.76556396484375, 'policy_logps/chosen': -387.29608154296875, 'referece_logps/rejected': -355.41485595703125, 'referece_logps/chosen': -378.9544372558594, 'logits/rejected': -0.8898244500160217, 'logits/chosen': -0.789295494556427, 'epoch': 1.07}

 18%|█▊        | 2866/16104 [13:19:12<55:43:43, 15.16s/it]

 18%|█▊        | 2867/16104 [13:19:24<51:24:17, 13.98s/it]

 18%|█▊        | 2868/16104 [13:19:43<56:56:08, 15.49s/it]

 18%|█▊        | 2869/16104 [13:19:57<56:10:48, 15.28s/it]

 18%|█▊        | 2870/16104 [13:20:14<57:01:36, 15.51s/it]

 18%|█▊        | 2871/16104 [13:20:34<62:15:37, 16.94s/it]


 18%|█▊        | 2873/16104 [13:21:09<63:16:11, 17.21s/it]
{'loss': 0.5839, 'learning_rate': 1.8867682175431515e-06, 'rewards/chosen': -1.0848029851913452, 'rewards/rejected': -2.034799814224243, 'rewards/accuracies': 0.75, 'rewards/margins': 0.949996829032898, 'policy_logps/rejected': -496.5450744628906, 'policy_logps/chosen': -419.91766357421875, 'referece_logps/rejected': -476.19708251953125, 'referece_logps/chosen': -409.0696105957031, 'logits/rejected': -0.44797495007514954, 'logits/chosen': -0.26153361797332764, 'epoch': 1.07}
[2024-04-08 02:28:11,492] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 18%|█▊        | 2875/16104 [13:21:49<68:41:09, 18.69s/it]
[2024-04-08 02:28:30,449] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2876/16104 [13:22:09<69:09:20, 18.82s/it]

 18%|█▊        | 2877/16104 [13:22:25<66:13:01, 18.02s/it]

 18%|█▊        | 2878/16104 [13:22:40<63:27:09, 17.27s/it]

 18%|█▊        | 2879/16104 [13:23:00<66:04:22, 17.99s/it]

 18%|█▊        | 2880/16104 [13:23:20<68:39:10, 18.69s/it]

 18%|█▊        | 2881/16104 [13:23:41<71:06:07, 19.36s/it]

 18%|█▊        | 2882/16104 [13:23:53<62:32:11, 17.03s/it]

 18%|█▊        | 2883/16104 [13:24:10<62:35:59, 17.05s/it]

 18%|█▊        | 2884/16104 [13:24:31<67:02:26, 18.26s/it]

 18%|█▊        | 2885/16104 [13:24:49<67:27:22, 18.37s/it]

 18%|█▊        | 2886/16104 [13:25:10<69:31:33, 18.94s/it]

 18%|█▊        | 2887/16104 [13:25:31<72:12:50, 19.67s/it]

 18%|█▊        | 2888/16104 [13:25:44<64:34:26, 17.59s/it]

 18%|█▊        | 2889/16104 [13:26:05<68:34:46, 18.68s/it]
[2024-04-08 02:32:46,152] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2890/16104 [13:26:21<65:08:20, 17.75s/it]

 18%|█▊        | 2891/16104 [13:26:40<67:04:54, 18.28s/it]
[2024-04-08 02:33:21,229] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2892/16104 [13:26:57<64:56:47, 17.70s/it]

 18%|█▊        | 2893/16104 [13:27:11<61:37:50, 16.79s/it]

 18%|█▊        | 2894/16104 [13:27:29<63:00:22, 17.17s/it]
[2024-04-08 02:34:10,309] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2895/16104 [13:27:49<65:37:27, 17.89s/it]

 18%|█▊        | 2896/16104 [13:28:10<69:17:54, 18.89s/it]

 18%|█▊        | 2897/16104 [13:28:26<65:42:23, 17.91s/it]

 18%|█▊        | 2898/16104 [13:28:46<68:41:10, 18.72s/it]
[2024-04-08 02:35:27,343] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2899/16104 [13:29:01<64:43:36, 17.65s/it]

 18%|█▊        | 2900/16104 [13:29:20<66:01:49, 18.00s/it]

 18%|█▊        | 2901/16104 [13:29:40<67:52:54, 18.51s/it]

 18%|█▊        | 2902/16104 [13:30:00<69:10:29, 18.86s/it]

 18%|█▊        | 2903/16104 [13:30:19<70:14:03, 19.15s/it]

 18%|█▊        | 2904/16104 [13:30:40<72:06:56, 19.67s/it]
[2024-04-08 02:37:21,387] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2905/16104 [13:30:52<63:37:12, 17.35s/it]
[2024-04-08 02:37:33,336] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2906/16104 [13:31:03<56:29:00, 15.41s/it]

 18%|█▊        | 2907/16104 [13:31:16<53:50:18, 14.69s/it]

 18%|█▊        | 2908/16104 [13:31:27<49:36:18, 13.53s/it]

 18%|█▊        | 2909/16104 [13:31:42<51:01:37, 13.92s/it]

 18%|█▊        | 2910/16104 [13:31:54<49:32:27, 13.52s/it]

 18%|█▊        | 2911/16104 [13:32:15<57:50:17, 15.78s/it]

 18%|█▊        | 2912/16104 [13:32:36<63:24:09, 17.30s/it]

 18%|█▊        | 2913/16104 [13:32:50<59:12:17, 16.16s/it]

 18%|█▊        | 2914/16104 [13:33:02<54:28:20, 14.87s/it]

 18%|█▊        | 2915/16104 [13:33:13<50:04:20, 13.67s/it]

 18%|█▊        | 2916/16104 [13:33:24<47:35:58, 12.99s/it]

 18%|█▊        | 2917/16104 [13:33:40<50:52:11, 13.89s/it]
[2024-04-08 02:40:20,975] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2918/16104 [13:33:56<53:16:09, 14.54s/it]

 18%|█▊        | 2919/16104 [13:34:09<51:20:04, 14.02s/it]

 18%|█▊        | 2920/16104 [13:34:29<58:27:40, 15.96s/it]

 18%|█▊        | 2921/16104 [13:34:48<61:41:09, 16.85s/it]

 18%|█▊        | 2922/16104 [13:35:10<67:28:21, 18.43s/it]

 18%|█▊        | 2923/16104 [13:35:30<68:59:56, 18.85s/it]

 18%|█▊        | 2924/16104 [13:35:53<73:33:25, 20.09s/it]

 18%|█▊        | 2925/16104 [13:36:11<70:44:49, 19.33s/it]

 18%|█▊        | 2926/16104 [13:36:25<65:20:56, 17.85s/it]

 18%|█▊        | 2927/16104 [13:36:41<63:04:41, 17.23s/it]

 18%|█▊        | 2928/16104 [13:36:59<64:04:36, 17.51s/it]
{'loss': 0.4797, 'learning_rate': 1.881601076506444e-06, 'rewards/chosen': -0.8030773401260376, 'rewards/rejected': -2.0675365924835205, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2644593715667725, 'policy_logps/rejected': -284.66107177734375, 'policy_logps/chosen': -248.33157348632812, 'referece_logps/rejected': -263.9857177734375, 'referece_logps/chosen': -240.30079650878906, 'logits/rejected': -0.5843678712844849, 'logits/chosen': -0.677731454372406, 'epoch': 1.09}


 18%|█▊        | 2930/16104 [13:37:31<61:28:42, 16.80s/it]

 18%|█▊        | 2931/16104 [13:37:53<66:56:12, 18.29s/it]

 18%|█▊        | 2932/16104 [13:38:15<71:29:59, 19.54s/it]

 18%|█▊        | 2933/16104 [13:38:33<69:43:12, 19.06s/it]
{'loss': 0.6318, 'learning_rate': 1.88112597751148e-06, 'rewards/chosen': -0.657819390296936, 'rewards/rejected': -0.7140970826148987, 'rewards/accuracies': 0.5, 'rewards/margins': 0.05627766251564026, 'policy_logps/rejected': -451.0768127441406, 'policy_logps/chosen': -353.50335693359375, 'referece_logps/rejected': -443.93585205078125, 'referece_logps/chosen': -346.92510986328125, 'logits/rejected': -0.860982358455658, 'logits/chosen': -0.7253241539001465, 'epoch': 1.09}

 18%|█▊        | 2934/16104 [13:38:44<60:42:52, 16.60s/it]


 18%|█▊        | 2936/16104 [13:39:13<57:11:40, 15.64s/it]

 18%|█▊        | 2937/16104 [13:39:27<55:04:24, 15.06s/it]

 18%|█▊        | 2938/16104 [13:39:39<51:56:04, 14.20s/it]

 18%|█▊        | 2939/16104 [13:39:56<55:07:15, 15.07s/it]
{'loss': 0.5376, 'learning_rate': 1.8805546825370633e-06, 'rewards/chosen': -1.2794078588485718, 'rewards/rejected': -1.4106531143188477, 'rewards/accuracies': 0.375, 'rewards/margins': 0.13124512135982513, 'policy_logps/rejected': -317.81268310546875, 'policy_logps/chosen': -357.93218994140625, 'referece_logps/rejected': -303.7061462402344, 'referece_logps/chosen': -345.13812255859375, 'logits/rejected': -0.08035805076360703, 'logits/chosen': 0.06971089541912079, 'epoch': 1.1}


 18%|█▊        | 2941/16104 [13:40:31<59:16:40, 16.21s/it]

 18%|█▊        | 2942/16104 [13:40:44<55:52:41, 15.28s/it]

 18%|█▊        | 2943/16104 [13:40:57<53:19:46, 14.59s/it]

 18%|█▊        | 2944/16104 [13:41:16<58:07:53, 15.90s/it]

 18%|█▊        | 2945/16104 [13:41:31<56:56:44, 15.58s/it]
[2024-04-08 02:48:12,279] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 18%|█▊        | 2946/16104 [13:41:48<57:44:49, 15.80s/it]

 18%|█▊        | 2947/16104 [13:42:05<60:05:08, 16.44s/it]
{'loss': 0.5337, 'learning_rate': 1.8797909613283455e-06, 'rewards/chosen': -0.7515448331832886, 'rewards/rejected': -1.4445232152938843, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6929783821105957, 'policy_logps/rejected': -301.83502197265625, 'policy_logps/chosen': -315.07293701171875, 'referece_logps/rejected': -287.3898010253906, 'referece_logps/chosen': -307.5574951171875, 'logits/rejected': 0.2217065393924713, 'logits/chosen': 0.22868292033672333, 'epoch': 1.1}


 18%|█▊        | 2949/16104 [13:42:41<61:04:02, 16.71s/it]

 18%|█▊        | 2950/16104 [13:42:57<61:15:05, 16.76s/it]
{'loss': 0.5133, 'learning_rate': 1.879503978548428e-06, 'rewards/chosen': -0.9012481570243835, 'rewards/rejected': -1.4125607013702393, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5113126039505005, 'policy_logps/rejected': -295.3124084472656, 'policy_logps/chosen': -256.4922180175781, 'referece_logps/rejected': -281.18682861328125, 'referece_logps/chosen': -247.47976684570312, 'logits/rejected': -1.1751817464828491, 'logits/chosen': -1.045861005783081, 'epoch': 1.1}


 18%|█▊        | 2952/16104 [13:43:25<56:50:41, 15.56s/it]

 18%|█▊        | 2953/16104 [13:43:42<57:55:54, 15.86s/it]

 18%|█▊        | 2954/16104 [13:43:52<52:16:47, 14.31s/it]

 18%|█▊        | 2955/16104 [13:44:03<48:21:30, 13.24s/it]

 18%|█▊        | 2956/16104 [13:44:16<48:31:30, 13.29s/it]

 18%|█▊        | 2957/16104 [13:44:29<47:23:51, 12.98s/it]

 18%|█▊        | 2958/16104 [13:44:49<55:16:18, 15.14s/it]

 18%|█▊        | 2959/16104 [13:45:08<60:06:58, 16.46s/it]

 18%|█▊        | 2960/16104 [13:45:22<57:20:53, 15.71s/it]
{'loss': 0.608, 'learning_rate': 1.8785450573320189e-06, 'rewards/chosen': -0.9011192917823792, 'rewards/rejected': -1.2006820440292358, 'rewards/accuracies': 0.75, 'rewards/margins': 0.29956287145614624, 'policy_logps/rejected': -427.11309814453125, 'policy_logps/chosen': -507.91064453125, 'referece_logps/rejected': -415.10626220703125, 'referece_logps/chosen': -498.89947509765625, 'logits/rejected': -0.1911984533071518, 'logits/chosen': -0.2409195601940155, 'epoch': 1.1}
[2024-04-08 02:52:21,164] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 18%|█▊        | 2962/16104 [13:45:57<60:37:28, 16.61s/it]

 18%|█▊        | 2963/16104 [13:46:10<56:02:07, 15.35s/it]

 18%|█▊        | 2964/16104 [13:46:20<50:48:55, 13.92s/it]

 18%|█▊        | 2965/16104 [13:46:39<56:12:20, 15.40s/it]
{'loss': 0.6162, 'learning_rate': 1.8780642637794346e-06, 'rewards/chosen': -0.7099601626396179, 'rewards/rejected': -0.8586462736129761, 'rewards/accuracies': 0.625, 'rewards/margins': 0.14868605136871338, 'policy_logps/rejected': -548.1912841796875, 'policy_logps/chosen': -420.966796875, 'referece_logps/rejected': -539.604736328125, 'referece_logps/chosen': -413.8671569824219, 'logits/rejected': -0.7576041221618652, 'logits/chosen': -0.6842324733734131, 'epoch': 1.1}


 18%|█▊        | 2967/16104 [13:47:13<59:13:16, 16.23s/it]
{'loss': 0.7089, 'learning_rate': 1.877871697696298e-06, 'rewards/chosen': -0.6074302792549133, 'rewards/rejected': -0.8198715448379517, 'rewards/accuracies': 0.75, 'rewards/margins': 0.21244120597839355, 'policy_logps/rejected': -522.9636840820312, 'policy_logps/chosen': -745.359619140625, 'referece_logps/rejected': -514.7650146484375, 'referece_logps/chosen': -739.2852783203125, 'logits/rejected': -1.0182641744613647, 'logits/chosen': -0.958488404750824, 'epoch': 1.11}


 18%|█▊        | 2969/16104 [13:47:39<52:38:02, 14.43s/it]
{'loss': 0.5298, 'learning_rate': 1.8776789895672556e-06, 'rewards/chosen': -0.8351969718933105, 'rewards/rejected': -1.3750280141830444, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5398309826850891, 'policy_logps/rejected': -256.5123596191406, 'policy_logps/chosen': -375.2930908203125, 'referece_logps/rejected': -242.76206970214844, 'referece_logps/chosen': -366.94110107421875, 'logits/rejected': -0.31953370571136475, 'logits/chosen': -0.4293516278266907, 'epoch': 1.11}
[2024-04-08 02:54:39,187] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 18%|█▊        | 2971/16104 [13:48:18<62:03:11, 17.01s/it]

 18%|█▊        | 2972/16104 [13:48:31<58:13:15, 15.96s/it]
{'loss': 0.5372, 'learning_rate': 1.8773896611058354e-06, 'rewards/chosen': -0.6425685882568359, 'rewards/rejected': -1.6656990051269531, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0231302976608276, 'policy_logps/rejected': -360.4305114746094, 'policy_logps/chosen': -460.1826171875, 'referece_logps/rejected': -343.7735290527344, 'referece_logps/chosen': -453.7569274902344, 'logits/rejected': -0.24128417670726776, 'logits/chosen': -0.18766732513904572, 'epoch': 1.11}


 18%|█▊        | 2974/16104 [13:49:03<56:28:14, 15.48s/it]

 18%|█▊        | 2975/16104 [13:49:19<57:13:21, 15.69s/it]
{'loss': 0.5405, 'learning_rate': 1.8771000132166263e-06, 'rewards/chosen': -0.6452625393867493, 'rewards/rejected': -1.085450530052185, 'rewards/accuracies': 0.25, 'rewards/margins': 0.44018808007240295, 'policy_logps/rejected': -430.86053466796875, 'policy_logps/chosen': -389.94000244140625, 'referece_logps/rejected': -420.00604248046875, 'referece_logps/chosen': -383.4873352050781, 'logits/rejected': 0.6830618381500244, 'logits/chosen': 0.675283670425415, 'epoch': 1.11}


 18%|█▊        | 2977/16104 [13:49:55<61:07:00, 16.76s/it]

 18%|█▊        | 2978/16104 [13:50:07<55:34:39, 15.24s/it]
{'loss': 0.6133, 'learning_rate': 1.8768100460050794e-06, 'rewards/chosen': -0.7349990606307983, 'rewards/rejected': -1.0272315740585327, 'rewards/accuracies': 0.875, 'rewards/margins': 0.2922325134277344, 'policy_logps/rejected': -525.1965942382812, 'policy_logps/chosen': -620.0128173828125, 'referece_logps/rejected': -514.92431640625, 'referece_logps/chosen': -612.662841796875, 'logits/rejected': 0.11389338970184326, 'logits/chosen': -0.03715471923351288, 'epoch': 1.11}


 19%|█▊        | 2980/16104 [13:50:37<56:45:16, 15.57s/it]

 19%|█▊        | 2981/16104 [13:50:53<56:33:31, 15.52s/it]
{'loss': 0.4911, 'learning_rate': 1.876519759576762e-06, 'rewards/chosen': -0.7437085509300232, 'rewards/rejected': -1.2100714445114136, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4663628935813904, 'policy_logps/rejected': -391.25250244140625, 'policy_logps/chosen': -343.42718505859375, 'referece_logps/rejected': -379.1517639160156, 'referece_logps/chosen': -335.9901123046875, 'logits/rejected': -0.47591274976730347, 'logits/chosen': -0.44851288199424744, 'epoch': 1.11}


 19%|█▊        | 2983/16104 [13:51:25<59:23:36, 16.30s/it]

 19%|█▊        | 2984/16104 [13:51:38<55:05:59, 15.12s/it]

 19%|█▊        | 2985/16104 [13:51:55<57:18:17, 15.73s/it]

 19%|█▊        | 2986/16104 [13:52:08<54:16:22, 14.89s/it]

 19%|█▊        | 2987/16104 [13:52:24<55:54:58, 15.35s/it]

 19%|█▊        | 2988/16104 [13:52:42<58:50:14, 16.15s/it]

 19%|█▊        | 2989/16104 [13:52:53<53:27:48, 14.68s/it]
{'loss': 0.5532, 'learning_rate': 1.8757441026233438e-06, 'rewards/chosen': -0.28875088691711426, 'rewards/rejected': -1.1116052865982056, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8228543996810913, 'policy_logps/rejected': -356.3590087890625, 'policy_logps/chosen': -372.7969055175781, 'referece_logps/rejected': -345.24298095703125, 'referece_logps/chosen': -369.90936279296875, 'logits/rejected': -0.13520023226737976, 'logits/chosen': -0.2909070551395416, 'epoch': 1.11}

 19%|█▊        | 2990/16104 [13:53:15<60:41:27, 16.66s/it]


 19%|█▊        | 2992/16104 [13:53:47<61:20:14, 16.84s/it]

 19%|█▊        | 2993/16104 [13:54:05<62:40:04, 17.21s/it]
{'loss': 0.5482, 'learning_rate': 1.875355423811198e-06, 'rewards/chosen': -1.4284154176712036, 'rewards/rejected': -1.3849763870239258, 'rewards/accuracies': 0.625, 'rewards/margins': -0.043439075350761414, 'policy_logps/rejected': -421.5228271484375, 'policy_logps/chosen': -363.73565673828125, 'referece_logps/rejected': -407.67303466796875, 'referece_logps/chosen': -349.45147705078125, 'logits/rejected': -0.1625520884990692, 'logits/chosen': -0.14857487380504608, 'epoch': 1.12}


 19%|█▊        | 2995/16104 [13:54:38<61:11:57, 16.81s/it]

 19%|█▊        | 2996/16104 [13:54:56<62:11:35, 17.08s/it]

 19%|█▊        | 2997/16104 [13:55:10<58:53:39, 16.18s/it]
{'loss': 0.5093, 'learning_rate': 1.8749661784440578e-06, 'rewards/chosen': -1.1225507259368896, 'rewards/rejected': -1.4492206573486328, 'rewards/accuracies': 0.5, 'rewards/margins': 0.32666996121406555, 'policy_logps/rejected': -426.99774169921875, 'policy_logps/chosen': -420.6180419921875, 'referece_logps/rejected': -412.5054931640625, 'referece_logps/chosen': -409.3924865722656, 'logits/rejected': -0.41360875964164734, 'logits/chosen': -0.1843012273311615, 'epoch': 1.12}


 19%|█▊        | 2999/16104 [13:55:40<56:53:21, 15.63s/it]

 19%|█▊        | 3000/16104 [13:55:53<53:36:01, 14.73s/it]

 19%|█▊        | 3001/16104 [13:56:30<77:59:23, 21.43s/it]

 19%|█▊        | 3002/16104 [13:56:44<69:20:31, 19.05s/it]

 19%|█▊        | 3003/16104 [13:57:06<72:46:58, 20.00s/it]

 19%|█▊        | 3004/16104 [13:57:20<66:10:32, 18.19s/it]

 19%|█▊        | 3005/16104 [13:57:38<66:39:40, 18.32s/it]

 19%|█▊        | 3006/16104 [13:57:54<63:21:31, 17.41s/it]

 19%|█▊        | 3007/16104 [13:58:12<63:49:52, 17.55s/it]
{'loss': 0.4709, 'learning_rate': 1.8739905880023024e-06, 'rewards/chosen': -0.7311100959777832, 'rewards/rejected': -1.9658781290054321, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2347681522369385, 'policy_logps/rejected': -379.3035888671875, 'policy_logps/chosen': -349.4612121582031, 'referece_logps/rejected': -359.6448059082031, 'referece_logps/chosen': -342.15008544921875, 'logits/rejected': 0.5437568426132202, 'logits/chosen': 0.5684758424758911, 'epoch': 1.12}


 19%|█▊        | 3009/16104 [13:58:49<66:04:08, 18.16s/it]

 19%|█▊        | 3010/16104 [13:59:07<65:53:08, 18.11s/it]

 19%|█▊        | 3011/16104 [13:59:24<65:01:33, 17.88s/it]

 19%|█▊        | 3012/16104 [13:59:37<60:13:33, 16.56s/it]

 19%|█▊        | 3013/16104 [13:59:54<60:40:04, 16.68s/it]

 19%|█▊        | 3014/16104 [14:00:16<65:33:08, 18.03s/it]
[2024-04-08 03:06:56,612] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 19%|█▊        | 3015/16104 [14:00:33<64:36:57, 17.77s/it]
[2024-04-08 03:07:13,785] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 19%|█▊        | 3016/16104 [14:00:56<70:14:34, 19.32s/it]

 19%|█▊        | 3017/16104 [14:01:18<73:31:02, 20.22s/it]

 19%|█▊        | 3018/16104 [14:01:34<68:26:18, 18.83s/it]

 19%|█▊        | 3019/16104 [14:01:46<61:43:27, 16.98s/it]
{'loss': 0.5637, 'learning_rate': 1.8728152130308302e-06, 'rewards/chosen': -1.1256506443023682, 'rewards/rejected': -1.3674328327178955, 'rewards/accuracies': 0.375, 'rewards/margins': 0.24178215861320496, 'policy_logps/rejected': -559.4269409179688, 'policy_logps/chosen': -485.3736877441406, 'referece_logps/rejected': -545.7526245117188, 'referece_logps/chosen': -474.1172180175781, 'logits/rejected': 0.3106566071510315, 'logits/chosen': 0.3782486021518707, 'epoch': 1.12}


 19%|█▉        | 3021/16104 [14:02:18<59:06:26, 16.26s/it]

 19%|█▉        | 3022/16104 [14:02:36<60:03:35, 16.53s/it]
[2024-04-08 03:09:16,611] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 19%|█▉        | 3023/16104 [14:02:56<64:03:00, 17.63s/it]
[2024-04-08 03:09:36,804] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 19%|█▉        | 3024/16104 [14:03:10<60:13:48, 16.58s/it]

 19%|█▉        | 3025/16104 [14:03:26<60:02:09, 16.52s/it]

 19%|█▉        | 3026/16104 [14:03:46<63:55:44, 17.60s/it]

 19%|█▉        | 3027/16104 [14:04:02<61:33:42, 16.95s/it]

 19%|█▉        | 3028/16104 [14:04:20<62:56:49, 17.33s/it]

 19%|█▉        | 3029/16104 [14:04:32<56:54:17, 15.67s/it]

 19%|█▉        | 3030/16104 [14:04:47<56:17:36, 15.50s/it]

 19%|█▉        | 3031/16104 [14:05:03<56:45:15, 15.63s/it]

 19%|█▉        | 3032/16104 [14:05:24<62:49:40, 17.30s/it]

 19%|█▉        | 3033/16104 [14:05:46<67:46:03, 18.66s/it]

 19%|█▉        | 3034/16104 [14:05:57<59:03:46, 16.27s/it]

 19%|█▉        | 3035/16104 [14:06:10<56:26:53, 15.55s/it]
{'loss': 0.531, 'learning_rate': 1.8712401388406773e-06, 'rewards/chosen': -0.8734968304634094, 'rewards/rejected': -2.172145128250122, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2986482381820679, 'policy_logps/rejected': -443.9472351074219, 'policy_logps/chosen': -398.00439453125, 'referece_logps/rejected': -422.22576904296875, 'referece_logps/chosen': -389.2694396972656, 'logits/rejected': -0.22866544127464294, 'logits/chosen': -0.03184019401669502, 'epoch': 1.13}
[2024-04-08 03:13:12,706] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 19%|█▉        | 3037/16104 [14:06:47<60:02:21, 16.54s/it]
{'loss': 0.5541, 'learning_rate': 1.8710426198540037e-06, 'rewards/chosen': -0.7687262296676636, 'rewards/rejected': -1.2526068687438965, 'rewards/accuracies': 0.625, 'rewards/margins': 0.48388075828552246, 'policy_logps/rejected': -371.9289245605469, 'policy_logps/chosen': -323.6451721191406, 'referece_logps/rejected': -359.4028625488281, 'referece_logps/chosen': -315.9579162597656, 'logits/rejected': -0.6868220567703247, 'logits/chosen': -0.6357689499855042, 'epoch': 1.13}


 19%|█▉        | 3039/16104 [14:07:21<62:49:29, 17.31s/it]

 19%|█▉        | 3040/16104 [14:07:33<57:06:01, 15.73s/it]
{'loss': 0.5068, 'learning_rate': 1.8707460771197771e-06, 'rewards/chosen': -0.7498993277549744, 'rewards/rejected': -2.0977470874786377, 'rewards/accuracies': 0.875, 'rewards/margins': 1.347847819328308, 'policy_logps/rejected': -499.23150634765625, 'policy_logps/chosen': -372.3555908203125, 'referece_logps/rejected': -478.2540283203125, 'referece_logps/chosen': -364.8565979003906, 'logits/rejected': -0.47983860969543457, 'logits/chosen': -0.31471753120422363, 'epoch': 1.13}

 19%|█▉        | 3041/16104 [14:07:50<57:47:22, 15.93s/it]


 19%|█▉        | 3043/16104 [14:08:27<62:20:06, 17.18s/it]
{'loss': 0.477, 'learning_rate': 1.8704492173764649e-06, 'rewards/chosen': -0.6281877756118774, 'rewards/rejected': -1.7614240646362305, 'rewards/accuracies': 0.5, 'rewards/margins': 1.1332364082336426, 'policy_logps/rejected': -432.4935607910156, 'policy_logps/chosen': -438.3886413574219, 'referece_logps/rejected': -414.8793029785156, 'referece_logps/chosen': -432.1067199707031, 'logits/rejected': -0.08954869955778122, 'logits/chosen': -0.04113363102078438, 'epoch': 1.13}

 19%|█▉        | 3044/16104 [14:08:49<68:04:52, 18.77s/it]


 19%|█▉        | 3046/16104 [14:09:17<58:03:31, 16.01s/it]

 19%|█▉        | 3047/16104 [14:09:37<63:08:56, 17.41s/it]
[2024-04-08 03:16:18,270] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5199, 'learning_rate': 1.8700529114469544e-06, 'rewards/chosen': -1.7942652702331543, 'rewards/rejected': -2.7744414806365967, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9801762104034424, 'policy_logps/rejected': -468.333740234375, 'policy_logps/chosen': -461.43707275390625, 'referece_logps/rejected': -440.58929443359375, 'referece_logps/chosen': -443.49444580078125, 'logits/rejected': -0.19695119559764862, 'logits/chosen': -0.1619967222213745, 'epoch': 1.14}

 19%|█▉        | 3048/16104 [14:09:54<62:17:09, 17.17s/it]

 19%|█▉        | 3049/16104 [14:10:08<59:02:34, 16.28s/it]

 19%|█▉        | 3050/16104 [14:10:24<58:32:39, 16.15s/it]


 19%|█▉        | 3052/16104 [14:10:53<55:03:06, 15.18s/it]
{'loss': 0.4779, 'learning_rate': 1.8695567371733596e-06, 'rewards/chosen': -0.9364092350006104, 'rewards/rejected': -1.8043099641799927, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8679007291793823, 'policy_logps/rejected': -276.93359375, 'policy_logps/chosen': -463.29583740234375, 'referece_logps/rejected': -258.8905029296875, 'referece_logps/chosen': -453.9317626953125, 'logits/rejected': -0.8885642290115356, 'logits/chosen': -0.9497002363204956, 'epoch': 1.14}

 19%|█▉        | 3053/16104 [14:11:13<59:19:58, 16.37s/it]

 19%|█▉        | 3054/16104 [14:11:26<56:03:32, 15.46s/it]


 19%|█▉        | 3056/16104 [14:12:03<61:30:28, 16.97s/it]
{'loss': 0.5565, 'learning_rate': 1.8691591645782284e-06, 'rewards/chosen': -1.2649784088134766, 'rewards/rejected': -1.6823607683181763, 'rewards/accuracies': 0.625, 'rewards/margins': 0.41738229990005493, 'policy_logps/rejected': -611.3320922851562, 'policy_logps/chosen': -349.03802490234375, 'referece_logps/rejected': -594.5084838867188, 'referece_logps/chosen': -336.38824462890625, 'logits/rejected': 0.0349644273519516, 'logits/chosen': 0.01271548867225647, 'epoch': 1.14}


 19%|█▉        | 3058/16104 [14:12:33<57:29:51, 15.87s/it]
{'loss': 0.5951, 'learning_rate': 1.8689601673103417e-06, 'rewards/chosen': -1.030416488647461, 'rewards/rejected': -1.1373738050460815, 'rewards/accuracies': 0.375, 'rewards/margins': 0.10695722699165344, 'policy_logps/rejected': -436.49542236328125, 'policy_logps/chosen': -407.8822326660156, 'referece_logps/rejected': -425.1217041015625, 'referece_logps/chosen': -397.5780944824219, 'logits/rejected': -0.6996252536773682, 'logits/chosen': -0.4618785083293915, 'epoch': 1.14}


 19%|█▉        | 3060/16104 [14:13:01<54:59:41, 15.18s/it]
{'loss': 0.5802, 'learning_rate': 1.8687610294384986e-06, 'rewards/chosen': -1.0500754117965698, 'rewards/rejected': -1.6268868446350098, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5768113732337952, 'policy_logps/rejected': -481.6007080078125, 'policy_logps/chosen': -390.2337951660156, 'referece_logps/rejected': -465.33184814453125, 'referece_logps/chosen': -379.73309326171875, 'logits/rejected': -0.9927927851676941, 'logits/chosen': -0.8176425695419312, 'epoch': 1.14}

 19%|█▉        | 3061/16104 [14:13:22<60:28:10, 16.69s/it]

 19%|█▉        | 3062/16104 [14:13:32<53:57:41, 14.90s/it]


 19%|█▉        | 3064/16104 [14:14:01<51:37:25, 14.25s/it]
{'loss': 0.4641, 'learning_rate': 1.868362332011854e-06, 'rewards/chosen': -0.8955953121185303, 'rewards/rejected': -2.002781867980957, 'rewards/accuracies': 0.625, 'rewards/margins': 1.1071865558624268, 'policy_logps/rejected': -357.8663330078125, 'policy_logps/chosen': -337.9651184082031, 'referece_logps/rejected': -337.8385009765625, 'referece_logps/chosen': -329.0091857910156, 'logits/rejected': -0.0993766263127327, 'logits/chosen': -0.06217130273580551, 'epoch': 1.14}

 19%|█▉        | 3065/16104 [14:14:18<55:16:01, 15.26s/it]

 19%|█▉        | 3066/16104 [14:14:34<56:00:16, 15.46s/it]

 19%|█▉        | 3067/16104 [14:14:54<60:45:07, 16.78s/it]

 19%|█▉        | 3068/16104 [14:15:06<55:46:49, 15.40s/it]

 19%|█▉        | 3069/16104 [14:15:25<58:48:16, 16.24s/it]


 19%|█▉        | 3071/16104 [14:15:54<56:37:28, 15.64s/it]

 19%|█▉        | 3072/16104 [14:16:17<64:56:15, 17.94s/it]

 19%|█▉        | 3073/16104 [14:16:33<63:00:27, 17.41s/it]
{'loss': 0.4452, 'learning_rate': 1.867463208277571e-06, 'rewards/chosen': -0.2445104569196701, 'rewards/rejected': -1.895068645477295, 'rewards/accuracies': 1.0, 'rewards/margins': 1.6505581140518188, 'policy_logps/rejected': -447.8905029296875, 'policy_logps/chosen': -312.1763916015625, 'referece_logps/rejected': -428.9398193359375, 'referece_logps/chosen': -309.73126220703125, 'logits/rejected': -0.20568349957466125, 'logits/chosen': -0.1406768262386322, 'epoch': 1.14}


 19%|█▉        | 3075/16104 [14:17:02<57:54:09, 16.00s/it]
{'loss': 0.4997, 'learning_rate': 1.8672630169047004e-06, 'rewards/chosen': -0.8936245441436768, 'rewards/rejected': -1.446136713027954, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5525121688842773, 'policy_logps/rejected': -234.45281982421875, 'policy_logps/chosen': -356.34307861328125, 'referece_logps/rejected': -219.99147033691406, 'referece_logps/chosen': -347.40679931640625, 'logits/rejected': -0.7927223443984985, 'logits/chosen': -0.8571926355361938, 'epoch': 1.15}


 19%|█▉        | 3077/16104 [14:17:33<56:58:19, 15.74s/it]
{'loss': 0.4232, 'learning_rate': 1.8670626852024846e-06, 'rewards/chosen': -1.4754068851470947, 'rewards/rejected': -1.8823633193969727, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4069565236568451, 'policy_logps/rejected': -301.15850830078125, 'policy_logps/chosen': -361.3469543457031, 'referece_logps/rejected': -282.3348693847656, 'referece_logps/chosen': -346.5928955078125, 'logits/rejected': -0.6286659836769104, 'logits/chosen': -0.5319459438323975, 'epoch': 1.15}
[2024-04-08 03:24:37,378] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 19%|█▉        | 3078/16104 [14:17:56<64:54:52, 17.94s/it]

 19%|█▉        | 3079/16104 [14:18:18<69:03:33, 19.09s/it]

 19%|█▉        | 3080/16104 [14:18:35<66:13:30, 18.31s/it]

 19%|█▉        | 3081/16104 [14:18:51<64:04:25, 17.71s/it]


 19%|█▉        | 3083/16104 [14:19:21<59:21:07, 16.41s/it]
{'loss': 0.6215, 'learning_rate': 1.86646084844403e-06, 'rewards/chosen': -1.1185499429702759, 'rewards/rejected': -1.2378498315811157, 'rewards/accuracies': 0.375, 'rewards/margins': 0.11929989606142044, 'policy_logps/rejected': -478.99163818359375, 'policy_logps/chosen': -330.8975830078125, 'referece_logps/rejected': -466.6131286621094, 'referece_logps/chosen': -319.7121276855469, 'logits/rejected': -0.36581793427467346, 'logits/chosen': -0.27648138999938965, 'epoch': 1.15}


 19%|█▉        | 3085/16104 [14:19:56<60:09:09, 16.63s/it]

 19%|█▉        | 3086/16104 [14:20:16<63:44:38, 17.63s/it]
{'loss': 0.3736, 'learning_rate': 1.8661594568365284e-06, 'rewards/chosen': -0.32092297077178955, 'rewards/rejected': -1.943933367729187, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6230103969573975, 'policy_logps/rejected': -273.6811218261719, 'policy_logps/chosen': -384.166748046875, 'referece_logps/rejected': -254.24179077148438, 'referece_logps/chosen': -380.95751953125, 'logits/rejected': -0.4608878791332245, 'logits/chosen': -0.4338796138763428, 'epoch': 1.15}
[2024-04-08 03:27:07,718] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 19%|█▉        | 3087/16104 [14:20:27<56:26:12, 15.61s/it]


 19%|█▉        | 3089/16104 [14:21:00<57:11:46, 15.82s/it]
{'loss': 0.5887, 'learning_rate': 1.8658577498897744e-06, 'rewards/chosen': -1.68955397605896, 'rewards/rejected': -1.264635682106018, 'rewards/accuracies': 0.5, 'rewards/margins': -0.42491814494132996, 'policy_logps/rejected': -277.19482421875, 'policy_logps/chosen': -393.26263427734375, 'referece_logps/rejected': -264.5484619140625, 'referece_logps/chosen': -376.3670959472656, 'logits/rejected': -1.337022066116333, 'logits/chosen': -1.2770698070526123, 'epoch': 1.15}

 19%|█▉        | 3090/16104 [14:21:17<58:46:00, 16.26s/it]


 19%|█▉        | 3091/16104 [14:21:29<53:34:58, 14.82s/it]
{'loss': 0.6052, 'learning_rate': 1.8655557277136085e-06, 'rewards/chosen': -1.232239007949829, 'rewards/rejected': -1.533602237701416, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3013632595539093, 'policy_logps/rejected': -293.02911376953125, 'policy_logps/chosen': -431.46185302734375, 'referece_logps/rejected': -277.693115234375, 'referece_logps/chosen': -419.13946533203125, 'logits/rejected': -0.3578170835971832, 'logits/chosen': -0.29888176918029785, 'epoch': 1.15}
 19%|█▉        | 3092/16104 [14:21:40<49:59:38, 13.83s/it]

 19%|█▉        | 3093/16104 [14:21:57<53:14:41, 14.73s/it]


 19%|█▉        | 3095/16104 [14:22:22<49:05:24, 13.58s/it]
{'loss': 0.4215, 'learning_rate': 1.8652533904179875e-06, 'rewards/chosen': -1.3033225536346436, 'rewards/rejected': -2.2323849201202393, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9290623068809509, 'policy_logps/rejected': -277.12152099609375, 'policy_logps/chosen': -342.5687255859375, 'referece_logps/rejected': -254.7976837158203, 'referece_logps/chosen': -329.5354919433594, 'logits/rejected': -1.1644915342330933, 'logits/chosen': -1.1907987594604492, 'epoch': 1.15}

 19%|█▉        | 3096/16104 [14:22:38<51:57:10, 14.38s/it]

 19%|█▉        | 3097/16104 [14:22:52<51:40:05, 14.30s/it]

 19%|█▉        | 3098/16104 [14:23:03<47:46:44, 13.23s/it]


 19%|█▉        | 3100/16104 [14:23:44<60:08:05, 16.65s/it]
[2024-04-08 03:30:24,571] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5487, 'learning_rate': 1.864748794958839e-06, 'rewards/chosen': -1.3015060424804688, 'rewards/rejected': -1.9704599380493164, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6689539551734924, 'policy_logps/rejected': -457.329833984375, 'policy_logps/chosen': -397.64117431640625, 'referece_logps/rejected': -437.62518310546875, 'referece_logps/chosen': -384.6261291503906, 'logits/rejected': -0.3694227933883667, 'logits/chosen': -0.4163631796836853, 'epoch': 1.15}


 19%|█▉        | 3102/16104 [14:24:20<63:49:57, 17.67s/it]
{'loss': 0.6326, 'learning_rate': 1.8645467118821698e-06, 'rewards/chosen': -0.7785204648971558, 'rewards/rejected': -1.202144980430603, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4236246347427368, 'policy_logps/rejected': -248.85110473632812, 'policy_logps/chosen': -296.104248046875, 'referece_logps/rejected': -236.8296356201172, 'referece_logps/chosen': -288.3190612792969, 'logits/rejected': -0.990746259689331, 'logits/chosen': -0.9366528987884521, 'epoch': 1.16}

 19%|█▉        | 3103/16104 [14:24:33<58:26:15, 16.18s/it]

 19%|█▉        | 3104/16104 [14:24:43<52:32:33, 14.55s/it]

 19%|█▉        | 3105/16104 [14:24:55<49:31:01, 13.71s/it]

 19%|█▉        | 3106/16104 [14:25:15<56:27:10, 15.64s/it]

 19%|█▉        | 3107/16104 [14:25:35<61:02:52, 16.91s/it]

 19%|█▉        | 3108/16104 [14:25:55<63:46:23, 17.67s/it]


 19%|█▉        | 3110/16104 [14:26:26<61:27:54, 17.03s/it]
{'loss': 0.5036, 'learning_rate': 1.8637369810045414e-06, 'rewards/chosen': -1.116312861442566, 'rewards/rejected': -2.10585880279541, 'rewards/accuracies': 1.0, 'rewards/margins': 0.9895460605621338, 'policy_logps/rejected': -372.4150390625, 'policy_logps/chosen': -405.26690673828125, 'referece_logps/rejected': -351.3564147949219, 'referece_logps/chosen': -394.1037902832031, 'logits/rejected': -0.39076679944992065, 'logits/chosen': -0.36937910318374634, 'epoch': 1.16}

 19%|█▉        | 3111/16104 [14:26:39<57:00:39, 15.80s/it]


 19%|█▉        | 3113/16104 [14:27:02<49:00:49, 13.58s/it]
{'loss': 0.5189, 'learning_rate': 1.8634327553076864e-06, 'rewards/chosen': -0.4329599440097809, 'rewards/rejected': -1.0186651945114136, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5857052206993103, 'policy_logps/rejected': -330.46746826171875, 'policy_logps/chosen': -370.1355895996094, 'referece_logps/rejected': -320.2807922363281, 'referece_logps/chosen': -365.8059997558594, 'logits/rejected': -0.7353644371032715, 'logits/chosen': -0.7745139002799988, 'epoch': 1.16}


 19%|█▉        | 3115/16104 [14:27:42<60:32:04, 16.78s/it]

 19%|█▉        | 3116/16104 [14:27:54<55:16:05, 15.32s/it]
{'loss': 0.4618, 'learning_rate': 1.863128215264278e-06, 'rewards/chosen': -1.136925220489502, 'rewards/rejected': -1.7828317880630493, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6459065675735474, 'policy_logps/rejected': -273.43853759765625, 'policy_logps/chosen': -435.95068359375, 'referece_logps/rejected': -255.6102294921875, 'referece_logps/chosen': -424.5814208984375, 'logits/rejected': 0.24304865300655365, 'logits/chosen': 0.24211491644382477, 'epoch': 1.16}

 19%|█▉        | 3117/16104 [14:28:09<55:14:12, 15.31s/it]

 19%|█▉        | 3118/16104 [14:28:31<61:54:04, 17.16s/it]


 19%|█▉        | 3120/16104 [14:29:12<67:42:03, 18.77s/it]
{'loss': 0.5573, 'learning_rate': 1.8627216730811882e-06, 'rewards/chosen': -1.1270461082458496, 'rewards/rejected': -1.8238667249679565, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6968205571174622, 'policy_logps/rejected': -461.4480895996094, 'policy_logps/chosen': -447.37701416015625, 'referece_logps/rejected': -443.20941162109375, 'referece_logps/chosen': -436.1065673828125, 'logits/rejected': -0.9461720585823059, 'logits/chosen': -0.8518854379653931, 'epoch': 1.16}

 19%|█▉        | 3121/16104 [14:29:29<65:16:51, 18.10s/it]

 19%|█▉        | 3122/16104 [14:29:42<59:44:53, 16.57s/it]

 19%|█▉        | 3123/16104 [14:30:01<62:32:52, 17.35s/it]

 19%|█▉        | 3124/16104 [14:30:17<61:33:01, 17.07s/it]

 19%|█▉        | 3125/16104 [14:30:32<58:29:34, 16.22s/it]

 19%|█▉        | 3126/16104 [14:30:46<56:13:32, 15.60s/it]


 19%|█▉        | 3128/16104 [14:31:28<66:45:10, 18.52s/it]

 19%|█▉        | 3129/16104 [14:31:45<64:31:09, 17.90s/it]
{'loss': 0.4888, 'learning_rate': 1.8618049120008552e-06, 'rewards/chosen': -1.21873939037323, 'rewards/rejected': -1.185909628868103, 'rewards/accuracies': 0.5, 'rewards/margins': -0.032829683274030685, 'policy_logps/rejected': -219.56845092773438, 'policy_logps/chosen': -295.89813232421875, 'referece_logps/rejected': -207.70936584472656, 'referece_logps/chosen': -283.71075439453125, 'logits/rejected': -0.9581640362739563, 'logits/chosen': -0.6289998292922974, 'epoch': 1.17}


 19%|█▉        | 3131/16104 [14:32:26<69:33:28, 19.30s/it]
{'loss': 0.5767, 'learning_rate': 1.8616008037334869e-06, 'rewards/chosen': -0.8646510243415833, 'rewards/rejected': -1.9460303783416748, 'rewards/accuracies': 1.0, 'rewards/margins': 1.0813794136047363, 'policy_logps/rejected': -241.8045196533203, 'policy_logps/chosen': -298.97943115234375, 'referece_logps/rejected': -222.34422302246094, 'referece_logps/chosen': -290.3328857421875, 'logits/rejected': -0.49227577447891235, 'logits/chosen': -0.5342456698417664, 'epoch': 1.17}

 19%|█▉        | 3132/16104 [14:32:43<66:53:16, 18.56s/it]


 19%|█▉        | 3134/16104 [14:33:11<58:33:30, 16.25s/it]

 19%|█▉        | 3135/16104 [14:33:28<60:14:55, 16.72s/it]

 19%|█▉        | 3136/16104 [14:33:41<55:37:23, 15.44s/it]
{'loss': 0.4256, 'learning_rate': 1.8610899232047974e-06, 'rewards/chosen': -0.8445180058479309, 'rewards/rejected': -2.6623568534851074, 'rewards/accuracies': 0.875, 'rewards/margins': 1.8178390264511108, 'policy_logps/rejected': -410.02972412109375, 'policy_logps/chosen': -366.1901550292969, 'referece_logps/rejected': -383.40618896484375, 'referece_logps/chosen': -357.74493408203125, 'logits/rejected': -0.8210801482200623, 'logits/chosen': -0.7754945755004883, 'epoch': 1.17}

 19%|█▉        | 3137/16104 [14:34:01<60:38:54, 16.84s/it]


 19%|█▉        | 3139/16104 [14:34:37<62:13:22, 17.28s/it]
{'loss': 0.5348, 'learning_rate': 1.8607829768630272e-06, 'rewards/chosen': -0.5639488697052002, 'rewards/rejected': -0.8332349061965942, 'rewards/accuracies': 0.75, 'rewards/margins': 0.26928606629371643, 'policy_logps/rejected': -443.0542907714844, 'policy_logps/chosen': -441.1165771484375, 'referece_logps/rejected': -434.7218933105469, 'referece_logps/chosen': -435.4770812988281, 'logits/rejected': 0.09885288774967194, 'logits/chosen': 0.19557689130306244, 'epoch': 1.17}


 20%|█▉        | 3141/16104 [14:35:13<62:30:12, 17.36s/it]
{'loss': 0.5371, 'learning_rate': 1.8605781718605784e-06, 'rewards/chosen': -0.8383628726005554, 'rewards/rejected': -1.0870288610458374, 'rewards/accuracies': 0.625, 'rewards/margins': 0.24866601824760437, 'policy_logps/rejected': -378.1639404296875, 'policy_logps/chosen': -376.4917297363281, 'referece_logps/rejected': -367.2936706542969, 'referece_logps/chosen': -368.10809326171875, 'logits/rejected': 0.6390460729598999, 'logits/chosen': 0.7454389333724976, 'epoch': 1.17}

 20%|█▉        | 3142/16104 [14:35:31<63:45:41, 17.71s/it]
[2024-04-08 03:42:34,430] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|█▉        | 3143/16104 [14:35:53<68:43:49, 19.09s/it]

 20%|█▉        | 3144/16104 [14:36:15<71:47:51, 19.94s/it]


 20%|█▉        | 3146/16104 [14:36:53<69:25:45, 19.29s/it]
{'loss': 0.5241, 'learning_rate': 1.8600655502183608e-06, 'rewards/chosen': -1.222705364227295, 'rewards/rejected': -1.801273226737976, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5785677433013916, 'policy_logps/rejected': -423.7065124511719, 'policy_logps/chosen': -504.54766845703125, 'referece_logps/rejected': -405.69378662109375, 'referece_logps/chosen': -492.3206481933594, 'logits/rejected': -0.6360126733779907, 'logits/chosen': -0.6394801735877991, 'epoch': 1.17}


 20%|█▉        | 3148/16104 [14:37:37<74:04:04, 20.58s/it]

 20%|█▉        | 3149/16104 [14:37:49<65:06:58, 18.09s/it]

 20%|█▉        | 3150/16104 [14:38:03<60:32:48, 16.83s/it]

 20%|█▉        | 3151/16104 [14:38:25<66:06:28, 18.37s/it]
{'loss': 0.5764, 'learning_rate': 1.8595520587965567e-06, 'rewards/chosen': -0.607535183429718, 'rewards/rejected': -1.5765184164047241, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9689834117889404, 'policy_logps/rejected': -550.9315795898438, 'policy_logps/chosen': -443.523193359375, 'referece_logps/rejected': -535.1663818359375, 'referece_logps/chosen': -437.4478759765625, 'logits/rejected': -0.3028591275215149, 'logits/chosen': -0.15919595956802368, 'epoch': 1.17}


 20%|█▉        | 3153/16104 [14:38:55<58:44:37, 16.33s/it]
{'loss': 0.5842, 'learning_rate': 1.8593464188058423e-06, 'rewards/chosen': -0.7842021584510803, 'rewards/rejected': -1.7679827213287354, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9837805032730103, 'policy_logps/rejected': -360.33880615234375, 'policy_logps/chosen': -392.40643310546875, 'referece_logps/rejected': -342.6589660644531, 'referece_logps/chosen': -384.56439208984375, 'logits/rejected': 0.17723190784454346, 'logits/chosen': 0.1856047660112381, 'epoch': 1.17}

 20%|█▉        | 3154/16104 [14:39:15<62:20:11, 17.33s/it]

 20%|█▉        | 3155/16104 [14:39:31<61:34:04, 17.12s/it]

 20%|█▉        | 3156/16104 [14:39:43<56:03:28, 15.59s/it]

 20%|█▉        | 3157/16104 [14:39:54<50:42:41, 14.10s/it]

 20%|█▉        | 3158/16104 [14:40:05<47:04:25, 13.09s/it]

 20%|█▉        | 3159/16104 [14:40:16<44:59:22, 12.51s/it]

 20%|█▉        | 3160/16104 [14:40:27<43:17:09, 12.04s/it]

 20%|█▉        | 3161/16104 [14:40:40<44:44:51, 12.45s/it]


 20%|█▉        | 3163/16104 [14:41:13<53:15:19, 14.81s/it]
{'loss': 0.5256, 'learning_rate': 1.8583161337927917e-06, 'rewards/chosen': -0.7406867146492004, 'rewards/rejected': -1.2190274000167847, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4783407151699066, 'policy_logps/rejected': -287.7205505371094, 'policy_logps/chosen': -310.6336975097656, 'referece_logps/rejected': -275.5302734375, 'referece_logps/chosen': -303.226806640625, 'logits/rejected': -0.4765298664569855, 'logits/chosen': -0.41533201932907104, 'epoch': 1.18}

 20%|█▉        | 3164/16104 [14:41:25<50:22:30, 14.01s/it]
[2024-04-08 03:48:27,084] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|█▉        | 3165/16104 [14:41:46<57:24:05, 15.97s/it]


 20%|█▉        | 3167/16104 [14:42:23<61:33:42, 17.13s/it]

 20%|█▉        | 3168/16104 [14:42:41<62:35:14, 17.42s/it]
{'loss': 0.3875, 'learning_rate': 1.8577996890099489e-06, 'rewards/chosen': -0.802660346031189, 'rewards/rejected': -1.3111273050308228, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5084669589996338, 'policy_logps/rejected': -312.57049560546875, 'policy_logps/chosen': -289.853515625, 'referece_logps/rejected': -299.459228515625, 'referece_logps/chosen': -281.8268737792969, 'logits/rejected': -0.40603628754615784, 'logits/chosen': -0.4430486559867859, 'epoch': 1.18}

 20%|█▉        | 3169/16104 [14:43:03<66:47:42, 18.59s/it]


 20%|█▉        | 3171/16104 [14:43:33<60:16:21, 16.78s/it]

 20%|█▉        | 3172/16104 [14:43:51<61:31:50, 17.13s/it]
{'loss': 0.5203, 'learning_rate': 1.8573859085671198e-06, 'rewards/chosen': -1.0165600776672363, 'rewards/rejected': -1.2890275716781616, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2724672853946686, 'policy_logps/rejected': -386.2649841308594, 'policy_logps/chosen': -298.6462707519531, 'referece_logps/rejected': -373.3747253417969, 'referece_logps/chosen': -288.480712890625, 'logits/rejected': -1.0324651002883911, 'logits/chosen': -0.9096331596374512, 'epoch': 1.18}

 20%|█▉        | 3173/16104 [14:44:09<61:42:35, 17.18s/it]


 20%|█▉        | 3175/16104 [14:44:33<53:17:48, 14.84s/it]
{'loss': 0.6108, 'learning_rate': 1.8570752090510618e-06, 'rewards/chosen': -1.0379278659820557, 'rewards/rejected': -1.4918313026428223, 'rewards/accuracies': 0.375, 'rewards/margins': 0.4539036154747009, 'policy_logps/rejected': -479.7845458984375, 'policy_logps/chosen': -443.4088134765625, 'referece_logps/rejected': -464.86627197265625, 'referece_logps/chosen': -433.029541015625, 'logits/rejected': 0.13444146513938904, 'logits/chosen': 0.2565637528896332, 'epoch': 1.18}

 20%|█▉        | 3176/16104 [14:44:50<55:18:00, 15.40s/it]

 20%|█▉        | 3177/16104 [14:45:13<62:53:55, 17.52s/it]

 20%|█▉        | 3178/16104 [14:45:33<65:28:38, 18.24s/it]

 20%|█▉        | 3179/16104 [14:45:48<62:12:34, 17.33s/it]

 20%|█▉        | 3180/16104 [14:46:03<59:47:15, 16.65s/it]

 20%|█▉        | 3181/16104 [14:46:22<62:40:32, 17.46s/it]

 20%|█▉        | 3182/16104 [14:46:41<64:21:47, 17.93s/it]

 20%|█▉        | 3183/16104 [14:46:56<61:04:13, 17.02s/it]


 20%|█▉        | 3185/16104 [14:47:34<64:57:38, 18.10s/it]

 20%|█▉        | 3186/16104 [14:47:54<66:48:31, 18.62s/it]
{'loss': 0.6133, 'learning_rate': 1.8559333087466456e-06, 'rewards/chosen': -1.0636851787567139, 'rewards/rejected': -1.50007963180542, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4363943338394165, 'policy_logps/rejected': -433.79449462890625, 'policy_logps/chosen': -536.8416137695312, 'referece_logps/rejected': -418.793701171875, 'referece_logps/chosen': -526.2047729492188, 'logits/rejected': -0.44432222843170166, 'logits/chosen': -0.22584128379821777, 'epoch': 1.19}

 20%|█▉        | 3187/16104 [14:48:05<59:16:46, 16.52s/it]

 20%|█▉        | 3188/16104 [14:48:25<62:44:22, 17.49s/it]

 20%|█▉        | 3189/16104 [14:48:37<56:28:58, 15.74s/it]

 20%|█▉        | 3190/16104 [14:48:57<61:26:05, 17.13s/it]

 20%|█▉        | 3191/16104 [14:49:09<55:27:45, 15.46s/it]


 20%|█▉        | 3193/16104 [14:49:52<67:13:16, 18.74s/it]
[2024-04-08 03:56:32,923] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4207, 'learning_rate': 1.8552044632499798e-06, 'rewards/chosen': -1.1235629320144653, 'rewards/rejected': -2.7639174461364746, 'rewards/accuracies': 0.625, 'rewards/margins': 1.6403545141220093, 'policy_logps/rejected': -422.79132080078125, 'policy_logps/chosen': -440.3241271972656, 'referece_logps/rejected': -395.1521301269531, 'referece_logps/chosen': -429.0884704589844, 'logits/rejected': 0.006718168035149574, 'logits/chosen': 0.02998405322432518, 'epoch': 1.19}

 20%|█▉        | 3194/16104 [14:50:03<59:01:23, 16.46s/it]
[2024-04-08 03:57:05,452] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 20%|█▉        | 3196/16104 [14:50:38<59:22:28, 16.56s/it]
[2024-04-08 03:57:18,788] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.469, 'learning_rate': 1.8548915818917936e-06, 'rewards/chosen': -1.2188245058059692, 'rewards/rejected': -2.421051502227783, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2022267580032349, 'policy_logps/rejected': -357.1648864746094, 'policy_logps/chosen': -355.6626892089844, 'referece_logps/rejected': -332.9543762207031, 'referece_logps/chosen': -343.47442626953125, 'logits/rejected': -0.23386768996715546, 'logits/chosen': -0.26637864112854004, 'epoch': 1.19}

 20%|█▉        | 3197/16104 [14:50:57<62:06:42, 17.32s/it]


 20%|█▉        | 3199/16104 [14:51:26<57:42:36, 16.10s/it]

 20%|█▉        | 3200/16104 [14:51:48<64:03:24, 17.87s/it]
{'loss': 0.5786, 'learning_rate': 1.8544739226208024e-06, 'rewards/chosen': -1.2608592510223389, 'rewards/rejected': -1.9819912910461426, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7211321592330933, 'policy_logps/rejected': -292.8545837402344, 'policy_logps/chosen': -288.482666015625, 'referece_logps/rejected': -273.0346984863281, 'referece_logps/chosen': -275.87408447265625, 'logits/rejected': -0.8707719445228577, 'logits/chosen': -0.9343933463096619, 'epoch': 1.19}

 20%|█▉        | 3201/16104 [14:52:02<59:30:06, 16.60s/it]


 20%|█▉        | 3203/16104 [14:52:32<58:22:55, 16.29s/it]

 20%|█▉        | 3204/16104 [14:52:48<57:54:16, 16.16s/it]
{'loss': 0.4686, 'learning_rate': 1.8540557103099198e-06, 'rewards/chosen': -1.6602047681808472, 'rewards/rejected': -2.0307183265686035, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3705134391784668, 'policy_logps/rejected': -313.177001953125, 'policy_logps/chosen': -348.3525390625, 'referece_logps/rejected': -292.8697814941406, 'referece_logps/chosen': -331.75054931640625, 'logits/rejected': -0.8407674431800842, 'logits/chosen': -0.7385324835777283, 'epoch': 1.19}

 20%|█▉        | 3205/16104 [14:53:04<58:03:48, 16.21s/it]


 20%|█▉        | 3207/16104 [14:53:40<60:03:03, 16.76s/it]
{'loss': 0.5333, 'learning_rate': 1.8537416883071458e-06, 'rewards/chosen': -0.9547228813171387, 'rewards/rejected': -1.3141028881072998, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3593800663948059, 'policy_logps/rejected': -364.0557861328125, 'policy_logps/chosen': -332.38104248046875, 'referece_logps/rejected': -350.9147033691406, 'referece_logps/chosen': -322.83380126953125, 'logits/rejected': -0.27286258339881897, 'logits/chosen': -0.423132985830307, 'epoch': 1.19}

 20%|█▉        | 3208/16104 [14:53:54<56:50:41, 15.87s/it]

 20%|█▉        | 3209/16104 [14:54:05<51:45:05, 14.45s/it]

 20%|█▉        | 3210/16104 [14:54:22<54:05:48, 15.10s/it]

 20%|█▉        | 3211/16104 [14:54:37<54:51:57, 15.32s/it]

 20%|█▉        | 3212/16104 [14:54:52<53:40:56, 14.99s/it]


 20%|█▉        | 3214/16104 [14:55:24<56:34:25, 15.80s/it]
{'loss': 0.6903, 'learning_rate': 1.8530077617603986e-06, 'rewards/chosen': -1.0749249458312988, 'rewards/rejected': -1.6507409811019897, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5758161544799805, 'policy_logps/rejected': -435.6708068847656, 'policy_logps/chosen': -482.6986389160156, 'referece_logps/rejected': -419.163330078125, 'referece_logps/chosen': -471.9493408203125, 'logits/rejected': 0.05661066249012947, 'logits/chosen': 0.006963793188333511, 'epoch': 1.2}

 20%|█▉        | 3215/16104 [14:55:40<56:25:43, 15.76s/it]

 20%|█▉        | 3216/16104 [14:55:52<52:31:36, 14.67s/it]

 20%|█▉        | 3217/16104 [14:56:11<57:18:52, 16.01s/it]

 20%|█▉        | 3218/16104 [14:56:31<61:07:07, 17.07s/it]


 20%|█▉        | 3220/16104 [14:57:06<62:49:52, 17.56s/it]
{'loss': 0.5315, 'learning_rate': 1.8523773360864179e-06, 'rewards/chosen': -0.7911580204963684, 'rewards/rejected': -1.5507652759552002, 'rewards/accuracies': 0.625, 'rewards/margins': 0.759607195854187, 'policy_logps/rejected': -533.1303100585938, 'policy_logps/chosen': -398.0118103027344, 'referece_logps/rejected': -517.6226806640625, 'referece_logps/chosen': -390.1002197265625, 'logits/rejected': -0.2417304515838623, 'logits/chosen': -0.22317641973495483, 'epoch': 1.2}

 20%|██        | 3221/16104 [14:57:26<64:36:03, 18.05s/it]

 20%|██        | 3222/16104 [14:57:40<60:20:51, 16.86s/it]
[2024-04-08 04:04:42,725] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|██        | 3223/16104 [14:58:02<65:53:30, 18.42s/it]
[2024-04-08 04:05:00,245] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|██        | 3224/16104 [14:58:19<64:55:30, 18.15s/it]

 20%|██        | 3225/16104 [14:58:36<63:31:13, 17.76s/it]

 20%|██        | 3226/16104 [14:58:52<61:39:34, 17.24s/it]
[2024-04-08 04:05:52,130] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|██        | 3227/16104 [14:59:11<63:33:53, 17.77s/it]

 20%|██        | 3228/16104 [14:59:27<61:24:21, 17.17s/it]


 20%|██        | 3230/16104 [14:59:50<51:11:14, 14.31s/it]
{'loss': 0.606, 'learning_rate': 1.8513238686695488e-06, 'rewards/chosen': -0.8546983599662781, 'rewards/rejected': -1.0885112285614014, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2338128387928009, 'policy_logps/rejected': -545.8118896484375, 'policy_logps/chosen': -456.12158203125, 'referece_logps/rejected': -534.9268188476562, 'referece_logps/chosen': -447.5745544433594, 'logits/rejected': -0.4111512005329132, 'logits/chosen': -0.25867706537246704, 'epoch': 1.2}

 20%|██        | 3231/16104 [15:00:05<51:28:46, 14.40s/it]


 20%|██        | 3233/16104 [15:00:27<44:59:22, 12.58s/it]
{'loss': 0.672, 'learning_rate': 1.8510071567178425e-06, 'rewards/chosen': -0.7745502591133118, 'rewards/rejected': -0.8542088866233826, 'rewards/accuracies': 0.5, 'rewards/margins': 0.07965859025716782, 'policy_logps/rejected': -368.91424560546875, 'policy_logps/chosen': -442.1207580566406, 'referece_logps/rejected': -360.3721618652344, 'referece_logps/chosen': -434.375244140625, 'logits/rejected': -0.4100278317928314, 'logits/chosen': -0.4167725443840027, 'epoch': 1.2}

 20%|██        | 3234/16104 [15:00:37<42:48:28, 11.97s/it]

 20%|██        | 3235/16104 [15:00:48<41:27:05, 11.60s/it]

 20%|██        | 3236/16104 [15:01:00<41:41:41, 11.66s/it]

 20%|██        | 3237/16104 [15:01:16<46:49:39, 13.10s/it]

 20%|██        | 3238/16104 [15:01:32<49:16:43, 13.79s/it]

 20%|██        | 3239/16104 [15:01:46<49:41:13, 13.90s/it]


 20%|██        | 3241/16104 [15:02:17<53:01:07, 14.84s/it]
{'loss': 0.6523, 'learning_rate': 1.8501610771375057e-06, 'rewards/chosen': -0.8914468884468079, 'rewards/rejected': -1.5663124322891235, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6748656034469604, 'policy_logps/rejected': -531.8766479492188, 'policy_logps/chosen': -447.753173828125, 'referece_logps/rejected': -516.2135620117188, 'referece_logps/chosen': -438.83868408203125, 'logits/rejected': 0.20139828324317932, 'logits/chosen': 0.24393311142921448, 'epoch': 1.21}

 20%|██        | 3242/16104 [15:02:40<61:46:20, 17.29s/it]

 20%|██        | 3243/16104 [15:02:54<58:15:57, 16.31s/it]

 20%|██        | 3244/16104 [15:03:12<60:57:05, 17.06s/it]

 20%|██        | 3245/16104 [15:03:25<56:35:06, 15.84s/it]

 20%|██        | 3246/16104 [15:03:36<51:00:44, 14.28s/it]

 20%|██        | 3247/16104 [15:03:55<55:56:09, 15.66s/it]
[2024-04-08 04:11:00,363] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|██        | 3248/16104 [15:04:19<65:18:16, 18.29s/it]
[2024-04-08 04:11:14,580] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|██        | 3249/16104 [15:04:34<60:56:25, 17.07s/it]
[2024-04-08 04:11:35,061] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 20%|██        | 3250/16104 [15:04:54<64:35:36, 18.09s/it]


 20%|██        | 3252/16104 [15:05:24<59:21:40, 16.63s/it]

 20%|██        | 3253/16104 [15:05:40<59:05:22, 16.55s/it]

 20%|██        | 3254/16104 [15:05:51<53:35:54, 15.02s/it]

 20%|██        | 3255/16104 [15:06:10<57:56:32, 16.23s/it]

 20%|██        | 3256/16104 [15:06:30<61:41:46, 17.29s/it]

 20%|██        | 3257/16104 [15:06:42<56:07:49, 15.73s/it]

 20%|██        | 3258/16104 [15:06:58<55:52:20, 15.66s/it]

 20%|██        | 3259/16104 [15:07:12<54:52:50, 15.38s/it]

 20%|██        | 3260/16104 [15:07:25<51:29:52, 14.43s/it]

 20%|██        | 3261/16104 [15:07:38<49:47:22, 13.96s/it]

 20%|██        | 3262/16104 [15:07:51<48:52:33, 13.70s/it]
{'loss': 0.5444, 'learning_rate': 1.8479296519861789e-06, 'rewards/chosen': -0.6472914814949036, 'rewards/rejected': -0.9696736335754395, 'rewards/accuracies': 0.75, 'rewards/margins': 0.32238227128982544, 'policy_logps/rejected': -354.5505676269531, 'policy_logps/chosen': -274.89324951171875, 'referece_logps/rejected': -344.85382080078125, 'referece_logps/chosen': -268.4203186035156, 'logits/rejected': 0.14138522744178772, 'logits/chosen': 0.23247592151165009, 'epoch': 1.22}

 20%|██        | 3263/16104 [15:08:05<49:46:24, 13.95s/it]


 20%|██        | 3265/16104 [15:08:44<60:35:54, 16.99s/it]

 20%|██        | 3266/16104 [15:09:04<63:46:26, 17.88s/it]

 20%|██        | 3267/16104 [15:09:23<65:04:52, 18.25s/it]

 20%|██        | 3268/16104 [15:09:42<66:06:08, 18.54s/it]

 20%|██        | 3269/16104 [15:09:59<63:57:43, 17.94s/it]

 20%|██        | 3270/16104 [15:10:19<66:34:39, 18.68s/it]

 20%|██        | 3271/16104 [15:10:32<60:53:19, 17.08s/it]

 20%|██        | 3272/16104 [15:10:46<56:56:52, 15.98s/it]

 20%|██        | 3273/16104 [15:10:57<51:20:56, 14.41s/it]

 20%|██        | 3274/16104 [15:11:09<49:26:02, 13.87s/it]

 20%|██        | 3275/16104 [15:11:21<46:53:38, 13.16s/it]
{'loss': 0.5111, 'learning_rate': 1.8465407106668806e-06, 'rewards/chosen': -0.9018522500991821, 'rewards/rejected': -1.767125129699707, 'rewards/accuracies': 1.0, 'rewards/margins': 0.8652729392051697, 'policy_logps/rejected': -460.20703125, 'policy_logps/chosen': -301.138671875, 'referece_logps/rejected': -442.5357360839844, 'referece_logps/chosen': -292.1201171875, 'logits/rejected': -0.9747621417045593, 'logits/chosen': -0.7966057658195496, 'epoch': 1.22}


 20%|██        | 3277/16104 [15:11:48<47:35:35, 13.36s/it]

 20%|██        | 3278/16104 [15:12:01<46:48:46, 13.14s/it]

 20%|██        | 3279/16104 [15:12:16<48:49:01, 13.70s/it]

 20%|██        | 3280/16104 [15:12:27<45:56:37, 12.90s/it]

 20%|██        | 3281/16104 [15:12:47<53:11:11, 14.93s/it]

 20%|██        | 3282/16104 [15:13:09<60:49:06, 17.08s/it]

 20%|██        | 3283/16104 [15:13:24<59:11:40, 16.62s/it]

 20%|██        | 3284/16104 [15:13:44<62:34:20, 17.57s/it]

 20%|██        | 3285/16104 [15:13:56<56:34:00, 15.89s/it]

 20%|██        | 3286/16104 [15:14:13<58:16:43, 16.37s/it]

 20%|██        | 3287/16104 [15:14:32<60:39:15, 17.04s/it]
{'loss': 0.4801, 'learning_rate': 1.845253474161324e-06, 'rewards/chosen': -0.9324595928192139, 'rewards/rejected': -1.9675841331481934, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0351245403289795, 'policy_logps/rejected': -350.8343200683594, 'policy_logps/chosen': -338.69732666015625, 'referece_logps/rejected': -331.1584777832031, 'referece_logps/chosen': -329.37274169921875, 'logits/rejected': -0.840895414352417, 'logits/chosen': -0.7976702451705933, 'epoch': 1.22}


 20%|██        | 3289/16104 [15:15:11<65:18:57, 18.35s/it]

 20%|██        | 3290/16104 [15:15:23<58:25:01, 16.41s/it]
{'loss': 0.5248, 'learning_rate': 1.8449308954215197e-06, 'rewards/chosen': -0.5510005354881287, 'rewards/rejected': -1.1665558815002441, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6155552268028259, 'policy_logps/rejected': -324.5966491699219, 'policy_logps/chosen': -276.3089599609375, 'referece_logps/rejected': -312.93109130859375, 'referece_logps/chosen': -270.7989807128906, 'logits/rejected': -0.9707063436508179, 'logits/chosen': -0.9095409512519836, 'epoch': 1.23}


 20%|██        | 3292/16104 [15:15:55<58:13:45, 16.36s/it]
{'loss': 0.5144, 'learning_rate': 1.8447156720262553e-06, 'rewards/chosen': -0.6772645711898804, 'rewards/rejected': -1.538681983947754, 'rewards/accuracies': 0.875, 'rewards/margins': 0.861417293548584, 'policy_logps/rejected': -395.8639831542969, 'policy_logps/chosen': -437.09478759765625, 'referece_logps/rejected': -380.4771423339844, 'referece_logps/chosen': -430.3221130371094, 'logits/rejected': 0.11126589775085449, 'logits/chosen': 0.15345995128154755, 'epoch': 1.23}


 20%|██        | 3294/16104 [15:16:33<62:58:06, 17.70s/it]

 20%|██        | 3295/16104 [15:16:56<69:31:32, 19.54s/it]

 20%|██        | 3296/16104 [15:17:11<64:00:39, 17.99s/it]

 20%|██        | 3297/16104 [15:17:26<61:20:05, 17.24s/it]

 20%|██        | 3298/16104 [15:17:45<63:12:29, 17.77s/it]

 20%|██        | 3299/16104 [15:17:57<56:34:17, 15.90s/it]

 20%|██        | 3300/16104 [15:18:08<51:00:10, 14.34s/it]

 20%|██        | 3301/16104 [15:18:21<49:40:18, 13.97s/it]

 21%|██        | 3302/16104 [15:18:41<56:15:09, 15.82s/it]
{'loss': 0.5206, 'learning_rate': 1.8436375055318414e-06, 'rewards/chosen': -1.0881359577178955, 'rewards/rejected': -1.599848985671997, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5117131471633911, 'policy_logps/rejected': -299.88372802734375, 'policy_logps/chosen': -247.29197692871094, 'referece_logps/rejected': -283.88525390625, 'referece_logps/chosen': -236.41061401367188, 'logits/rejected': -0.7752546072006226, 'logits/chosen': -0.6613311171531677, 'epoch': 1.23}


 21%|██        | 3304/16104 [15:19:19<62:19:57, 17.53s/it]

 21%|██        | 3305/16104 [15:19:39<65:09:58, 18.33s/it]

 21%|██        | 3306/16104 [15:19:55<63:05:57, 17.75s/it]

 21%|██        | 3307/16104 [15:20:10<59:35:09, 16.76s/it]

 21%|██        | 3308/16104 [15:20:29<62:33:44, 17.60s/it]

 21%|██        | 3309/16104 [15:20:43<58:52:45, 16.57s/it]

 21%|██        | 3310/16104 [15:21:01<59:58:15, 16.87s/it]
{'loss': 0.5084, 'learning_rate': 1.842772515009056e-06, 'rewards/chosen': -0.9889938831329346, 'rewards/rejected': -1.9922397136688232, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0032457113265991, 'policy_logps/rejected': -379.02569580078125, 'policy_logps/chosen': -323.9127197265625, 'referece_logps/rejected': -359.1033020019531, 'referece_logps/chosen': -314.0227966308594, 'logits/rejected': -0.788539707660675, 'logits/chosen': -0.7534419298171997, 'epoch': 1.23}


 21%|██        | 3312/16104 [15:21:23<49:26:21, 13.91s/it]

 21%|██        | 3313/16104 [15:21:38<50:16:29, 14.15s/it]

 21%|██        | 3314/16104 [15:21:51<49:22:48, 13.90s/it]

 21%|██        | 3315/16104 [15:22:09<53:24:20, 15.03s/it]
{'loss': 0.4918, 'learning_rate': 1.8422307878114714e-06, 'rewards/chosen': -0.8210209608078003, 'rewards/rejected': -1.6610037088394165, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8399828672409058, 'policy_logps/rejected': -434.1763610839844, 'policy_logps/chosen': -420.783935546875, 'referece_logps/rejected': -417.56634521484375, 'referece_logps/chosen': -412.57373046875, 'logits/rejected': -0.15930107235908508, 'logits/chosen': -0.24202635884284973, 'epoch': 1.24}


 21%|██        | 3317/16104 [15:22:43<55:54:34, 15.74s/it]

 21%|██        | 3318/16104 [15:23:02<60:15:41, 16.97s/it]
{'loss': 0.5062, 'learning_rate': 1.841905342620996e-06, 'rewards/chosen': -1.473183512687683, 'rewards/rejected': -1.883140206336975, 'rewards/accuracies': 0.625, 'rewards/margins': 0.40995675325393677, 'policy_logps/rejected': -399.3697509765625, 'policy_logps/chosen': -357.816162109375, 'referece_logps/rejected': -380.53839111328125, 'referece_logps/chosen': -343.0843200683594, 'logits/rejected': -0.02011004090309143, 'logits/chosen': 0.04676634073257446, 'epoch': 1.24}


 21%|██        | 3320/16104 [15:23:39<61:58:40, 17.45s/it]

 21%|██        | 3321/16104 [15:23:59<65:01:46, 18.31s/it]

 21%|██        | 3322/16104 [15:24:15<62:48:59, 17.69s/it]

 21%|██        | 3323/16104 [15:24:28<57:04:32, 16.08s/it]

 21%|██        | 3324/16104 [15:24:45<58:11:36, 16.39s/it]

 21%|██        | 3325/16104 [15:25:02<58:39:36, 16.53s/it]

 21%|██        | 3326/16104 [15:25:23<63:37:40, 17.93s/it]

 21%|██        | 3327/16104 [15:25:39<62:00:01, 17.47s/it]

 21%|██        | 3328/16104 [15:25:57<62:31:42, 17.62s/it]

 21%|██        | 3329/16104 [15:26:17<64:43:41, 18.24s/it]

 21%|██        | 3330/16104 [15:26:39<68:27:12, 19.29s/it]

 21%|██        | 3331/16104 [15:26:54<63:54:05, 18.01s/it]
{'loss': 0.6065, 'learning_rate': 1.8404915397689277e-06, 'rewards/chosen': -0.8959993124008179, 'rewards/rejected': -1.4791961908340454, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5831969380378723, 'policy_logps/rejected': -302.8798522949219, 'policy_logps/chosen': -266.9638671875, 'referece_logps/rejected': -288.0879211425781, 'referece_logps/chosen': -258.00390625, 'logits/rejected': -0.30602437257766724, 'logits/chosen': -0.24878738820552826, 'epoch': 1.24}


 21%|██        | 3333/16104 [15:27:28<63:59:29, 18.04s/it]
{'loss': 0.4963, 'learning_rate': 1.8402735214048987e-06, 'rewards/chosen': -1.3937922716140747, 'rewards/rejected': -2.063260793685913, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6694684028625488, 'policy_logps/rejected': -245.5703125, 'policy_logps/chosen': -341.4162902832031, 'referece_logps/rejected': -224.93772888183594, 'referece_logps/chosen': -327.4783935546875, 'logits/rejected': 0.16754207015037537, 'logits/chosen': 0.19759860634803772, 'epoch': 1.24}


 21%|██        | 3335/16104 [15:28:05<64:16:20, 18.12s/it]

 21%|██        | 3336/16104 [15:28:21<61:59:49, 17.48s/it]

 21%|██        | 3337/16104 [15:28:39<62:12:15, 17.54s/it]

 21%|██        | 3338/16104 [15:28:51<56:36:42, 15.96s/it]

 21%|██        | 3339/16104 [15:29:12<61:17:56, 17.29s/it]

 21%|██        | 3340/16104 [15:29:31<63:59:49, 18.05s/it]

 21%|██        | 3341/16104 [15:29:52<66:34:18, 18.78s/it]
[2024-04-08 04:36:32,862] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3342/16104 [15:30:15<71:47:35, 20.25s/it]
[2024-04-08 04:36:56,554] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3343/16104 [15:30:36<71:44:03, 20.24s/it]
[2024-04-08 04:37:16,756] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3344/16104 [15:30:49<64:50:09, 18.29s/it]

 21%|██        | 3345/16104 [15:31:09<66:16:54, 18.70s/it]

 21%|██        | 3346/16104 [15:31:30<69:07:18, 19.50s/it]
[2024-04-08 04:38:11,545] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3347/16104 [15:31:52<71:19:38, 20.13s/it]

 21%|██        | 3348/16104 [15:32:06<64:14:52, 18.13s/it]
{'loss': 0.4958, 'learning_rate': 1.8386340523178111e-06, 'rewards/chosen': -0.9088447093963623, 'rewards/rejected': -1.7237684726715088, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8149237632751465, 'policy_logps/rejected': -267.636962890625, 'policy_logps/chosen': -275.07696533203125, 'referece_logps/rejected': -250.39930725097656, 'referece_logps/chosen': -265.988525390625, 'logits/rejected': 0.49716198444366455, 'logits/chosen': 0.5155037045478821, 'epoch': 1.25}


 21%|██        | 3350/16104 [15:32:36<59:42:10, 16.85s/it]

 21%|██        | 3351/16104 [15:32:56<63:14:34, 17.85s/it]

 21%|██        | 3352/16104 [15:33:17<66:51:57, 18.88s/it]

 21%|██        | 3353/16104 [15:33:39<69:47:41, 19.71s/it]
{'loss': 0.5416, 'learning_rate': 1.8380858656723137e-06, 'rewards/chosen': -1.480989694595337, 'rewards/rejected': -1.9278377294540405, 'rewards/accuracies': 0.75, 'rewards/margins': 0.44684815406799316, 'policy_logps/rejected': -419.4757995605469, 'policy_logps/chosen': -308.1312561035156, 'referece_logps/rejected': -400.19744873046875, 'referece_logps/chosen': -293.3213806152344, 'logits/rejected': -0.35865676403045654, 'logits/chosen': -0.4351975917816162, 'epoch': 1.25}


 21%|██        | 3355/16104 [15:34:17<68:22:47, 19.31s/it]
{'loss': 0.4309, 'learning_rate': 1.8378663536685782e-06, 'rewards/chosen': -0.884269118309021, 'rewards/rejected': -2.4646592140197754, 'rewards/accuracies': 1.0, 'rewards/margins': 1.5803899765014648, 'policy_logps/rejected': -424.4200134277344, 'policy_logps/chosen': -315.8832092285156, 'referece_logps/rejected': -399.7734375, 'referece_logps/chosen': -307.04052734375, 'logits/rejected': -0.3246607780456543, 'logits/chosen': -0.23630471527576447, 'epoch': 1.25}

 21%|██        | 3356/16104 [15:34:37<68:39:30, 19.39s/it]


 21%|██        | 3358/16104 [15:35:14<67:44:41, 19.13s/it]

 21%|██        | 3359/16104 [15:35:33<67:23:47, 19.04s/it]

 21%|██        | 3360/16104 [15:35:46<61:43:59, 17.44s/it]

 21%|██        | 3361/16104 [15:36:08<66:02:04, 18.66s/it]
[2024-04-08 04:42:48,786] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3362/16104 [15:36:20<59:03:39, 16.69s/it]
[2024-04-08 04:43:00,879] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3363/16104 [15:36:32<54:26:42, 15.38s/it]

 21%|██        | 3364/16104 [15:36:43<50:06:53, 14.16s/it]

 21%|██        | 3365/16104 [15:36:56<48:34:51, 13.73s/it]

 21%|██        | 3366/16104 [15:37:13<51:36:47, 14.59s/it]

 21%|██        | 3367/16104 [15:37:34<58:27:22, 16.52s/it]

 21%|██        | 3368/16104 [15:37:45<52:32:27, 14.85s/it]
{'loss': 0.5466, 'learning_rate': 1.8364362226477073e-06, 'rewards/chosen': -0.7714833617210388, 'rewards/rejected': -1.201952576637268, 'rewards/accuracies': 0.5, 'rewards/margins': 0.43046918511390686, 'policy_logps/rejected': -315.7515563964844, 'policy_logps/chosen': -370.826904296875, 'referece_logps/rejected': -303.7320556640625, 'referece_logps/chosen': -363.1120910644531, 'logits/rejected': -0.7026054263114929, 'logits/chosen': -0.7079160213470459, 'epoch': 1.25}


 21%|██        | 3370/16104 [15:38:15<51:56:01, 14.68s/it]

 21%|██        | 3371/16104 [15:38:34<56:57:46, 16.11s/it]

 21%|██        | 3372/16104 [15:38:54<60:34:41, 17.13s/it]

 21%|██        | 3373/16104 [15:39:14<63:16:27, 17.89s/it]

 21%|██        | 3374/16104 [15:39:28<59:33:16, 16.84s/it]

 21%|██        | 3375/16104 [15:39:47<61:33:26, 17.41s/it]

 21%|██        | 3376/16104 [15:40:03<60:16:17, 17.05s/it]

 21%|██        | 3377/16104 [15:40:23<63:32:29, 17.97s/it]
{'loss': 0.537, 'learning_rate': 1.8354427816554084e-06, 'rewards/chosen': -0.7645002603530884, 'rewards/rejected': -1.9864044189453125, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2219040393829346, 'policy_logps/rejected': -508.8127746582031, 'policy_logps/chosen': -276.3808898925781, 'referece_logps/rejected': -488.94873046875, 'referece_logps/chosen': -268.73590087890625, 'logits/rejected': -0.46702396869659424, 'logits/chosen': -0.31949248909950256, 'epoch': 1.26}


 21%|██        | 3379/16104 [15:40:54<58:14:57, 16.48s/it]

 21%|██        | 3380/16104 [15:41:05<52:06:23, 14.74s/it]
{'loss': 0.457, 'learning_rate': 1.835111026184411e-06, 'rewards/chosen': -1.098482370376587, 'rewards/rejected': -1.7599709033966064, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6614885330200195, 'policy_logps/rejected': -449.3641052246094, 'policy_logps/chosen': -580.9512329101562, 'referece_logps/rejected': -431.7643737792969, 'referece_logps/chosen': -569.9664306640625, 'logits/rejected': 0.15419378876686096, 'logits/chosen': 0.08072441816329956, 'epoch': 1.26}


 21%|██        | 3382/16104 [15:41:41<58:33:36, 16.57s/it]
[2024-04-08 04:48:21,999] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4217, 'learning_rate': 1.8348896869543004e-06, 'rewards/chosen': -0.8685461282730103, 'rewards/rejected': -2.445557117462158, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5770108699798584, 'policy_logps/rejected': -409.52978515625, 'policy_logps/chosen': -615.0830078125, 'referece_logps/rejected': -385.07421875, 'referece_logps/chosen': -606.3974609375, 'logits/rejected': 0.21191518008708954, 'logits/chosen': 0.21359477937221527, 'epoch': 1.26}
[2024-04-08 04:48:42,668] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3383/16104 [15:42:02<62:54:00, 17.80s/it]


 21%|██        | 3385/16104 [15:42:31<58:12:42, 16.48s/it]
[2024-04-08 04:49:12,080] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██        | 3386/16104 [15:42:49<59:42:41, 16.90s/it]
{'loss': 0.5578, 'learning_rate': 1.834446603256588e-06, 'rewards/chosen': -0.9568653106689453, 'rewards/rejected': -0.9426047205924988, 'rewards/accuracies': 0.625, 'rewards/margins': -0.014260709285736084, 'policy_logps/rejected': -568.6544189453125, 'policy_logps/chosen': -403.3946228027344, 'referece_logps/rejected': -559.2283935546875, 'referece_logps/chosen': -393.8259582519531, 'logits/rejected': 0.07205331325531006, 'logits/chosen': -0.10238336026668549, 'epoch': 1.26}


 21%|██        | 3388/16104 [15:43:30<66:24:45, 18.80s/it]

 21%|██        | 3389/16104 [15:43:41<57:43:10, 16.34s/it]
{'loss': 0.6332, 'learning_rate': 1.8341139360416563e-06, 'rewards/chosen': -0.964297890663147, 'rewards/rejected': -0.7205953598022461, 'rewards/accuracies': 0.375, 'rewards/margins': -0.2437025010585785, 'policy_logps/rejected': -460.8548583984375, 'policy_logps/chosen': -433.99212646484375, 'referece_logps/rejected': -453.64892578125, 'referece_logps/chosen': -424.3491516113281, 'logits/rejected': -0.041000813245773315, 'logits/chosen': -0.035154446959495544, 'epoch': 1.26}


 21%|██        | 3391/16104 [15:44:13<58:52:51, 16.67s/it]
[2024-04-08 04:50:54,031] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5035, 'learning_rate': 1.8338919891839067e-06, 'rewards/chosen': -0.8358974456787109, 'rewards/rejected': -1.0925949811935425, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2566974461078644, 'policy_logps/rejected': -599.2315673828125, 'policy_logps/chosen': -640.2026977539062, 'referece_logps/rejected': -588.3056640625, 'referece_logps/chosen': -631.84375, 'logits/rejected': 0.1911829560995102, 'logits/chosen': 0.20905767381191254, 'epoch': 1.26}
[2024-04-08 04:51:06,690] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 21%|██        | 3393/16104 [15:44:43<56:38:27, 16.04s/it]

 21%|██        | 3394/16104 [15:45:03<60:21:24, 17.10s/it]
{'loss': 0.494, 'learning_rate': 1.8335588159153708e-06, 'rewards/chosen': -0.9740451574325562, 'rewards/rejected': -1.49026620388031, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5162209868431091, 'policy_logps/rejected': -285.58465576171875, 'policy_logps/chosen': -250.68264770507812, 'referece_logps/rejected': -270.6820068359375, 'referece_logps/chosen': -240.9421844482422, 'logits/rejected': -1.2907952070236206, 'logits/chosen': -1.1843924522399902, 'epoch': 1.26}


 21%|██        | 3396/16104 [15:45:45<68:11:47, 19.32s/it]
{'loss': 0.5473, 'learning_rate': 1.8333365318008181e-06, 'rewards/chosen': -1.028642177581787, 'rewards/rejected': -1.1923261880874634, 'rewards/accuracies': 0.5, 'rewards/margins': 0.16368401050567627, 'policy_logps/rejected': -326.1944580078125, 'policy_logps/chosen': -377.5137023925781, 'referece_logps/rejected': -314.2712097167969, 'referece_logps/chosen': -367.2272644042969, 'logits/rejected': -0.7798003554344177, 'logits/chosen': -0.7158839702606201, 'epoch': 1.27}
[2024-04-08 04:52:46,950] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 21%|██        | 3398/16104 [15:46:19<63:07:16, 17.88s/it]

 21%|██        | 3399/16104 [15:46:31<56:52:45, 16.12s/it]

 21%|██        | 3400/16104 [15:46:46<55:59:00, 15.86s/it]
{'loss': 0.5612, 'learning_rate': 1.832891559088308e-06, 'rewards/chosen': -0.7670391201972961, 'rewards/rejected': -1.2067328691482544, 'rewards/accuracies': 0.75, 'rewards/margins': 0.43969374895095825, 'policy_logps/rejected': -224.7848358154297, 'policy_logps/chosen': -286.00616455078125, 'referece_logps/rejected': -212.71751403808594, 'referece_logps/chosen': -278.3357849121094, 'logits/rejected': -1.3700129985809326, 'logits/chosen': -1.496502161026001, 'epoch': 1.27}


 21%|██        | 3402/16104 [15:47:23<61:18:59, 17.38s/it]

 21%|██        | 3403/16104 [15:47:43<64:19:47, 18.23s/it]

 21%|██        | 3404/16104 [15:47:59<61:42:33, 17.49s/it]

 21%|██        | 3405/16104 [15:48:11<55:27:49, 15.72s/it]
{'loss': 0.4337, 'learning_rate': 1.8323345851626204e-06, 'rewards/chosen': -0.5872119069099426, 'rewards/rejected': -1.2025341987609863, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6153222322463989, 'policy_logps/rejected': -366.6436767578125, 'policy_logps/chosen': -434.2749328613281, 'referece_logps/rejected': -354.6183166503906, 'referece_logps/chosen': -428.40283203125, 'logits/rejected': -0.9863966107368469, 'logits/chosen': -0.9707693457603455, 'epoch': 1.27}


 21%|██        | 3407/16104 [15:48:49<62:24:28, 17.69s/it]
{'loss': 0.4436, 'learning_rate': 1.8321115598748583e-06, 'rewards/chosen': -1.2167572975158691, 'rewards/rejected': -1.951521873474121, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7347646951675415, 'policy_logps/rejected': -429.9717712402344, 'policy_logps/chosen': -409.01763916015625, 'referece_logps/rejected': -410.45654296875, 'referece_logps/chosen': -396.8500671386719, 'logits/rejected': -0.2669369876384735, 'logits/chosen': -0.3265612721443176, 'epoch': 1.27}


 21%|██        | 3409/16104 [15:49:27<63:04:34, 17.89s/it]
{'loss': 0.4647, 'learning_rate': 1.8318883999455072e-06, 'rewards/chosen': -0.8307703733444214, 'rewards/rejected': -1.9993165731430054, 'rewards/accuracies': 0.625, 'rewards/margins': 1.1685460805892944, 'policy_logps/rejected': -413.565185546875, 'policy_logps/chosen': -316.4440612792969, 'referece_logps/rejected': -393.572021484375, 'referece_logps/chosen': -308.1363525390625, 'logits/rejected': -1.227236032485962, 'logits/chosen': -1.2430081367492676, 'epoch': 1.27}

 21%|██        | 3410/16104 [15:49:48<66:24:28, 18.83s/it]

 21%|██        | 3411/16104 [15:50:02<61:45:55, 17.52s/it]


 21%|██        | 3413/16104 [15:50:27<53:10:34, 15.08s/it]
{'loss': 0.5839, 'learning_rate': 1.831441676306497e-06, 'rewards/chosen': -1.076529860496521, 'rewards/rejected': -1.5001051425933838, 'rewards/accuracies': 0.625, 'rewards/margins': 0.423575222492218, 'policy_logps/rejected': -522.4700927734375, 'policy_logps/chosen': -363.9347229003906, 'referece_logps/rejected': -507.46905517578125, 'referece_logps/chosen': -353.16943359375, 'logits/rejected': -0.16431762278079987, 'logits/chosen': -0.36311066150665283, 'epoch': 1.27}


 21%|██        | 3415/16104 [15:51:03<58:18:15, 16.54s/it]

 21%|██        | 3416/16104 [15:51:16<54:07:31, 15.36s/it]
{'loss': 0.6446, 'learning_rate': 1.8311062804117872e-06, 'rewards/chosen': -0.928765058517456, 'rewards/rejected': -1.122241735458374, 'rewards/accuracies': 0.625, 'rewards/margins': 0.19347679615020752, 'policy_logps/rejected': -320.24859619140625, 'policy_logps/chosen': -351.59130859375, 'referece_logps/rejected': -309.02618408203125, 'referece_logps/chosen': -342.30364990234375, 'logits/rejected': -0.3453454375267029, 'logits/chosen': -0.365925133228302, 'epoch': 1.27}


 21%|██        | 3418/16104 [15:51:55<62:47:16, 17.82s/it]

 21%|██        | 3419/16104 [15:52:14<63:22:16, 17.98s/it]

 21%|██        | 3420/16104 [15:52:34<65:14:59, 18.52s/it]

 21%|██        | 3421/16104 [15:52:47<60:01:23, 17.04s/it]
{'loss': 0.4001, 'learning_rate': 1.8305466149196622e-06, 'rewards/chosen': -0.8401206731796265, 'rewards/rejected': -1.8222800493240356, 'rewards/accuracies': 1.0, 'rewards/margins': 0.9821593761444092, 'policy_logps/rejected': -328.9866943359375, 'policy_logps/chosen': -391.73724365234375, 'referece_logps/rejected': -310.7638854980469, 'referece_logps/chosen': -383.3360595703125, 'logits/rejected': -1.1412224769592285, 'logits/chosen': -1.2432832717895508, 'epoch': 1.27}


 21%|██▏       | 3423/16104 [15:53:27<65:52:55, 18.70s/it]

 21%|██▏       | 3424/16104 [15:53:42<61:13:22, 17.38s/it]

 21%|██▏       | 3425/16104 [15:53:55<56:57:29, 16.17s/it]
{'loss': 0.5662, 'learning_rate': 1.830098277751147e-06, 'rewards/chosen': -1.5997205972671509, 'rewards/rejected': -2.109264612197876, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5095440149307251, 'policy_logps/rejected': -405.6929931640625, 'policy_logps/chosen': -500.2030029296875, 'referece_logps/rejected': -384.600341796875, 'referece_logps/chosen': -484.205810546875, 'logits/rejected': -0.9871094226837158, 'logits/chosen': -0.9364923238754272, 'epoch': 1.28}

 21%|██▏       | 3426/16104 [15:54:16<62:28:25, 17.74s/it]

 21%|██▏       | 3427/16104 [15:54:33<61:06:59, 17.36s/it]

 21%|██▏       | 3428/16104 [15:54:51<61:45:11, 17.54s/it]


 21%|██▏       | 3430/16104 [15:55:31<66:52:36, 19.00s/it]
[2024-04-08 05:02:12,434] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5469, 'learning_rate': 1.829537100798055e-06, 'rewards/chosen': -0.4252985417842865, 'rewards/rejected': -2.1763105392456055, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7510120868682861, 'policy_logps/rejected': -388.8348388671875, 'policy_logps/chosen': -394.2842102050781, 'referece_logps/rejected': -367.07171630859375, 'referece_logps/chosen': -390.0312194824219, 'logits/rejected': -0.3115765452384949, 'logits/chosen': -0.3324032127857208, 'epoch': 1.28}
[2024-04-08 05:02:25,591] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 21%|██▏       | 3432/16104 [15:56:05<64:07:48, 18.22s/it]
{'loss': 0.6109, 'learning_rate': 1.829312395091236e-06, 'rewards/chosen': -1.4449644088745117, 'rewards/rejected': -1.4912124872207642, 'rewards/accuracies': 0.375, 'rewards/margins': 0.04624805599451065, 'policy_logps/rejected': -556.9555053710938, 'policy_logps/chosen': -510.4130859375, 'referece_logps/rejected': -542.0433349609375, 'referece_logps/chosen': -495.96343994140625, 'logits/rejected': -0.39610129594802856, 'logits/chosen': -0.41132059693336487, 'epoch': 1.28}

 21%|██▏       | 3433/16104 [15:56:24<65:02:34, 18.48s/it]


 21%|██▏       | 3435/16104 [15:56:53<59:28:10, 16.90s/it]
{'loss': 0.586, 'learning_rate': 1.8289750849386303e-06, 'rewards/chosen': -0.6782398223876953, 'rewards/rejected': -1.2174888849258423, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5392490029335022, 'policy_logps/rejected': -311.95867919921875, 'policy_logps/chosen': -390.0329895019531, 'referece_logps/rejected': -299.7838134765625, 'referece_logps/chosen': -383.25054931640625, 'logits/rejected': -0.4169580936431885, 'logits/chosen': -0.506767749786377, 'epoch': 1.28}

 21%|██▏       | 3436/16104 [15:57:11<60:12:30, 17.11s/it]

 21%|██▏       | 3437/16104 [15:57:28<60:15:24, 17.13s/it]


 21%|██▏       | 3439/16104 [15:57:57<55:43:32, 15.84s/it]

 21%|██▏       | 3440/16104 [15:58:08<50:28:31, 14.35s/it]

 21%|██▏       | 3441/16104 [15:58:26<53:52:01, 15.31s/it]

 21%|██▏       | 3442/16104 [15:58:42<55:02:44, 15.65s/it]

 21%|██▏       | 3443/16104 [15:59:02<59:33:20, 16.93s/it]
{'loss': 0.5017, 'learning_rate': 1.8280741160573315e-06, 'rewards/chosen': -1.278145670890808, 'rewards/rejected': -2.3369569778442383, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0588114261627197, 'policy_logps/rejected': -389.6036376953125, 'policy_logps/chosen': -266.347412109375, 'referece_logps/rejected': -366.23406982421875, 'referece_logps/chosen': -253.56594848632812, 'logits/rejected': -1.056156039237976, 'logits/chosen': -0.9747742414474487, 'epoch': 1.28}


 21%|██▏       | 3445/16104 [15:59:31<56:10:15, 15.97s/it]

 21%|██▏       | 3446/16104 [15:59:48<56:51:55, 16.17s/it]

 21%|██▏       | 3447/16104 [16:00:09<62:21:22, 17.74s/it]
{'loss': 0.5538, 'learning_rate': 1.8276228275410361e-06, 'rewards/chosen': -1.248059868812561, 'rewards/rejected': -1.5749266147613525, 'rewards/accuracies': 0.625, 'rewards/margins': 0.32686662673950195, 'policy_logps/rejected': -391.9666442871094, 'policy_logps/chosen': -277.188720703125, 'referece_logps/rejected': -376.2173767089844, 'referece_logps/chosen': -264.7081298828125, 'logits/rejected': -0.44475191831588745, 'logits/chosen': -0.38687029480934143, 'epoch': 1.28}

 21%|██▏       | 3448/16104 [16:00:20<55:10:16, 15.69s/it]


 21%|██▏       | 3450/16104 [16:00:56<59:19:50, 16.88s/it]

 21%|██▏       | 3451/16104 [16:01:11<57:55:09, 16.48s/it]
{'loss': 0.4691, 'learning_rate': 1.8271710033636437e-06, 'rewards/chosen': -0.8838657140731812, 'rewards/rejected': -2.2512974739074707, 'rewards/accuracies': 0.875, 'rewards/margins': 1.367431640625, 'policy_logps/rejected': -402.4363098144531, 'policy_logps/chosen': -397.21612548828125, 'referece_logps/rejected': -379.92333984375, 'referece_logps/chosen': -388.37750244140625, 'logits/rejected': -0.7739653587341309, 'logits/chosen': -0.6337961554527283, 'epoch': 1.29}


 21%|██▏       | 3453/16104 [16:01:42<56:49:25, 16.17s/it]
{'loss': 0.533, 'learning_rate': 1.8269448904934082e-06, 'rewards/chosen': -0.6379473209381104, 'rewards/rejected': -1.179997444152832, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5420501828193665, 'policy_logps/rejected': -338.0897216796875, 'policy_logps/chosen': -533.8272705078125, 'referece_logps/rejected': -326.28973388671875, 'referece_logps/chosen': -527.44775390625, 'logits/rejected': -0.7652981281280518, 'logits/chosen': -0.6650134921073914, 'epoch': 1.29}

 21%|██▏       | 3454/16104 [16:01:59<57:40:40, 16.41s/it]


 21%|██▏       | 3456/16104 [16:02:32<58:53:27, 16.76s/it]

 21%|██▏       | 3457/16104 [16:02:49<59:27:54, 16.93s/it]
{'loss': 0.4748, 'learning_rate': 1.8264922633727915e-06, 'rewards/chosen': -0.8090223073959351, 'rewards/rejected': -2.496734380722046, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6877119541168213, 'policy_logps/rejected': -619.978515625, 'policy_logps/chosen': -383.5010986328125, 'referece_logps/rejected': -595.0111083984375, 'referece_logps/chosen': -375.4109191894531, 'logits/rejected': -0.014140307903289795, 'logits/chosen': 0.02845814824104309, 'epoch': 1.29}

 21%|██▏       | 3458/16104 [16:03:09<62:03:05, 17.66s/it]

 21%|██▏       | 3459/16104 [16:03:25<60:06:56, 17.11s/it]
[2024-04-08 05:10:25,860] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 21%|██▏       | 3460/16104 [16:03:45<63:19:28, 18.03s/it]


 21%|██▏       | 3462/16104 [16:04:12<54:30:10, 15.52s/it]

 22%|██▏       | 3463/16104 [16:04:28<55:05:09, 15.69s/it]
{'loss': 0.5833, 'learning_rate': 1.8258123197909518e-06, 'rewards/chosen': -1.0239732265472412, 'rewards/rejected': -1.5598742961883545, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5359011292457581, 'policy_logps/rejected': -333.84466552734375, 'policy_logps/chosen': -361.00537109375, 'referece_logps/rejected': -318.24591064453125, 'referece_logps/chosen': -350.765625, 'logits/rejected': -0.19131897389888763, 'logits/chosen': -0.2564465403556824, 'epoch': 1.29}


 22%|██▏       | 3465/16104 [16:05:03<59:01:02, 16.81s/it]

 22%|██▏       | 3466/16104 [16:05:22<61:52:34, 17.63s/it]

 22%|██▏       | 3467/16104 [16:05:42<64:29:47, 18.37s/it]
{'loss': 0.4167, 'learning_rate': 1.8253583558969706e-06, 'rewards/chosen': -0.7798218131065369, 'rewards/rejected': -1.694140911102295, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9143190383911133, 'policy_logps/rejected': -452.7750549316406, 'policy_logps/chosen': -537.6576538085938, 'referece_logps/rejected': -435.8336181640625, 'referece_logps/chosen': -529.859375, 'logits/rejected': 0.0558878630399704, 'logits/chosen': -0.04671294987201691, 'epoch': 1.29}

 22%|██▏       | 3468/16104 [16:06:01<64:44:35, 18.45s/it]

 22%|██▏       | 3469/16104 [16:06:15<60:23:04, 17.20s/it]


 22%|██▏       | 3471/16104 [16:06:55<64:58:22, 18.52s/it]

 22%|██▏       | 3472/16104 [16:07:10<62:11:11, 17.72s/it]

 22%|██▏       | 3473/16104 [16:07:30<64:31:04, 18.39s/it]

 22%|██▏       | 3474/16104 [16:07:48<63:57:46, 18.23s/it]

 22%|██▏       | 3475/16104 [16:08:02<59:13:39, 16.88s/it]

 22%|██▏       | 3476/16104 [16:08:20<60:14:27, 17.17s/it]

 22%|██▏       | 3477/16104 [16:08:35<57:43:18, 16.46s/it]
{'loss': 0.6115, 'learning_rate': 1.8242211097004296e-06, 'rewards/chosen': -1.3651124238967896, 'rewards/rejected': -1.619194507598877, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2540821135044098, 'policy_logps/rejected': -296.27947998046875, 'policy_logps/chosen': -297.51409912109375, 'referece_logps/rejected': -280.0875244140625, 'referece_logps/chosen': -283.86297607421875, 'logits/rejected': -0.15637236833572388, 'logits/chosen': -0.09679646044969559, 'epoch': 1.3}

 22%|██▏       | 3478/16104 [16:08:47<53:29:40, 15.25s/it]


 22%|██▏       | 3480/16104 [16:09:14<49:45:18, 14.19s/it]
{'loss': 0.5983, 'learning_rate': 1.8238792854783281e-06, 'rewards/chosen': -0.9338276386260986, 'rewards/rejected': -1.7044484615325928, 'rewards/accuracies': 0.5, 'rewards/margins': 0.7706208229064941, 'policy_logps/rejected': -457.13043212890625, 'policy_logps/chosen': -518.5613403320312, 'referece_logps/rejected': -440.0859680175781, 'referece_logps/chosen': -509.22308349609375, 'logits/rejected': 0.29419568181037903, 'logits/chosen': 0.2410913109779358, 'epoch': 1.3}

 22%|██▏       | 3481/16104 [16:09:33<54:59:24, 15.68s/it]


 22%|██▏       | 3483/16104 [16:10:13<61:53:17, 17.65s/it]
{'loss': 0.5562, 'learning_rate': 1.823537161309749e-06, 'rewards/chosen': -1.1327824592590332, 'rewards/rejected': -1.3637092113494873, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23092669248580933, 'policy_logps/rejected': -469.4931640625, 'policy_logps/chosen': -579.3008422851562, 'referece_logps/rejected': -455.8561096191406, 'referece_logps/chosen': -567.9730224609375, 'logits/rejected': -0.7666733264923096, 'logits/chosen': -0.8122537732124329, 'epoch': 1.3}

 22%|██▏       | 3484/16104 [16:10:29<60:21:04, 17.22s/it]

 22%|██▏       | 3485/16104 [16:10:46<59:44:14, 17.04s/it]

 22%|██▏       | 3486/16104 [16:11:08<65:05:57, 18.57s/it]

 22%|██▏       | 3487/16104 [16:11:24<62:23:37, 17.80s/it]

 22%|██▏       | 3488/16104 [16:11:45<66:14:56, 18.90s/it]

 22%|██▏       | 3489/16104 [16:11:58<59:40:02, 17.03s/it]

 22%|██▏       | 3490/16104 [16:12:19<64:07:02, 18.30s/it]

 22%|██▏       | 3491/16104 [16:12:38<64:15:20, 18.34s/it]

 22%|██▏       | 3492/16104 [16:12:55<62:46:01, 17.92s/it]

 22%|██▏       | 3493/16104 [16:13:14<64:35:35, 18.44s/it]

 22%|██▏       | 3494/16104 [16:13:28<60:12:48, 17.19s/it]

 22%|██▏       | 3495/16104 [16:13:40<53:47:11, 15.36s/it]


 22%|██▏       | 3497/16104 [16:14:15<57:11:34, 16.33s/it]
{'loss': 0.6013, 'learning_rate': 1.8219366195601247e-06, 'rewards/chosen': -1.3624707460403442, 'rewards/rejected': -1.069772720336914, 'rewards/accuracies': 0.5, 'rewards/margins': -0.29269811511039734, 'policy_logps/rejected': -230.54946899414062, 'policy_logps/chosen': -243.09046936035156, 'referece_logps/rejected': -219.85174560546875, 'referece_logps/chosen': -229.4657440185547, 'logits/rejected': -0.9013311862945557, 'logits/chosen': -1.0454989671707153, 'epoch': 1.3}


 22%|██▏       | 3499/16104 [16:14:43<52:12:51, 14.91s/it]
{'loss': 0.5285, 'learning_rate': 1.8217074384616295e-06, 'rewards/chosen': -0.9395875930786133, 'rewards/rejected': -1.7781307697296143, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8385430574417114, 'policy_logps/rejected': -259.628662109375, 'policy_logps/chosen': -321.0418395996094, 'referece_logps/rejected': -241.84735107421875, 'referece_logps/chosen': -311.6459655761719, 'logits/rejected': -0.8325322866439819, 'logits/chosen': -1.1116310358047485, 'epoch': 1.3}

 22%|██▏       | 3500/16104 [16:14:54<47:51:10, 13.67s/it]

 22%|██▏       | 3501/16104 [16:15:29<70:00:35, 20.00s/it]

 22%|██▏       | 3502/16104 [16:15:40<60:58:14, 17.42s/it]

 22%|██▏       | 3503/16104 [16:15:53<55:56:56, 15.98s/it]


 22%|██▏       | 3505/16104 [16:16:21<52:09:41, 14.90s/it]
{'loss': 0.6082, 'learning_rate': 1.821019097565819e-06, 'rewards/chosen': -0.8780498504638672, 'rewards/rejected': -1.356684684753418, 'rewards/accuracies': 0.875, 'rewards/margins': 0.47863486409187317, 'policy_logps/rejected': -405.5937194824219, 'policy_logps/chosen': -384.112060546875, 'referece_logps/rejected': -392.02685546875, 'referece_logps/chosen': -375.3315734863281, 'logits/rejected': -0.9351269602775574, 'logits/chosen': -0.8390282392501831, 'epoch': 1.31}

 22%|██▏       | 3506/16104 [16:16:32<47:49:02, 13.66s/it]

 22%|██▏       | 3507/16104 [16:16:44<45:53:41, 13.12s/it]

 22%|██▏       | 3508/16104 [16:17:00<49:34:40, 14.17s/it]

 22%|██▏       | 3509/16104 [16:17:12<46:44:19, 13.36s/it]

 22%|██▏       | 3510/16104 [16:17:23<44:09:16, 12.62s/it]

 22%|██▏       | 3511/16104 [16:17:33<42:06:25, 12.04s/it]


 22%|██▏       | 3513/16104 [16:18:07<51:18:43, 14.67s/it]
{'loss': 0.5902, 'learning_rate': 1.8200994500239588e-06, 'rewards/chosen': -1.083954930305481, 'rewards/rejected': -1.3121322393417358, 'rewards/accuracies': 0.625, 'rewards/margins': 0.22817733883857727, 'policy_logps/rejected': -332.662109375, 'policy_logps/chosen': -329.70770263671875, 'referece_logps/rejected': -319.5408020019531, 'referece_logps/chosen': -318.8681640625, 'logits/rejected': -0.44524210691452026, 'logits/chosen': -0.3722122013568878, 'epoch': 1.31}

 22%|██▏       | 3514/16104 [16:18:18<47:10:56, 13.49s/it]

 22%|██▏       | 3515/16104 [16:18:30<45:33:18, 13.03s/it]

 22%|██▏       | 3516/16104 [16:18:49<51:32:12, 14.74s/it]


 22%|██▏       | 3518/16104 [16:19:27<59:34:42, 17.04s/it]
{'loss': 0.4939, 'learning_rate': 1.8195235919883634e-06, 'rewards/chosen': -0.4507492184638977, 'rewards/rejected': -1.762325406074524, 'rewards/accuracies': 1.0, 'rewards/margins': 1.3115761280059814, 'policy_logps/rejected': -297.6507873535156, 'policy_logps/chosen': -281.63427734375, 'referece_logps/rejected': -280.02752685546875, 'referece_logps/chosen': -277.12677001953125, 'logits/rejected': -0.9042133092880249, 'logits/chosen': -0.8057692050933838, 'epoch': 1.31}

 22%|██▏       | 3519/16104 [16:19:39<54:13:09, 15.51s/it]


 22%|██▏       | 3521/16104 [16:20:05<49:05:56, 14.05s/it]
{'loss': 0.5619, 'learning_rate': 1.8191776793154316e-06, 'rewards/chosen': -0.9282218813896179, 'rewards/rejected': -1.6035289764404297, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6753069162368774, 'policy_logps/rejected': -312.72650146484375, 'policy_logps/chosen': -483.4556884765625, 'referece_logps/rejected': -296.69122314453125, 'referece_logps/chosen': -474.17352294921875, 'logits/rejected': -1.006533145904541, 'logits/chosen': -1.2217143774032593, 'epoch': 1.31}

 22%|██▏       | 3522/16104 [16:20:22<51:55:55, 14.86s/it]

 22%|██▏       | 3523/16104 [16:20:33<47:34:53, 13.62s/it]

 22%|██▏       | 3524/16104 [16:20:49<50:24:05, 14.42s/it]


 22%|██▏       | 3526/16104 [16:21:17<50:50:25, 14.55s/it]
{'loss': 0.5274, 'learning_rate': 1.818600495512157e-06, 'rewards/chosen': -0.8909406661987305, 'rewards/rejected': -1.4855437278747559, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5946029424667358, 'policy_logps/rejected': -398.7152099609375, 'policy_logps/chosen': -460.061767578125, 'referece_logps/rejected': -383.8597717285156, 'referece_logps/chosen': -451.15234375, 'logits/rejected': -0.8565871715545654, 'logits/chosen': -0.7713070511817932, 'epoch': 1.31}


 22%|██▏       | 3528/16104 [16:21:52<55:27:13, 15.87s/it]

 22%|██▏       | 3529/16104 [16:22:07<55:33:12, 15.90s/it]
{'loss': 0.5498, 'learning_rate': 1.8182537878266226e-06, 'rewards/chosen': -1.062643051147461, 'rewards/rejected': -0.8261874318122864, 'rewards/accuracies': 0.25, 'rewards/margins': -0.23645563423633575, 'policy_logps/rejected': -361.2253112792969, 'policy_logps/chosen': -378.5824279785156, 'referece_logps/rejected': -352.96343994140625, 'referece_logps/chosen': -367.9560241699219, 'logits/rejected': -0.046574756503105164, 'logits/chosen': -0.05954524129629135, 'epoch': 1.31}

 22%|██▏       | 3530/16104 [16:22:27<59:29:39, 17.03s/it]

 22%|██▏       | 3531/16104 [16:22:39<53:59:58, 15.46s/it]

 22%|██▏       | 3532/16104 [16:22:51<50:38:17, 14.50s/it]

 22%|██▏       | 3533/16104 [16:23:06<51:20:32, 14.70s/it]

 22%|██▏       | 3534/16104 [16:23:29<59:35:07, 17.07s/it]

 22%|██▏       | 3535/16104 [16:23:43<56:09:06, 16.08s/it]

 22%|██▏       | 3536/16104 [16:24:00<57:34:00, 16.49s/it]

 22%|██▏       | 3537/16104 [16:24:22<63:07:22, 18.08s/it]

 22%|██▏       | 3538/16104 [16:24:36<59:06:37, 16.93s/it]

 22%|██▏       | 3539/16104 [16:24:53<58:39:05, 16.80s/it]

 22%|██▏       | 3540/16104 [16:25:08<57:20:36, 16.43s/it]


 22%|██▏       | 3542/16104 [16:25:44<60:32:48, 17.35s/it]
{'loss': 0.5511, 'learning_rate': 1.8167479470970391e-06, 'rewards/chosen': -1.1406348943710327, 'rewards/rejected': -1.670862078666687, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5302271842956543, 'policy_logps/rejected': -336.0696105957031, 'policy_logps/chosen': -411.0089111328125, 'referece_logps/rejected': -319.3609619140625, 'referece_logps/chosen': -399.60260009765625, 'logits/rejected': 0.17590077221393585, 'logits/chosen': 0.023573890328407288, 'epoch': 1.32}

 22%|██▏       | 3543/16104 [16:26:02<61:47:42, 17.71s/it]


 22%|██▏       | 3545/16104 [16:26:28<53:21:43, 15.30s/it]
{'loss': 0.5323, 'learning_rate': 1.8163996520811442e-06, 'rewards/chosen': -1.1203657388687134, 'rewards/rejected': -1.0914736986160278, 'rewards/accuracies': 0.25, 'rewards/margins': -0.028892040252685547, 'policy_logps/rejected': -423.6125183105469, 'policy_logps/chosen': -420.15692138671875, 'referece_logps/rejected': -412.69775390625, 'referece_logps/chosen': -408.9532775878906, 'logits/rejected': 0.47059744596481323, 'logits/chosen': 0.35799723863601685, 'epoch': 1.32}

 22%|██▏       | 3546/16104 [16:26:43<52:46:19, 15.13s/it]


 22%|██▏       | 3548/16104 [16:27:04<44:59:19, 12.90s/it]

 22%|██▏       | 3549/16104 [16:27:16<43:33:54, 12.49s/it]
{'loss': 0.5706, 'learning_rate': 1.8159347964010433e-06, 'rewards/chosen': -0.7423348426818848, 'rewards/rejected': -1.1119463443756104, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3696114420890808, 'policy_logps/rejected': -446.8917236328125, 'policy_logps/chosen': -446.1885986328125, 'referece_logps/rejected': -435.77227783203125, 'referece_logps/chosen': -438.76519775390625, 'logits/rejected': -1.065346360206604, 'logits/chosen': -1.043443202972412, 'epoch': 1.32}

 22%|██▏       | 3550/16104 [16:27:29<44:59:54, 12.90s/it]

 22%|██▏       | 3551/16104 [16:27:51<53:46:24, 15.42s/it]

 22%|██▏       | 3552/16104 [16:28:04<51:03:15, 14.64s/it]

 22%|██▏       | 3553/16104 [16:28:24<57:36:17, 16.52s/it]


 22%|██▏       | 3555/16104 [16:28:58<57:53:52, 16.61s/it]
{'loss': 0.4457, 'learning_rate': 1.8152365227944999e-06, 'rewards/chosen': -0.8411600589752197, 'rewards/rejected': -2.0878658294677734, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2467060089111328, 'policy_logps/rejected': -289.5970153808594, 'policy_logps/chosen': -301.16607666015625, 'referece_logps/rejected': -268.7183837890625, 'referece_logps/chosen': -292.75445556640625, 'logits/rejected': -1.2638485431671143, 'logits/chosen': -1.432462453842163, 'epoch': 1.32}


 22%|██▏       | 3557/16104 [16:29:30<56:14:07, 16.14s/it]
{'loss': 0.5059, 'learning_rate': 1.8150035010532406e-06, 'rewards/chosen': -0.8851175308227539, 'rewards/rejected': -2.7532780170440674, 'rewards/accuracies': 0.875, 'rewards/margins': 1.868160367012024, 'policy_logps/rejected': -537.2958984375, 'policy_logps/chosen': -500.7802429199219, 'referece_logps/rejected': -509.76312255859375, 'referece_logps/chosen': -491.9290771484375, 'logits/rejected': -0.658596396446228, 'logits/chosen': -0.5163492560386658, 'epoch': 1.33}

 22%|██▏       | 3558/16104 [16:29:47<56:34:22, 16.23s/it]

 22%|██▏       | 3559/16104 [16:30:01<54:18:02, 15.58s/it]

 22%|██▏       | 3560/16104 [16:30:20<58:34:28, 16.81s/it]


 22%|██▏       | 3562/16104 [16:30:50<53:44:58, 15.43s/it]

 22%|██▏       | 3563/16104 [16:31:02<50:05:21, 14.38s/it]
{'loss': 0.5399, 'learning_rate': 1.814303644740092e-06, 'rewards/chosen': -1.1471102237701416, 'rewards/rejected': -1.5867393016815186, 'rewards/accuracies': 0.875, 'rewards/margins': 0.4396291971206665, 'policy_logps/rejected': -346.0148620605469, 'policy_logps/chosen': -340.2531433105469, 'referece_logps/rejected': -330.1474609375, 'referece_logps/chosen': -328.78204345703125, 'logits/rejected': -0.7305912971496582, 'logits/chosen': -0.6899425983428955, 'epoch': 1.33}

 22%|██▏       | 3564/16104 [16:31:22<55:39:20, 15.98s/it]

 22%|██▏       | 3565/16104 [16:31:37<55:19:21, 15.88s/it]

 22%|██▏       | 3566/16104 [16:31:58<59:59:48, 17.23s/it]

 22%|██▏       | 3567/16104 [16:32:19<64:13:40, 18.44s/it]

 22%|██▏       | 3568/16104 [16:32:33<59:27:15, 17.07s/it]

 22%|██▏       | 3569/16104 [16:32:51<60:25:49, 17.36s/it]


 22%|██▏       | 3571/16104 [16:33:28<63:15:58, 18.17s/it]
{'loss': 0.4792, 'learning_rate': 1.8133686585238572e-06, 'rewards/chosen': -0.9693675637245178, 'rewards/rejected': -2.1322057247161865, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1628379821777344, 'policy_logps/rejected': -303.4189453125, 'policy_logps/chosen': -305.49969482421875, 'referece_logps/rejected': -282.096923828125, 'referece_logps/chosen': -295.8059997558594, 'logits/rejected': -0.613112211227417, 'logits/chosen': -0.5412119626998901, 'epoch': 1.33}


 22%|██▏       | 3573/16104 [16:34:02<62:07:16, 17.85s/it]
{'loss': 0.4285, 'learning_rate': 1.8131345828530572e-06, 'rewards/chosen': -1.1903772354125977, 'rewards/rejected': -1.38926100730896, 'rewards/accuracies': 0.625, 'rewards/margins': 0.1988837867975235, 'policy_logps/rejected': -310.2120056152344, 'policy_logps/chosen': -288.7465515136719, 'referece_logps/rejected': -296.31939697265625, 'referece_logps/chosen': -276.8427734375, 'logits/rejected': -1.0649919509887695, 'logits/chosen': -1.1027390956878662, 'epoch': 1.33}


 22%|██▏       | 3575/16104 [16:34:42<65:58:15, 18.96s/it]
{'loss': 0.3993, 'learning_rate': 1.812900375611279e-06, 'rewards/chosen': -0.928167998790741, 'rewards/rejected': -2.364682674407959, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4365148544311523, 'policy_logps/rejected': -416.7380065917969, 'policy_logps/chosen': -288.979248046875, 'referece_logps/rejected': -393.0911865234375, 'referece_logps/chosen': -279.69757080078125, 'logits/rejected': -0.5896999835968018, 'logits/chosen': -0.4710489809513092, 'epoch': 1.33}


 22%|██▏       | 3577/16104 [16:35:18<63:02:43, 18.12s/it]
{'loss': 0.4751, 'learning_rate': 1.8126660368364184e-06, 'rewards/chosen': -0.4131937026977539, 'rewards/rejected': -2.0021135807037354, 'rewards/accuracies': 1.0, 'rewards/margins': 1.5889196395874023, 'policy_logps/rejected': -332.2208557128906, 'policy_logps/chosen': -327.0249938964844, 'referece_logps/rejected': -312.1997375488281, 'referece_logps/chosen': -322.89306640625, 'logits/rejected': -0.6410701274871826, 'logits/chosen': -0.5194642543792725, 'epoch': 1.33}

 22%|██▏       | 3578/16104 [16:35:31<57:15:05, 16.45s/it]


 22%|██▏       | 3580/16104 [16:35:58<52:52:17, 15.20s/it]
{'loss': 0.4727, 'learning_rate': 1.81231428213255e-06, 'rewards/chosen': -0.84574294090271, 'rewards/rejected': -1.2400379180908203, 'rewards/accuracies': 0.625, 'rewards/margins': 0.39429497718811035, 'policy_logps/rejected': -342.3663024902344, 'policy_logps/chosen': -300.7005920410156, 'referece_logps/rejected': -329.96588134765625, 'referece_logps/chosen': -292.2431945800781, 'logits/rejected': -0.6372894048690796, 'logits/chosen': -0.40584447979927063, 'epoch': 1.33}

 22%|██▏       | 3581/16104 [16:36:13<52:50:23, 15.19s/it]

 22%|██▏       | 3582/16104 [16:36:31<55:14:36, 15.88s/it]


 22%|██▏       | 3584/16104 [16:37:10<62:22:43, 17.94s/it]
{'loss': 0.5865, 'learning_rate': 1.8118448158490156e-06, 'rewards/chosen': -1.2104195356369019, 'rewards/rejected': -1.704037070274353, 'rewards/accuracies': 0.5, 'rewards/margins': 0.493617445230484, 'policy_logps/rejected': -349.2731018066406, 'policy_logps/chosen': -581.74755859375, 'referece_logps/rejected': -332.23272705078125, 'referece_logps/chosen': -569.643310546875, 'logits/rejected': -0.6451078653335571, 'logits/chosen': -0.8366154432296753, 'epoch': 1.34}

 22%|██▏       | 3585/16104 [16:37:30<63:51:10, 18.36s/it]

 22%|██▏       | 3586/16104 [16:37:47<63:00:03, 18.12s/it]

 22%|██▏       | 3587/16104 [16:38:04<61:14:16, 17.61s/it]

 22%|██▏       | 3588/16104 [16:38:18<57:28:52, 16.53s/it]

 22%|██▏       | 3589/16104 [16:38:40<63:29:19, 18.26s/it]

 22%|██▏       | 3590/16104 [16:39:01<66:37:47, 19.17s/it]

 22%|██▏       | 3591/16104 [16:39:19<64:56:22, 18.68s/it]

 22%|██▏       | 3592/16104 [16:39:39<66:35:55, 19.16s/it]

 22%|██▏       | 3593/16104 [16:39:59<67:10:26, 19.33s/it]

 22%|██▏       | 3594/16104 [16:40:15<64:27:50, 18.55s/it]

 22%|██▏       | 3595/16104 [16:40:29<58:58:00, 16.97s/it]

 22%|██▏       | 3596/16104 [16:40:42<54:37:21, 15.72s/it]

 22%|██▏       | 3597/16104 [16:40:56<53:21:34, 15.36s/it]

 22%|██▏       | 3598/16104 [16:41:07<48:31:09, 13.97s/it]

 22%|██▏       | 3599/16104 [16:41:24<52:14:58, 15.04s/it]

 22%|██▏       | 3600/16104 [16:41:39<51:31:28, 14.83s/it]

 22%|██▏       | 3601/16104 [16:41:53<51:02:45, 14.70s/it]

 22%|██▏       | 3602/16104 [16:42:07<50:39:21, 14.59s/it]

 22%|██▏       | 3603/16104 [16:42:27<55:22:16, 15.95s/it]

 22%|██▏       | 3604/16104 [16:42:41<53:26:07, 15.39s/it]

 22%|██▏       | 3605/16104 [16:43:00<57:36:14, 16.59s/it]

 22%|██▏       | 3606/16104 [16:43:14<54:40:29, 15.75s/it]

 22%|██▏       | 3607/16104 [16:43:32<57:03:19, 16.44s/it]

 22%|██▏       | 3608/16104 [16:43:52<60:31:51, 17.44s/it]

 22%|██▏       | 3609/16104 [16:44:14<65:20:08, 18.82s/it]

 22%|██▏       | 3610/16104 [16:44:35<67:39:53, 19.50s/it]

 22%|██▏       | 3611/16104 [16:44:51<64:11:58, 18.50s/it]

 22%|██▏       | 3612/16104 [16:45:11<65:32:05, 18.89s/it]

 22%|██▏       | 3613/16104 [16:45:30<66:25:06, 19.14s/it]

 22%|██▏       | 3614/16104 [16:45:46<62:37:02, 18.05s/it]

 22%|██▏       | 3615/16104 [16:45:57<55:49:16, 16.09s/it]

 22%|██▏       | 3616/16104 [16:46:15<57:18:47, 16.52s/it]

 22%|██▏       | 3617/16104 [16:46:29<55:05:31, 15.88s/it]

 22%|██▏       | 3618/16104 [16:46:41<50:58:56, 14.70s/it]

 22%|██▏       | 3619/16104 [16:46:57<52:21:53, 15.10s/it]

 22%|██▏       | 3620/16104 [16:47:08<48:11:22, 13.90s/it]

 22%|██▏       | 3621/16104 [16:47:27<52:46:00, 15.22s/it]

 22%|██▏       | 3622/16104 [16:47:46<56:46:26, 16.37s/it]

 22%|██▏       | 3623/16104 [16:47:58<52:29:42, 15.14s/it]

 23%|██▎       | 3624/16104 [16:48:17<56:38:31, 16.34s/it]
[2024-04-08 05:55:20,133] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3625/16104 [16:48:39<62:24:34, 18.00s/it]

 23%|██▎       | 3626/16104 [16:48:51<55:53:42, 16.13s/it]

 23%|██▎       | 3627/16104 [16:49:09<58:13:32, 16.80s/it]

 23%|██▎       | 3628/16104 [16:49:20<52:09:25, 15.05s/it]

 23%|██▎       | 3629/16104 [16:49:41<57:53:48, 16.71s/it]

 23%|██▎       | 3630/16104 [16:49:53<53:12:28, 15.36s/it]


 23%|██▎       | 3632/16104 [16:50:27<54:02:19, 15.60s/it]

 23%|██▎       | 3633/16104 [16:50:46<57:29:19, 16.60s/it]

 23%|██▎       | 3634/16104 [16:51:05<60:03:32, 17.34s/it]

 23%|██▎       | 3635/16104 [16:51:23<61:13:46, 17.68s/it]

 23%|██▎       | 3636/16104 [16:51:40<59:44:31, 17.25s/it]

 23%|██▎       | 3637/16104 [16:51:58<60:28:03, 17.46s/it]

 23%|██▎       | 3638/16104 [16:52:08<53:28:37, 15.44s/it]

 23%|██▎       | 3639/16104 [16:52:27<56:47:35, 16.40s/it]

 23%|██▎       | 3640/16104 [16:52:41<54:13:19, 15.66s/it]
{'loss': 0.4793, 'learning_rate': 1.8052172545928932e-06, 'rewards/chosen': -0.6408870220184326, 'rewards/rejected': -1.1992765665054321, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5583896040916443, 'policy_logps/rejected': -418.41705322265625, 'policy_logps/chosen': -341.3124694824219, 'referece_logps/rejected': -406.42431640625, 'referece_logps/chosen': -334.903564453125, 'logits/rejected': 0.06823819875717163, 'logits/chosen': 0.11990074068307877, 'epoch': 1.36}


 23%|██▎       | 3642/16104 [16:53:16<57:51:12, 16.71s/it]

 23%|██▎       | 3643/16104 [16:53:36<60:53:51, 17.59s/it]

 23%|██▎       | 3644/16104 [16:53:49<56:39:53, 16.37s/it]

 23%|██▎       | 3645/16104 [16:54:04<54:49:01, 15.84s/it]

 23%|██▎       | 3646/16104 [16:54:20<55:33:06, 16.05s/it]

 23%|██▎       | 3647/16104 [16:54:38<57:08:44, 16.51s/it]

 23%|██▎       | 3648/16104 [16:54:55<57:18:08, 16.56s/it]

 23%|██▎       | 3649/16104 [16:55:17<63:34:20, 18.38s/it]
[2024-04-08 06:01:58,258] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4728, 'learning_rate': 1.8041425613499626e-06, 'rewards/chosen': -0.9120714068412781, 'rewards/rejected': -1.9177699089050293, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0056984424591064, 'policy_logps/rejected': -456.08843994140625, 'policy_logps/chosen': -398.7034606933594, 'referece_logps/rejected': -436.9107971191406, 'referece_logps/chosen': -389.582763671875, 'logits/rejected': -0.09386777877807617, 'logits/chosen': -0.06616564095020294, 'epoch': 1.36}

 23%|██▎       | 3650/16104 [16:55:30<57:40:38, 16.67s/it]

 23%|██▎       | 3651/16104 [16:55:43<53:28:28, 15.46s/it]

 23%|██▎       | 3652/16104 [16:55:59<54:54:15, 15.87s/it]

 23%|██▎       | 3653/16104 [16:56:15<54:08:52, 15.66s/it]

 23%|██▎       | 3654/16104 [16:56:28<51:40:06, 14.94s/it]

 23%|██▎       | 3655/16104 [16:56:45<54:24:01, 15.73s/it]

 23%|██▎       | 3656/16104 [16:57:08<61:43:22, 17.85s/it]
[2024-04-08 06:03:49,217] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3657/16104 [16:57:22<57:19:30, 16.58s/it]

 23%|██▎       | 3658/16104 [16:57:38<57:14:29, 16.56s/it]
[2024-04-08 06:04:19,336] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3659/16104 [16:57:49<51:11:12, 14.81s/it]

 23%|██▎       | 3660/16104 [16:58:04<51:09:57, 14.80s/it]

 23%|██▎       | 3661/16104 [16:58:14<46:52:30, 13.56s/it]

 23%|██▎       | 3662/16104 [16:58:25<43:50:17, 12.68s/it]
{'loss': 0.6296, 'learning_rate': 1.8025855759426898e-06, 'rewards/chosen': -1.1241276264190674, 'rewards/rejected': -0.790798544883728, 'rewards/accuracies': 0.375, 'rewards/margins': -0.3333290219306946, 'policy_logps/rejected': -430.83221435546875, 'policy_logps/chosen': -387.7865905761719, 'referece_logps/rejected': -422.9242248535156, 'referece_logps/chosen': -376.5453186035156, 'logits/rejected': -0.32085227966308594, 'logits/chosen': -0.3114708662033081, 'epoch': 1.36}


 23%|██▎       | 3664/16104 [16:58:47<40:35:45, 11.75s/it]

 23%|██▎       | 3665/16104 [16:58:58<39:31:16, 11.44s/it]

 23%|██▎       | 3666/16104 [16:59:14<44:38:56, 12.92s/it]
[2024-04-08 06:05:54,994] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3667/16104 [16:59:29<46:54:59, 13.58s/it]

 23%|██▎       | 3668/16104 [16:59:40<43:46:56, 12.67s/it]

 23%|██▎       | 3669/16104 [16:59:54<45:04:48, 13.05s/it]

 23%|██▎       | 3670/16104 [17:00:04<42:37:51, 12.34s/it]

 23%|██▎       | 3671/16104 [17:00:21<47:37:25, 13.79s/it]

 23%|██▎       | 3672/16104 [17:00:33<45:19:32, 13.13s/it]

 23%|██▎       | 3673/16104 [17:00:53<52:25:36, 15.18s/it]
[2024-04-08 06:07:34,012] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3674/16104 [17:01:16<60:56:57, 17.65s/it]
[2024-04-08 06:07:57,425] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3675/16104 [17:01:38<64:57:55, 18.82s/it]

 23%|██▎       | 3676/16104 [17:01:49<56:36:05, 16.40s/it]

 23%|██▎       | 3677/16104 [17:02:02<52:59:46, 15.35s/it]
[2024-04-08 06:08:42,626] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3678/16104 [17:02:22<58:29:14, 16.94s/it]
[2024-04-08 06:09:03,285] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3679/16104 [17:02:42<61:38:29, 17.86s/it]

 23%|██▎       | 3680/16104 [17:03:00<61:43:06, 17.88s/it]

 23%|██▎       | 3681/16104 [17:03:17<61:04:30, 17.70s/it]

 23%|██▎       | 3682/16104 [17:03:36<61:51:33, 17.93s/it]

 23%|██▎       | 3683/16104 [17:03:49<57:07:00, 16.55s/it]
{'loss': 0.5214, 'learning_rate': 1.800058859934244e-06, 'rewards/chosen': -1.0081815719604492, 'rewards/rejected': -0.9372830390930176, 'rewards/accuracies': 0.5, 'rewards/margins': -0.07089854776859283, 'policy_logps/rejected': -394.5271301269531, 'policy_logps/chosen': -432.9261169433594, 'referece_logps/rejected': -385.15435791015625, 'referece_logps/chosen': -422.84429931640625, 'logits/rejected': -0.6360466480255127, 'logits/chosen': -0.716016948223114, 'epoch': 1.37}


 23%|██▎       | 3685/16104 [17:04:27<61:36:58, 17.86s/it]

 23%|██▎       | 3686/16104 [17:04:43<59:05:34, 17.13s/it]

 23%|██▎       | 3687/16104 [17:05:04<62:53:22, 18.23s/it]

 23%|██▎       | 3688/16104 [17:05:18<59:11:42, 17.16s/it]

 23%|██▎       | 3689/16104 [17:05:33<56:50:19, 16.48s/it]

 23%|██▎       | 3690/16104 [17:05:55<62:39:04, 18.17s/it]

 23%|██▎       | 3691/16104 [17:06:13<62:18:12, 18.07s/it]

 23%|██▎       | 3692/16104 [17:06:27<57:59:27, 16.82s/it]

 23%|██▎       | 3693/16104 [17:06:48<61:42:35, 17.90s/it]
[2024-04-08 06:13:28,598] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 23%|██▎       | 3694/16104 [17:07:05<61:24:17, 17.81s/it]

 23%|██▎       | 3695/16104 [17:07:23<61:46:45, 17.92s/it]

 23%|██▎       | 3696/16104 [17:07:41<61:16:56, 17.78s/it]

 23%|██▎       | 3697/16104 [17:07:57<59:46:49, 17.35s/it]

 23%|██▎       | 3698/16104 [17:08:10<55:14:55, 16.03s/it]

 23%|██▎       | 3699/16104 [17:08:22<51:26:29, 14.93s/it]

 23%|██▎       | 3700/16104 [17:08:41<55:27:40, 16.10s/it]

 23%|██▎       | 3701/16104 [17:09:00<57:46:27, 16.77s/it]

 23%|██▎       | 3702/16104 [17:09:12<53:35:46, 15.56s/it]

 23%|██▎       | 3703/16104 [17:09:32<57:47:06, 16.77s/it]

 23%|██▎       | 3704/16104 [17:09:52<60:59:11, 17.71s/it]
{'loss': 0.5384, 'learning_rate': 1.7975178715073826e-06, 'rewards/chosen': -0.8768584728240967, 'rewards/rejected': -1.7630211114883423, 'rewards/accuracies': 0.75, 'rewards/margins': 0.886162519454956, 'policy_logps/rejected': -376.318115234375, 'policy_logps/chosen': -351.506103515625, 'referece_logps/rejected': -358.6878662109375, 'referece_logps/chosen': -342.737548828125, 'logits/rejected': -0.5451260805130005, 'logits/chosen': -0.6074038743972778, 'epoch': 1.38}

 23%|██▎       | 3705/16104 [17:10:13<64:41:59, 18.79s/it]

 23%|██▎       | 3706/16104 [17:10:33<65:38:21, 19.06s/it]


 23%|██▎       | 3708/16104 [17:11:08<63:10:15, 18.35s/it]

 23%|██▎       | 3709/16104 [17:11:24<60:32:47, 17.59s/it]

 23%|██▎       | 3710/16104 [17:11:46<65:16:35, 18.96s/it]

 23%|██▎       | 3711/16104 [17:12:09<68:53:56, 20.01s/it]

 23%|██▎       | 3712/16104 [17:12:24<64:12:41, 18.65s/it]
{'loss': 0.5013, 'learning_rate': 1.7965461311747256e-06, 'rewards/chosen': -1.1243367195129395, 'rewards/rejected': -2.2323527336120605, 'rewards/accuracies': 0.625, 'rewards/margins': 1.1080162525177002, 'policy_logps/rejected': -353.2810974121094, 'policy_logps/chosen': -288.8096008300781, 'referece_logps/rejected': -330.95751953125, 'referece_logps/chosen': -277.56622314453125, 'logits/rejected': -0.09768861532211304, 'logits/chosen': -0.18118390440940857, 'epoch': 1.38}


 23%|██▎       | 3714/16104 [17:12:58<61:30:03, 17.87s/it]
{'loss': 0.5648, 'learning_rate': 1.7963028737761166e-06, 'rewards/chosen': -1.1079976558685303, 'rewards/rejected': -1.653414249420166, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5454164743423462, 'policy_logps/rejected': -348.19415283203125, 'policy_logps/chosen': -438.3521728515625, 'referece_logps/rejected': -331.6600036621094, 'referece_logps/chosen': -427.27215576171875, 'logits/rejected': 0.5277379751205444, 'logits/chosen': 0.5740214586257935, 'epoch': 1.38}


 23%|██▎       | 3716/16104 [17:13:34<61:14:52, 17.80s/it]
{'loss': 0.5506, 'learning_rate': 1.7960594875300198e-06, 'rewards/chosen': -0.7929202318191528, 'rewards/rejected': -0.8775912523269653, 'rewards/accuracies': 0.5, 'rewards/margins': 0.0846710205078125, 'policy_logps/rejected': -296.9022521972656, 'policy_logps/chosen': -223.27737426757812, 'referece_logps/rejected': -288.1263427734375, 'referece_logps/chosen': -215.3481903076172, 'logits/rejected': -0.5080331563949585, 'logits/chosen': -0.5087387561798096, 'epoch': 1.38}


 23%|██▎       | 3718/16104 [17:14:06<60:09:48, 17.49s/it]

 23%|██▎       | 3719/16104 [17:14:20<56:03:21, 16.29s/it]

 23%|██▎       | 3720/16104 [17:14:32<52:07:57, 15.15s/it]

 23%|██▎       | 3721/16104 [17:14:53<57:35:19, 16.74s/it]

 23%|██▎       | 3722/16104 [17:15:07<54:55:37, 15.97s/it]

 23%|██▎       | 3723/16104 [17:15:21<52:32:45, 15.28s/it]
{'loss': 0.5608, 'learning_rate': 1.7952066215634766e-06, 'rewards/chosen': -1.1350035667419434, 'rewards/rejected': -1.86406672000885, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7290633320808411, 'policy_logps/rejected': -455.7947998046875, 'policy_logps/chosen': -383.3934326171875, 'referece_logps/rejected': -437.15411376953125, 'referece_logps/chosen': -372.04339599609375, 'logits/rejected': -0.957862913608551, 'logits/chosen': -0.8791360259056091, 'epoch': 1.39}

 23%|██▎       | 3724/16104 [17:15:37<54:02:04, 15.71s/it]


 23%|██▎       | 3726/16104 [17:16:08<51:55:20, 15.10s/it]

 23%|██▎       | 3727/16104 [17:16:19<47:18:02, 13.76s/it]

 23%|██▎       | 3728/16104 [17:16:40<55:22:54, 16.11s/it]

 23%|██▎       | 3729/16104 [17:16:53<51:24:00, 14.95s/it]

 23%|██▎       | 3730/16104 [17:17:05<48:23:48, 14.08s/it]

 23%|██▎       | 3731/16104 [17:17:24<54:07:52, 15.75s/it]

 23%|██▎       | 3732/16104 [17:17:41<55:00:54, 16.01s/it]

 23%|██▎       | 3733/16104 [17:17:59<57:07:03, 16.62s/it]

 23%|██▎       | 3734/16104 [17:18:18<60:00:18, 17.46s/it]

 23%|██▎       | 3735/16104 [17:18:37<60:44:39, 17.68s/it]

 23%|██▎       | 3736/16104 [17:18:59<65:14:34, 18.99s/it]

 23%|██▎       | 3737/16104 [17:19:19<66:49:02, 19.45s/it]
{'loss': 0.4588, 'learning_rate': 1.7934961626983248e-06, 'rewards/chosen': -1.7584669589996338, 'rewards/rejected': -2.673816680908203, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9153494834899902, 'policy_logps/rejected': -297.35284423828125, 'policy_logps/chosen': -219.38497924804688, 'referece_logps/rejected': -270.61468505859375, 'referece_logps/chosen': -201.80030822753906, 'logits/rejected': -0.6690046191215515, 'logits/chosen': -0.23832744359970093, 'epoch': 1.39}


 23%|██▎       | 3739/16104 [17:19:53<62:26:50, 18.18s/it]
{'loss': 0.599, 'learning_rate': 1.7932512975419138e-06, 'rewards/chosen': -0.6656301617622375, 'rewards/rejected': -1.8582810163497925, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1926507949829102, 'policy_logps/rejected': -393.78033447265625, 'policy_logps/chosen': -298.4018249511719, 'referece_logps/rejected': -375.197509765625, 'referece_logps/chosen': -291.74554443359375, 'logits/rejected': -1.4517226219177246, 'logits/chosen': -1.0560239553451538, 'epoch': 1.39}


 23%|██▎       | 3741/16104 [17:20:27<61:02:22, 17.77s/it]

 23%|██▎       | 3742/16104 [17:20:39<55:30:52, 16.17s/it]

 23%|██▎       | 3743/16104 [17:20:55<55:10:26, 16.07s/it]

 23%|██▎       | 3744/16104 [17:21:15<58:50:28, 17.14s/it]
{'loss': 0.6096, 'learning_rate': 1.7926385731900804e-06, 'rewards/chosen': -0.711504340171814, 'rewards/rejected': -1.1661529541015625, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4546486437320709, 'policy_logps/rejected': -284.2513122558594, 'policy_logps/chosen': -270.16943359375, 'referece_logps/rejected': -272.58978271484375, 'referece_logps/chosen': -263.0544128417969, 'logits/rejected': -0.613391101360321, 'logits/chosen': -0.6383251547813416, 'epoch': 1.39}


 23%|██▎       | 3746/16104 [17:21:52<62:21:15, 18.16s/it]

 23%|██▎       | 3747/16104 [17:22:15<66:46:24, 19.45s/it]

 23%|██▎       | 3748/16104 [17:22:34<66:40:40, 19.43s/it]

 23%|██▎       | 3749/16104 [17:22:45<57:30:08, 16.76s/it]
{'loss': 0.5805, 'learning_rate': 1.792025047247193e-06, 'rewards/chosen': -0.6289995312690735, 'rewards/rejected': -1.0912294387817383, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4622299075126648, 'policy_logps/rejected': -525.786376953125, 'policy_logps/chosen': -385.4495849609375, 'referece_logps/rejected': -514.8740844726562, 'referece_logps/chosen': -379.1595764160156, 'logits/rejected': -0.5456848740577698, 'logits/chosen': -0.399303674697876, 'epoch': 1.4}


 23%|██▎       | 3751/16104 [17:23:19<59:18:52, 17.29s/it]
{'loss': 0.627, 'learning_rate': 1.791779412563498e-06, 'rewards/chosen': -0.872473955154419, 'rewards/rejected': -1.0703319311141968, 'rewards/accuracies': 0.625, 'rewards/margins': 0.19785800576210022, 'policy_logps/rejected': -289.1235046386719, 'policy_logps/chosen': -344.9327392578125, 'referece_logps/rejected': -278.420166015625, 'referece_logps/chosen': -336.2079772949219, 'logits/rejected': -0.7858775854110718, 'logits/chosen': -0.8837618231773376, 'epoch': 1.4}


 23%|██▎       | 3753/16104 [17:23:40<47:49:41, 13.94s/it]
{'loss': 0.5247, 'learning_rate': 1.7915336497642434e-06, 'rewards/chosen': -0.8885085582733154, 'rewards/rejected': -1.480851650238037, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5923431515693665, 'policy_logps/rejected': -352.353271484375, 'policy_logps/chosen': -360.8257141113281, 'referece_logps/rejected': -337.5447082519531, 'referece_logps/chosen': -351.94061279296875, 'logits/rejected': 0.3124901056289673, 'logits/chosen': 0.31030750274658203, 'epoch': 1.4}

 23%|██▎       | 3754/16104 [17:23:52<45:03:16, 13.13s/it]


 23%|██▎       | 3756/16104 [17:24:31<57:11:42, 16.67s/it]

 23%|██▎       | 3757/16104 [17:24:47<55:52:08, 16.29s/it]

 23%|██▎       | 3758/16104 [17:25:08<61:30:41, 17.94s/it]
{'loss': 0.4102, 'learning_rate': 1.7909186825215517e-06, 'rewards/chosen': -0.5803307294845581, 'rewards/rejected': -1.292904257774353, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7125734686851501, 'policy_logps/rejected': -337.8249816894531, 'policy_logps/chosen': -336.2267761230469, 'referece_logps/rejected': -324.8959655761719, 'referece_logps/chosen': -330.4234924316406, 'logits/rejected': -0.344976544380188, 'logits/chosen': -0.27991169691085815, 'epoch': 1.4}

 23%|██▎       | 3759/16104 [17:25:26<60:55:00, 17.76s/it]

 23%|██▎       | 3760/16104 [17:25:44<61:21:23, 17.89s/it]


 23%|██▎       | 3762/16104 [17:26:21<61:57:38, 18.07s/it]

 23%|██▎       | 3763/16104 [17:26:39<61:42:50, 18.00s/it]

 23%|██▎       | 3764/16104 [17:26:59<63:24:29, 18.50s/it]

 23%|██▎       | 3765/16104 [17:27:12<57:47:31, 16.86s/it]

 23%|██▎       | 3766/16104 [17:27:24<52:38:53, 15.36s/it]

 23%|██▎       | 3767/16104 [17:27:43<56:52:59, 16.60s/it]

 23%|██▎       | 3768/16104 [17:28:01<58:28:00, 17.06s/it]
{'loss': 0.5984, 'learning_rate': 1.789686349103677e-06, 'rewards/chosen': -0.8428550362586975, 'rewards/rejected': -1.0530800819396973, 'rewards/accuracies': 0.625, 'rewards/margins': 0.21022503077983856, 'policy_logps/rejected': -430.094970703125, 'policy_logps/chosen': -261.2475891113281, 'referece_logps/rejected': -419.564208984375, 'referece_logps/chosen': -252.81906127929688, 'logits/rejected': -0.1564689725637436, 'logits/chosen': -0.19756092131137848, 'epoch': 1.4}

 23%|██▎       | 3769/16104 [17:28:16<56:08:53, 16.39s/it]


 23%|██▎       | 3771/16104 [17:28:55<61:57:17, 18.08s/it]

 23%|██▎       | 3772/16104 [17:29:11<60:17:58, 17.60s/it]

 23%|██▎       | 3773/16104 [17:29:31<61:58:54, 18.10s/it]
{'loss': 0.5176, 'learning_rate': 1.789068984174746e-06, 'rewards/chosen': -0.8332588076591492, 'rewards/rejected': -1.5756182670593262, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7423595190048218, 'policy_logps/rejected': -384.0494384765625, 'policy_logps/chosen': -382.402099609375, 'referece_logps/rejected': -368.29327392578125, 'referece_logps/chosen': -374.069580078125, 'logits/rejected': 0.16047032177448273, 'logits/chosen': 0.1828220635652542, 'epoch': 1.41}


 23%|██▎       | 3775/16104 [17:30:07<62:03:47, 18.12s/it]

 23%|██▎       | 3776/16104 [17:30:20<56:35:22, 16.53s/it]
{'loss': 0.4425, 'learning_rate': 1.7886981821464451e-06, 'rewards/chosen': -0.7841185927391052, 'rewards/rejected': -1.5396676063537598, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7555490136146545, 'policy_logps/rejected': -254.65765380859375, 'policy_logps/chosen': -349.783935546875, 'referece_logps/rejected': -239.26100158691406, 'referece_logps/chosen': -341.9427490234375, 'logits/rejected': -0.6166302561759949, 'logits/chosen': -0.5279476642608643, 'epoch': 1.41}


 23%|██▎       | 3778/16104 [17:30:42<47:27:50, 13.86s/it]

 23%|██▎       | 3779/16104 [17:31:01<52:44:01, 15.40s/it]
{'loss': 0.5063, 'learning_rate': 1.7883270929799124e-06, 'rewards/chosen': -0.5329429507255554, 'rewards/rejected': -2.198618173599243, 'rewards/accuracies': 0.875, 'rewards/margins': 1.665675401687622, 'policy_logps/rejected': -524.455322265625, 'policy_logps/chosen': -605.409423828125, 'referece_logps/rejected': -502.46917724609375, 'referece_logps/chosen': -600.0800170898438, 'logits/rejected': 0.23857395350933075, 'logits/chosen': 0.2298598289489746, 'epoch': 1.41}


 23%|██▎       | 3781/16104 [17:31:44<63:38:08, 18.59s/it]

 23%|██▎       | 3782/16104 [17:32:01<62:37:18, 18.30s/it]

 23%|██▎       | 3783/16104 [17:32:23<66:26:19, 19.41s/it]

 23%|██▎       | 3784/16104 [17:32:41<65:03:17, 19.01s/it]

 24%|██▎       | 3785/16104 [17:32:52<56:32:12, 16.52s/it]
{'loss': 0.5819, 'learning_rate': 1.7875840537726579e-06, 'rewards/chosen': -1.5393255949020386, 'rewards/rejected': -1.5559444427490234, 'rewards/accuracies': 0.625, 'rewards/margins': 0.01661887764930725, 'policy_logps/rejected': -504.60357666015625, 'policy_logps/chosen': -619.2034912109375, 'referece_logps/rejected': -489.04412841796875, 'referece_logps/chosen': -603.8102416992188, 'logits/rejected': -0.9466531276702881, 'logits/chosen': -1.12246572971344, 'epoch': 1.41}


 24%|██▎       | 3787/16104 [17:33:27<58:31:56, 17.11s/it]
{'loss': 0.5858, 'learning_rate': 1.7873361191100097e-06, 'rewards/chosen': -1.2484489679336548, 'rewards/rejected': -2.187394618988037, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9389455914497375, 'policy_logps/rejected': -525.962890625, 'policy_logps/chosen': -413.736083984375, 'referece_logps/rejected': -504.0889892578125, 'referece_logps/chosen': -401.25164794921875, 'logits/rejected': -0.367965430021286, 'logits/chosen': -0.34681129455566406, 'epoch': 1.41}

 24%|██▎       | 3788/16104 [17:33:42<56:56:37, 16.64s/it]


 24%|██▎       | 3790/16104 [17:34:16<57:28:53, 16.80s/it]

 24%|██▎       | 3791/16104 [17:34:32<56:31:11, 16.52s/it]
{'loss': 0.5632, 'learning_rate': 1.7868398676350438e-06, 'rewards/chosen': -0.9314529299736023, 'rewards/rejected': -1.7296563386917114, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7982032299041748, 'policy_logps/rejected': -276.20245361328125, 'policy_logps/chosen': -392.65765380859375, 'referece_logps/rejected': -258.9058532714844, 'referece_logps/chosen': -383.3431396484375, 'logits/rejected': 0.1387680619955063, 'logits/chosen': 0.12471615523099899, 'epoch': 1.41}

 24%|██▎       | 3792/16104 [17:34:53<60:54:05, 17.81s/it]


 24%|██▎       | 3794/16104 [17:35:25<56:49:48, 16.62s/it]

 24%|██▎       | 3795/16104 [17:35:36<50:45:56, 14.85s/it]
{'loss': 0.503, 'learning_rate': 1.7863431068948755e-06, 'rewards/chosen': -1.0490868091583252, 'rewards/rejected': -1.3746979236602783, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3256111145019531, 'policy_logps/rejected': -371.951171875, 'policy_logps/chosen': -464.9400329589844, 'referece_logps/rejected': -358.20416259765625, 'referece_logps/chosen': -454.4491882324219, 'logits/rejected': 0.23158138990402222, 'logits/chosen': 0.3154100775718689, 'epoch': 1.41}


 24%|██▎       | 3797/16104 [17:35:57<43:44:00, 12.79s/it]

 24%|██▎       | 3798/16104 [17:36:08<41:32:07, 12.15s/it]
{'loss': 0.6146, 'learning_rate': 1.7859702023278609e-06, 'rewards/chosen': -0.4367002546787262, 'rewards/rejected': -1.0272282361984253, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5905280113220215, 'policy_logps/rejected': -259.22320556640625, 'policy_logps/chosen': -387.9210510253906, 'referece_logps/rejected': -248.95091247558594, 'referece_logps/chosen': -383.55401611328125, 'logits/rejected': -0.7304609417915344, 'logits/chosen': -0.711275577545166, 'epoch': 1.42}

 24%|██▎       | 3799/16104 [17:36:29<50:13:57, 14.70s/it]


 24%|██▎       | 3801/16104 [17:37:10<61:05:41, 17.88s/it]
{'loss': 0.6786, 'learning_rate': 1.785597011615779e-06, 'rewards/chosen': -0.710166335105896, 'rewards/rejected': -1.3065965175628662, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5964301228523254, 'policy_logps/rejected': -377.43121337890625, 'policy_logps/chosen': -325.4228515625, 'referece_logps/rejected': -364.3652648925781, 'referece_logps/chosen': -318.3211669921875, 'logits/rejected': -0.3952913284301758, 'logits/chosen': -0.3059888184070587, 'epoch': 1.42}

 24%|██▎       | 3802/16104 [17:37:23<55:39:53, 16.29s/it]

 24%|██▎       | 3803/16104 [17:37:43<59:39:31, 17.46s/it]


 24%|██▎       | 3805/16104 [17:38:18<60:16:43, 17.64s/it]

 24%|██▎       | 3806/16104 [17:38:32<56:41:46, 16.60s/it]
{'loss': 0.3868, 'learning_rate': 1.7849743915867806e-06, 'rewards/chosen': -1.1482537984848022, 'rewards/rejected': -2.936436176300049, 'rewards/accuracies': 1.0, 'rewards/margins': 1.788182258605957, 'policy_logps/rejected': -326.48065185546875, 'policy_logps/chosen': -309.640380859375, 'referece_logps/rejected': -297.1163024902344, 'referece_logps/chosen': -298.1578063964844, 'logits/rejected': -0.8673590421676636, 'logits/chosen': -0.8541511297225952, 'epoch': 1.42}


 24%|██▎       | 3808/16104 [17:39:12<62:38:30, 18.34s/it]

 24%|██▎       | 3809/16104 [17:39:24<56:30:34, 16.55s/it]
{'loss': 0.5209, 'learning_rate': 1.7846004384857022e-06, 'rewards/chosen': -1.5771043300628662, 'rewards/rejected': -1.756658673286438, 'rewards/accuracies': 0.5, 'rewards/margins': 0.1795545220375061, 'policy_logps/rejected': -341.2664489746094, 'policy_logps/chosen': -454.30841064453125, 'referece_logps/rejected': -323.6998596191406, 'referece_logps/chosen': -438.5373840332031, 'logits/rejected': -0.7149878740310669, 'logits/chosen': -0.7284777164459229, 'epoch': 1.42}

 24%|██▎       | 3810/16104 [17:39:35<50:27:47, 14.78s/it]

 24%|██▎       | 3811/16104 [17:39:47<47:26:01, 13.89s/it]

 24%|██▎       | 3812/16104 [17:40:03<50:00:52, 14.65s/it]

 24%|██▎       | 3813/16104 [17:40:15<47:42:57, 13.98s/it]


 24%|██▎       | 3815/16104 [17:40:42<45:38:54, 13.37s/it]

 24%|██▎       | 3816/16104 [17:40:56<46:47:38, 13.71s/it]

 24%|██▎       | 3817/16104 [17:41:16<52:50:26, 15.48s/it]

 24%|██▎       | 3818/16104 [17:41:34<55:44:19, 16.33s/it]

 24%|██▎       | 3819/16104 [17:41:57<61:37:53, 18.06s/it]
{'loss': 0.5231, 'learning_rate': 1.7833518659126561e-06, 'rewards/chosen': -0.8316935300827026, 'rewards/rejected': -1.8579055070877075, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0262119770050049, 'policy_logps/rejected': -506.68609619140625, 'policy_logps/chosen': -349.91015625, 'referece_logps/rejected': -488.1070556640625, 'referece_logps/chosen': -341.5932312011719, 'logits/rejected': -0.39638400077819824, 'logits/chosen': -0.3286685645580292, 'epoch': 1.42}

 24%|██▎       | 3820/16104 [17:42:18<64:49:47, 19.00s/it]

 24%|██▎       | 3821/16104 [17:42:39<67:05:20, 19.66s/it]


 24%|██▎       | 3823/16104 [17:43:16<66:47:14, 19.58s/it]

 24%|██▎       | 3824/16104 [17:43:39<69:33:30, 20.39s/it]
{'loss': 0.3937, 'learning_rate': 1.7827263910110777e-06, 'rewards/chosen': -0.6820091605186462, 'rewards/rejected': -2.6641571521759033, 'rewards/accuracies': 1.0, 'rewards/margins': 1.9821476936340332, 'policy_logps/rejected': -264.262939453125, 'policy_logps/chosen': -387.21038818359375, 'referece_logps/rejected': -237.62136840820312, 'referece_logps/chosen': -380.39031982421875, 'logits/rejected': -0.44063568115234375, 'logits/chosen': -0.35726019740104675, 'epoch': 1.42}


 24%|██▍       | 3826/16104 [17:44:03<54:47:30, 16.07s/it]

 24%|██▍       | 3827/16104 [17:44:23<58:47:34, 17.24s/it]
{'loss': 0.4461, 'learning_rate': 1.782350726077494e-06, 'rewards/chosen': -0.9662113189697266, 'rewards/rejected': -2.239598035812378, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2733864784240723, 'policy_logps/rejected': -572.4695434570312, 'policy_logps/chosen': -333.7454833984375, 'referece_logps/rejected': -550.0736083984375, 'referece_logps/chosen': -324.0833740234375, 'logits/rejected': -0.5165054202079773, 'logits/chosen': -0.2662796974182129, 'epoch': 1.43}

 24%|██▍       | 3828/16104 [17:44:40<58:32:51, 17.17s/it]


 24%|██▍       | 3830/16104 [17:45:04<49:58:51, 14.66s/it]

 24%|██▍       | 3831/16104 [17:45:24<55:23:08, 16.25s/it]
{'loss': 0.5385, 'learning_rate': 1.7818493964582868e-06, 'rewards/chosen': -0.936809778213501, 'rewards/rejected': -1.4414525032043457, 'rewards/accuracies': 1.0, 'rewards/margins': 0.5046427249908447, 'policy_logps/rejected': -358.58319091796875, 'policy_logps/chosen': -353.0086975097656, 'referece_logps/rejected': -344.168701171875, 'referece_logps/chosen': -343.640625, 'logits/rejected': -1.6851768493652344, 'logits/chosen': -1.5646237134933472, 'epoch': 1.43}

 24%|██▍       | 3832/16104 [17:45:35<49:45:56, 14.60s/it]

 24%|██▍       | 3833/16104 [17:45:52<51:59:32, 15.25s/it]

 24%|██▍       | 3834/16104 [17:46:05<50:15:29, 14.75s/it]

 24%|██▍       | 3835/16104 [17:46:28<57:50:18, 16.97s/it]

 24%|██▍       | 3836/16104 [17:46:46<59:17:59, 17.40s/it]


 24%|██▍       | 3838/16104 [17:47:17<56:07:29, 16.47s/it]

 24%|██▍       | 3839/16104 [17:47:37<60:02:11, 17.62s/it]

 24%|██▍       | 3840/16104 [17:47:56<61:41:42, 18.11s/it]
{'loss': 0.4212, 'learning_rate': 1.780719555118619e-06, 'rewards/chosen': -1.204390525817871, 'rewards/rejected': -2.157452344894409, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9530618786811829, 'policy_logps/rejected': -516.101318359375, 'policy_logps/chosen': -505.94805908203125, 'referece_logps/rejected': -494.5268859863281, 'referece_logps/chosen': -493.90411376953125, 'logits/rejected': 0.21757671236991882, 'logits/chosen': 0.23052221536636353, 'epoch': 1.43}

 24%|██▍       | 3841/16104 [17:48:12<58:55:25, 17.30s/it]

 24%|██▍       | 3842/16104 [17:48:33<63:27:51, 18.63s/it]


 24%|██▍       | 3844/16104 [17:49:07<60:11:57, 17.68s/it]
{'loss': 0.4759, 'learning_rate': 1.7802165820729811e-06, 'rewards/chosen': -1.445119857788086, 'rewards/rejected': -1.6687097549438477, 'rewards/accuracies': 0.375, 'rewards/margins': 0.2235899269580841, 'policy_logps/rejected': -440.10736083984375, 'policy_logps/chosen': -544.1387939453125, 'referece_logps/rejected': -423.42022705078125, 'referece_logps/chosen': -529.6876220703125, 'logits/rejected': 0.20878294110298157, 'logits/chosen': 0.2674165666103363, 'epoch': 1.43}


 24%|██▍       | 3846/16104 [17:49:41<58:35:43, 17.21s/it]
{'loss': 0.4762, 'learning_rate': 1.7799649061628945e-06, 'rewards/chosen': -1.3277816772460938, 'rewards/rejected': -2.0954933166503906, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7677115201950073, 'policy_logps/rejected': -398.4966125488281, 'policy_logps/chosen': -238.31369018554688, 'referece_logps/rejected': -377.5416564941406, 'referece_logps/chosen': -225.03585815429688, 'logits/rejected': -0.3951995372772217, 'logits/chosen': -0.32965755462646484, 'epoch': 1.43}


 24%|██▍       | 3848/16104 [17:50:19<62:03:11, 18.23s/it]
{'loss': 0.4627, 'learning_rate': 1.7797131040489202e-06, 'rewards/chosen': -1.5891532897949219, 'rewards/rejected': -2.1465909481048584, 'rewards/accuracies': 0.625, 'rewards/margins': 0.557437539100647, 'policy_logps/rejected': -402.09991455078125, 'policy_logps/chosen': -304.8293762207031, 'referece_logps/rejected': -380.634033203125, 'referece_logps/chosen': -288.9378356933594, 'logits/rejected': -1.525238275527954, 'logits/chosen': -1.4805707931518555, 'epoch': 1.43}


 24%|██▍       | 3850/16104 [17:50:55<62:25:46, 18.34s/it]
{'loss': 0.4345, 'learning_rate': 1.7794611757718011e-06, 'rewards/chosen': -0.8613686561584473, 'rewards/rejected': -1.8514063358306885, 'rewards/accuracies': 1.0, 'rewards/margins': 0.9900375008583069, 'policy_logps/rejected': -328.1532287597656, 'policy_logps/chosen': -214.2462615966797, 'referece_logps/rejected': -309.63916015625, 'referece_logps/chosen': -205.632568359375, 'logits/rejected': -0.5935304760932922, 'logits/chosen': -0.6159296035766602, 'epoch': 1.43}

 24%|██▍       | 3851/16104 [17:51:14<63:07:22, 18.55s/it]


 24%|██▍       | 3853/16104 [17:51:55<66:41:52, 19.60s/it]

 24%|██▍       | 3854/16104 [17:52:17<68:36:11, 20.16s/it]

 24%|██▍       | 3855/16104 [17:52:35<66:51:55, 19.65s/it]

 24%|██▍       | 3856/16104 [17:52:49<60:46:48, 17.86s/it]
{'loss': 0.5032, 'learning_rate': 1.778704634369317e-06, 'rewards/chosen': -1.2723345756530762, 'rewards/rejected': -2.412069320678711, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1397347450256348, 'policy_logps/rejected': -422.3822326660156, 'policy_logps/chosen': -426.59515380859375, 'referece_logps/rejected': -398.26153564453125, 'referece_logps/chosen': -413.87176513671875, 'logits/rejected': -1.7688243389129639, 'logits/chosen': -1.8884644508361816, 'epoch': 1.44}


 24%|██▍       | 3858/16104 [17:53:21<56:55:35, 16.73s/it]
{'loss': 0.5298, 'learning_rate': 1.778452201847462e-06, 'rewards/chosen': -0.8088876605033875, 'rewards/rejected': -2.2046074867248535, 'rewards/accuracies': 0.625, 'rewards/margins': 1.3957198858261108, 'policy_logps/rejected': -604.5650024414062, 'policy_logps/chosen': -325.709716796875, 'referece_logps/rejected': -582.5189208984375, 'referece_logps/chosen': -317.6208190917969, 'logits/rejected': 0.9249191880226135, 'logits/chosen': 1.0535050630569458, 'epoch': 1.44}


 24%|██▍       | 3860/16104 [17:53:57<58:18:26, 17.14s/it]
{'loss': 0.4794, 'learning_rate': 1.7781996433664856e-06, 'rewards/chosen': -0.8420435190200806, 'rewards/rejected': -1.4423609972000122, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6003175973892212, 'policy_logps/rejected': -277.8522033691406, 'policy_logps/chosen': -324.6187438964844, 'referece_logps/rejected': -263.4286193847656, 'referece_logps/chosen': -316.19830322265625, 'logits/rejected': -0.23799733817577362, 'logits/chosen': -0.2600974142551422, 'epoch': 1.44}

 24%|██▍       | 3861/16104 [17:54:08<52:13:02, 15.35s/it]


 24%|██▍       | 3863/16104 [17:54:39<52:44:00, 15.51s/it]
{'loss': 0.4694, 'learning_rate': 1.7778205695610673e-06, 'rewards/chosen': -0.7784102559089661, 'rewards/rejected': -1.6677844524383545, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8893742561340332, 'policy_logps/rejected': -533.2938842773438, 'policy_logps/chosen': -577.7105712890625, 'referece_logps/rejected': -516.6160888671875, 'referece_logps/chosen': -569.926513671875, 'logits/rejected': -0.11142337322235107, 'logits/chosen': -0.16326844692230225, 'epoch': 1.44}

 24%|██▍       | 3864/16104 [17:54:52<50:35:53, 14.88s/it]


 24%|██▍       | 3866/16104 [17:55:29<55:26:33, 16.31s/it]
{'loss': 0.4811, 'learning_rate': 1.777441212577586e-06, 'rewards/chosen': -0.8015846610069275, 'rewards/rejected': -1.77327561378479, 'rewards/accuracies': 1.0, 'rewards/margins': 0.9716910123825073, 'policy_logps/rejected': -419.5591735839844, 'policy_logps/chosen': -365.6967468261719, 'referece_logps/rejected': -401.826416015625, 'referece_logps/chosen': -357.680908203125, 'logits/rejected': -0.460316002368927, 'logits/chosen': -0.3746620714664459, 'epoch': 1.44}


 24%|██▍       | 3868/16104 [17:56:01<54:12:42, 15.95s/it]
{'loss': 0.5956, 'learning_rate': 1.7771881506689846e-06, 'rewards/chosen': -0.8557785749435425, 'rewards/rejected': -1.428587555885315, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5728090405464172, 'policy_logps/rejected': -384.3916320800781, 'policy_logps/chosen': -541.6376953125, 'referece_logps/rejected': -370.1057434082031, 'referece_logps/chosen': -533.0799560546875, 'logits/rejected': -0.6279222965240479, 'logits/chosen': -0.7432434558868408, 'epoch': 1.44}

 24%|██▍       | 3869/16104 [17:56:23<60:09:30, 17.70s/it]

 24%|██▍       | 3870/16104 [17:56:39<58:40:59, 17.27s/it]


 24%|██▍       | 3872/16104 [17:57:14<59:31:18, 17.52s/it]
{'loss': 0.5702, 'learning_rate': 1.776681649628982e-06, 'rewards/chosen': -1.5931466817855835, 'rewards/rejected': -2.4523987770080566, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8592517375946045, 'policy_logps/rejected': -508.36456298828125, 'policy_logps/chosen': -420.4917297363281, 'referece_logps/rejected': -483.8406066894531, 'referece_logps/chosen': -404.5602722167969, 'logits/rejected': -1.0866541862487793, 'logits/chosen': -0.81075119972229, 'epoch': 1.44}
[2024-04-08 07:04:14,971] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 24%|██▍       | 3873/16104 [17:57:34<62:21:14, 18.35s/it]
[2024-04-08 07:04:33,070] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 24%|██▍       | 3875/16104 [17:58:07<58:49:29, 17.32s/it]
{'loss': 0.5692, 'learning_rate': 1.7763014439403903e-06, 'rewards/chosen': -0.9382294416427612, 'rewards/rejected': -1.8272120952606201, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8889825940132141, 'policy_logps/rejected': -331.3065185546875, 'policy_logps/chosen': -309.5204162597656, 'referece_logps/rejected': -313.034423828125, 'referece_logps/chosen': -300.13812255859375, 'logits/rejected': -0.1347334384918213, 'logits/chosen': -0.16076011955738068, 'epoch': 1.44}

 24%|██▍       | 3876/16104 [17:58:29<63:02:39, 18.56s/it]


 24%|██▍       | 3878/16104 [17:58:55<53:39:02, 15.80s/it]
{'loss': 0.5029, 'learning_rate': 1.775920955626798e-06, 'rewards/chosen': -0.7355993390083313, 'rewards/rejected': -1.875813364982605, 'rewards/accuracies': 0.75, 'rewards/margins': 1.140214204788208, 'policy_logps/rejected': -600.1478881835938, 'policy_logps/chosen': -438.1024169921875, 'referece_logps/rejected': -581.3897705078125, 'referece_logps/chosen': -430.7464294433594, 'logits/rejected': -1.1319111585617065, 'logits/chosen': -0.9647162556648254, 'epoch': 1.44}


 24%|██▍       | 3880/16104 [17:59:29<57:18:19, 16.88s/it]

 24%|██▍       | 3881/16104 [17:59:49<60:25:27, 17.80s/it]
{'loss': 0.5157, 'learning_rate': 1.775540184826728e-06, 'rewards/chosen': -1.1321161985397339, 'rewards/rejected': -2.236743211746216, 'rewards/accuracies': 1.0, 'rewards/margins': 1.104627013206482, 'policy_logps/rejected': -276.92266845703125, 'policy_logps/chosen': -309.18084716796875, 'referece_logps/rejected': -254.55526733398438, 'referece_logps/chosen': -297.85968017578125, 'logits/rejected': -0.48736339807510376, 'logits/chosen': -0.5959224104881287, 'epoch': 1.45}

 24%|██▍       | 3882/16104 [18:00:04<57:47:50, 17.02s/it]


 24%|██▍       | 3884/16104 [18:00:35<55:05:06, 16.23s/it]

 24%|██▍       | 3885/16104 [18:00:53<57:02:06, 16.80s/it]

 24%|██▍       | 3886/16104 [18:01:12<58:23:08, 17.20s/it]
{'loss': 0.5912, 'learning_rate': 1.774904939455443e-06, 'rewards/chosen': -1.5065559148788452, 'rewards/rejected': -1.70158851146698, 'rewards/accuracies': 0.625, 'rewards/margins': 0.19503262639045715, 'policy_logps/rejected': -333.60064697265625, 'policy_logps/chosen': -345.9071350097656, 'referece_logps/rejected': -316.584716796875, 'referece_logps/chosen': -330.841552734375, 'logits/rejected': 0.2545738220214844, 'logits/chosen': 0.3487841486930847, 'epoch': 1.45}

 24%|██▍       | 3887/16104 [18:01:24<53:42:49, 15.83s/it]


 24%|██▍       | 3889/16104 [18:01:46<44:43:33, 13.18s/it]
{'loss': 0.6062, 'learning_rate': 1.774523416036103e-06, 'rewards/chosen': -1.022862434387207, 'rewards/rejected': -1.4717283248901367, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4488658905029297, 'policy_logps/rejected': -319.6812438964844, 'policy_logps/chosen': -423.1689758300781, 'referece_logps/rejected': -304.9639587402344, 'referece_logps/chosen': -412.94036865234375, 'logits/rejected': -0.7008587121963501, 'logits/chosen': -0.6894392967224121, 'epoch': 1.45}

 24%|██▍       | 3890/16104 [18:01:56<42:09:56, 12.43s/it]


 24%|██▍       | 3892/16104 [18:02:20<40:41:19, 11.99s/it]
{'loss': 0.7509, 'learning_rate': 1.7741416106390826e-06, 'rewards/chosen': -1.3191168308258057, 'rewards/rejected': -1.0052149295806885, 'rewards/accuracies': 0.25, 'rewards/margins': -0.3139019012451172, 'policy_logps/rejected': -274.3858337402344, 'policy_logps/chosen': -371.28363037109375, 'referece_logps/rejected': -264.33367919921875, 'referece_logps/chosen': -358.09246826171875, 'logits/rejected': -0.40864166617393494, 'logits/chosen': -0.21777044236660004, 'epoch': 1.45}

 24%|██▍       | 3893/16104 [18:02:39<48:18:02, 14.24s/it]

 24%|██▍       | 3894/16104 [18:02:59<53:41:55, 15.83s/it]

 24%|██▍       | 3895/16104 [18:03:18<57:30:39, 16.96s/it]

 24%|██▍       | 3896/16104 [18:03:34<56:41:41, 16.72s/it]


 24%|██▍       | 3898/16104 [18:04:14<62:31:27, 18.44s/it]

 24%|██▍       | 3899/16104 [18:04:34<64:19:11, 18.97s/it]
[2024-04-08 07:11:14,860] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 24%|██▍       | 3900/16104 [18:04:56<67:22:39, 19.88s/it]
[2024-04-08 07:11:36,843] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5568, 'learning_rate': 1.7731220854135706e-06, 'rewards/chosen': -0.6745681762695312, 'rewards/rejected': -2.4389333724975586, 'rewards/accuracies': 0.625, 'rewards/margins': 1.7643651962280273, 'policy_logps/rejected': -593.2581176757812, 'policy_logps/chosen': -561.5252685546875, 'referece_logps/rejected': -568.8687744140625, 'referece_logps/chosen': -554.7796020507812, 'logits/rejected': 0.4871698021888733, 'logits/chosen': 0.37704870104789734, 'epoch': 1.45}

 24%|██▍       | 3901/16104 [18:05:11<62:28:09, 18.43s/it]

 24%|██▍       | 3902/16104 [18:05:30<63:33:48, 18.75s/it]


 24%|██▍       | 3904/16104 [18:06:04<61:13:17, 18.07s/it]

 24%|██▍       | 3905/16104 [18:06:24<63:05:33, 18.62s/it]

 24%|██▍       | 3906/16104 [18:06:36<55:44:35, 16.45s/it]

 24%|██▍       | 3907/16104 [18:06:54<57:46:33, 17.05s/it]
{'loss': 0.5645, 'learning_rate': 1.772228358857434e-06, 'rewards/chosen': -0.9272584915161133, 'rewards/rejected': -1.543571949005127, 'rewards/accuracies': 0.5, 'rewards/margins': 0.6163133978843689, 'policy_logps/rejected': -398.7903747558594, 'policy_logps/chosen': -394.1932678222656, 'referece_logps/rejected': -383.35467529296875, 'referece_logps/chosen': -384.9206848144531, 'logits/rejected': -0.2483188956975937, 'logits/chosen': -0.24250808358192444, 'epoch': 1.46}

 24%|██▍       | 3908/16104 [18:07:05<51:37:55, 15.24s/it]


 24%|██▍       | 3910/16104 [18:07:36<51:01:11, 15.06s/it]
{'loss': 0.5451, 'learning_rate': 1.7718448645169656e-06, 'rewards/chosen': -0.7103105783462524, 'rewards/rejected': -0.9403704404830933, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23005984723567963, 'policy_logps/rejected': -361.1356201171875, 'policy_logps/chosen': -333.4437561035156, 'referece_logps/rejected': -351.7319030761719, 'referece_logps/chosen': -326.34063720703125, 'logits/rejected': 0.3525233268737793, 'logits/chosen': 0.4060686230659485, 'epoch': 1.46}

 24%|██▍       | 3911/16104 [18:07:53<52:36:40, 15.53s/it]

 24%|██▍       | 3912/16104 [18:08:13<57:26:32, 16.96s/it]

 24%|██▍       | 3913/16104 [18:08:35<62:38:29, 18.50s/it]

 24%|██▍       | 3914/16104 [18:08:55<63:27:32, 18.74s/it]

 24%|██▍       | 3915/16104 [18:09:16<65:49:10, 19.44s/it]

 24%|██▍       | 3916/16104 [18:09:32<62:49:39, 18.56s/it]
[2024-04-08 07:16:36,475] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 24%|██▍       | 3917/16104 [18:09:55<67:36:08, 19.97s/it]
[2024-04-08 07:16:58,476] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 24%|██▍       | 3918/16104 [18:10:17<69:39:34, 20.58s/it]

 24%|██▍       | 3919/16104 [18:10:35<66:41:12, 19.70s/it]
[2024-04-08 07:17:38,264] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 24%|██▍       | 3920/16104 [18:10:57<69:08:50, 20.43s/it]

 24%|██▍       | 3921/16104 [18:11:16<67:43:23, 20.01s/it]

 24%|██▍       | 3922/16104 [18:11:37<68:20:12, 20.19s/it]

 24%|██▍       | 3923/16104 [18:11:57<68:18:54, 20.19s/it]

 24%|██▍       | 3924/16104 [18:12:17<67:49:15, 20.05s/it]

 24%|██▍       | 3925/16104 [18:12:37<68:06:18, 20.13s/it]

 24%|██▍       | 3926/16104 [18:12:51<61:58:32, 18.32s/it]


 24%|██▍       | 3928/16104 [18:13:23<56:40:42, 16.76s/it]
{'loss': 0.545, 'learning_rate': 1.769538002315177e-06, 'rewards/chosen': -0.5835988521575928, 'rewards/rejected': -1.0517557859420776, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4681569039821625, 'policy_logps/rejected': -326.52996826171875, 'policy_logps/chosen': -364.25494384765625, 'referece_logps/rejected': -316.0124206542969, 'referece_logps/chosen': -358.4189758300781, 'logits/rejected': 0.02521786093711853, 'logits/chosen': -0.040285199880599976, 'epoch': 1.46}


 24%|██▍       | 3930/16104 [18:13:51<51:02:14, 15.09s/it]
{'loss': 0.5595, 'learning_rate': 1.769281061155461e-06, 'rewards/chosen': -0.6190974116325378, 'rewards/rejected': -1.357120156288147, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7380227446556091, 'policy_logps/rejected': -357.5855407714844, 'policy_logps/chosen': -396.42535400390625, 'referece_logps/rejected': -344.01434326171875, 'referece_logps/chosen': -390.234375, 'logits/rejected': 0.10984376817941666, 'logits/chosen': 0.11079724878072739, 'epoch': 1.46}

 24%|██▍       | 3931/16104 [18:14:02<46:57:38, 13.89s/it]

 24%|██▍       | 3932/16104 [18:14:22<53:01:28, 15.68s/it]

 24%|██▍       | 3933/16104 [18:14:32<47:56:47, 14.18s/it]


 24%|██▍       | 3935/16104 [18:15:09<54:46:16, 16.20s/it]
{'loss': 0.5071, 'learning_rate': 1.7686381637683156e-06, 'rewards/chosen': -0.6414871215820312, 'rewards/rejected': -1.017333984375, 'rewards/accuracies': 0.75, 'rewards/margins': 0.37584683299064636, 'policy_logps/rejected': -437.18115234375, 'policy_logps/chosen': -424.2250671386719, 'referece_logps/rejected': -427.0078430175781, 'referece_logps/chosen': -417.81024169921875, 'logits/rejected': -0.5807103514671326, 'logits/chosen': -0.4662432372570038, 'epoch': 1.47}

 24%|██▍       | 3936/16104 [18:15:19<49:01:29, 14.50s/it]

 24%|██▍       | 3937/16104 [18:15:38<53:11:13, 15.74s/it]

 24%|██▍       | 3938/16104 [18:15:55<55:08:09, 16.32s/it]

 24%|██▍       | 3939/16104 [18:16:07<50:29:30, 14.94s/it]

 24%|██▍       | 3940/16104 [18:16:21<48:51:31, 14.46s/it]

 24%|██▍       | 3941/16104 [18:16:36<49:33:15, 14.67s/it]

 24%|██▍       | 3942/16104 [18:16:50<49:14:56, 14.58s/it]

 24%|██▍       | 3943/16104 [18:17:06<51:03:15, 15.11s/it]

 24%|██▍       | 3944/16104 [18:17:17<46:37:03, 13.80s/it]

 24%|██▍       | 3945/16104 [18:17:37<52:45:57, 15.62s/it]

 25%|██▍       | 3946/16104 [18:17:48<47:47:17, 14.15s/it]

 25%|██▍       | 3947/16104 [18:18:05<51:16:37, 15.18s/it]

 25%|██▍       | 3948/16104 [18:18:18<48:56:15, 14.49s/it]

 25%|██▍       | 3949/16104 [18:18:38<54:20:48, 16.10s/it]

 25%|██▍       | 3950/16104 [18:18:54<54:12:44, 16.06s/it]

 25%|██▍       | 3951/16104 [18:19:13<56:44:22, 16.81s/it]

 25%|██▍       | 3952/16104 [18:19:31<58:07:28, 17.22s/it]
[2024-04-08 07:26:33,534] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3953/16104 [18:19:52<62:38:41, 18.56s/it]
[2024-04-08 07:26:49,612] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3954/16104 [18:20:09<60:07:38, 17.82s/it]
[2024-04-08 07:27:09,828] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3955/16104 [18:20:29<62:33:07, 18.54s/it]

 25%|██▍       | 3956/16104 [18:20:45<59:56:40, 17.76s/it]

 25%|██▍       | 3957/16104 [18:21:06<63:37:52, 18.86s/it]

 25%|██▍       | 3958/16104 [18:21:23<61:24:12, 18.20s/it]

 25%|██▍       | 3959/16104 [18:21:38<57:58:04, 17.18s/it]

 25%|██▍       | 3960/16104 [18:21:56<58:58:10, 17.48s/it]

 25%|██▍       | 3961/16104 [18:22:08<53:19:17, 15.81s/it]

 25%|██▍       | 3962/16104 [18:22:27<57:17:22, 16.99s/it]
[2024-04-08 07:29:27,406] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 25%|██▍       | 3964/16104 [18:23:01<56:31:44, 16.76s/it]
{'loss': 0.364, 'learning_rate': 1.7648940507430745e-06, 'rewards/chosen': -0.9261839389801025, 'rewards/rejected': -2.717278480529785, 'rewards/accuracies': 1.0, 'rewards/margins': 1.7910945415496826, 'policy_logps/rejected': -349.9354553222656, 'policy_logps/chosen': -535.2681884765625, 'referece_logps/rejected': -322.76263427734375, 'referece_logps/chosen': -526.00634765625, 'logits/rejected': 0.6100145578384399, 'logits/chosen': 0.690358579158783, 'epoch': 1.48}

 25%|██▍       | 3965/16104 [18:23:19<57:24:59, 17.03s/it]

 25%|██▍       | 3966/16104 [18:23:30<51:05:16, 15.15s/it]

 25%|██▍       | 3967/16104 [18:23:45<51:23:38, 15.24s/it]
[2024-04-08 07:30:48,132] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3968/16104 [18:24:07<58:10:28, 17.26s/it]
[2024-04-08 07:31:07,382] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3969/16104 [18:24:26<60:11:03, 17.85s/it]

 25%|██▍       | 3970/16104 [18:24:47<63:05:19, 18.72s/it]

 25%|██▍       | 3971/16104 [18:25:07<64:02:32, 19.00s/it]
[2024-04-08 07:32:12,039] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3972/16104 [18:25:31<69:21:09, 20.58s/it]
[2024-04-08 07:32:25,266] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3973/16104 [18:25:44<61:54:51, 18.37s/it]

 25%|██▍       | 3974/16104 [18:26:02<61:42:43, 18.32s/it]

 25%|██▍       | 3975/16104 [18:26:14<54:36:50, 16.21s/it]

 25%|██▍       | 3976/16104 [18:26:30<54:42:51, 16.24s/it]

 25%|██▍       | 3977/16104 [18:26:41<49:03:10, 14.56s/it]


 25%|██▍       | 3979/16104 [18:27:16<53:09:47, 15.78s/it]
{'loss': 0.4849, 'learning_rate': 1.762947221869805e-06, 'rewards/chosen': -1.1097251176834106, 'rewards/rejected': -1.6838561296463013, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5741310119628906, 'policy_logps/rejected': -288.30572509765625, 'policy_logps/chosen': -461.0074157714844, 'referece_logps/rejected': -271.4671630859375, 'referece_logps/chosen': -449.91015625, 'logits/rejected': 0.13665899634361267, 'logits/chosen': 0.11847686767578125, 'epoch': 1.48}

 25%|██▍       | 3980/16104 [18:27:33<54:26:10, 16.16s/it]

 25%|██▍       | 3981/16104 [18:27:50<55:25:16, 16.46s/it]


 25%|██▍       | 3983/16104 [18:28:26<58:37:45, 17.41s/it]
{'loss': 0.5234, 'learning_rate': 1.7624268939935702e-06, 'rewards/chosen': -1.3248661756515503, 'rewards/rejected': -2.30237078666687, 'rewards/accuracies': 0.5, 'rewards/margins': 0.977504551410675, 'policy_logps/rejected': -308.0221862792969, 'policy_logps/chosen': -489.6352233886719, 'referece_logps/rejected': -284.9984436035156, 'referece_logps/chosen': -476.3865661621094, 'logits/rejected': -0.1862521767616272, 'logits/chosen': 0.0011033415794372559, 'epoch': 1.48}

 25%|██▍       | 3984/16104 [18:28:44<59:32:37, 17.69s/it]
[2024-04-08 07:35:45,589] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3985/16104 [18:29:05<62:32:55, 18.58s/it]
[2024-04-08 07:36:01,845] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3986/16104 [18:29:21<60:11:45, 17.88s/it]

 25%|██▍       | 3987/16104 [18:29:38<59:22:17, 17.64s/it]

 25%|██▍       | 3988/16104 [18:29:59<63:04:21, 18.74s/it]

 25%|██▍       | 3989/16104 [18:30:10<54:58:53, 16.34s/it]
[2024-04-08 07:37:10,945] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3990/16104 [18:30:30<58:39:37, 17.43s/it]
[2024-04-08 07:37:31,424] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3991/16104 [18:30:50<61:43:52, 18.35s/it]

 25%|██▍       | 3992/16104 [18:31:11<64:20:05, 19.12s/it]
[2024-04-08 07:38:11,846] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3993/16104 [18:31:31<64:42:06, 19.23s/it]

 25%|██▍       | 3994/16104 [18:31:42<57:05:32, 16.97s/it]

 25%|██▍       | 3995/16104 [18:32:00<57:39:49, 17.14s/it]
[2024-04-08 07:39:03,302] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 3996/16104 [18:32:22<62:46:34, 18.66s/it]


 25%|██▍       | 3998/16104 [18:32:51<55:22:28, 16.47s/it]

 25%|██▍       | 3999/16104 [18:33:08<55:51:25, 16.61s/it]

 25%|██▍       | 4000/16104 [18:33:28<58:40:47, 17.45s/it]

 25%|██▍       | 4001/16104 [18:33:59<72:28:19, 21.56s/it]

 25%|██▍       | 4002/16104 [18:34:18<70:24:57, 20.95s/it]
[2024-04-08 07:40:59,345] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 4003/16104 [18:34:38<69:13:15, 20.59s/it]

 25%|██▍       | 4004/16104 [18:35:00<70:32:41, 20.99s/it]

 25%|██▍       | 4005/16104 [18:35:13<62:23:54, 18.57s/it]

 25%|██▍       | 4006/16104 [18:35:33<63:48:34, 18.99s/it]

 25%|██▍       | 4007/16104 [18:35:48<59:57:48, 17.84s/it]

 25%|██▍       | 4008/16104 [18:36:10<64:27:02, 19.18s/it]
[2024-04-08 07:42:51,388] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▍       | 4009/16104 [18:36:30<65:01:38, 19.35s/it]

 25%|██▍       | 4010/16104 [18:36:45<60:49:03, 18.10s/it]

 25%|██▍       | 4011/16104 [18:37:03<60:43:10, 18.08s/it]

 25%|██▍       | 4012/16104 [18:37:15<54:21:05, 16.18s/it]

 25%|██▍       | 4013/16104 [18:37:27<50:24:15, 15.01s/it]

 25%|██▍       | 4014/16104 [18:37:47<55:02:37, 16.39s/it]

 25%|██▍       | 4015/16104 [18:38:01<52:41:41, 15.69s/it]

 25%|██▍       | 4016/16104 [18:38:12<47:33:29, 14.16s/it]

 25%|██▍       | 4017/16104 [18:38:28<49:34:49, 14.77s/it]

 25%|██▍       | 4018/16104 [18:38:38<45:27:20, 13.54s/it]

 25%|██▍       | 4019/16104 [18:38:49<42:34:54, 12.68s/it]
{'loss': 0.5049, 'learning_rate': 1.757721777725949e-06, 'rewards/chosen': -0.822557270526886, 'rewards/rejected': -1.4447656869888306, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6222082376480103, 'policy_logps/rejected': -319.79473876953125, 'policy_logps/chosen': -528.6661987304688, 'referece_logps/rejected': -305.3470764160156, 'referece_logps/chosen': -520.440673828125, 'logits/rejected': -0.2274872064590454, 'logits/chosen': -0.38491153717041016, 'epoch': 1.5}


 25%|██▍       | 4021/16104 [18:39:26<51:54:06, 15.46s/it]

 25%|██▍       | 4022/16104 [18:39:45<56:07:44, 16.72s/it]

 25%|██▍       | 4023/16104 [18:39:56<50:01:17, 14.91s/it]

 25%|██▍       | 4024/16104 [18:40:09<47:50:26, 14.26s/it]
{'loss': 0.4068, 'learning_rate': 1.7570651419962807e-06, 'rewards/chosen': -1.4071499109268188, 'rewards/rejected': -2.470491647720337, 'rewards/accuracies': 0.625, 'rewards/margins': 1.063341498374939, 'policy_logps/rejected': -333.7950439453125, 'policy_logps/chosen': -388.4292297363281, 'referece_logps/rejected': -309.09014892578125, 'referece_logps/chosen': -374.3576965332031, 'logits/rejected': 0.024938344955444336, 'logits/chosen': 0.03501632809638977, 'epoch': 1.5}

 25%|██▍       | 4025/16104 [18:40:29<53:25:42, 15.92s/it]


 25%|██▌       | 4027/16104 [18:41:10<61:20:40, 18.29s/it]

 25%|██▌       | 4028/16104 [18:41:30<62:51:07, 18.74s/it]
{'loss': 0.4395, 'learning_rate': 1.7565392821372424e-06, 'rewards/chosen': -1.0346068143844604, 'rewards/rejected': -1.8179353475570679, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7833283543586731, 'policy_logps/rejected': -351.95892333984375, 'policy_logps/chosen': -500.41455078125, 'referece_logps/rejected': -333.7795715332031, 'referece_logps/chosen': -490.0684814453125, 'logits/rejected': -0.8698988556861877, 'logits/chosen': -1.0276838541030884, 'epoch': 1.5}

 25%|██▌       | 4029/16104 [18:41:45<58:48:49, 17.53s/it]


 25%|██▌       | 4031/16104 [18:42:24<62:36:17, 18.67s/it]

 25%|██▌       | 4032/16104 [18:42:42<61:22:33, 18.30s/it]
{'loss': 0.5878, 'learning_rate': 1.756012932624405e-06, 'rewards/chosen': -0.9356367588043213, 'rewards/rejected': -1.9614661931991577, 'rewards/accuracies': 0.75, 'rewards/margins': 1.025829553604126, 'policy_logps/rejected': -208.207275390625, 'policy_logps/chosen': -292.3287048339844, 'referece_logps/rejected': -188.5926055908203, 'referece_logps/chosen': -282.97235107421875, 'logits/rejected': -1.1361414194107056, 'logits/chosen': -1.2997195720672607, 'epoch': 1.5}


 25%|██▌       | 4034/16104 [18:43:06<50:52:57, 15.18s/it]
{'loss': 0.5734, 'learning_rate': 1.7557495743542582e-06, 'rewards/chosen': -1.2306092977523804, 'rewards/rejected': -1.2838373184204102, 'rewards/accuracies': 0.5, 'rewards/margins': 0.053227826952934265, 'policy_logps/rejected': -385.268798828125, 'policy_logps/chosen': -281.793701171875, 'referece_logps/rejected': -372.4303894042969, 'referece_logps/chosen': -269.48760986328125, 'logits/rejected': 0.04204334691166878, 'logits/chosen': 0.13206271827220917, 'epoch': 1.5}


 25%|██▌       | 4036/16104 [18:43:38<51:10:55, 15.27s/it]

 25%|██▌       | 4037/16104 [18:43:54<52:02:46, 15.53s/it]

 25%|██▌       | 4038/16104 [18:44:12<54:27:27, 16.25s/it]

 25%|██▌       | 4039/16104 [18:44:32<57:51:37, 17.26s/it]

 25%|██▌       | 4040/16104 [18:44:52<60:52:15, 18.16s/it]
{'loss': 0.5419, 'learning_rate': 1.7549587660003228e-06, 'rewards/chosen': -1.3700518608093262, 'rewards/rejected': -1.5616941452026367, 'rewards/accuracies': 0.5, 'rewards/margins': 0.19164235889911652, 'policy_logps/rejected': -384.30169677734375, 'policy_logps/chosen': -367.3262023925781, 'referece_logps/rejected': -368.68475341796875, 'referece_logps/chosen': -353.62567138671875, 'logits/rejected': 0.10259963572025299, 'logits/chosen': 0.005739122629165649, 'epoch': 1.51}


 25%|██▌       | 4042/16104 [18:45:17<51:59:11, 15.52s/it]

 25%|██▌       | 4043/16104 [18:45:34<53:20:24, 15.92s/it]
{'loss': 0.5342, 'learning_rate': 1.7545629494690695e-06, 'rewards/chosen': -1.4494152069091797, 'rewards/rejected': -3.2730839252471924, 'rewards/accuracies': 0.875, 'rewards/margins': 1.823668360710144, 'policy_logps/rejected': -329.44207763671875, 'policy_logps/chosen': -314.1515197753906, 'referece_logps/rejected': -296.71124267578125, 'referece_logps/chosen': -299.6573486328125, 'logits/rejected': -0.890573263168335, 'logits/chosen': -0.7978525757789612, 'epoch': 1.51}


 25%|██▌       | 4045/16104 [18:45:58<46:33:35, 13.90s/it]

 25%|██▌       | 4046/16104 [18:46:08<43:17:38, 12.93s/it]

 25%|██▌       | 4047/16104 [18:46:22<43:33:44, 13.01s/it]

 25%|██▌       | 4048/16104 [18:46:36<44:28:04, 13.28s/it]

 25%|██▌       | 4049/16104 [18:46:56<51:28:09, 15.37s/it]

 25%|██▌       | 4050/16104 [18:47:10<50:05:52, 14.96s/it]

 25%|██▌       | 4051/16104 [18:47:32<57:26:46, 17.16s/it]
[2024-04-08 07:54:13,123] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▌       | 4052/16104 [18:47:48<55:50:58, 16.68s/it]
[2024-04-08 07:54:28,697] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▌       | 4053/16104 [18:48:07<58:55:32, 17.60s/it]

 25%|██▌       | 4054/16104 [18:48:26<59:50:04, 17.88s/it]

 25%|██▌       | 4055/16104 [18:48:43<58:35:10, 17.50s/it]

 25%|██▌       | 4056/16104 [18:49:02<60:37:01, 18.11s/it]

 25%|██▌       | 4057/16104 [18:49:18<58:10:01, 17.38s/it]

 25%|██▌       | 4058/16104 [18:49:40<62:51:43, 18.79s/it]

 25%|██▌       | 4059/16104 [18:49:56<60:43:29, 18.15s/it]
{'loss': 0.3759, 'learning_rate': 1.7524472919295486e-06, 'rewards/chosen': -1.1495342254638672, 'rewards/rejected': -2.233821392059326, 'rewards/accuracies': 0.75, 'rewards/margins': 1.084287405014038, 'policy_logps/rejected': -375.89971923828125, 'policy_logps/chosen': -297.2133483886719, 'referece_logps/rejected': -353.5615234375, 'referece_logps/chosen': -285.718017578125, 'logits/rejected': -1.2326269149780273, 'logits/chosen': -1.2454137802124023, 'epoch': 1.51}

 25%|██▌       | 4060/16104 [18:50:17<63:18:58, 18.93s/it]


 25%|██▌       | 4062/16104 [18:50:50<57:29:28, 17.19s/it]

 25%|██▌       | 4063/16104 [18:51:10<60:02:35, 17.95s/it]

 25%|██▌       | 4064/16104 [18:51:28<60:25:09, 18.07s/it]

 25%|██▌       | 4065/16104 [18:51:41<54:49:46, 16.40s/it]

 25%|██▌       | 4066/16104 [18:51:58<55:17:19, 16.53s/it]

 25%|██▌       | 4067/16104 [18:52:18<58:42:07, 17.56s/it]
{'loss': 0.4768, 'learning_rate': 1.7513865397576058e-06, 'rewards/chosen': -1.0444107055664062, 'rewards/rejected': -2.032853126525879, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9884424209594727, 'policy_logps/rejected': -296.4002380371094, 'policy_logps/chosen': -357.5755615234375, 'referece_logps/rejected': -276.0716857910156, 'referece_logps/chosen': -347.1314697265625, 'logits/rejected': -0.8083635568618774, 'logits/chosen': -0.6725099682807922, 'epoch': 1.52}
[2024-04-08 07:59:18,593] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 25%|██▌       | 4069/16104 [18:52:52<57:02:03, 17.06s/it]

 25%|██▌       | 4070/16104 [18:53:09<57:10:24, 17.10s/it]

 25%|██▌       | 4071/16104 [18:53:31<62:08:45, 18.59s/it]

 25%|██▌       | 4072/16104 [18:53:48<60:39:40, 18.15s/it]

 25%|██▌       | 4073/16104 [18:54:02<56:46:42, 16.99s/it]

 25%|██▌       | 4074/16104 [18:54:17<53:53:10, 16.13s/it]
{'loss': 0.573, 'learning_rate': 1.7504567857798722e-06, 'rewards/chosen': -0.8835434317588806, 'rewards/rejected': -1.071571707725525, 'rewards/accuracies': 0.5, 'rewards/margins': 0.18802830576896667, 'policy_logps/rejected': -582.7847900390625, 'policy_logps/chosen': -532.9022216796875, 'referece_logps/rejected': -572.069091796875, 'referece_logps/chosen': -524.0667724609375, 'logits/rejected': 0.19998672604560852, 'logits/chosen': 0.34564539790153503, 'epoch': 1.52}


 25%|██▌       | 4076/16104 [18:54:48<52:49:33, 15.81s/it]

 25%|██▌       | 4077/16104 [18:55:03<51:43:09, 15.48s/it]
{'loss': 0.4866, 'learning_rate': 1.750057864322184e-06, 'rewards/chosen': -0.9950982332229614, 'rewards/rejected': -2.172830104827881, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1777318716049194, 'policy_logps/rejected': -285.4469909667969, 'policy_logps/chosen': -197.4659881591797, 'referece_logps/rejected': -263.71868896484375, 'referece_logps/chosen': -187.51499938964844, 'logits/rejected': -0.9750268459320068, 'logits/chosen': -0.9328733682632446, 'epoch': 1.52}
[2024-04-08 08:02:04,554] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▌       | 4078/16104 [18:55:23<57:03:58, 17.08s/it]
[2024-04-08 08:02:24,572] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 25%|██▌       | 4080/16104 [18:55:59<57:05:23, 17.09s/it]
{'loss': 0.4352, 'learning_rate': 1.7496586697938912e-06, 'rewards/chosen': -1.039462924003601, 'rewards/rejected': -2.142688512802124, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1032254695892334, 'policy_logps/rejected': -361.88470458984375, 'policy_logps/chosen': -312.8140563964844, 'referece_logps/rejected': -340.45782470703125, 'referece_logps/chosen': -302.41943359375, 'logits/rejected': -0.7856395840644836, 'logits/chosen': -0.7874431610107422, 'epoch': 1.52}

 25%|██▌       | 4081/16104 [18:56:16<57:09:29, 17.11s/it]

 25%|██▌       | 4082/16104 [18:56:30<53:58:53, 16.16s/it]


 25%|██▌       | 4084/16104 [18:57:06<58:24:01, 17.49s/it]

 25%|██▌       | 4085/16104 [18:57:27<61:51:45, 18.53s/it]
[2024-04-08 08:04:08,418] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4507, 'learning_rate': 1.7489927391512821e-06, 'rewards/chosen': -0.8599757552146912, 'rewards/rejected': -1.8320420980453491, 'rewards/accuracies': 0.875, 'rewards/margins': 0.972066342830658, 'policy_logps/rejected': -437.6492919921875, 'policy_logps/chosen': -476.7623596191406, 'referece_logps/rejected': -419.328857421875, 'referece_logps/chosen': -468.16259765625, 'logits/rejected': -0.9199700951576233, 'logits/chosen': -0.8641555309295654, 'epoch': 1.52}
[2024-04-08 08:04:28,954] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 25%|██▌       | 4087/16104 [18:58:05<61:52:51, 18.54s/it]
[2024-04-08 08:04:46,108] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 25%|██▌       | 4088/16104 [18:58:24<62:16:39, 18.66s/it]

 25%|██▌       | 4089/16104 [18:58:45<64:44:46, 19.40s/it]

 25%|██▌       | 4090/16104 [18:59:03<63:18:10, 18.97s/it]

 25%|██▌       | 4091/16104 [18:59:21<62:10:14, 18.63s/it]
{'loss': 0.5752, 'learning_rate': 1.748192622602485e-06, 'rewards/chosen': -0.7516119480133057, 'rewards/rejected': -1.4794073104858398, 'rewards/accuracies': 0.5, 'rewards/margins': 0.7277953624725342, 'policy_logps/rejected': -443.86138916015625, 'policy_logps/chosen': -353.8728942871094, 'referece_logps/rejected': -429.06732177734375, 'referece_logps/chosen': -346.3567810058594, 'logits/rejected': -0.8318047523498535, 'logits/chosen': -0.7450066804885864, 'epoch': 1.52}

 25%|██▌       | 4092/16104 [18:59:38<60:27:10, 18.12s/it]


 25%|██▌       | 4094/16104 [19:00:13<60:32:34, 18.15s/it]

 25%|██▌       | 4095/16104 [19:00:31<60:01:20, 17.99s/it]

 25%|██▌       | 4096/16104 [19:00:51<62:52:52, 18.85s/it]
[2024-04-08 08:07:32,553] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.546, 'learning_rate': 1.747525026454938e-06, 'rewards/chosen': -0.5213863849639893, 'rewards/rejected': -1.4883652925491333, 'rewards/accuracies': 0.875, 'rewards/margins': 0.966978907585144, 'policy_logps/rejected': -365.2496032714844, 'policy_logps/chosen': -360.7489013671875, 'referece_logps/rejected': -350.36590576171875, 'referece_logps/chosen': -355.5350646972656, 'logits/rejected': -0.014885619282722473, 'logits/chosen': 0.1640988290309906, 'epoch': 1.53}


 25%|██▌       | 4098/16104 [19:01:18<52:50:26, 15.84s/it]

 25%|██▌       | 4099/16104 [19:01:29<47:36:45, 14.28s/it]
{'loss': 0.5751, 'learning_rate': 1.7471241058585433e-06, 'rewards/chosen': -1.1485767364501953, 'rewards/rejected': -1.0326480865478516, 'rewards/accuracies': 0.375, 'rewards/margins': -0.11592863500118256, 'policy_logps/rejected': -414.77838134765625, 'policy_logps/chosen': -419.48931884765625, 'referece_logps/rejected': -404.4518737792969, 'referece_logps/chosen': -408.00360107421875, 'logits/rejected': -1.1475571393966675, 'logits/chosen': -1.1426725387573242, 'epoch': 1.53}


 25%|██▌       | 4101/16104 [19:01:50<41:29:59, 12.45s/it]

 25%|██▌       | 4102/16104 [19:02:01<39:42:50, 11.91s/it]

 25%|██▌       | 4103/16104 [19:02:13<39:27:01, 11.83s/it]

 25%|██▌       | 4104/16104 [19:02:23<38:16:47, 11.48s/it]

 25%|██▌       | 4105/16104 [19:02:36<39:49:09, 11.95s/it]

 25%|██▌       | 4106/16104 [19:02:49<40:32:51, 12.17s/it]

 26%|██▌       | 4107/16104 [19:03:05<44:31:35, 13.36s/it]
{'loss': 0.5222, 'learning_rate': 1.7460536548747999e-06, 'rewards/chosen': -1.449715495109558, 'rewards/rejected': -1.9594168663024902, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5097013711929321, 'policy_logps/rejected': -338.6397705078125, 'policy_logps/chosen': -577.7900390625, 'referece_logps/rejected': -319.04559326171875, 'referece_logps/chosen': -563.2929077148438, 'logits/rejected': -1.065281629562378, 'logits/chosen': -1.3181054592132568, 'epoch': 1.53}


 26%|██▌       | 4109/16104 [19:03:30<42:17:35, 12.69s/it]

 26%|██▌       | 4110/16104 [19:03:44<44:22:36, 13.32s/it]

 26%|██▌       | 4111/16104 [19:04:04<51:04:39, 15.33s/it]

 26%|██▌       | 4112/16104 [19:04:15<46:23:39, 13.93s/it]

 26%|██▌       | 4113/16104 [19:04:28<45:49:58, 13.76s/it]

 26%|██▌       | 4114/16104 [19:04:47<50:35:26, 15.19s/it]

 26%|██▌       | 4115/16104 [19:05:01<49:15:52, 14.79s/it]

 26%|██▌       | 4116/16104 [19:05:21<54:55:01, 16.49s/it]

 26%|██▌       | 4117/16104 [19:05:42<58:44:00, 17.64s/it]
{'loss': 0.5068, 'learning_rate': 1.7447128753427864e-06, 'rewards/chosen': -0.6350553631782532, 'rewards/rejected': -1.2170960903167725, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5820407867431641, 'policy_logps/rejected': -348.6062316894531, 'policy_logps/chosen': -292.7612609863281, 'referece_logps/rejected': -336.43524169921875, 'referece_logps/chosen': -286.4106750488281, 'logits/rejected': -0.5830793380737305, 'logits/chosen': -0.5046966075897217, 'epoch': 1.53}


 26%|██▌       | 4119/16104 [19:06:09<51:22:43, 15.43s/it]

 26%|██▌       | 4120/16104 [19:06:27<53:21:48, 16.03s/it]

 26%|██▌       | 4121/16104 [19:06:41<52:04:38, 15.65s/it]
{'loss': 0.5789, 'learning_rate': 1.7441757197271133e-06, 'rewards/chosen': -0.7027555108070374, 'rewards/rejected': -1.8200554847717285, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1172999143600464, 'policy_logps/rejected': -434.48114013671875, 'policy_logps/chosen': -562.3865356445312, 'referece_logps/rejected': -416.2806091308594, 'referece_logps/chosen': -555.3590087890625, 'logits/rejected': -1.4365090131759644, 'logits/chosen': -1.4925702810287476, 'epoch': 1.54}

 26%|██▌       | 4122/16104 [19:06:56<51:06:11, 15.35s/it]


 26%|██▌       | 4124/16104 [19:07:21<46:20:54, 13.93s/it]

 26%|██▌       | 4125/16104 [19:07:38<49:02:23, 14.74s/it]

 26%|██▌       | 4126/16104 [19:07:49<45:19:41, 13.62s/it]

 26%|██▌       | 4127/16104 [19:08:05<47:59:08, 14.42s/it]

 26%|██▌       | 4128/16104 [19:08:26<54:28:03, 16.37s/it]

 26%|██▌       | 4129/16104 [19:08:42<54:15:58, 16.31s/it]

 26%|██▌       | 4130/16104 [19:09:03<59:14:33, 17.81s/it]
{'loss': 0.576, 'learning_rate': 1.7429653590827883e-06, 'rewards/chosen': -0.8461626768112183, 'rewards/rejected': -1.8205357789993286, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9743729829788208, 'policy_logps/rejected': -467.623046875, 'policy_logps/chosen': -379.51092529296875, 'referece_logps/rejected': -449.4176940917969, 'referece_logps/chosen': -371.04925537109375, 'logits/rejected': -0.014718309976160526, 'logits/chosen': 0.08786492794752121, 'epoch': 1.54}


 26%|██▌       | 4132/16104 [19:09:42<60:35:50, 18.22s/it]

 26%|██▌       | 4133/16104 [19:09:54<55:01:09, 16.55s/it]

 26%|██▌       | 4134/16104 [19:10:14<57:57:46, 17.43s/it]

 26%|██▌       | 4135/16104 [19:10:36<62:49:58, 18.90s/it]

 26%|██▌       | 4136/16104 [19:10:58<65:48:28, 19.80s/it]
{'loss': 0.5523, 'learning_rate': 1.7421570992994447e-06, 'rewards/chosen': -0.6824593544006348, 'rewards/rejected': -1.923535943031311, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2410764694213867, 'policy_logps/rejected': -400.1232604980469, 'policy_logps/chosen': -302.43109130859375, 'referece_logps/rejected': -380.88787841796875, 'referece_logps/chosen': -295.60650634765625, 'logits/rejected': 0.6669878959655762, 'logits/chosen': 0.6768689155578613, 'epoch': 1.54}

 26%|██▌       | 4137/16104 [19:11:13<61:14:51, 18.42s/it]


 26%|██▌       | 4139/16104 [19:11:50<60:43:56, 18.27s/it]

 26%|██▌       | 4140/16104 [19:12:12<64:54:38, 19.53s/it]
[2024-04-08 08:18:53,279] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4745, 'learning_rate': 1.7416176589396514e-06, 'rewards/chosen': -0.8029539585113525, 'rewards/rejected': -2.0479984283447266, 'rewards/accuracies': 0.75, 'rewards/margins': 1.245044469833374, 'policy_logps/rejected': -513.5748901367188, 'policy_logps/chosen': -310.0199890136719, 'referece_logps/rejected': -493.09490966796875, 'referece_logps/chosen': -301.9904479980469, 'logits/rejected': -0.029967278242111206, 'logits/chosen': 0.14516085386276245, 'epoch': 1.54}

 26%|██▌       | 4141/16104 [19:12:31<64:18:51, 19.35s/it]
[2024-04-08 08:19:28,373] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 26%|██▌       | 4142/16104 [19:12:47<61:07:12, 18.39s/it]

 26%|██▌       | 4143/16104 [19:13:09<64:04:51, 19.29s/it]


 26%|██▌       | 4145/16104 [19:13:48<64:52:12, 19.53s/it]

 26%|██▌       | 4146/16104 [19:14:00<56:51:07, 17.12s/it]

 26%|██▌       | 4147/16104 [19:14:13<52:20:05, 15.76s/it]
{'loss': 0.5193, 'learning_rate': 1.7406724835296043e-06, 'rewards/chosen': -0.6042019724845886, 'rewards/rejected': -1.1822746992111206, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5780726671218872, 'policy_logps/rejected': -354.0333557128906, 'policy_logps/chosen': -456.62518310546875, 'referece_logps/rejected': -342.2106018066406, 'referece_logps/chosen': -450.5831604003906, 'logits/rejected': 0.2768840789794922, 'logits/chosen': 0.16041600704193115, 'epoch': 1.55}

 26%|██▌       | 4148/16104 [19:14:35<58:47:28, 17.70s/it]

 26%|██▌       | 4149/16104 [19:14:55<60:58:35, 18.36s/it]
[2024-04-08 08:21:50,524] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 26%|██▌       | 4150/16104 [19:15:09<57:26:13, 17.30s/it]

 26%|██▌       | 4151/16104 [19:15:23<53:53:22, 16.23s/it]


 26%|██▌       | 4153/16104 [19:15:58<55:07:02, 16.60s/it]

 26%|██▌       | 4154/16104 [19:16:14<54:42:13, 16.48s/it]
{'loss': 0.4174, 'learning_rate': 1.7397258400051347e-06, 'rewards/chosen': -0.8633747100830078, 'rewards/rejected': -1.825535535812378, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9621608257293701, 'policy_logps/rejected': -261.9986572265625, 'policy_logps/chosen': -388.0906982421875, 'referece_logps/rejected': -243.7432861328125, 'referece_logps/chosen': -379.4569396972656, 'logits/rejected': 0.020699769258499146, 'logits/chosen': -0.15704452991485596, 'epoch': 1.55}


 26%|██▌       | 4156/16104 [19:16:53<59:59:49, 18.08s/it]
[2024-04-08 08:23:33,619] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.4287, 'learning_rate': 1.7394551010355558e-06, 'rewards/chosen': -1.0737295150756836, 'rewards/rejected': -1.7941688299179077, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7204392552375793, 'policy_logps/rejected': -286.96746826171875, 'policy_logps/chosen': -528.958251953125, 'referece_logps/rejected': -269.0257873535156, 'referece_logps/chosen': -518.2208862304688, 'logits/rejected': -0.577761173248291, 'logits/chosen': -0.6519132256507874, 'epoch': 1.55}

 26%|██▌       | 4157/16104 [19:17:13<62:04:46, 18.71s/it]


 26%|██▌       | 4159/16104 [19:17:42<55:42:58, 16.79s/it]

 26%|██▌       | 4160/16104 [19:18:02<58:37:10, 17.67s/it]
{'loss': 0.4864, 'learning_rate': 1.7389132641928883e-06, 'rewards/chosen': -0.8993320465087891, 'rewards/rejected': -1.1576435565948486, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2583114504814148, 'policy_logps/rejected': -365.6893005371094, 'policy_logps/chosen': -392.9810485839844, 'referece_logps/rejected': -354.1128845214844, 'referece_logps/chosen': -383.98773193359375, 'logits/rejected': -0.29687032103538513, 'logits/chosen': -0.3699745833873749, 'epoch': 1.55}

 26%|██▌       | 4161/16104 [19:18:16<54:25:03, 16.40s/it]

 26%|██▌       | 4162/16104 [19:18:28<50:01:50, 15.08s/it]

 26%|██▌       | 4163/16104 [19:18:47<54:26:24, 16.41s/it]


 26%|██▌       | 4165/16104 [19:19:16<49:56:07, 15.06s/it]

 26%|██▌       | 4166/16104 [19:19:31<49:45:07, 15.00s/it]
{'loss': 0.5956, 'learning_rate': 1.7380996123278045e-06, 'rewards/chosen': -1.081390619277954, 'rewards/rejected': -1.6320799589157104, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5506894588470459, 'policy_logps/rejected': -330.0190734863281, 'policy_logps/chosen': -354.7960205078125, 'referece_logps/rejected': -313.6982727050781, 'referece_logps/chosen': -343.98211669921875, 'logits/rejected': -0.5920363664627075, 'logits/chosen': -0.6033619046211243, 'epoch': 1.55}

 26%|██▌       | 4167/16104 [19:19:49<53:14:44, 16.06s/it]


 26%|██▌       | 4169/16104 [19:20:16<48:07:29, 14.52s/it]

 26%|██▌       | 4170/16104 [19:20:32<49:34:29, 14.95s/it]

 26%|██▌       | 4171/16104 [19:20:51<53:04:46, 16.01s/it]

 26%|██▌       | 4172/16104 [19:21:07<52:56:07, 15.97s/it]
{'loss': 0.5656, 'learning_rate': 1.7372848855947757e-06, 'rewards/chosen': -0.7530023455619812, 'rewards/rejected': -1.180746078491211, 'rewards/accuracies': 0.625, 'rewards/margins': 0.42774373292922974, 'policy_logps/rejected': -439.6236877441406, 'policy_logps/chosen': -457.77032470703125, 'referece_logps/rejected': -427.81622314453125, 'referece_logps/chosen': -450.24029541015625, 'logits/rejected': -0.8709335327148438, 'logits/chosen': -0.9210680723190308, 'epoch': 1.55}

 26%|██▌       | 4173/16104 [19:21:24<53:45:14, 16.22s/it]

 26%|██▌       | 4174/16104 [19:21:42<55:44:52, 16.82s/it]


 26%|██▌       | 4176/16104 [19:22:22<61:16:31, 18.49s/it]

 26%|██▌       | 4177/16104 [19:22:35<55:13:45, 16.67s/it]
{'loss': 0.557, 'learning_rate': 1.7366051264268275e-06, 'rewards/chosen': -1.397447109222412, 'rewards/rejected': -1.814841628074646, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4173944592475891, 'policy_logps/rejected': -227.00184631347656, 'policy_logps/chosen': -277.7880554199219, 'referece_logps/rejected': -208.8534393310547, 'referece_logps/chosen': -263.8135986328125, 'logits/rejected': -0.7268669605255127, 'logits/chosen': -0.8505343198776245, 'epoch': 1.56}

 26%|██▌       | 4178/16104 [19:22:50<53:36:29, 16.18s/it]

 26%|██▌       | 4179/16104 [19:23:05<53:05:36, 16.03s/it]

 26%|██▌       | 4180/16104 [19:23:28<59:29:17, 17.96s/it]


 26%|██▌       | 4182/16104 [19:23:55<51:55:47, 15.68s/it]

 26%|██▌       | 4183/16104 [19:24:07<48:16:14, 14.58s/it]
{'loss': 0.4401, 'learning_rate': 1.7357884321851865e-06, 'rewards/chosen': -0.8527591824531555, 'rewards/rejected': -1.1920690536499023, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3393098711967468, 'policy_logps/rejected': -275.3616943359375, 'policy_logps/chosen': -308.7916564941406, 'referece_logps/rejected': -263.44097900390625, 'referece_logps/chosen': -300.2640380859375, 'logits/rejected': -1.201777458190918, 'logits/chosen': -1.2060976028442383, 'epoch': 1.56}


 26%|██▌       | 4185/16104 [19:24:33<45:23:54, 13.71s/it]

 26%|██▌       | 4186/16104 [19:24:46<45:07:14, 13.63s/it]

 26%|██▌       | 4187/16104 [19:25:05<49:59:01, 15.10s/it]

 26%|██▌       | 4188/16104 [19:25:16<46:28:32, 14.04s/it]
{'loss': 0.4515, 'learning_rate': 1.7351070350912976e-06, 'rewards/chosen': -0.9768012762069702, 'rewards/rejected': -2.2278854846954346, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2510840892791748, 'policy_logps/rejected': -307.4119567871094, 'policy_logps/chosen': -432.076171875, 'referece_logps/rejected': -285.13311767578125, 'referece_logps/chosen': -422.30816650390625, 'logits/rejected': -0.8420668244361877, 'logits/chosen': -0.8374438881874084, 'epoch': 1.56}

 26%|██▌       | 4189/16104 [19:25:36<52:10:00, 15.76s/it]

 26%|██▌       | 4190/16104 [19:25:49<49:44:13, 15.03s/it]


 26%|██▌       | 4192/16104 [19:26:29<57:14:30, 17.30s/it]
{'loss': 0.4128, 'learning_rate': 1.7345613821280836e-06, 'rewards/chosen': -0.6662863492965698, 'rewards/rejected': -1.502776861190796, 'rewards/accuracies': 0.875, 'rewards/margins': 0.836490273475647, 'policy_logps/rejected': -359.17425537109375, 'policy_logps/chosen': -306.76519775390625, 'referece_logps/rejected': -344.146484375, 'referece_logps/chosen': -300.10235595703125, 'logits/rejected': -1.0080710649490356, 'logits/chosen': -1.1034718751907349, 'epoch': 1.56}


 26%|██▌       | 4194/16104 [19:27:05<57:58:19, 17.52s/it]

 26%|██▌       | 4195/16104 [19:27:25<60:04:25, 18.16s/it]
{'loss': 0.4747, 'learning_rate': 1.734151830386017e-06, 'rewards/chosen': -1.0468971729278564, 'rewards/rejected': -1.7305622100830078, 'rewards/accuracies': 0.5, 'rewards/margins': 0.6836650371551514, 'policy_logps/rejected': -332.0290832519531, 'policy_logps/chosen': -315.3086242675781, 'referece_logps/rejected': -314.72344970703125, 'referece_logps/chosen': -304.83966064453125, 'logits/rejected': -0.5195294618606567, 'logits/chosen': -0.483417272567749, 'epoch': 1.56}
[2024-04-08 08:34:26,858] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 26%|██▌       | 4197/16104 [19:28:01<59:22:27, 17.95s/it]
[2024-04-08 08:34:42,319] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 26%|██▌       | 4198/16104 [19:28:21<60:54:35, 18.42s/it]

 26%|██▌       | 4199/16104 [19:28:43<64:44:10, 19.58s/it]
{'loss': 0.4988, 'learning_rate': 1.7336053456538686e-06, 'rewards/chosen': -1.2546181678771973, 'rewards/rejected': -1.8954854011535645, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6408671736717224, 'policy_logps/rejected': -350.6350402832031, 'policy_logps/chosen': -447.03228759765625, 'referece_logps/rejected': -331.68017578125, 'referece_logps/chosen': -434.48614501953125, 'logits/rejected': -0.5732465982437134, 'logits/chosen': -0.6084378957748413, 'epoch': 1.56}

 26%|██▌       | 4200/16104 [19:28:58<60:34:59, 18.32s/it]


 26%|██▌       | 4202/16104 [19:29:29<56:49:02, 17.19s/it]

 26%|██▌       | 4203/16104 [19:29:49<59:17:08, 17.93s/it]

 26%|██▌       | 4204/16104 [19:30:01<53:41:12, 16.24s/it]
{'loss': 0.6212, 'learning_rate': 1.732921572078175e-06, 'rewards/chosen': -1.328416109085083, 'rewards/rejected': -1.6452937126159668, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3168776035308838, 'policy_logps/rejected': -282.0685119628906, 'policy_logps/chosen': -326.3428955078125, 'referece_logps/rejected': -265.6155700683594, 'referece_logps/chosen': -313.0587158203125, 'logits/rejected': -0.5496914982795715, 'logits/chosen': -0.3965193033218384, 'epoch': 1.57}

 26%|██▌       | 4205/16104 [19:30:21<56:38:25, 17.14s/it]


 26%|██▌       | 4207/16104 [19:30:57<58:26:10, 17.68s/it]
{'loss': 0.5602, 'learning_rate': 1.732510952112675e-06, 'rewards/chosen': -1.129008173942566, 'rewards/rejected': -2.7666616439819336, 'rewards/accuracies': 0.625, 'rewards/margins': 1.6376535892486572, 'policy_logps/rejected': -521.5729370117188, 'policy_logps/chosen': -397.8845520019531, 'referece_logps/rejected': -493.9062805175781, 'referece_logps/chosen': -386.5944519042969, 'logits/rejected': -0.35677218437194824, 'logits/chosen': -0.2139485627412796, 'epoch': 1.57}


 26%|██▌       | 4209/16104 [19:31:34<59:57:18, 18.15s/it]
{'loss': 0.5335, 'learning_rate': 1.7322370573029047e-06, 'rewards/chosen': -0.3646125793457031, 'rewards/rejected': -1.1760096549987793, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8113969564437866, 'policy_logps/rejected': -353.0594482421875, 'policy_logps/chosen': -321.57940673828125, 'referece_logps/rejected': -341.29937744140625, 'referece_logps/chosen': -317.9332580566406, 'logits/rejected': 0.39165180921554565, 'logits/chosen': 0.3633470833301544, 'epoch': 1.57}


 26%|██▌       | 4211/16104 [19:32:03<53:10:51, 16.10s/it]
{'loss': 0.5148, 'learning_rate': 1.7319630440119526e-06, 'rewards/chosen': -0.9910299777984619, 'rewards/rejected': -1.5362221002578735, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5451921224594116, 'policy_logps/rejected': -366.84619140625, 'policy_logps/chosen': -326.4055480957031, 'referece_logps/rejected': -351.4839782714844, 'referece_logps/chosen': -316.4952392578125, 'logits/rejected': -0.82269287109375, 'logits/chosen': -0.8441148996353149, 'epoch': 1.57}

 26%|██▌       | 4212/16104 [19:32:18<51:36:44, 15.62s/it]
[2024-04-08 08:39:17,496] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 26%|██▌       | 4213/16104 [19:32:36<54:39:17, 16.55s/it]

 26%|██▌       | 4214/16104 [19:32:58<59:32:34, 18.03s/it]

 26%|██▌       | 4215/16104 [19:33:12<55:37:12, 16.84s/it]

 26%|██▌       | 4216/16104 [19:33:32<58:35:06, 17.74s/it]

 26%|██▌       | 4217/16104 [19:33:51<59:44:37, 18.09s/it]

 26%|██▌       | 4218/16104 [19:34:04<54:45:47, 16.59s/it]


 26%|██▌       | 4220/16104 [19:34:35<52:11:34, 15.81s/it]

 26%|██▌       | 4221/16104 [19:34:53<53:48:17, 16.30s/it]
{'loss': 0.5713, 'learning_rate': 1.7305912018919491e-06, 'rewards/chosen': -0.9801100492477417, 'rewards/rejected': -1.6561768054962158, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6760666370391846, 'policy_logps/rejected': -322.20849609375, 'policy_logps/chosen': -371.27117919921875, 'referece_logps/rejected': -305.646728515625, 'referece_logps/chosen': -361.47003173828125, 'logits/rejected': -1.3174761533737183, 'logits/chosen': -1.0901806354522705, 'epoch': 1.57}


 26%|██▌       | 4223/16104 [19:35:26<54:56:17, 16.65s/it]
{'loss': 0.5465, 'learning_rate': 1.730316478645663e-06, 'rewards/chosen': -1.01094651222229, 'rewards/rejected': -1.1185935735702515, 'rewards/accuracies': 0.5, 'rewards/margins': 0.10764701664447784, 'policy_logps/rejected': -434.211181640625, 'policy_logps/chosen': -326.6708984375, 'referece_logps/rejected': -423.0252685546875, 'referece_logps/chosen': -316.56146240234375, 'logits/rejected': -1.5565977096557617, 'logits/chosen': -1.5648590326309204, 'epoch': 1.57}


 26%|██▌       | 4225/16104 [19:36:01<57:47:19, 17.51s/it]

 26%|██▌       | 4226/16104 [19:36:20<58:28:52, 17.72s/it]
{'loss': 0.4651, 'learning_rate': 1.7299041722205966e-06, 'rewards/chosen': -0.8296818137168884, 'rewards/rejected': -1.5438544750213623, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7141727209091187, 'policy_logps/rejected': -488.0855407714844, 'policy_logps/chosen': -467.25299072265625, 'referece_logps/rejected': -472.64703369140625, 'referece_logps/chosen': -458.95623779296875, 'logits/rejected': 0.38808363676071167, 'logits/chosen': 0.4322013556957245, 'epoch': 1.57}

 26%|██▌       | 4227/16104 [19:36:36<57:21:24, 17.39s/it]

 26%|██▋       | 4228/16104 [19:36:55<58:38:35, 17.78s/it]

 26%|██▋       | 4229/16104 [19:37:09<54:50:41, 16.63s/it]

 26%|██▋       | 4230/16104 [19:37:27<56:08:49, 17.02s/it]


 26%|██▋       | 4232/16104 [19:38:06<60:12:08, 18.26s/it]

 26%|██▋       | 4233/16104 [19:38:26<61:43:22, 18.72s/it]

 26%|██▋       | 4234/16104 [19:38:45<62:47:01, 19.04s/it]
{'loss': 0.493, 'learning_rate': 1.7288033896877026e-06, 'rewards/chosen': -1.1278327703475952, 'rewards/rejected': -2.225219488143921, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0973865985870361, 'policy_logps/rejected': -281.6777648925781, 'policy_logps/chosen': -275.2270202636719, 'referece_logps/rejected': -259.4255676269531, 'referece_logps/chosen': -263.94873046875, 'logits/rejected': -1.0367411375045776, 'logits/chosen': -1.0482206344604492, 'epoch': 1.58}


 26%|██▋       | 4236/16104 [19:39:17<57:10:36, 17.34s/it]
{'loss': 0.4627, 'learning_rate': 1.728527899129136e-06, 'rewards/chosen': -1.0495847463607788, 'rewards/rejected': -1.5162593126296997, 'rewards/accuracies': 0.75, 'rewards/margins': 0.46667444705963135, 'policy_logps/rejected': -201.26548767089844, 'policy_logps/chosen': -320.92669677734375, 'referece_logps/rejected': -186.10287475585938, 'referece_logps/chosen': -310.43084716796875, 'logits/rejected': -0.899767279624939, 'logits/chosen': -0.9478759169578552, 'epoch': 1.58}

 26%|██▋       | 4237/16104 [19:39:37<59:28:32, 18.04s/it]

 26%|██▋       | 4238/16104 [19:39:49<53:29:31, 16.23s/it]


 26%|██▋       | 4240/16104 [19:40:26<57:07:28, 17.33s/it]

 26%|██▋       | 4241/16104 [19:40:42<55:36:24, 16.87s/it]
{'loss': 0.471, 'learning_rate': 1.7278386571008454e-06, 'rewards/chosen': -1.4182885885238647, 'rewards/rejected': -2.7602009773254395, 'rewards/accuracies': 1.0, 'rewards/margins': 1.3419123888015747, 'policy_logps/rejected': -637.2371826171875, 'policy_logps/chosen': -647.996337890625, 'referece_logps/rejected': -609.6351928710938, 'referece_logps/chosen': -633.8135375976562, 'logits/rejected': -0.4851570129394531, 'logits/chosen': -0.4829639494419098, 'epoch': 1.58}

 26%|██▋       | 4242/16104 [19:41:01<57:26:08, 17.43s/it]

 26%|██▋       | 4243/16104 [19:41:19<58:40:24, 17.81s/it]

 26%|██▋       | 4244/16104 [19:41:33<54:15:54, 16.47s/it]

 26%|██▋       | 4245/16104 [19:41:52<56:58:17, 17.29s/it]

 26%|██▋       | 4246/16104 [19:42:11<58:42:03, 17.82s/it]

 26%|██▋       | 4247/16104 [19:42:33<62:35:00, 19.00s/it]

 26%|██▋       | 4248/16104 [19:42:48<58:53:12, 17.88s/it]

 26%|██▋       | 4249/16104 [19:43:00<52:48:08, 16.03s/it]

 26%|██▋       | 4250/16104 [19:43:11<48:28:10, 14.72s/it]

 26%|██▋       | 4251/16104 [19:43:24<46:06:39, 14.00s/it]

 26%|██▋       | 4252/16104 [19:43:35<43:51:35, 13.32s/it]

 26%|██▋       | 4253/16104 [19:43:48<43:01:37, 13.07s/it]

 26%|██▋       | 4254/16104 [19:44:10<51:57:32, 15.79s/it]

 26%|██▋       | 4255/16104 [19:44:27<53:35:07, 16.28s/it]

 26%|██▋       | 4256/16104 [19:44:47<57:16:04, 17.40s/it]
[2024-04-08 08:51:50,018] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 26%|██▋       | 4257/16104 [19:45:09<61:24:33, 18.66s/it]

 26%|██▋       | 4258/16104 [19:45:22<55:55:04, 16.99s/it]

 26%|██▋       | 4259/16104 [19:45:33<50:00:30, 15.20s/it]


 26%|██▋       | 4261/16104 [19:46:09<53:36:25, 16.30s/it]
{'loss': 0.5994, 'learning_rate': 1.7250743353765817e-06, 'rewards/chosen': -0.9850165843963623, 'rewards/rejected': -1.5285813808441162, 'rewards/accuracies': 0.375, 'rewards/margins': 0.5435647368431091, 'policy_logps/rejected': -512.1117553710938, 'policy_logps/chosen': -489.6092834472656, 'referece_logps/rejected': -496.825927734375, 'referece_logps/chosen': -479.7591552734375, 'logits/rejected': -0.07742631435394287, 'logits/chosen': -0.06057141721248627, 'epoch': 1.59}

 26%|██▋       | 4262/16104 [19:46:25<53:50:12, 16.37s/it]

 26%|██▋       | 4263/16104 [19:46:40<52:07:42, 15.85s/it]

 26%|██▋       | 4264/16104 [19:46:57<53:24:56, 16.24s/it]
[2024-04-08 08:53:58,575] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 26%|██▋       | 4265/16104 [19:47:18<57:46:27, 17.57s/it]

 26%|██▋       | 4266/16104 [19:47:34<56:37:45, 17.22s/it]

 26%|██▋       | 4267/16104 [19:47:52<57:21:43, 17.45s/it]

 27%|██▋       | 4268/16104 [19:48:08<55:37:41, 16.92s/it]


 27%|██▋       | 4270/16104 [19:48:50<62:59:59, 19.17s/it]
{'loss': 0.5003, 'learning_rate': 1.7238265602866435e-06, 'rewards/chosen': -0.7723499536514282, 'rewards/rejected': -1.8493183851242065, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0769684314727783, 'policy_logps/rejected': -473.2253723144531, 'policy_logps/chosen': -415.1630859375, 'referece_logps/rejected': -454.732177734375, 'referece_logps/chosen': -407.4395751953125, 'logits/rejected': -0.32980701327323914, 'logits/chosen': -0.23410984873771667, 'epoch': 1.59}

 27%|██▋       | 4271/16104 [19:49:08<61:31:32, 18.72s/it]


 27%|██▋       | 4273/16104 [19:49:45<60:22:42, 18.37s/it]
{'loss': 0.5541, 'learning_rate': 1.723410108013315e-06, 'rewards/chosen': -1.057932734489441, 'rewards/rejected': -2.10545015335083, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0475174188613892, 'policy_logps/rejected': -358.6070251464844, 'policy_logps/chosen': -364.54449462890625, 'referece_logps/rejected': -337.55255126953125, 'referece_logps/chosen': -353.9652099609375, 'logits/rejected': -0.6389940977096558, 'logits/chosen': -0.7631288766860962, 'epoch': 1.59}

 27%|██▋       | 4274/16104 [19:49:58<55:10:22, 16.79s/it]

 27%|██▋       | 4275/16104 [19:50:15<55:34:13, 16.91s/it]

 27%|██▋       | 4276/16104 [19:50:31<54:39:05, 16.63s/it]


 27%|██▋       | 4278/16104 [19:51:01<51:38:53, 15.72s/it]

 27%|██▋       | 4279/16104 [19:51:13<47:59:54, 14.61s/it]
{'loss': 0.5857, 'learning_rate': 1.7225764135111866e-06, 'rewards/chosen': -1.4259625673294067, 'rewards/rejected': -1.8093079328536987, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3833453059196472, 'policy_logps/rejected': -436.7047119140625, 'policy_logps/chosen': -372.84393310546875, 'referece_logps/rejected': -418.6116027832031, 'referece_logps/chosen': -358.5843200683594, 'logits/rejected': -0.14682798087596893, 'logits/chosen': -0.01851080171763897, 'epoch': 1.59}

 27%|██▋       | 4280/16104 [19:51:25<45:51:03, 13.96s/it]


 27%|██▋       | 4282/16104 [19:52:09<58:50:56, 17.92s/it]
{'loss': 0.5613, 'learning_rate': 1.722159171585907e-06, 'rewards/chosen': -0.973785400390625, 'rewards/rejected': -1.1870802640914917, 'rewards/accuracies': 0.5, 'rewards/margins': 0.21329481899738312, 'policy_logps/rejected': -340.4837341308594, 'policy_logps/chosen': -340.4485168457031, 'referece_logps/rejected': -328.6129455566406, 'referece_logps/chosen': -330.710693359375, 'logits/rejected': -0.5595988035202026, 'logits/chosen': -0.477377325296402, 'epoch': 1.6}

 27%|██▋       | 4283/16104 [19:52:28<59:59:33, 18.27s/it]

 27%|██▋       | 4284/16104 [19:52:42<56:04:48, 17.08s/it]

 27%|██▋       | 4285/16104 [19:52:58<54:42:37, 16.66s/it]


 27%|██▋       | 4287/16104 [19:53:23<47:21:26, 14.43s/it]
{'loss': 0.58, 'learning_rate': 1.7214631841996372e-06, 'rewards/chosen': -0.6728495955467224, 'rewards/rejected': -1.2402088642120361, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5673592686653137, 'policy_logps/rejected': -466.78131103515625, 'policy_logps/chosen': -321.3108215332031, 'referece_logps/rejected': -454.3792419433594, 'referece_logps/chosen': -314.58233642578125, 'logits/rejected': -1.1632707118988037, 'logits/chosen': -1.3774386644363403, 'epoch': 1.6}


 27%|██▋       | 4289/16104 [19:53:55<48:55:08, 14.91s/it]
{'loss': 0.487, 'learning_rate': 1.7211845849143927e-06, 'rewards/chosen': -0.7561664581298828, 'rewards/rejected': -1.5439682006835938, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7878017425537109, 'policy_logps/rejected': -276.1900329589844, 'policy_logps/chosen': -286.74603271484375, 'referece_logps/rejected': -260.7503356933594, 'referece_logps/chosen': -279.1843566894531, 'logits/rejected': -0.936733067035675, 'logits/chosen': -1.0113245248794556, 'epoch': 1.6}

 27%|██▋       | 4290/16104 [19:54:06<45:00:17, 13.71s/it]

 27%|██▋       | 4291/16104 [19:54:17<42:10:21, 12.85s/it]

 27%|██▋       | 4292/16104 [19:54:27<40:07:44, 12.23s/it]

 27%|██▋       | 4293/16104 [19:54:49<48:57:07, 14.92s/it]

 27%|██▋       | 4294/16104 [19:55:02<47:51:43, 14.59s/it]

 27%|██▋       | 4295/16104 [19:55:14<44:27:52, 13.56s/it]

 27%|██▋       | 4296/16104 [19:55:24<41:38:13, 12.69s/it]


 27%|██▋       | 4298/16104 [19:55:59<49:58:51, 15.24s/it]
{'loss': 0.4282, 'learning_rate': 1.7199294447085148e-06, 'rewards/chosen': -1.013887643814087, 'rewards/rejected': -1.980973482131958, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9670857191085815, 'policy_logps/rejected': -387.9371337890625, 'policy_logps/chosen': -423.2855224609375, 'referece_logps/rejected': -368.1274108886719, 'referece_logps/chosen': -413.1466369628906, 'logits/rejected': -0.7827441692352295, 'logits/chosen': -0.7230036854743958, 'epoch': 1.6}

 27%|██▋       | 4299/16104 [19:56:17<52:07:03, 15.89s/it]


 27%|██▋       | 4301/16104 [19:56:51<53:33:37, 16.34s/it]
{'loss': 0.4979, 'learning_rate': 1.7195105402329632e-06, 'rewards/chosen': -1.242261528968811, 'rewards/rejected': -1.4754499197006226, 'rewards/accuracies': 0.75, 'rewards/margins': 0.23318824172019958, 'policy_logps/rejected': -316.4968566894531, 'policy_logps/chosen': -384.0343322753906, 'referece_logps/rejected': -301.74237060546875, 'referece_logps/chosen': -371.6116943359375, 'logits/rejected': 0.27683889865875244, 'logits/chosen': 0.21435056626796722, 'epoch': 1.6}

 27%|██▋       | 4302/16104 [19:57:08<54:41:48, 16.68s/it]

 27%|██▋       | 4303/16104 [19:57:23<52:18:23, 15.96s/it]

 27%|██▋       | 4304/16104 [19:57:42<55:53:56, 17.05s/it]


 27%|██▋       | 4306/16104 [19:58:09<49:36:00, 15.13s/it]
{'loss': 0.4785, 'learning_rate': 1.71881178407271e-06, 'rewards/chosen': -1.1241979598999023, 'rewards/rejected': -2.160850763320923, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0366525650024414, 'policy_logps/rejected': -580.2977905273438, 'policy_logps/chosen': -445.1905822753906, 'referece_logps/rejected': -558.6893310546875, 'referece_logps/chosen': -433.9486083984375, 'logits/rejected': -1.31417715549469, 'logits/chosen': -1.1208994388580322, 'epoch': 1.6}

 27%|██▋       | 4307/16104 [19:58:25<50:52:56, 15.53s/it]

 27%|██▋       | 4308/16104 [19:58:37<46:39:34, 14.24s/it]

 27%|██▋       | 4309/16104 [19:58:51<46:42:06, 14.25s/it]

 27%|██▋       | 4310/16104 [19:59:04<45:32:31, 13.90s/it]

 27%|██▋       | 4311/16104 [19:59:19<46:22:32, 14.16s/it]

 27%|██▋       | 4312/16104 [19:59:37<50:00:28, 15.27s/it]

 27%|██▋       | 4313/16104 [19:59:57<54:35:27, 16.67s/it]

 27%|██▋       | 4314/16104 [20:00:16<57:30:39, 17.56s/it]

 27%|██▋       | 4315/16104 [20:00:38<62:00:50, 18.94s/it]

 27%|██▋       | 4316/16104 [20:00:58<63:04:43, 19.26s/it]

 27%|██▋       | 4317/16104 [20:01:09<54:39:43, 16.69s/it]

 27%|██▋       | 4318/16104 [20:01:22<50:30:21, 15.43s/it]

 27%|██▋       | 4319/16104 [20:01:38<51:07:24, 15.62s/it]

 27%|██▋       | 4320/16104 [20:01:54<51:49:07, 15.83s/it]

 27%|██▋       | 4321/16104 [20:02:14<56:07:36, 17.15s/it]


 27%|██▋       | 4323/16104 [20:02:47<55:59:37, 17.11s/it]
{'loss': 0.4954, 'learning_rate': 1.7164305799227857e-06, 'rewards/chosen': -1.2610704898834229, 'rewards/rejected': -1.9664238691329956, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7053531408309937, 'policy_logps/rejected': -307.03619384765625, 'policy_logps/chosen': -401.88525390625, 'referece_logps/rejected': -287.3719482421875, 'referece_logps/chosen': -389.2745361328125, 'logits/rejected': -0.28946441411972046, 'logits/chosen': -0.3829021155834198, 'epoch': 1.61}

 27%|██▋       | 4324/16104 [20:03:04<55:47:10, 17.05s/it]

 27%|██▋       | 4325/16104 [20:03:24<58:43:15, 17.95s/it]

 27%|██▋       | 4326/16104 [20:03:41<57:17:01, 17.51s/it]

 27%|██▋       | 4327/16104 [20:03:59<57:59:16, 17.73s/it]


 27%|██▋       | 4329/16104 [20:04:33<56:30:26, 17.28s/it]
{'loss': 0.4863, 'learning_rate': 1.715588153812357e-06, 'rewards/chosen': -0.7040477395057678, 'rewards/rejected': -1.2522944211959839, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5482467412948608, 'policy_logps/rejected': -372.3436279296875, 'policy_logps/chosen': -538.7313232421875, 'referece_logps/rejected': -359.8206787109375, 'referece_logps/chosen': -531.6908569335938, 'logits/rejected': 0.32132208347320557, 'logits/chosen': 0.6227731704711914, 'epoch': 1.61}


 27%|██▋       | 4331/16104 [20:05:10<56:59:51, 17.43s/it]
{'loss': 0.5058, 'learning_rate': 1.7153071134737394e-06, 'rewards/chosen': -0.8104960322380066, 'rewards/rejected': -1.818162202835083, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0076662302017212, 'policy_logps/rejected': -357.6415710449219, 'policy_logps/chosen': -325.5619201660156, 'referece_logps/rejected': -339.4599609375, 'referece_logps/chosen': -317.4569396972656, 'logits/rejected': 0.03132270276546478, 'logits/chosen': 0.05820438265800476, 'epoch': 1.61}

 27%|██▋       | 4332/16104 [20:05:29<59:02:48, 18.06s/it]
[2024-04-08 09:12:31,008] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 27%|██▋       | 4334/16104 [20:06:10<62:30:45, 19.12s/it]
{'loss': 0.5056, 'learning_rate': 1.7148853359641625e-06, 'rewards/chosen': -1.1462535858154297, 'rewards/rejected': -1.658715009689331, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5124614834785461, 'policy_logps/rejected': -325.11395263671875, 'policy_logps/chosen': -489.97857666015625, 'referece_logps/rejected': -308.52679443359375, 'referece_logps/chosen': -478.5160827636719, 'logits/rejected': -0.589159369468689, 'logits/chosen': -0.6929346919059753, 'epoch': 1.61}

 27%|██▋       | 4335/16104 [20:06:31<65:03:07, 19.90s/it]

 27%|██▋       | 4336/16104 [20:06:51<64:59:23, 19.88s/it]

 27%|██▋       | 4337/16104 [20:07:13<66:51:22, 20.45s/it]

 27%|██▋       | 4338/16104 [20:07:30<63:32:14, 19.44s/it]

 27%|██▋       | 4339/16104 [20:07:45<59:06:51, 18.09s/it]


 27%|██▋       | 4341/16104 [20:08:22<60:04:15, 18.38s/it]
{'loss': 0.5788, 'learning_rate': 1.7139001765638601e-06, 'rewards/chosen': -1.3182449340820312, 'rewards/rejected': -1.5088828802108765, 'rewards/accuracies': 0.875, 'rewards/margins': 0.19063794612884521, 'policy_logps/rejected': -536.4263916015625, 'policy_logps/chosen': -449.35345458984375, 'referece_logps/rejected': -521.3375244140625, 'referece_logps/chosen': -436.1710205078125, 'logits/rejected': -0.31294286251068115, 'logits/chosen': -0.28805649280548096, 'epoch': 1.62}

 27%|██▋       | 4342/16104 [20:08:42<61:48:38, 18.92s/it]

 27%|██▋       | 4343/16104 [20:09:02<62:43:59, 19.20s/it]

 27%|██▋       | 4344/16104 [20:09:13<54:58:35, 16.83s/it]

 27%|██▋       | 4345/16104 [20:09:28<52:49:59, 16.17s/it]

 27%|██▋       | 4346/16104 [20:09:43<52:05:40, 15.95s/it]

 27%|██▋       | 4347/16104 [20:10:00<52:54:52, 16.20s/it]

 27%|██▋       | 4348/16104 [20:10:13<50:09:03, 15.36s/it]

 27%|██▋       | 4349/16104 [20:10:28<49:42:57, 15.23s/it]

 27%|██▋       | 4350/16104 [20:10:39<45:27:47, 13.92s/it]

 27%|██▋       | 4351/16104 [20:10:50<42:48:26, 13.11s/it]

 27%|██▋       | 4352/16104 [20:11:03<42:16:16, 12.95s/it]

 27%|██▋       | 4353/16104 [20:11:17<43:35:59, 13.36s/it]

 27%|██▋       | 4354/16104 [20:11:28<40:58:28, 12.55s/it]

 27%|██▋       | 4355/16104 [20:11:39<39:36:40, 12.14s/it]

 27%|██▋       | 4356/16104 [20:11:50<38:12:30, 11.71s/it]

 27%|██▋       | 4357/16104 [20:12:00<37:11:57, 11.40s/it]

 27%|██▋       | 4358/16104 [20:12:17<42:01:40, 12.88s/it]

 27%|██▋       | 4359/16104 [20:12:30<42:41:43, 13.09s/it]

 27%|██▋       | 4360/16104 [20:12:41<40:22:20, 12.38s/it]

 27%|██▋       | 4361/16104 [20:12:57<43:41:11, 13.39s/it]

 27%|██▋       | 4362/16104 [20:13:13<46:42:08, 14.32s/it]

 27%|██▋       | 4363/16104 [20:13:33<51:56:25, 15.93s/it]

 27%|██▋       | 4364/16104 [20:13:45<48:29:10, 14.87s/it]

 27%|██▋       | 4365/16104 [20:14:02<50:47:25, 15.58s/it]

 27%|██▋       | 4366/16104 [20:14:19<51:27:07, 15.78s/it]


 27%|██▋       | 4368/16104 [20:14:59<59:01:09, 18.10s/it]

 27%|██▋       | 4369/16104 [20:15:20<62:19:21, 19.12s/it]
{'loss': 0.5121, 'learning_rate': 1.7099454080515158e-06, 'rewards/chosen': -0.7575595378875732, 'rewards/rejected': -1.6644134521484375, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9068537950515747, 'policy_logps/rejected': -456.5776672363281, 'policy_logps/chosen': -393.0252685546875, 'referece_logps/rejected': -439.93359375, 'referece_logps/chosen': -385.4496154785156, 'logits/rejected': -0.5237581729888916, 'logits/chosen': -0.22313280403614044, 'epoch': 1.63}

 27%|██▋       | 4370/16104 [20:15:40<63:28:20, 19.47s/it]
[2024-04-08 09:22:43,532] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 27%|██▋       | 4371/16104 [20:16:02<65:58:24, 20.24s/it]
[2024-04-08 09:23:01,679] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 27%|██▋       | 4373/16104 [20:16:36<60:01:20, 18.42s/it]

 27%|██▋       | 4374/16104 [20:16:56<61:26:54, 18.86s/it]

 27%|██▋       | 4375/16104 [20:17:12<58:15:44, 17.88s/it]

 27%|██▋       | 4376/16104 [20:17:23<52:15:42, 16.04s/it]

 27%|██▋       | 4377/16104 [20:17:42<54:49:00, 16.83s/it]
[2024-04-08 09:24:23,210] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 27%|██▋       | 4378/16104 [20:17:58<54:04:19, 16.60s/it]

 27%|██▋       | 4379/16104 [20:18:18<56:43:55, 17.42s/it]

 27%|██▋       | 4380/16104 [20:18:39<60:15:22, 18.50s/it]

 27%|██▋       | 4381/16104 [20:18:53<56:19:33, 17.30s/it]

 27%|██▋       | 4382/16104 [20:19:12<57:59:24, 17.81s/it]

 27%|██▋       | 4383/16104 [20:19:26<54:00:27, 16.59s/it]

 27%|██▋       | 4384/16104 [20:19:43<54:58:07, 16.88s/it]

 27%|██▋       | 4385/16104 [20:20:02<56:09:56, 17.25s/it]

 27%|██▋       | 4386/16104 [20:20:23<60:00:22, 18.44s/it]

 27%|██▋       | 4387/16104 [20:20:40<59:18:25, 18.22s/it]

 27%|██▋       | 4388/16104 [20:21:00<60:40:51, 18.65s/it]

 27%|██▋       | 4389/16104 [20:21:16<58:27:59, 17.97s/it]

 27%|██▋       | 4390/16104 [20:21:36<60:10:37, 18.49s/it]
{'loss': 0.5461, 'learning_rate': 1.7069645491219352e-06, 'rewards/chosen': -1.2198940515518188, 'rewards/rejected': -1.4959534406661987, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2760593891143799, 'policy_logps/rejected': -367.44580078125, 'policy_logps/chosen': -397.7763671875, 'referece_logps/rejected': -352.4862976074219, 'referece_logps/chosen': -385.57745361328125, 'logits/rejected': -0.9572892785072327, 'logits/chosen': -1.0502488613128662, 'epoch': 1.64}


 27%|██▋       | 4392/16104 [20:22:07<54:28:15, 16.74s/it]

 27%|██▋       | 4393/16104 [20:22:26<56:30:18, 17.37s/it]

 27%|██▋       | 4394/16104 [20:22:46<59:06:09, 18.17s/it]
[2024-04-08 09:29:27,330] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 27%|██▋       | 4395/16104 [20:22:57<52:02:59, 16.00s/it]

 27%|██▋       | 4396/16104 [20:23:14<53:13:28, 16.37s/it]

 27%|██▋       | 4397/16104 [20:23:30<51:57:54, 15.98s/it]

 27%|██▋       | 4398/16104 [20:23:42<48:16:16, 14.85s/it]

 27%|██▋       | 4399/16104 [20:23:56<47:44:59, 14.69s/it]
{'loss': 0.5053, 'learning_rate': 1.7056831743222408e-06, 'rewards/chosen': -0.6776571273803711, 'rewards/rejected': -1.937308430671692, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2596511840820312, 'policy_logps/rejected': -243.83450317382812, 'policy_logps/chosen': -331.7804260253906, 'referece_logps/rejected': -224.46142578125, 'referece_logps/chosen': -325.0038757324219, 'logits/rejected': -0.8177494406700134, 'logits/chosen': -0.7666963338851929, 'epoch': 1.64}
[2024-04-08 09:30:58,181] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 27%|██▋       | 4400/16104 [20:24:17<54:00:05, 16.61s/it]


 27%|██▋       | 4402/16104 [20:24:45<50:22:58, 15.50s/it]

 27%|██▋       | 4403/16104 [20:25:04<53:11:02, 16.36s/it]

 27%|██▋       | 4404/16104 [20:25:16<49:36:46, 15.27s/it]

 27%|██▋       | 4405/16104 [20:25:33<50:35:59, 15.57s/it]
{'loss': 0.5091, 'learning_rate': 1.7048276396201772e-06, 'rewards/chosen': -1.2138489484786987, 'rewards/rejected': -3.0025508403778076, 'rewards/accuracies': 1.0, 'rewards/margins': 1.788702130317688, 'policy_logps/rejected': -450.718505859375, 'policy_logps/chosen': -433.2830505371094, 'referece_logps/rejected': -420.69305419921875, 'referece_logps/chosen': -421.14459228515625, 'logits/rejected': -0.2165924310684204, 'logits/chosen': -0.16759651899337769, 'epoch': 1.64}


 27%|██▋       | 4407/16104 [20:26:04<50:25:28, 15.52s/it]

 27%|██▋       | 4408/16104 [20:26:18<48:05:30, 14.80s/it]

 27%|██▋       | 4409/16104 [20:26:39<54:07:25, 16.66s/it]

 27%|██▋       | 4410/16104 [20:26:58<57:08:08, 17.59s/it]

 27%|██▋       | 4411/16104 [20:27:17<58:04:26, 17.88s/it]

 27%|██▋       | 4412/16104 [20:27:31<54:17:35, 16.72s/it]

 27%|██▋       | 4413/16104 [20:27:49<55:23:38, 17.06s/it]

 27%|██▋       | 4414/16104 [20:28:04<53:26:45, 16.46s/it]

 27%|██▋       | 4415/16104 [20:28:26<58:56:54, 18.16s/it]

 27%|██▋       | 4416/16104 [20:28:38<53:11:35, 16.38s/it]

 27%|██▋       | 4417/16104 [20:28:50<48:23:36, 14.91s/it]

 27%|██▋       | 4418/16104 [20:29:12<55:19:09, 17.04s/it]

 27%|██▋       | 4419/16104 [20:29:26<52:59:47, 16.33s/it]

 27%|██▋       | 4420/16104 [20:29:48<58:06:08, 17.90s/it]
[2024-04-08 09:36:28,950] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 27%|██▋       | 4421/16104 [20:30:03<55:32:22, 17.11s/it]
[2024-04-08 09:36:44,226] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 27%|██▋       | 4422/16104 [20:30:18<52:53:39, 16.30s/it]

 27%|██▋       | 4423/16104 [20:30:34<53:14:15, 16.41s/it]

 27%|██▋       | 4424/16104 [20:30:56<58:24:11, 18.00s/it]

 27%|██▋       | 4425/16104 [20:31:15<59:45:07, 18.42s/it]

 27%|██▋       | 4426/16104 [20:31:33<59:06:33, 18.22s/it]

 27%|██▋       | 4427/16104 [20:31:51<59:00:32, 18.19s/it]
{'loss': 0.5027, 'learning_rate': 1.7016819069849307e-06, 'rewards/chosen': -1.3706774711608887, 'rewards/rejected': -1.7680764198303223, 'rewards/accuracies': 0.625, 'rewards/margins': 0.397398978471756, 'policy_logps/rejected': -291.5832214355469, 'policy_logps/chosen': -355.6794738769531, 'referece_logps/rejected': -273.9024658203125, 'referece_logps/chosen': -341.97271728515625, 'logits/rejected': -0.804058849811554, 'logits/chosen': -0.8344897031784058, 'epoch': 1.65}


 28%|██▊       | 4429/16104 [20:32:27<58:46:47, 18.12s/it]

 28%|██▊       | 4430/16104 [20:32:41<54:45:29, 16.89s/it]

 28%|██▊       | 4431/16104 [20:32:57<54:05:19, 16.68s/it]

 28%|██▊       | 4432/16104 [20:33:13<53:28:18, 16.49s/it]

 28%|██▊       | 4433/16104 [20:33:26<50:15:20, 15.50s/it]

 28%|██▊       | 4434/16104 [20:33:44<52:37:12, 16.23s/it]
{'loss': 0.5347, 'learning_rate': 1.7006781081123948e-06, 'rewards/chosen': -0.572906494140625, 'rewards/rejected': -0.8770290017127991, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3041225075721741, 'policy_logps/rejected': -357.2752380371094, 'policy_logps/chosen': -400.736328125, 'referece_logps/rejected': -348.50494384765625, 'referece_logps/chosen': -395.00732421875, 'logits/rejected': 0.03809359669685364, 'logits/chosen': 0.00749264657497406, 'epoch': 1.65}


 28%|██▊       | 4436/16104 [20:34:09<46:12:44, 14.26s/it]

 28%|██▊       | 4437/16104 [20:34:25<48:07:45, 14.85s/it]

 28%|██▊       | 4438/16104 [20:34:36<44:01:44, 13.59s/it]

 28%|██▊       | 4439/16104 [20:34:46<41:12:36, 12.72s/it]

 28%|██▊       | 4440/16104 [20:35:01<43:22:37, 13.39s/it]

 28%|██▊       | 4441/16104 [20:35:17<45:35:24, 14.07s/it]

 28%|██▊       | 4442/16104 [20:35:32<46:15:10, 14.28s/it]

 28%|██▊       | 4443/16104 [20:35:47<47:35:17, 14.69s/it]

 28%|██▊       | 4444/16104 [20:36:05<50:30:04, 15.59s/it]

 28%|██▊       | 4445/16104 [20:36:21<51:10:57, 15.80s/it]

 28%|██▊       | 4446/16104 [20:36:32<46:16:18, 14.29s/it]

 28%|██▊       | 4447/16104 [20:36:49<49:11:52, 15.19s/it]

 28%|██▊       | 4448/16104 [20:37:00<45:12:46, 13.96s/it]

 28%|██▊       | 4449/16104 [20:37:11<42:03:03, 12.99s/it]

 28%|██▊       | 4450/16104 [20:37:32<50:04:49, 15.47s/it]

 28%|██▊       | 4451/16104 [20:37:46<47:56:53, 14.81s/it]

 28%|██▊       | 4452/16104 [20:38:05<52:35:55, 16.25s/it]

 28%|██▊       | 4453/16104 [20:38:23<54:31:36, 16.85s/it]

 28%|██▊       | 4454/16104 [20:38:37<51:42:47, 15.98s/it]

 28%|██▊       | 4455/16104 [20:38:52<50:32:49, 15.62s/it]

 28%|██▊       | 4456/16104 [20:39:14<56:07:21, 17.35s/it]

 28%|██▊       | 4457/16104 [20:39:27<51:53:35, 16.04s/it]

 28%|██▊       | 4458/16104 [20:39:44<52:55:42, 16.36s/it]

 28%|██▊       | 4459/16104 [20:39:57<49:39:39, 15.35s/it]

 28%|██▊       | 4460/16104 [20:40:16<53:47:59, 16.63s/it]

 28%|██▊       | 4461/16104 [20:40:33<54:14:17, 16.77s/it]
{'loss': 0.4609, 'learning_rate': 1.6967933205005754e-06, 'rewards/chosen': -0.6766233444213867, 'rewards/rejected': -1.4411230087280273, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7644996643066406, 'policy_logps/rejected': -433.56768798828125, 'policy_logps/chosen': -460.51568603515625, 'referece_logps/rejected': -419.15643310546875, 'referece_logps/chosen': -453.74945068359375, 'logits/rejected': 0.3355644941329956, 'logits/chosen': 0.3846028447151184, 'epoch': 1.66}

 28%|██▊       | 4462/16104 [20:40:44<48:15:21, 14.92s/it]


 28%|██▊       | 4464/16104 [20:41:19<51:56:49, 16.07s/it]

 28%|██▊       | 4465/16104 [20:41:37<53:51:03, 16.66s/it]
{'loss': 0.5333, 'learning_rate': 1.6962160460747396e-06, 'rewards/chosen': -1.0719798803329468, 'rewards/rejected': -0.9306541681289673, 'rewards/accuracies': 0.5, 'rewards/margins': -0.14132565259933472, 'policy_logps/rejected': -423.50457763671875, 'policy_logps/chosen': -332.9095458984375, 'referece_logps/rejected': -414.1980285644531, 'referece_logps/chosen': -322.18975830078125, 'logits/rejected': 0.3902393877506256, 'logits/chosen': 0.4483964443206787, 'epoch': 1.66}

 28%|██▊       | 4466/16104 [20:41:56<56:41:03, 17.53s/it]


 28%|██▊       | 4468/16104 [20:42:34<58:53:01, 18.22s/it]

 28%|██▊       | 4469/16104 [20:42:56<62:24:05, 19.31s/it]
{'loss': 0.6197, 'learning_rate': 1.695638321038023e-06, 'rewards/chosen': -0.6873139142990112, 'rewards/rejected': -1.291467308998108, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6041533350944519, 'policy_logps/rejected': -472.46038818359375, 'policy_logps/chosen': -414.97198486328125, 'referece_logps/rejected': -459.5456848144531, 'referece_logps/chosen': -408.098876953125, 'logits/rejected': -0.7091997861862183, 'logits/chosen': -0.7089931964874268, 'epoch': 1.67}


 28%|██▊       | 4471/16104 [20:43:32<61:03:56, 18.90s/it]
{'loss': 0.4438, 'learning_rate': 1.6953492896574234e-06, 'rewards/chosen': -1.4056413173675537, 'rewards/rejected': -1.7398841381072998, 'rewards/accuracies': 0.5, 'rewards/margins': 0.33424264192581177, 'policy_logps/rejected': -437.60809326171875, 'policy_logps/chosen': -426.69024658203125, 'referece_logps/rejected': -420.20928955078125, 'referece_logps/chosen': -412.63385009765625, 'logits/rejected': -0.40739545226097107, 'logits/chosen': -0.4854217767715454, 'epoch': 1.67}

 28%|██▊       | 4472/16104 [20:43:51<61:16:30, 18.96s/it]

 28%|██▊       | 4473/16104 [20:44:11<62:17:25, 19.28s/it]
[2024-04-08 09:51:13,672] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 28%|██▊       | 4475/16104 [20:44:44<56:28:44, 17.48s/it]

 28%|██▊       | 4476/16104 [20:45:04<58:44:21, 18.19s/it]
[2024-04-08 09:51:45,025] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 28%|██▊       | 4477/16104 [20:45:21<57:43:58, 17.88s/it]
{'loss': 0.538, 'learning_rate': 1.694481520627921e-06, 'rewards/chosen': -1.8399577140808105, 'rewards/rejected': -2.5512938499450684, 'rewards/accuracies': 0.5, 'rewards/margins': 0.7113359570503235, 'policy_logps/rejected': -398.24609375, 'policy_logps/chosen': -418.47686767578125, 'referece_logps/rejected': -372.733154296875, 'referece_logps/chosen': -400.0772705078125, 'logits/rejected': 0.32775717973709106, 'logits/chosen': 0.3683093786239624, 'epoch': 1.67}

 28%|██▊       | 4478/16104 [20:45:37<55:32:45, 17.20s/it]


 28%|██▊       | 4480/16104 [20:46:10<54:02:41, 16.74s/it]
{'loss': 0.4766, 'learning_rate': 1.6940472567784484e-06, 'rewards/chosen': -0.9117961525917053, 'rewards/rejected': -3.2069263458251953, 'rewards/accuracies': 0.875, 'rewards/margins': 2.2951302528381348, 'policy_logps/rejected': -363.3594970703125, 'policy_logps/chosen': -211.49659729003906, 'referece_logps/rejected': -331.2902526855469, 'referece_logps/chosen': -202.37864685058594, 'logits/rejected': -0.30368465185165405, 'logits/chosen': -0.043926388025283813, 'epoch': 1.67}

 28%|██▊       | 4481/16104 [20:46:21<48:39:45, 15.07s/it]


 28%|██▊       | 4483/16104 [20:46:53<49:16:25, 15.26s/it]

 28%|██▊       | 4484/16104 [20:47:15<55:50:20, 17.30s/it]

 28%|██▊       | 4485/16104 [20:47:30<53:41:14, 16.63s/it]
{'loss': 0.5529, 'learning_rate': 1.6933229222651246e-06, 'rewards/chosen': -0.5800918340682983, 'rewards/rejected': -0.5438833236694336, 'rewards/accuracies': 0.5, 'rewards/margins': -0.03620852902531624, 'policy_logps/rejected': -413.32952880859375, 'policy_logps/chosen': -624.382568359375, 'referece_logps/rejected': -407.8907165527344, 'referece_logps/chosen': -618.5816650390625, 'logits/rejected': -0.7534638047218323, 'logits/chosen': -1.042748212814331, 'epoch': 1.67}


 28%|██▊       | 4487/16104 [20:48:05<54:56:34, 17.03s/it]
{'loss': 0.5891, 'learning_rate': 1.69303299209572e-06, 'rewards/chosen': -0.9153839349746704, 'rewards/rejected': -2.1628785133361816, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2474946975708008, 'policy_logps/rejected': -332.80792236328125, 'policy_logps/chosen': -266.60882568359375, 'referece_logps/rejected': -311.17913818359375, 'referece_logps/chosen': -257.4549865722656, 'logits/rejected': -0.6239894032478333, 'logits/chosen': -0.6718874573707581, 'epoch': 1.67}


 28%|██▊       | 4489/16104 [20:48:44<58:31:09, 18.14s/it]

 28%|██▊       | 4490/16104 [20:49:00<56:52:46, 17.63s/it]

 28%|██▊       | 4491/16104 [20:49:20<58:46:27, 18.22s/it]
{'loss': 0.4959, 'learning_rate': 1.6924527953907908e-06, 'rewards/chosen': -0.8768016695976257, 'rewards/rejected': -1.26059091091156, 'rewards/accuracies': 0.5, 'rewards/margins': 0.38378915190696716, 'policy_logps/rejected': -252.34461975097656, 'policy_logps/chosen': -330.4933776855469, 'referece_logps/rejected': -239.73870849609375, 'referece_logps/chosen': -321.725341796875, 'logits/rejected': -1.3456718921661377, 'logits/chosen': -1.422724723815918, 'epoch': 1.67}

 28%|██▊       | 4492/16104 [20:49:39<59:28:23, 18.44s/it]

 28%|██▊       | 4493/16104 [20:49:53<54:51:34, 17.01s/it]


 28%|██▊       | 4495/16104 [20:50:26<55:14:20, 17.13s/it]
{'loss': 0.4794, 'learning_rate': 1.6918721505106641e-06, 'rewards/chosen': -0.720077633857727, 'rewards/rejected': -1.7124137878417969, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9923361539840698, 'policy_logps/rejected': -356.58062744140625, 'policy_logps/chosen': -311.84356689453125, 'referece_logps/rejected': -339.4565124511719, 'referece_logps/chosen': -304.6427917480469, 'logits/rejected': -0.8356671333312988, 'logits/chosen': -0.8763094544410706, 'epoch': 1.67}

 28%|██▊       | 4496/16104 [20:50:37<49:12:01, 15.26s/it]
[2024-04-08 09:57:34,416] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 28%|██▊       | 4497/16104 [20:50:53<50:32:51, 15.68s/it]

 28%|██▊       | 4498/16104 [20:51:11<52:38:10, 16.33s/it]

 28%|██▊       | 4499/16104 [20:51:31<55:48:35, 17.31s/it]


 28%|██▊       | 4501/16104 [20:52:20<70:31:10, 21.88s/it]

 28%|██▊       | 4502/16104 [20:52:38<66:29:58, 20.63s/it]

 28%|██▊       | 4503/16104 [20:52:59<66:15:12, 20.56s/it]
{'loss': 0.5165, 'learning_rate': 1.6907095177283487e-06, 'rewards/chosen': -1.203372597694397, 'rewards/rejected': -2.3674254417419434, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1640527248382568, 'policy_logps/rejected': -309.72332763671875, 'policy_logps/chosen': -352.8673095703125, 'referece_logps/rejected': -286.0490417480469, 'referece_logps/chosen': -340.83355712890625, 'logits/rejected': -0.9247876405715942, 'logits/chosen': -0.9376153945922852, 'epoch': 1.68}

 28%|██▊       | 4504/16104 [20:53:20<66:38:35, 20.68s/it]


 28%|██▊       | 4506/16104 [20:53:54<59:59:02, 18.62s/it]

 28%|██▊       | 4507/16104 [20:54:13<60:14:10, 18.70s/it]
{'loss': 0.5215, 'learning_rate': 1.6901275305786485e-06, 'rewards/chosen': -1.1778514385223389, 'rewards/rejected': -0.9537197947502136, 'rewards/accuracies': 0.625, 'rewards/margins': -0.22413156926631927, 'policy_logps/rejected': -310.6451416015625, 'policy_logps/chosen': -497.41412353515625, 'referece_logps/rejected': -301.1079406738281, 'referece_logps/chosen': -485.6356201171875, 'logits/rejected': 0.08320370316505432, 'logits/chosen': -0.05207638815045357, 'epoch': 1.68}


 28%|██▊       | 4509/16104 [20:54:50<61:10:36, 18.99s/it]
{'loss': 0.4826, 'learning_rate': 1.6898363694789124e-06, 'rewards/chosen': -0.8857680559158325, 'rewards/rejected': -1.7111438512802124, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8253758549690247, 'policy_logps/rejected': -300.74847412109375, 'policy_logps/chosen': -297.27862548828125, 'referece_logps/rejected': -283.63702392578125, 'referece_logps/chosen': -288.4209289550781, 'logits/rejected': -0.8285080194473267, 'logits/chosen': -0.7357209324836731, 'epoch': 1.68}


 28%|██▊       | 4511/16104 [20:55:18<52:23:53, 16.27s/it]

 28%|██▊       | 4512/16104 [20:55:31<49:14:40, 15.29s/it]
{'loss': 0.4608, 'learning_rate': 1.6893994185556965e-06, 'rewards/chosen': -0.7546002864837646, 'rewards/rejected': -1.6511105298995972, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8965101838111877, 'policy_logps/rejected': -274.0079650878906, 'policy_logps/chosen': -470.2411804199219, 'referece_logps/rejected': -257.4968566894531, 'referece_logps/chosen': -462.6951599121094, 'logits/rejected': -0.3089118003845215, 'logits/chosen': -0.3024022579193115, 'epoch': 1.68}

 28%|██▊       | 4513/16104 [20:55:48<50:41:28, 15.74s/it]
[2024-04-08 10:02:48,831] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time


 28%|██▊       | 4515/16104 [20:56:22<52:05:12, 16.18s/it]

 28%|██▊       | 4516/16104 [20:56:35<48:43:05, 15.14s/it]

 28%|██▊       | 4517/16104 [20:56:48<47:28:26, 14.75s/it]

 28%|██▊       | 4518/16104 [20:57:08<52:13:54, 16.23s/it]

 28%|██▊       | 4519/16104 [20:57:29<56:16:05, 17.49s/it]

 28%|██▊       | 4520/16104 [20:57:47<57:09:56, 17.77s/it]

 28%|██▊       | 4521/16104 [20:57:59<51:39:58, 16.06s/it]

 28%|██▊       | 4522/16104 [20:58:20<56:26:49, 17.55s/it]
{'loss': 0.5588, 'learning_rate': 1.68794110368925e-06, 'rewards/chosen': -0.7445598840713501, 'rewards/rejected': -1.3053297996520996, 'rewards/accuracies': 0.75, 'rewards/margins': 0.56076979637146, 'policy_logps/rejected': -269.39501953125, 'policy_logps/chosen': -335.3393249511719, 'referece_logps/rejected': -256.34173583984375, 'referece_logps/chosen': -327.89373779296875, 'logits/rejected': -0.09264631569385529, 'logits/chosen': 0.0048011913895606995, 'epoch': 1.68}


 28%|██▊       | 4524/16104 [20:58:53<54:06:54, 16.82s/it]

 28%|██▊       | 4525/16104 [20:59:14<58:22:25, 18.15s/it]
{'loss': 0.6075, 'learning_rate': 1.6875030663061089e-06, 'rewards/chosen': -1.6318150758743286, 'rewards/rejected': -2.1134495735168457, 'rewards/accuracies': 0.75, 'rewards/margins': 0.48163464665412903, 'policy_logps/rejected': -527.96533203125, 'policy_logps/chosen': -357.9767761230469, 'referece_logps/rejected': -506.8308410644531, 'referece_logps/chosen': -341.65863037109375, 'logits/rejected': -0.6568911671638489, 'logits/chosen': -0.64644455909729, 'epoch': 1.69}

 28%|██▊       | 4526/16104 [20:59:34<59:46:39, 18.59s/it]


 28%|██▊       | 4528/16104 [21:00:13<61:44:37, 19.20s/it]

 28%|██▊       | 4529/16104 [21:00:29<58:10:42, 18.09s/it]
{'loss': 0.473, 'learning_rate': 1.6869186271393452e-06, 'rewards/chosen': -0.7536033987998962, 'rewards/rejected': -1.3095239400863647, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5559206008911133, 'policy_logps/rejected': -392.4143981933594, 'policy_logps/chosen': -367.497802734375, 'referece_logps/rejected': -379.31915283203125, 'referece_logps/chosen': -359.96173095703125, 'logits/rejected': 0.0010180175304412842, 'logits/chosen': -0.0690721943974495, 'epoch': 1.69}


 28%|██▊       | 4531/16104 [21:00:59<54:31:13, 16.96s/it]

 28%|██▊       | 4532/16104 [21:01:19<56:59:30, 17.73s/it]

 28%|██▊       | 4533/16104 [21:01:31<51:36:46, 16.06s/it]
{'loss': 0.5483, 'learning_rate': 1.6863337433792562e-06, 'rewards/chosen': -0.9186196327209473, 'rewards/rejected': -1.6728954315185547, 'rewards/accuracies': 1.0, 'rewards/margins': 0.7542757391929626, 'policy_logps/rejected': -370.07757568359375, 'policy_logps/chosen': -504.6100158691406, 'referece_logps/rejected': -353.34869384765625, 'referece_logps/chosen': -495.423828125, 'logits/rejected': 0.369781494140625, 'logits/chosen': 0.2957611083984375, 'epoch': 1.69}


 28%|██▊       | 4535/16104 [21:01:56<46:02:39, 14.33s/it]

 28%|██▊       | 4536/16104 [21:02:19<54:18:11, 16.90s/it]
[2024-04-08 10:09:00,141] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5045, 'learning_rate': 1.6858947890225316e-06, 'rewards/chosen': -0.7470478415489197, 'rewards/rejected': -2.786378860473633, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0393309593200684, 'policy_logps/rejected': -459.7466125488281, 'policy_logps/chosen': -499.25982666015625, 'referece_logps/rejected': -431.88287353515625, 'referece_logps/chosen': -491.7893371582031, 'logits/rejected': 0.13150857388973236, 'logits/chosen': 0.07018522918224335, 'epoch': 1.69}


 28%|██▊       | 4538/16104 [21:02:51<54:00:00, 16.81s/it]
{'loss': 0.56, 'learning_rate': 1.6856020140465098e-06, 'rewards/chosen': -1.3303027153015137, 'rewards/rejected': -2.058328866958618, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7280258536338806, 'policy_logps/rejected': -540.8509521484375, 'policy_logps/chosen': -502.22918701171875, 'referece_logps/rejected': -520.2676391601562, 'referece_logps/chosen': -488.9261474609375, 'logits/rejected': -0.21579648554325104, 'logits/chosen': -0.15509894490242004, 'epoch': 1.69}


 28%|██▊       | 4540/16104 [21:03:23<51:50:15, 16.14s/it]

 28%|██▊       | 4541/16104 [21:03:39<52:14:22, 16.26s/it]

 28%|██▊       | 4542/16104 [21:04:01<57:44:38, 17.98s/it]
{'loss': 0.5349, 'learning_rate': 1.6850161313359614e-06, 'rewards/chosen': -0.848376989364624, 'rewards/rejected': -1.3549540042877197, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5065769553184509, 'policy_logps/rejected': -433.93414306640625, 'policy_logps/chosen': -374.7230224609375, 'referece_logps/rejected': -420.3846130371094, 'referece_logps/chosen': -366.2392578125, 'logits/rejected': -0.8548075556755066, 'logits/chosen': -0.7451451420783997, 'epoch': 1.69}


 28%|██▊       | 4544/16104 [21:04:29<50:33:02, 15.74s/it]
[2024-04-08 10:11:10,435] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5518, 'learning_rate': 1.684723023696235e-06, 'rewards/chosen': -1.1048520803451538, 'rewards/rejected': -1.367940068244934, 'rewards/accuracies': 0.375, 'rewards/margins': 0.2630879282951355, 'policy_logps/rejected': -438.6162109375, 'policy_logps/chosen': -344.10614013671875, 'referece_logps/rejected': -424.93682861328125, 'referece_logps/chosen': -333.0576171875, 'logits/rejected': -0.37678709626197815, 'logits/chosen': -0.37213701009750366, 'epoch': 1.69}


 28%|██▊       | 4546/16104 [21:04:56<46:03:48, 14.35s/it]
{'loss': 0.5357, 'learning_rate': 1.684429805263437e-06, 'rewards/chosen': -0.9150383472442627, 'rewards/rejected': -1.054833173751831, 'rewards/accuracies': 0.625, 'rewards/margins': 0.1397949457168579, 'policy_logps/rejected': -465.1555480957031, 'policy_logps/chosen': -389.11083984375, 'referece_logps/rejected': -454.607177734375, 'referece_logps/chosen': -379.9604797363281, 'logits/rejected': -0.2575283646583557, 'logits/chosen': -0.18082445859909058, 'epoch': 1.69}


 28%|██▊       | 4548/16104 [21:05:21<43:03:43, 13.42s/it]
{'loss': 0.552, 'learning_rate': 1.684136476085012e-06, 'rewards/chosen': -0.4798259735107422, 'rewards/rejected': -1.1555378437042236, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6757117509841919, 'policy_logps/rejected': -308.1506652832031, 'policy_logps/chosen': -416.1158447265625, 'referece_logps/rejected': -296.59527587890625, 'referece_logps/chosen': -411.3175964355469, 'logits/rejected': 0.325216680765152, 'logits/chosen': 0.28450682759284973, 'epoch': 1.69}


 28%|██▊       | 4550/16104 [21:05:55<49:18:41, 15.36s/it]

 28%|██▊       | 4551/16104 [21:06:15<53:21:25, 16.63s/it]
{'loss': 0.5016, 'learning_rate': 1.683696274773154e-06, 'rewards/chosen': -0.9285566806793213, 'rewards/rejected': -1.6941802501678467, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7656235694885254, 'policy_logps/rejected': -630.6723022460938, 'policy_logps/chosen': -445.3713684082031, 'referece_logps/rejected': -613.73046875, 'referece_logps/chosen': -436.0858459472656, 'logits/rejected': -0.9598000049591064, 'logits/chosen': -0.6989568471908569, 'epoch': 1.7}


 28%|██▊       | 4553/16104 [21:06:51<55:53:50, 17.42s/it]
{'loss': 0.545, 'learning_rate': 1.6834026689383507e-06, 'rewards/chosen': -1.2074320316314697, 'rewards/rejected': -1.1517316102981567, 'rewards/accuracies': 0.5, 'rewards/margins': -0.05570048838853836, 'policy_logps/rejected': -324.1818542480469, 'policy_logps/chosen': -425.9085693359375, 'referece_logps/rejected': -312.66455078125, 'referece_logps/chosen': -413.83428955078125, 'logits/rejected': -0.9596169590950012, 'logits/chosen': -1.0232162475585938, 'epoch': 1.7}


 28%|██▊       | 4555/16104 [21:07:25<56:26:11, 17.59s/it]

 28%|██▊       | 4556/16104 [21:07:37<51:00:45, 15.90s/it]

 28%|██▊       | 4557/16104 [21:07:57<54:31:20, 17.00s/it]
{'loss': 0.5972, 'learning_rate': 1.6828151255779832e-06, 'rewards/chosen': -0.9054043889045715, 'rewards/rejected': -1.4146939516067505, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5092895030975342, 'policy_logps/rejected': -305.8073425292969, 'policy_logps/chosen': -290.5118408203125, 'referece_logps/rejected': -291.6604309082031, 'referece_logps/chosen': -281.4577941894531, 'logits/rejected': -0.81095951795578, 'logits/chosen': -0.8959780931472778, 'epoch': 1.7}


 28%|██▊       | 4559/16104 [21:08:25<49:42:40, 15.50s/it]

 28%|██▊       | 4560/16104 [21:08:41<50:13:07, 15.66s/it]

 28%|██▊       | 4561/16104 [21:08:55<48:34:47, 15.15s/it]

 28%|██▊       | 4562/16104 [21:09:12<50:27:28, 15.74s/it]

 28%|██▊       | 4563/16104 [21:09:27<49:54:46, 15.57s/it]
{'loss': 0.5018, 'learning_rate': 1.681932982023679e-06, 'rewards/chosen': -0.9389158487319946, 'rewards/rejected': -1.2990509271621704, 'rewards/accuracies': 0.625, 'rewards/margins': 0.36013510823249817, 'policy_logps/rejected': -298.6197509765625, 'policy_logps/chosen': -341.3272705078125, 'referece_logps/rejected': -285.6292724609375, 'referece_logps/chosen': -331.9381103515625, 'logits/rejected': 0.3257463574409485, 'logits/chosen': 0.2517666518688202, 'epoch': 1.7}


 28%|██▊       | 4565/16104 [21:10:05<56:21:14, 17.58s/it]

 28%|██▊       | 4566/16104 [21:10:23<56:33:48, 17.65s/it]

 28%|██▊       | 4567/16104 [21:10:39<54:55:12, 17.14s/it]

 28%|██▊       | 4568/16104 [21:10:58<56:24:52, 17.61s/it]
[2024-04-08 10:17:38,732] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.5112, 'learning_rate': 1.6811971037419546e-06, 'rewards/chosen': -1.4990043640136719, 'rewards/rejected': -2.6643223762512207, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1653177738189697, 'policy_logps/rejected': -401.0525817871094, 'policy_logps/chosen': -354.23492431640625, 'referece_logps/rejected': -374.40936279296875, 'referece_logps/chosen': -339.2449035644531, 'logits/rejected': -0.6136063933372498, 'logits/chosen': -0.4447862207889557, 'epoch': 1.7}

 28%|██▊       | 4569/16104 [21:11:14<55:11:03, 17.22s/it]


 28%|██▊       | 4571/16104 [21:11:36<45:00:07, 14.05s/it]
{'loss': 0.5755, 'learning_rate': 1.6807552460576285e-06, 'rewards/chosen': -0.6822994351387024, 'rewards/rejected': -1.4577363729476929, 'rewards/accuracies': 0.875, 'rewards/margins': 0.7754369974136353, 'policy_logps/rejected': -276.67071533203125, 'policy_logps/chosen': -380.2178649902344, 'referece_logps/rejected': -262.09332275390625, 'referece_logps/chosen': -373.3948669433594, 'logits/rejected': 0.2815549075603485, 'logits/chosen': 0.4087190628051758, 'epoch': 1.7}


 28%|██▊       | 4573/16104 [21:12:04<44:52:57, 14.01s/it]
{'loss': 0.6146, 'learning_rate': 1.6804605365693252e-06, 'rewards/chosen': -0.6555749773979187, 'rewards/rejected': -0.6500265002250671, 'rewards/accuracies': 0.5, 'rewards/margins': -0.005548465996980667, 'policy_logps/rejected': -458.7314453125, 'policy_logps/chosen': -399.3575439453125, 'referece_logps/rejected': -452.2311706542969, 'referece_logps/chosen': -392.8017883300781, 'logits/rejected': -0.35079270601272583, 'logits/chosen': -0.37369391322135925, 'epoch': 1.7}


 28%|██▊       | 4575/16104 [21:12:33<45:07:24, 14.09s/it]
{'loss': 0.5819, 'learning_rate': 1.6801657169776511e-06, 'rewards/chosen': -0.7859371304512024, 'rewards/rejected': -1.1522172689437866, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3662801682949066, 'policy_logps/rejected': -350.86541748046875, 'policy_logps/chosen': -378.19677734375, 'referece_logps/rejected': -339.34326171875, 'referece_logps/chosen': -370.3373718261719, 'logits/rejected': 0.2842915654182434, 'logits/chosen': 0.39757972955703735, 'epoch': 1.7}

 28%|██▊       | 4576/16104 [21:12:53<50:35:51, 15.80s/it]


 28%|██▊       | 4578/16104 [21:13:28<52:07:27, 16.28s/it]

 28%|██▊       | 4579/16104 [21:13:40<47:48:43, 14.93s/it]

 28%|██▊       | 4580/16104 [21:13:56<48:59:58, 15.31s/it]

 28%|██▊       | 4581/16104 [21:14:16<53:04:12, 16.58s/it]
{'loss': 0.5605, 'learning_rate': 1.6792805980595321e-06, 'rewards/chosen': -0.9954970479011536, 'rewards/rejected': -1.3333008289337158, 'rewards/accuracies': 0.75, 'rewards/margins': 0.33780378103256226, 'policy_logps/rejected': -357.8160400390625, 'policy_logps/chosen': -403.947998046875, 'referece_logps/rejected': -344.4830627441406, 'referece_logps/chosen': -393.9930114746094, 'logits/rejected': -0.9536798000335693, 'logits/chosen': -0.895525336265564, 'epoch': 1.71}

 28%|██▊       | 4582/16104 [21:14:35<55:38:23, 17.38s/it]
[2024-04-08 10:21:37,284] [WARNING] [stage3.py:2069:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 28%|██▊       | 4583/16104 [21:14:56<59:30:58, 18.60s/it]
[2024-04-08 10:21:51,887] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 28%|██▊       | 4584/16104 [21:15:11<55:40:48, 17.40s/it]

 28%|██▊       | 4585/16104 [21:15:30<57:41:35, 18.03s/it]

 28%|██▊       | 4586/16104 [21:15:47<55:55:20, 17.48s/it]

 28%|██▊       | 4587/16104 [21:16:06<58:11:06, 18.19s/it]

 28%|██▊       | 4588/16104 [21:16:21<54:49:57, 17.14s/it]

 28%|██▊       | 4589/16104 [21:16:39<55:40:35, 17.41s/it]

 29%|██▊       | 4590/16104 [21:16:52<51:45:00, 16.18s/it]


 29%|██▊       | 4592/16104 [21:17:24<52:03:40, 16.28s/it]
{'loss': 0.4651, 'learning_rate': 1.6776553117707e-06, 'rewards/chosen': -0.8020319938659668, 'rewards/rejected': -1.8036892414093018, 'rewards/accuracies': 0.625, 'rewards/margins': 1.001657247543335, 'policy_logps/rejected': -267.676025390625, 'policy_logps/chosen': -444.1702880859375, 'referece_logps/rejected': -249.6391143798828, 'referece_logps/chosen': -436.14996337890625, 'logits/rejected': -0.5991929173469543, 'logits/chosen': -0.7525452375411987, 'epoch': 1.71}
[2024-04-08 10:24:25,557] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 29%|██▊       | 4593/16104 [21:17:45<55:54:42, 17.49s/it]

 29%|██▊       | 4594/16104 [21:18:01<54:54:23, 17.17s/it]

 29%|██▊       | 4595/16104 [21:18:19<56:06:35, 17.55s/it]

 29%|██▊       | 4596/16104 [21:18:39<58:10:19, 18.20s/it]


 29%|██▊       | 4598/16104 [21:19:06<50:01:06, 15.65s/it]
{'loss': 0.5049, 'learning_rate': 1.6767673934379639e-06, 'rewards/chosen': -1.1267906427383423, 'rewards/rejected': -1.9294917583465576, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8027010560035706, 'policy_logps/rejected': -339.2234191894531, 'policy_logps/chosen': -416.2317810058594, 'referece_logps/rejected': -319.92852783203125, 'referece_logps/chosen': -404.9638977050781, 'logits/rejected': -0.5938782691955566, 'logits/chosen': -0.5735273361206055, 'epoch': 1.71}


 29%|██▊       | 4600/16104 [21:19:32<46:00:31, 14.40s/it]

 29%|██▊       | 4601/16104 [21:19:52<51:25:16, 16.09s/it]
{'loss': 0.519, 'learning_rate': 1.6763230646087098e-06, 'rewards/chosen': -0.9892814755439758, 'rewards/rejected': -1.8284177780151367, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8391361236572266, 'policy_logps/rejected': -454.57568359375, 'policy_logps/chosen': -492.68511962890625, 'referece_logps/rejected': -436.2914733886719, 'referece_logps/chosen': -482.79229736328125, 'logits/rejected': -0.5514049530029297, 'logits/chosen': -0.6261118650436401, 'epoch': 1.71}

 29%|██▊       | 4602/16104 [21:20:07<50:14:10, 15.72s/it]

 29%|██▊       | 4603/16104 [21:20:25<52:08:02, 16.32s/it]

 29%|██▊       | 4604/16104 [21:20:43<54:24:42, 17.03s/it]

 29%|██▊       | 4605/16104 [21:21:03<57:12:41, 17.91s/it]

 29%|██▊       | 4606/16104 [21:21:23<58:50:36, 18.42s/it]


 29%|██▊       | 4608/16104 [21:22:02<60:08:42, 18.83s/it]

 29%|██▊       | 4609/16104 [21:22:22<61:12:34, 19.17s/it]

 29%|██▊       | 4610/16104 [21:22:42<62:05:09, 19.45s/it]
{'loss': 0.3894, 'learning_rate': 1.6749886014108539e-06, 'rewards/chosen': -1.3883095979690552, 'rewards/rejected': -1.9725322723388672, 'rewards/accuracies': 0.75, 'rewards/margins': 0.584222674369812, 'policy_logps/rejected': -331.7538757324219, 'policy_logps/chosen': -359.57940673828125, 'referece_logps/rejected': -312.0285339355469, 'referece_logps/chosen': -345.6963195800781, 'logits/rejected': -0.526807963848114, 'logits/chosen': -0.5339755415916443, 'epoch': 1.72}


 29%|██▊       | 4612/16104 [21:23:10<52:44:17, 16.52s/it]
{'loss': 0.459, 'learning_rate': 1.6746917535301171e-06, 'rewards/chosen': -0.7806947827339172, 'rewards/rejected': -2.218782424926758, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4380877017974854, 'policy_logps/rejected': -339.5553283691406, 'policy_logps/chosen': -369.3546447753906, 'referece_logps/rejected': -317.36749267578125, 'referece_logps/chosen': -361.54766845703125, 'logits/rejected': -0.4860891103744507, 'logits/chosen': -0.35986292362213135, 'epoch': 1.72}


 29%|██▊       | 4614/16104 [21:23:47<55:17:53, 17.33s/it]
{'loss': 0.4831, 'learning_rate': 1.6743947964794397e-06, 'rewards/chosen': -1.1831059455871582, 'rewards/rejected': -1.7059354782104492, 'rewards/accuracies': 0.5, 'rewards/margins': 0.522829532623291, 'policy_logps/rejected': -316.3870849609375, 'policy_logps/chosen': -270.7646179199219, 'referece_logps/rejected': -299.3277587890625, 'referece_logps/chosen': -258.9335632324219, 'logits/rejected': -0.8869493007659912, 'logits/chosen': -0.7312807440757751, 'epoch': 1.72}

 29%|██▊       | 4615/16104 [21:24:08<59:04:05, 18.51s/it]

 29%|██▊       | 4616/16104 [21:24:27<60:03:09, 18.82s/it]

 29%|██▊       | 4617/16104 [21:24:47<60:41:52, 19.02s/it]


 29%|██▊       | 4619/16104 [21:25:22<59:23:10, 18.61s/it]
{'loss': 0.4183, 'learning_rate': 1.6736519265496262e-06, 'rewards/chosen': -0.4817289710044861, 'rewards/rejected': -2.2368993759155273, 'rewards/accuracies': 0.875, 'rewards/margins': 1.755170226097107, 'policy_logps/rejected': -402.6501770019531, 'policy_logps/chosen': -404.1480712890625, 'referece_logps/rejected': -380.2811584472656, 'referece_logps/chosen': -399.330810546875, 'logits/rejected': -0.47624582052230835, 'logits/chosen': -0.3738800883293152, 'epoch': 1.72}


 29%|██▊       | 4621/16104 [21:26:00<59:38:14, 18.70s/it]
{'loss': 0.5979, 'learning_rate': 1.6733545877826644e-06, 'rewards/chosen': -1.077344536781311, 'rewards/rejected': -1.0922125577926636, 'rewards/accuracies': 0.5, 'rewards/margins': 0.014867961406707764, 'policy_logps/rejected': -309.28387451171875, 'policy_logps/chosen': -388.4545593261719, 'referece_logps/rejected': -298.36181640625, 'referece_logps/chosen': -377.6811218261719, 'logits/rejected': -0.621738076210022, 'logits/chosen': -0.7557041049003601, 'epoch': 1.72}

 29%|██▊       | 4622/16104 [21:26:19<60:07:44, 18.85s/it]

 29%|██▊       | 4623/16104 [21:26:31<53:07:28, 16.66s/it]

 29%|██▊       | 4624/16104 [21:26:47<52:47:28, 16.55s/it]

 29%|██▊       | 4625/16104 [21:27:08<56:16:01, 17.65s/it]


 29%|██▊       | 4627/16104 [21:27:39<52:12:51, 16.38s/it]
{'loss': 0.4712, 'learning_rate': 1.6724619179528486e-06, 'rewards/chosen': -1.8918437957763672, 'rewards/rejected': -2.670140266418457, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7782965898513794, 'policy_logps/rejected': -361.38714599609375, 'policy_logps/chosen': -345.3902587890625, 'referece_logps/rejected': -334.68572998046875, 'referece_logps/chosen': -326.4718017578125, 'logits/rejected': -1.0183874368667603, 'logits/chosen': -0.9350043535232544, 'epoch': 1.72}

 29%|██▊       | 4628/16104 [21:27:52<49:24:04, 15.50s/it]

 29%|██▊       | 4629/16104 [21:28:12<53:42:27, 16.85s/it]

 29%|██▉       | 4630/16104 [21:28:34<58:53:52, 18.48s/it]

 29%|██▉       | 4631/16104 [21:28:52<58:12:55, 18.27s/it]

 29%|██▉       | 4632/16104 [21:29:04<52:23:19, 16.44s/it]


 29%|██▉       | 4634/16104 [21:29:41<54:46:14, 17.19s/it]
{'loss': 0.4579, 'learning_rate': 1.6714192322056186e-06, 'rewards/chosen': -1.0917266607284546, 'rewards/rejected': -1.5063748359680176, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4146481156349182, 'policy_logps/rejected': -487.6090393066406, 'policy_logps/chosen': -418.654541015625, 'referece_logps/rejected': -472.5452575683594, 'referece_logps/chosen': -407.7372741699219, 'logits/rejected': -1.0640939474105835, 'logits/chosen': -0.9400075674057007, 'epoch': 1.73}

 29%|██▉       | 4635/16104 [21:29:57<54:05:40, 16.98s/it]

 29%|██▉       | 4636/16104 [21:30:14<53:31:42, 16.80s/it]

 29%|██▉       | 4637/16104 [21:30:34<56:53:53, 17.86s/it]

 29%|██▉       | 4638/16104 [21:30:52<57:18:27, 17.99s/it]

 29%|██▉       | 4639/16104 [21:31:12<59:16:02, 18.61s/it]

 29%|██▉       | 4640/16104 [21:31:32<60:42:20, 19.06s/it]

 29%|██▉       | 4641/16104 [21:31:52<61:08:02, 19.20s/it]


 29%|██▉       | 4643/16104 [21:32:25<55:55:30, 17.57s/it]

 29%|██▉       | 4644/16104 [21:32:41<54:22:10, 17.08s/it]

 29%|██▉       | 4645/16104 [21:32:59<55:03:48, 17.30s/it]

 29%|██▉       | 4646/16104 [21:33:17<55:48:19, 17.53s/it]
{'loss': 0.5141, 'learning_rate': 1.6696286758192617e-06, 'rewards/chosen': -0.829516589641571, 'rewards/rejected': -1.9721109867095947, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1425942182540894, 'policy_logps/rejected': -236.13552856445312, 'policy_logps/chosen': -305.4781494140625, 'referece_logps/rejected': -216.4144287109375, 'referece_logps/chosen': -297.1829833984375, 'logits/rejected': -0.5719059109687805, 'logits/chosen': -0.48127275705337524, 'epoch': 1.73}

 29%|██▉       | 4647/16104 [21:33:34<55:42:31, 17.50s/it]

 29%|██▉       | 4648/16104 [21:33:50<53:50:59, 16.92s/it]

 29%|██▉       | 4649/16104 [21:34:08<55:17:18, 17.38s/it]

 29%|██▉       | 4650/16104 [21:34:22<51:26:00, 16.17s/it]

 29%|██▉       | 4651/16104 [21:34:40<53:13:04, 16.73s/it]

 29%|██▉       | 4652/16104 [21:34:56<52:42:57, 16.57s/it]

 29%|██▉       | 4653/16104 [21:35:10<50:40:07, 15.93s/it]

 29%|██▉       | 4654/16104 [21:35:30<54:08:37, 17.02s/it]

 29%|██▉       | 4655/16104 [21:35:43<49:53:49, 15.69s/it]

 29%|██▉       | 4656/16104 [21:35:56<47:42:29, 15.00s/it]

 29%|██▉       | 4657/16104 [21:36:18<54:18:45, 17.08s/it]

 29%|██▉       | 4658/16104 [21:36:35<54:50:01, 17.25s/it]

 29%|██▉       | 4659/16104 [21:36:54<56:03:33, 17.63s/it]


 29%|██▉       | 4661/16104 [21:37:33<59:07:30, 18.60s/it]

 29%|██▉       | 4662/16104 [21:37:53<60:40:19, 19.09s/it]
{'loss': 0.4672, 'learning_rate': 1.6672352014738755e-06, 'rewards/chosen': -1.7523400783538818, 'rewards/rejected': -2.5599756240844727, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8076357841491699, 'policy_logps/rejected': -459.37896728515625, 'policy_logps/chosen': -378.50054931640625, 'referece_logps/rejected': -433.77923583984375, 'referece_logps/chosen': -360.9771423339844, 'logits/rejected': -0.5481023788452148, 'logits/chosen': -0.49958768486976624, 'epoch': 1.74}


 29%|██▉       | 4664/16104 [21:38:25<56:00:56, 17.63s/it]
{'loss': 0.5144, 'learning_rate': 1.6669355308366507e-06, 'rewards/chosen': -1.0145330429077148, 'rewards/rejected': -1.9452961683273315, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9307628870010376, 'policy_logps/rejected': -377.0313720703125, 'policy_logps/chosen': -365.582763671875, 'referece_logps/rejected': -357.578369140625, 'referece_logps/chosen': -355.43743896484375, 'logits/rejected': -0.976804256439209, 'logits/chosen': -0.9226937294006348, 'epoch': 1.74}

 29%|██▉       | 4665/16104 [21:38:45<57:53:00, 18.22s/it]

 29%|██▉       | 4666/16104 [21:39:06<60:51:49, 19.16s/it]

 29%|██▉       | 4667/16104 [21:39:19<55:08:02, 17.35s/it]

 29%|██▉       | 4668/16104 [21:39:38<56:32:45, 17.80s/it]

 29%|██▉       | 4669/16104 [21:39:58<58:47:17, 18.51s/it]

 29%|██▉       | 4670/16104 [21:40:12<54:24:54, 17.13s/it]

 29%|██▉       | 4671/16104 [21:40:32<57:09:54, 18.00s/it]

 29%|██▉       | 4672/16104 [21:40:54<60:14:02, 18.97s/it]

 29%|██▉       | 4673/16104 [21:41:13<61:00:13, 19.21s/it]

 29%|██▉       | 4674/16104 [21:41:31<59:35:21, 18.77s/it]

 29%|██▉       | 4675/16104 [21:41:51<60:49:53, 19.16s/it]

 29%|██▉       | 4676/16104 [21:42:11<61:24:03, 19.34s/it]

 29%|██▉       | 4677/16104 [21:42:26<57:09:49, 18.01s/it]

 29%|██▉       | 4678/16104 [21:42:36<50:01:59, 15.76s/it]

 29%|██▉       | 4679/16104 [21:42:57<55:04:30, 17.35s/it]

 29%|██▉       | 4680/16104 [21:43:13<53:21:53, 16.82s/it]

 29%|██▉       | 4681/16104 [21:43:29<52:27:42, 16.53s/it]

 29%|██▉       | 4682/16104 [21:43:44<51:27:47, 16.22s/it]

 29%|██▉       | 4683/16104 [21:44:00<50:38:24, 15.96s/it]

 29%|██▉       | 4684/16104 [21:44:19<54:11:57, 17.09s/it]

 29%|██▉       | 4685/16104 [21:44:32<50:01:38, 15.77s/it]

 29%|██▉       | 4686/16104 [21:44:48<49:40:28, 15.66s/it]

 29%|██▉       | 4687/16104 [21:45:00<46:44:03, 14.74s/it]

 29%|██▉       | 4688/16104 [21:45:16<48:16:54, 15.23s/it]

 29%|██▉       | 4689/16104 [21:45:35<51:26:26, 16.22s/it]

 29%|██▉       | 4690/16104 [21:45:47<47:16:31, 14.91s/it]

 29%|██▉       | 4691/16104 [21:46:06<51:38:57, 16.29s/it]

 29%|██▉       | 4692/16104 [21:46:26<54:53:25, 17.32s/it]

 29%|██▉       | 4693/16104 [21:46:41<52:40:37, 16.62s/it]

 29%|██▉       | 4694/16104 [21:46:54<48:53:15, 15.42s/it]

 29%|██▉       | 4695/16104 [21:47:06<45:28:35, 14.35s/it]

 29%|██▉       | 4696/16104 [21:47:17<42:49:58, 13.52s/it]

 29%|██▉       | 4697/16104 [21:47:36<48:07:35, 15.19s/it]

 29%|██▉       | 4698/16104 [21:47:53<49:40:04, 15.68s/it]

 29%|██▉       | 4699/16104 [21:48:14<54:36:31, 17.24s/it]

 29%|██▉       | 4700/16104 [21:48:32<55:43:55, 17.59s/it]

 29%|██▉       | 4701/16104 [21:48:52<58:02:38, 18.32s/it]

 29%|██▉       | 4702/16104 [21:49:10<57:33:44, 18.17s/it]

 29%|██▉       | 4703/16104 [21:49:28<57:13:26, 18.07s/it]

 29%|██▉       | 4704/16104 [21:49:41<52:26:01, 16.56s/it]

 29%|██▉       | 4705/16104 [21:49:57<52:17:07, 16.51s/it]

 29%|██▉       | 4706/16104 [21:50:15<53:40:46, 16.95s/it]

 29%|██▉       | 4707/16104 [21:50:33<54:20:55, 17.17s/it]

 29%|██▉       | 4708/16104 [21:50:44<48:17:10, 15.25s/it]

 29%|██▉       | 4709/16104 [21:50:56<45:06:01, 14.25s/it]

 29%|██▉       | 4710/16104 [21:51:08<43:12:15, 13.65s/it]

 29%|██▉       | 4711/16104 [21:51:28<49:01:59, 15.49s/it]

 29%|██▉       | 4712/16104 [21:51:46<51:33:42, 16.29s/it]

 29%|██▉       | 4713/16104 [21:52:06<54:54:18, 17.35s/it]

 29%|██▉       | 4714/16104 [21:52:25<57:05:34, 18.05s/it]

 29%|██▉       | 4715/16104 [21:52:42<55:23:11, 17.51s/it]

 29%|██▉       | 4716/16104 [21:53:03<58:57:56, 18.64s/it]

 29%|██▉       | 4717/16104 [21:53:25<62:02:37, 19.62s/it]

 29%|██▉       | 4718/16104 [21:53:44<61:20:28, 19.39s/it]

 29%|██▉       | 4719/16104 [21:53:58<56:11:06, 17.77s/it]

 29%|██▉       | 4720/16104 [21:54:18<58:04:00, 18.36s/it]

 29%|██▉       | 4721/16104 [21:54:40<61:41:12, 19.51s/it]

 29%|██▉       | 4722/16104 [21:55:00<62:30:57, 19.77s/it]

 29%|██▉       | 4723/16104 [21:55:21<63:36:34, 20.12s/it]

 29%|██▉       | 4724/16104 [21:55:38<60:45:22, 19.22s/it]

 29%|██▉       | 4725/16104 [21:55:58<61:30:51, 19.46s/it]

 29%|██▉       | 4726/16104 [21:56:09<53:41:40, 16.99s/it]

 29%|██▉       | 4727/16104 [21:56:27<53:58:24, 17.08s/it]

 29%|██▉       | 4728/16104 [21:56:37<47:53:44, 15.16s/it]

 29%|██▉       | 4729/16104 [21:56:54<49:10:13, 15.56s/it]

 29%|██▉       | 4730/16104 [21:57:13<52:44:03, 16.69s/it]

 29%|██▉       | 4731/16104 [21:57:33<55:25:29, 17.54s/it]

 29%|██▉       | 4732/16104 [21:57:43<48:48:44, 15.45s/it]

 29%|██▉       | 4733/16104 [21:58:01<51:08:07, 16.19s/it]


 29%|██▉       | 4735/16104 [21:58:23<42:51:22, 13.57s/it]

 29%|██▉       | 4736/16104 [21:58:40<46:06:08, 14.60s/it]

 29%|██▉       | 4737/16104 [21:58:51<42:18:54, 13.40s/it]

 29%|██▉       | 4738/16104 [21:59:13<50:10:09, 15.89s/it]

 29%|██▉       | 4739/16104 [21:59:32<53:48:33, 17.04s/it]

 29%|██▉       | 4740/16104 [21:59:44<48:57:00, 15.51s/it]

 29%|██▉       | 4741/16104 [21:59:55<44:20:42, 14.05s/it]

 29%|██▉       | 4742/16104 [22:00:08<43:03:44, 13.64s/it]

 29%|██▉       | 4743/16104 [22:00:24<45:43:58, 14.49s/it]

 29%|██▉       | 4744/16104 [22:00:44<50:37:18, 16.04s/it]

 29%|██▉       | 4745/16104 [22:01:03<53:46:14, 17.04s/it]

 29%|██▉       | 4746/16104 [22:01:22<55:16:15, 17.52s/it]

 29%|██▉       | 4747/16104 [22:01:39<55:33:29, 17.61s/it]

 29%|██▉       | 4748/16104 [22:02:02<59:59:46, 19.02s/it]

 29%|██▉       | 4749/16104 [22:02:14<54:00:31, 17.12s/it]

 29%|██▉       | 4750/16104 [22:02:29<51:24:17, 16.30s/it]

 30%|██▉       | 4751/16104 [22:02:41<47:53:05, 15.18s/it]

 30%|██▉       | 4752/16104 [22:03:00<50:43:05, 16.08s/it]

 30%|██▉       | 4753/16104 [22:03:20<54:19:18, 17.23s/it]

 30%|██▉       | 4754/16104 [22:03:40<57:03:03, 18.10s/it]

 30%|██▉       | 4755/16104 [22:03:58<56:56:10, 18.06s/it]

 30%|██▉       | 4756/16104 [22:04:10<51:25:09, 16.31s/it]

 30%|██▉       | 4757/16104 [22:04:22<47:38:34, 15.12s/it]

 30%|██▉       | 4758/16104 [22:04:34<44:45:21, 14.20s/it]

 30%|██▉       | 4759/16104 [22:04:45<41:23:12, 13.13s/it]

 30%|██▉       | 4760/16104 [22:04:58<41:37:44, 13.21s/it]

 30%|██▉       | 4761/16104 [22:05:19<48:17:37, 15.33s/it]

 30%|██▉       | 4762/16104 [22:05:30<44:21:51, 14.08s/it]

 30%|██▉       | 4763/16104 [22:05:42<42:37:56, 13.53s/it]

 30%|██▉       | 4764/16104 [22:06:04<50:30:55, 16.04s/it]

 30%|██▉       | 4765/16104 [22:06:16<46:42:33, 14.83s/it]

 30%|██▉       | 4766/16104 [22:06:29<45:05:04, 14.32s/it]

 30%|██▉       | 4767/16104 [22:06:43<44:59:56, 14.29s/it]
{'loss': 0.4727, 'learning_rate': 1.6513577142562843e-06, 'rewards/chosen': -0.6171198487281799, 'rewards/rejected': -1.5352668762207031, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9181471467018127, 'policy_logps/rejected': -306.5435485839844, 'policy_logps/chosen': -302.99462890625, 'referece_logps/rejected': -291.1908874511719, 'referece_logps/chosen': -296.8234558105469, 'logits/rejected': -0.9957424402236938, 'logits/chosen': -0.9604629874229431, 'epoch': 1.78}


 30%|██▉       | 4769/16104 [22:07:13<46:30:59, 14.77s/it]

 30%|██▉       | 4770/16104 [22:07:31<49:18:32, 15.66s/it]

 30%|██▉       | 4771/16104 [22:07:44<47:28:02, 15.08s/it]

 30%|██▉       | 4772/16104 [22:08:04<51:54:45, 16.49s/it]

 30%|██▉       | 4773/16104 [22:08:17<48:48:13, 15.51s/it]

 30%|██▉       | 4774/16104 [22:08:30<46:33:48, 14.80s/it]

 30%|██▉       | 4775/16104 [22:08:45<46:05:33, 14.65s/it]

 30%|██▉       | 4776/16104 [22:08:59<45:39:09, 14.51s/it]
{'loss': 0.5633, 'learning_rate': 1.649983169082358e-06, 'rewards/chosen': -1.0491892099380493, 'rewards/rejected': -1.9255659580230713, 'rewards/accuracies': 0.875, 'rewards/margins': 0.876376748085022, 'policy_logps/rejected': -476.1339416503906, 'policy_logps/chosen': -439.06256103515625, 'referece_logps/rejected': -456.87823486328125, 'referece_logps/chosen': -428.5707092285156, 'logits/rejected': -0.5521684288978577, 'logits/chosen': -0.7030695676803589, 'epoch': 1.78}


 30%|██▉       | 4778/16104 [22:09:31<48:17:23, 15.35s/it]

 30%|██▉       | 4779/16104 [22:09:52<52:51:50, 16.80s/it]

 30%|██▉       | 4780/16104 [22:10:04<49:10:06, 15.63s/it]

 30%|██▉       | 4781/16104 [22:10:25<53:44:30, 17.09s/it]

 30%|██▉       | 4782/16104 [22:10:44<55:57:22, 17.79s/it]

 30%|██▉       | 4783/16104 [22:10:59<53:03:09, 16.87s/it]

 30%|██▉       | 4784/16104 [22:11:15<51:59:58, 16.54s/it]

 30%|██▉       | 4785/16104 [22:11:34<54:54:57, 17.47s/it]

 30%|██▉       | 4786/16104 [22:11:49<52:22:52, 16.66s/it]

 30%|██▉       | 4787/16104 [22:12:01<47:54:49, 15.24s/it]

 30%|██▉       | 4788/16104 [22:12:15<46:13:58, 14.71s/it]
{'loss': 0.6417, 'learning_rate': 1.648147130048764e-06, 'rewards/chosen': -1.281570553779602, 'rewards/rejected': -1.4583641290664673, 'rewards/accuracies': 0.625, 'rewards/margins': 0.17679356038570404, 'policy_logps/rejected': -326.47991943359375, 'policy_logps/chosen': -458.01947021484375, 'referece_logps/rejected': -311.8962707519531, 'referece_logps/chosen': -445.20379638671875, 'logits/rejected': -0.03277324140071869, 'logits/chosen': -0.14984889328479767, 'epoch': 1.78}

 30%|██▉       | 4789/16104 [22:12:34<50:51:00, 16.18s/it]


 30%|██▉       | 4791/16104 [22:13:14<57:15:19, 18.22s/it]
{'loss': 0.4786, 'learning_rate': 1.647687529951461e-06, 'rewards/chosen': -1.1756953001022339, 'rewards/rejected': -2.4386258125305176, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2629303932189941, 'policy_logps/rejected': -603.831298828125, 'policy_logps/chosen': -471.26483154296875, 'referece_logps/rejected': -579.445068359375, 'referece_logps/chosen': -459.5079040527344, 'logits/rejected': -0.5378139019012451, 'logits/chosen': -0.3741786777973175, 'epoch': 1.79}


 30%|██▉       | 4793/16104 [22:13:49<54:41:58, 17.41s/it]
{'loss': 0.5101, 'learning_rate': 1.6473809988756817e-06, 'rewards/chosen': -1.3654156923294067, 'rewards/rejected': -1.5977346897125244, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23231928050518036, 'policy_logps/rejected': -550.0935668945312, 'policy_logps/chosen': -568.0584106445312, 'referece_logps/rejected': -534.1162109375, 'referece_logps/chosen': -554.4042358398438, 'logits/rejected': -0.5468254685401917, 'logits/chosen': -0.44432246685028076, 'epoch': 1.79}


 30%|██▉       | 4795/16104 [22:14:20<51:15:50, 16.32s/it]

 30%|██▉       | 4796/16104 [22:14:39<53:00:21, 16.87s/it]

 30%|██▉       | 4797/16104 [22:14:59<55:52:17, 17.79s/it]
{'loss': 0.6123, 'learning_rate': 1.6467676225211427e-06, 'rewards/chosen': -1.4339408874511719, 'rewards/rejected': -1.8277182579040527, 'rewards/accuracies': 0.375, 'rewards/margins': 0.3937772512435913, 'policy_logps/rejected': -445.03753662109375, 'policy_logps/chosen': -512.00732421875, 'referece_logps/rejected': -426.7603454589844, 'referece_logps/chosen': -497.66790771484375, 'logits/rejected': -0.3381471037864685, 'logits/chosen': -0.349267840385437, 'epoch': 1.79}


 30%|██▉       | 4799/16104 [22:15:35<56:00:28, 17.84s/it]

 30%|██▉       | 4800/16104 [22:15:48<50:49:58, 16.19s/it]

 30%|██▉       | 4801/16104 [22:16:09<56:03:02, 17.85s/it]

 30%|██▉       | 4802/16104 [22:16:25<53:41:45, 17.10s/it]

 30%|██▉       | 4803/16104 [22:16:37<49:25:19, 15.74s/it]

 30%|██▉       | 4804/16104 [22:16:56<52:04:14, 16.59s/it]

 30%|██▉       | 4805/16104 [22:17:11<51:00:49, 16.25s/it]

 30%|██▉       | 4806/16104 [22:17:28<51:11:33, 16.31s/it]

 30%|██▉       | 4807/16104 [22:17:46<52:35:58, 16.76s/it]

 30%|██▉       | 4808/16104 [22:18:04<53:49:16, 17.15s/it]

 30%|██▉       | 4809/16104 [22:18:25<57:59:18, 18.48s/it]
{'loss': 0.5527, 'learning_rate': 1.6449249834081553e-06, 'rewards/chosen': -1.1059975624084473, 'rewards/rejected': -2.081897258758545, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9758996963500977, 'policy_logps/rejected': -380.54510498046875, 'policy_logps/chosen': -463.6309814453125, 'referece_logps/rejected': -359.7261657714844, 'referece_logps/chosen': -452.571044921875, 'logits/rejected': -0.8837787508964539, 'logits/chosen': -0.9534075260162354, 'epoch': 1.79}

 30%|██▉       | 4810/16104 [22:18:40<54:39:37, 17.42s/it]

 30%|██▉       | 4811/16104 [22:18:54<51:33:32, 16.44s/it]


 30%|██▉       | 4813/16104 [22:19:32<54:57:43, 17.52s/it]

 30%|██▉       | 4814/16104 [22:19:50<55:11:02, 17.60s/it]

 30%|██▉       | 4815/16104 [22:20:03<50:59:52, 16.26s/it]

 30%|██▉       | 4816/16104 [22:20:22<53:37:15, 17.10s/it]

 30%|██▉       | 4817/16104 [22:20:35<50:08:01, 15.99s/it]

 30%|██▉       | 4818/16104 [22:20:46<45:12:26, 14.42s/it]

 30%|██▉       | 4819/16104 [22:20:57<41:48:00, 13.33s/it]

 30%|██▉       | 4820/16104 [22:21:09<40:45:56, 13.01s/it]

 30%|██▉       | 4821/16104 [22:21:25<43:39:47, 13.93s/it]

 30%|██▉       | 4822/16104 [22:21:38<42:09:47, 13.45s/it]

 30%|██▉       | 4823/16104 [22:21:49<40:42:13, 12.99s/it]

 30%|██▉       | 4824/16104 [22:22:01<39:39:21, 12.66s/it]

 30%|██▉       | 4825/16104 [22:22:23<48:12:29, 15.39s/it]
{'loss': 0.5898, 'learning_rate': 1.6424622893245608e-06, 'rewards/chosen': -1.2860276699066162, 'rewards/rejected': -1.5186254978179932, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2325977385044098, 'policy_logps/rejected': -414.37890625, 'policy_logps/chosen': -407.7388610839844, 'referece_logps/rejected': -399.192626953125, 'referece_logps/chosen': -394.8785705566406, 'logits/rejected': -1.1575018167495728, 'logits/chosen': -1.3415330648422241, 'epoch': 1.8}


 30%|██▉       | 4827/16104 [22:22:59<52:08:52, 16.65s/it]

 30%|██▉       | 4828/16104 [22:23:19<55:03:14, 17.58s/it]

 30%|██▉       | 4829/16104 [22:23:34<52:43:33, 16.83s/it]
{'loss': 0.5994, 'learning_rate': 1.6418455752569942e-06, 'rewards/chosen': -0.9049904346466064, 'rewards/rejected': -2.207474946975708, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3024842739105225, 'policy_logps/rejected': -650.492919921875, 'policy_logps/chosen': -660.5891723632812, 'referece_logps/rejected': -628.418212890625, 'referece_logps/chosen': -651.5393676757812, 'logits/rejected': 0.2638193666934967, 'logits/chosen': 0.2048555612564087, 'epoch': 1.8}

 30%|██▉       | 4830/16104 [22:23:45<46:59:14, 15.00s/it]


 30%|███       | 4832/16104 [22:24:13<44:58:39, 14.36s/it]

 30%|███       | 4833/16104 [22:24:31<48:32:23, 15.50s/it]
{'loss': 0.5239, 'learning_rate': 1.6412284457686665e-06, 'rewards/chosen': -0.7771968245506287, 'rewards/rejected': -1.1946849822998047, 'rewards/accuracies': 0.875, 'rewards/margins': 0.41748809814453125, 'policy_logps/rejected': -490.71185302734375, 'policy_logps/chosen': -555.7967529296875, 'referece_logps/rejected': -478.7649841308594, 'referece_logps/chosen': -548.0247802734375, 'logits/rejected': -0.06351575255393982, 'logits/chosen': -0.039098843932151794, 'epoch': 1.8}


 30%|███       | 4835/16104 [22:25:11<55:02:18, 17.58s/it]

 30%|███       | 4836/16104 [22:25:28<54:43:48, 17.49s/it]

 30%|███       | 4837/16104 [22:25:41<50:58:07, 16.29s/it]

 30%|███       | 4838/16104 [22:26:01<54:22:34, 17.38s/it]
{'loss': 0.484, 'learning_rate': 1.640456450331334e-06, 'rewards/chosen': -0.39953938126564026, 'rewards/rejected': -1.74117910861969, 'rewards/accuracies': 1.0, 'rewards/margins': 1.341639757156372, 'policy_logps/rejected': -423.251708984375, 'policy_logps/chosen': -528.7528076171875, 'referece_logps/rejected': -405.8399353027344, 'referece_logps/chosen': -524.7574462890625, 'logits/rejected': -0.21898314356803894, 'logits/chosen': -0.2740148901939392, 'epoch': 1.8}


 30%|███       | 4840/16104 [22:26:36<53:37:36, 17.14s/it]
{'loss': 0.4594, 'learning_rate': 1.6401474707594296e-06, 'rewards/chosen': -0.7041153907775879, 'rewards/rejected': -1.8171299695968628, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1130144596099854, 'policy_logps/rejected': -514.8344116210938, 'policy_logps/chosen': -379.40325927734375, 'referece_logps/rejected': -496.6630859375, 'referece_logps/chosen': -372.3621520996094, 'logits/rejected': -0.24413342773914337, 'logits/chosen': -0.031043432652950287, 'epoch': 1.8}


 30%|███       | 4842/16104 [22:27:12<55:47:03, 17.83s/it]
{'loss': 0.4753, 'learning_rate': 1.6398383876070962e-06, 'rewards/chosen': -0.48135149478912354, 'rewards/rejected': -1.612057089805603, 'rewards/accuracies': 1.0, 'rewards/margins': 1.130705714225769, 'policy_logps/rejected': -195.97811889648438, 'policy_logps/chosen': -253.46536254882812, 'referece_logps/rejected': -179.8575439453125, 'referece_logps/chosen': -248.65185546875, 'logits/rejected': -1.3605859279632568, 'logits/chosen': -1.3883025646209717, 'epoch': 1.8}


 30%|███       | 4844/16104 [22:27:40<48:42:12, 15.57s/it]

 30%|███       | 4845/16104 [22:27:52<45:32:57, 14.56s/it]

 30%|███       | 4846/16104 [22:28:04<43:28:27, 13.90s/it]

 30%|███       | 4847/16104 [22:28:20<45:29:28, 14.55s/it]

 30%|███       | 4848/16104 [22:28:34<44:24:23, 14.20s/it]
{'loss': 0.4226, 'learning_rate': 1.6389105171677236e-06, 'rewards/chosen': -0.10524531453847885, 'rewards/rejected': -2.0548973083496094, 'rewards/accuracies': 1.0, 'rewards/margins': 1.949651837348938, 'policy_logps/rejected': -266.4129333496094, 'policy_logps/chosen': -289.0439147949219, 'referece_logps/rejected': -245.8639678955078, 'referece_logps/chosen': -287.991455078125, 'logits/rejected': -0.7377865314483643, 'logits/chosen': -0.8432953357696533, 'epoch': 1.81}


 30%|███       | 4850/16104 [22:29:02<43:17:42, 13.85s/it]

 30%|███       | 4851/16104 [22:29:17<44:16:17, 14.16s/it]

 30%|███       | 4852/16104 [22:29:32<45:10:17, 14.45s/it]
{'loss': 0.5814, 'learning_rate': 1.6382914198899938e-06, 'rewards/chosen': -1.7035903930664062, 'rewards/rejected': -3.235980987548828, 'rewards/accuracies': 0.625, 'rewards/margins': 1.5323904752731323, 'policy_logps/rejected': -447.8568115234375, 'policy_logps/chosen': -581.3877563476562, 'referece_logps/rejected': -415.4969482421875, 'referece_logps/chosen': -564.3518676757812, 'logits/rejected': -0.9798523187637329, 'logits/chosen': -0.9841721057891846, 'epoch': 1.81}


 30%|███       | 4854/16104 [22:30:06<50:04:39, 16.02s/it]

 30%|███       | 4855/16104 [22:30:21<49:13:29, 15.75s/it]

 30%|███       | 4856/16104 [22:30:34<46:26:19, 14.86s/it]

 30%|███       | 4857/16104 [22:30:48<45:51:35, 14.68s/it]

 30%|███       | 4858/16104 [22:31:08<50:48:36, 16.27s/it]
{'loss': 0.4358, 'learning_rate': 1.6373619994979206e-06, 'rewards/chosen': -0.4384213984012604, 'rewards/rejected': -1.9054350852966309, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4670137166976929, 'policy_logps/rejected': -201.99990844726562, 'policy_logps/chosen': -353.146728515625, 'referece_logps/rejected': -182.945556640625, 'referece_logps/chosen': -348.76251220703125, 'logits/rejected': -1.2632166147232056, 'logits/chosen': -1.2218017578125, 'epoch': 1.81}


 30%|███       | 4860/16104 [22:31:48<56:54:01, 18.22s/it]

 30%|███       | 4861/16104 [22:32:06<56:49:53, 18.20s/it]

 30%|███       | 4862/16104 [22:32:26<58:15:11, 18.65s/it]

 30%|███       | 4863/16104 [22:32:43<56:49:10, 18.20s/it]
{'loss': 0.4549, 'learning_rate': 1.6365867734302981e-06, 'rewards/chosen': -1.2534265518188477, 'rewards/rejected': -2.314760684967041, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0613341331481934, 'policy_logps/rejected': -360.69903564453125, 'policy_logps/chosen': -437.740234375, 'referece_logps/rejected': -337.55145263671875, 'referece_logps/chosen': -425.20599365234375, 'logits/rejected': -0.20161356031894684, 'logits/chosen': -0.38642454147338867, 'epoch': 1.81}

 30%|███       | 4864/16104 [22:32:57<53:27:05, 17.12s/it]

 30%|███       | 4865/16104 [22:33:16<54:23:19, 17.42s/it]

 30%|███       | 4866/16104 [22:33:35<56:26:45, 18.08s/it]


 30%|███       | 4868/16104 [22:34:13<56:32:42, 18.12s/it]

 30%|███       | 4869/16104 [22:34:26<52:20:41, 16.77s/it]

 30%|███       | 4870/16104 [22:34:42<51:10:46, 16.40s/it]

 30%|███       | 4871/16104 [22:35:02<54:51:25, 17.58s/it]

 30%|███       | 4872/16104 [22:35:16<51:27:25, 16.49s/it]

 30%|███       | 4873/16104 [22:35:30<49:18:21, 15.80s/it]

 30%|███       | 4874/16104 [22:35:47<49:36:36, 15.90s/it]

 30%|███       | 4875/16104 [22:36:09<55:18:07, 17.73s/it]

 30%|███       | 4876/16104 [22:36:29<57:31:19, 18.44s/it]

 30%|███       | 4877/16104 [22:36:41<51:31:57, 16.52s/it]
{'loss': 0.4046, 'learning_rate': 1.6344127180537569e-06, 'rewards/chosen': -0.372715026140213, 'rewards/rejected': -2.2900891304016113, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9173741340637207, 'policy_logps/rejected': -468.7152404785156, 'policy_logps/chosen': -609.2171630859375, 'referece_logps/rejected': -445.8143615722656, 'referece_logps/chosen': -605.489990234375, 'logits/rejected': -0.2874124348163605, 'logits/chosen': -0.33956918120384216, 'epoch': 1.82}


 30%|███       | 4879/16104 [22:37:15<53:12:26, 17.06s/it]

 30%|███       | 4880/16104 [22:37:28<49:35:17, 15.91s/it]
{'loss': 0.5604, 'learning_rate': 1.6339461940471054e-06, 'rewards/chosen': -1.2353063821792603, 'rewards/rejected': -1.61751127243042, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3822048306465149, 'policy_logps/rejected': -383.302001953125, 'policy_logps/chosen': -342.0330810546875, 'referece_logps/rejected': -367.1268615722656, 'referece_logps/chosen': -329.6800537109375, 'logits/rejected': -0.8695873022079468, 'logits/chosen': -0.6039249897003174, 'epoch': 1.82}


 30%|███       | 4882/16104 [22:38:03<52:42:04, 16.91s/it]

 30%|███       | 4883/16104 [22:38:23<55:07:32, 17.69s/it]
{'loss': 0.4973, 'learning_rate': 1.6334794392421667e-06, 'rewards/chosen': -1.1653236150741577, 'rewards/rejected': -2.886557102203369, 'rewards/accuracies': 0.75, 'rewards/margins': 1.7212333679199219, 'policy_logps/rejected': -552.7596435546875, 'policy_logps/chosen': -369.60791015625, 'referece_logps/rejected': -523.89404296875, 'referece_logps/chosen': -357.9546813964844, 'logits/rejected': 0.1694851815700531, 'logits/chosen': 0.3192574977874756, 'epoch': 1.82}


 30%|███       | 4885/16104 [22:38:57<53:06:55, 17.04s/it]

 30%|███       | 4886/16104 [22:39:16<55:29:42, 17.81s/it]

 30%|███       | 4887/16104 [22:39:37<57:55:32, 18.59s/it]
{'loss': 0.5301, 'learning_rate': 1.632856740776408e-06, 'rewards/chosen': -0.659885048866272, 'rewards/rejected': -1.338442087173462, 'rewards/accuracies': 1.0, 'rewards/margins': 0.6785570383071899, 'policy_logps/rejected': -440.67901611328125, 'policy_logps/chosen': -387.4874572753906, 'referece_logps/rejected': -427.2945861816406, 'referece_logps/chosen': -380.88861083984375, 'logits/rejected': -0.7593843340873718, 'logits/chosen': -0.8892914056777954, 'epoch': 1.82}


 30%|███       | 4889/16104 [22:39:59<45:55:02, 14.74s/it]
{'loss': 0.5206, 'learning_rate': 1.6325452379172303e-06, 'rewards/chosen': -0.4820018708705902, 'rewards/rejected': -1.5299949645996094, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0479929447174072, 'policy_logps/rejected': -454.5418395996094, 'policy_logps/chosen': -389.55914306640625, 'referece_logps/rejected': -439.2419128417969, 'referece_logps/chosen': -384.7391357421875, 'logits/rejected': -0.7540054321289062, 'logits/chosen': -0.5828595161437988, 'epoch': 1.82}

 30%|███       | 4890/16104 [22:40:18<49:56:20, 16.03s/it]


 30%|███       | 4892/16104 [22:40:51<49:21:41, 15.85s/it]

 30%|███       | 4893/16104 [22:41:09<52:13:42, 16.77s/it]
{'loss': 0.5399, 'learning_rate': 1.6319219251982932e-06, 'rewards/chosen': -0.5794744491577148, 'rewards/rejected': -0.9711731672286987, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3916986584663391, 'policy_logps/rejected': -573.2289428710938, 'policy_logps/chosen': -428.8351745605469, 'referece_logps/rejected': -563.5171508789062, 'referece_logps/chosen': -423.04046630859375, 'logits/rejected': -0.8408771753311157, 'logits/chosen': -0.8297168016433716, 'epoch': 1.82}

 30%|███       | 4894/16104 [22:41:30<55:33:17, 17.84s/it]


 30%|███       | 4896/16104 [22:42:07<55:56:59, 17.97s/it]

 30%|███       | 4897/16104 [22:42:25<56:09:18, 18.04s/it]

 30%|███       | 4898/16104 [22:42:43<56:08:30, 18.04s/it]

 30%|███       | 4899/16104 [22:43:03<57:56:21, 18.62s/it]

 30%|███       | 4900/16104 [22:43:17<53:16:20, 17.12s/it]
{'loss': 0.4234, 'learning_rate': 1.6308301440318118e-06, 'rewards/chosen': 0.1304885894060135, 'rewards/rejected': -2.766479969024658, 'rewards/accuracies': 1.0, 'rewards/margins': 2.896968364715576, 'policy_logps/rejected': -327.6122741699219, 'policy_logps/chosen': -320.9159851074219, 'referece_logps/rejected': -299.94744873046875, 'referece_logps/chosen': -322.22088623046875, 'logits/rejected': -0.42518365383148193, 'logits/chosen': -0.42058420181274414, 'epoch': 1.83}

 30%|███       | 4901/16104 [22:43:28<47:20:58, 15.22s/it]

 30%|███       | 4902/16104 [22:43:44<48:00:08, 15.43s/it]


 30%|███       | 4904/16104 [22:44:15<47:59:44, 15.43s/it]

 30%|███       | 4905/16104 [22:44:26<43:30:46, 13.99s/it]

 30%|███       | 4906/16104 [22:44:45<48:52:26, 15.71s/it]
{'loss': 0.5582, 'learning_rate': 1.6298933363114767e-06, 'rewards/chosen': -0.877879798412323, 'rewards/rejected': -1.1044926643371582, 'rewards/accuracies': 0.625, 'rewards/margins': 0.22661271691322327, 'policy_logps/rejected': -229.5824432373047, 'policy_logps/chosen': -256.4942932128906, 'referece_logps/rejected': -218.5375213623047, 'referece_logps/chosen': -247.71546936035156, 'logits/rejected': -0.9610098004341125, 'logits/chosen': -0.9766512513160706, 'epoch': 1.83}


 30%|███       | 4908/16104 [22:45:15<46:23:47, 14.92s/it]
{'loss': 0.6969, 'learning_rate': 1.6295808631615048e-06, 'rewards/chosen': -0.9587008953094482, 'rewards/rejected': -1.6257035732269287, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6670025587081909, 'policy_logps/rejected': -375.63409423828125, 'policy_logps/chosen': -334.5876770019531, 'referece_logps/rejected': -359.3770751953125, 'referece_logps/chosen': -325.0006408691406, 'logits/rejected': -0.7356485724449158, 'logits/chosen': -0.6686940789222717, 'epoch': 1.83}

 30%|███       | 4909/16104 [22:45:36<51:47:52, 16.66s/it]


 30%|███       | 4911/16104 [22:46:01<45:45:48, 14.72s/it]

 31%|███       | 4912/16104 [22:46:19<48:54:47, 15.73s/it]

 31%|███       | 4913/16104 [22:46:35<49:09:58, 15.82s/it]

 31%|███       | 4914/16104 [22:46:49<47:29:23, 15.28s/it]
{'loss': 0.5119, 'learning_rate': 1.6286428326898536e-06, 'rewards/chosen': -1.5197283029556274, 'rewards/rejected': -2.918686866760254, 'rewards/accuracies': 0.625, 'rewards/margins': 1.3989583253860474, 'policy_logps/rejected': -516.8475952148438, 'policy_logps/chosen': -382.5955505371094, 'referece_logps/rejected': -487.6607666015625, 'referece_logps/chosen': -367.3982849121094, 'logits/rejected': -0.34645992517471313, 'logits/chosen': -0.2209795117378235, 'epoch': 1.83}

 31%|███       | 4915/16104 [22:47:10<52:36:02, 16.92s/it]

 31%|███       | 4916/16104 [22:47:21<46:46:28, 15.05s/it]


 31%|███       | 4918/16104 [22:47:59<53:21:45, 17.17s/it]

 31%|███       | 4919/16104 [22:48:19<55:57:39, 18.01s/it]
{'loss': 0.4325, 'learning_rate': 1.6278604412547946e-06, 'rewards/chosen': -0.8643962144851685, 'rewards/rejected': -2.066068649291992, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2016725540161133, 'policy_logps/rejected': -414.44158935546875, 'policy_logps/chosen': -392.6633605957031, 'referece_logps/rejected': -393.7809143066406, 'referece_logps/chosen': -384.0194091796875, 'logits/rejected': 0.8184202313423157, 'logits/chosen': 0.7436038851737976, 'epoch': 1.83}

 31%|███       | 4920/16104 [22:48:39<57:21:13, 18.46s/it]


 31%|███       | 4922/16104 [22:49:10<52:07:50, 16.78s/it]
{'loss': 0.6074, 'learning_rate': 1.6273907015662154e-06, 'rewards/chosen': -1.241137146949768, 'rewards/rejected': -1.4754570722579956, 'rewards/accuracies': 0.375, 'rewards/margins': 0.23431989550590515, 'policy_logps/rejected': -419.9718017578125, 'policy_logps/chosen': -308.76727294921875, 'referece_logps/rejected': -405.21722412109375, 'referece_logps/chosen': -296.35589599609375, 'logits/rejected': -1.1887192726135254, 'logits/chosen': -1.0601400136947632, 'epoch': 1.83}

 31%|███       | 4923/16104 [22:49:20<46:32:19, 14.98s/it]

 31%|███       | 4924/16104 [22:49:38<48:57:42, 15.77s/it]


 31%|███       | 4926/16104 [22:50:08<47:05:32, 15.17s/it]

 31%|███       | 4927/16104 [22:50:26<49:55:12, 16.08s/it]

 31%|███       | 4928/16104 [22:50:38<46:13:13, 14.89s/it]
{'loss': 0.5736, 'learning_rate': 1.6264505371251915e-06, 'rewards/chosen': -1.0091211795806885, 'rewards/rejected': -1.7276395559310913, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7185183763504028, 'policy_logps/rejected': -408.3349304199219, 'policy_logps/chosen': -368.3885498046875, 'referece_logps/rejected': -391.0585632324219, 'referece_logps/chosen': -358.29736328125, 'logits/rejected': -1.5314407348632812, 'logits/chosen': -1.4148859977722168, 'epoch': 1.84}


 31%|███       | 4930/16104 [22:51:07<45:25:31, 14.63s/it]
{'loss': 0.5213, 'learning_rate': 1.626136946182221e-06, 'rewards/chosen': -0.5963550806045532, 'rewards/rejected': -2.195671558380127, 'rewards/accuracies': 0.75, 'rewards/margins': 1.5993164777755737, 'policy_logps/rejected': -328.08868408203125, 'policy_logps/chosen': -464.9102478027344, 'referece_logps/rejected': -306.1319580078125, 'referece_logps/chosen': -458.94671630859375, 'logits/rejected': -0.6090673208236694, 'logits/chosen': -0.6348053216934204, 'epoch': 1.84}

 31%|███       | 4931/16104 [22:51:27<50:11:58, 16.17s/it]

 31%|███       | 4932/16104 [22:51:45<51:48:28, 16.69s/it]


 31%|███       | 4934/16104 [22:52:24<56:11:57, 18.11s/it]
{'loss': 0.4485, 'learning_rate': 1.6255094604067594e-06, 'rewards/chosen': -1.4005357027053833, 'rewards/rejected': -1.7581804990768433, 'rewards/accuracies': 0.625, 'rewards/margins': 0.3576447665691376, 'policy_logps/rejected': -347.4908447265625, 'policy_logps/chosen': -258.66778564453125, 'referece_logps/rejected': -329.9090576171875, 'referece_logps/chosen': -244.6624298095703, 'logits/rejected': -0.15144798159599304, 'logits/chosen': -0.10744542628526688, 'epoch': 1.84}

 31%|███       | 4935/16104 [22:52:39<53:19:42, 17.19s/it]

 31%|███       | 4936/16104 [22:52:51<48:44:55, 15.71s/it]

 31%|███       | 4937/16104 [22:53:03<45:18:44, 14.61s/it]

 31%|███       | 4938/16104 [22:53:21<48:16:46, 15.57s/it]

 31%|███       | 4939/16104 [22:53:33<44:33:57, 14.37s/it]

 31%|███       | 4940/16104 [22:53:51<48:21:50, 15.60s/it]


 31%|███       | 4942/16104 [22:54:18<44:54:04, 14.48s/it]
{'loss': 0.559, 'learning_rate': 1.6242532747195386e-06, 'rewards/chosen': -1.1421246528625488, 'rewards/rejected': -2.2437069416046143, 'rewards/accuracies': 0.875, 'rewards/margins': 1.101582407951355, 'policy_logps/rejected': -437.60394287109375, 'policy_logps/chosen': -444.6241149902344, 'referece_logps/rejected': -415.1669006347656, 'referece_logps/chosen': -433.2028503417969, 'logits/rejected': -0.11978459358215332, 'logits/chosen': -0.1357746422290802, 'epoch': 1.84}


 31%|███       | 4944/16104 [22:54:42<41:04:05, 13.25s/it]
{'loss': 0.5152, 'learning_rate': 1.6239389756490685e-06, 'rewards/chosen': -0.49211007356643677, 'rewards/rejected': -1.0334739685058594, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5413639545440674, 'policy_logps/rejected': -402.0444030761719, 'policy_logps/chosen': -444.32733154296875, 'referece_logps/rejected': -391.709716796875, 'referece_logps/chosen': -439.40625, 'logits/rejected': -1.1286413669586182, 'logits/chosen': -0.9734371900558472, 'epoch': 1.84}


 31%|███       | 4946/16104 [22:55:12<42:38:41, 13.76s/it]

 31%|███       | 4947/16104 [22:55:30<46:44:03, 15.08s/it]
{'loss': 0.5988, 'learning_rate': 1.6234673377634246e-06, 'rewards/chosen': -0.9640408158302307, 'rewards/rejected': -1.2038544416427612, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23981371521949768, 'policy_logps/rejected': -259.2013854980469, 'policy_logps/chosen': -432.5658874511719, 'referece_logps/rejected': -247.16281127929688, 'referece_logps/chosen': -422.925537109375, 'logits/rejected': -0.7365350127220154, 'logits/chosen': -0.9267352819442749, 'epoch': 1.84}

 31%|███       | 4948/16104 [22:55:49<50:20:38, 16.25s/it]


 31%|███       | 4950/16104 [22:56:12<42:39:57, 13.77s/it]

 31%|███       | 4951/16104 [22:56:32<48:13:09, 15.56s/it]

 31%|███       | 4952/16104 [22:56:54<54:08:17, 17.48s/it]

 31%|███       | 4953/16104 [22:57:14<56:16:33, 18.17s/it]
{'loss': 0.5553, 'learning_rate': 1.6225233812140528e-06, 'rewards/chosen': -0.9256356954574585, 'rewards/rejected': -1.321462631225586, 'rewards/accuracies': 0.75, 'rewards/margins': 0.39582687616348267, 'policy_logps/rejected': -414.724853515625, 'policy_logps/chosen': -333.5501708984375, 'referece_logps/rejected': -401.51019287109375, 'referece_logps/chosen': -324.2938232421875, 'logits/rejected': -0.29816919565200806, 'logits/chosen': -0.3358018398284912, 'epoch': 1.85}

 31%|███       | 4954/16104 [22:57:31<55:11:42, 17.82s/it]


 31%|███       | 4956/16104 [22:58:08<57:15:42, 18.49s/it]
{'loss': 0.5461, 'learning_rate': 1.6220510628939876e-06, 'rewards/chosen': -1.3484718799591064, 'rewards/rejected': -1.26534104347229, 'rewards/accuracies': 0.5, 'rewards/margins': -0.0831308513879776, 'policy_logps/rejected': -557.9928588867188, 'policy_logps/chosen': -448.8140563964844, 'referece_logps/rejected': -545.3394165039062, 'referece_logps/chosen': -435.3293151855469, 'logits/rejected': -0.8625457882881165, 'logits/chosen': -0.8005223274230957, 'epoch': 1.85}


 31%|███       | 4958/16104 [22:58:47<59:12:00, 19.12s/it]

 31%|███       | 4959/16104 [22:59:05<58:09:30, 18.79s/it]
{'loss': 0.4603, 'learning_rate': 1.6215785181062487e-06, 'rewards/chosen': -1.2097485065460205, 'rewards/rejected': -2.9421067237854004, 'rewards/accuracies': 1.0, 'rewards/margins': 1.7323580980300903, 'policy_logps/rejected': -475.60833740234375, 'policy_logps/chosen': -379.222412109375, 'referece_logps/rejected': -446.18731689453125, 'referece_logps/chosen': -367.1249084472656, 'logits/rejected': -1.0007915496826172, 'logits/chosen': -0.9391363263130188, 'epoch': 1.85}


 31%|███       | 4961/16104 [22:59:46<61:22:19, 19.83s/it]

 31%|███       | 4962/16104 [23:00:05<60:12:22, 19.45s/it]
{'loss': 0.6084, 'learning_rate': 1.6211057470228733e-06, 'rewards/chosen': -1.1602728366851807, 'rewards/rejected': -2.0362396240234375, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8759665489196777, 'policy_logps/rejected': -329.8899230957031, 'policy_logps/chosen': -301.73370361328125, 'referece_logps/rejected': -309.52752685546875, 'referece_logps/chosen': -290.1309814453125, 'logits/rejected': -0.9918173551559448, 'logits/chosen': -1.090588092803955, 'epoch': 1.85}


 31%|███       | 4964/16104 [23:00:42<59:05:01, 19.09s/it]
{'loss': 0.4405, 'learning_rate': 1.6207904406658192e-06, 'rewards/chosen': -1.5019330978393555, 'rewards/rejected': -2.2601304054260254, 'rewards/accuracies': 1.0, 'rewards/margins': 0.7581971883773804, 'policy_logps/rejected': -421.947021484375, 'policy_logps/chosen': -570.0630493164062, 'referece_logps/rejected': -399.3457336425781, 'referece_logps/chosen': -555.043701171875, 'logits/rejected': -0.4471234083175659, 'logits/chosen': -0.495417058467865, 'epoch': 1.85}

 31%|███       | 4965/16104 [23:01:02<59:28:44, 19.22s/it]

 31%|███       | 4966/16104 [23:01:21<59:45:06, 19.31s/it]

 31%|███       | 4967/16104 [23:01:42<60:51:58, 19.67s/it]


 31%|███       | 4969/16104 [23:02:18<58:58:46, 19.07s/it]

 31%|███       | 4970/16104 [23:02:38<59:49:57, 19.35s/it]

 31%|███       | 4971/16104 [23:03:00<62:17:48, 20.14s/it]
{'loss': 0.4214, 'learning_rate': 1.6196860777205408e-06, 'rewards/chosen': -0.8785071969032288, 'rewards/rejected': -2.5001564025878906, 'rewards/accuracies': 0.875, 'rewards/margins': 1.621649146080017, 'policy_logps/rejected': -373.12457275390625, 'policy_logps/chosen': -363.958984375, 'referece_logps/rejected': -348.12298583984375, 'referece_logps/chosen': -355.1739501953125, 'logits/rejected': -0.328255832195282, 'logits/chosen': -0.40618693828582764, 'epoch': 1.85}

 31%|███       | 4972/16104 [23:03:22<63:31:31, 20.54s/it]

 31%|███       | 4973/16104 [23:03:42<62:51:46, 20.33s/it]

 31%|███       | 4974/16104 [23:04:02<62:44:32, 20.29s/it]


 31%|███       | 4976/16104 [23:04:29<51:20:14, 16.61s/it]
{'loss': 0.5075, 'learning_rate': 1.6188964948954985e-06, 'rewards/chosen': -1.014416217803955, 'rewards/rejected': -1.8709008693695068, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8564847111701965, 'policy_logps/rejected': -337.44696044921875, 'policy_logps/chosen': -322.5397033691406, 'referece_logps/rejected': -318.73797607421875, 'referece_logps/chosen': -312.39556884765625, 'logits/rejected': -0.5236455202102661, 'logits/chosen': -0.3971908390522003, 'epoch': 1.85}

 31%|███       | 4977/16104 [23:04:46<51:41:43, 16.73s/it]

 31%|███       | 4978/16104 [23:05:07<55:52:09, 18.08s/it]


 31%|███       | 4980/16104 [23:05:43<54:40:58, 17.70s/it]
{'loss': 0.4132, 'learning_rate': 1.6182643779587349e-06, 'rewards/chosen': -0.7103303670883179, 'rewards/rejected': -1.3444268703460693, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6340965032577515, 'policy_logps/rejected': -434.7005310058594, 'policy_logps/chosen': -415.08502197265625, 'referece_logps/rejected': -421.2562255859375, 'referece_logps/chosen': -407.9816589355469, 'logits/rejected': -0.33762457966804504, 'logits/chosen': -0.15937988460063934, 'epoch': 1.86}

 31%|███       | 4981/16104 [23:05:56<50:18:03, 16.28s/it]


 31%|███       | 4983/16104 [23:06:29<51:51:32, 16.79s/it]
{'loss': 0.5829, 'learning_rate': 1.6177900276298689e-06, 'rewards/chosen': -1.5891218185424805, 'rewards/rejected': -1.7281365394592285, 'rewards/accuracies': 0.5, 'rewards/margins': 0.1390146017074585, 'policy_logps/rejected': -672.1207275390625, 'policy_logps/chosen': -550.1893920898438, 'referece_logps/rejected': -654.8394165039062, 'referece_logps/chosen': -534.2982177734375, 'logits/rejected': 0.0451761931180954, 'logits/chosen': 0.13199904561042786, 'epoch': 1.86}

 31%|███       | 4984/16104 [23:06:50<55:45:45, 18.05s/it]


 31%|███       | 4986/16104 [23:07:29<57:57:01, 18.76s/it]
{'loss': 0.5379, 'learning_rate': 1.6173154523846276e-06, 'rewards/chosen': -0.4445560574531555, 'rewards/rejected': -1.2673115730285645, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8227553963661194, 'policy_logps/rejected': -383.21954345703125, 'policy_logps/chosen': -392.49298095703125, 'referece_logps/rejected': -370.5464172363281, 'referece_logps/chosen': -388.0473937988281, 'logits/rejected': 0.3074501156806946, 'logits/chosen': 0.37397879362106323, 'epoch': 1.86}

 31%|███       | 4987/16104 [23:07:42<52:29:46, 17.00s/it]

 31%|███       | 4988/16104 [23:07:53<47:25:20, 15.36s/it]

 31%|███       | 4989/16104 [23:08:05<44:16:26, 14.34s/it]

 31%|███       | 4990/16104 [23:08:16<40:44:31, 13.20s/it]


 31%|███       | 4992/16104 [23:08:57<52:13:21, 16.92s/it]
{'loss': 0.5364, 'learning_rate': 1.6163656278362075e-06, 'rewards/chosen': -0.522743821144104, 'rewards/rejected': -1.765964388847351, 'rewards/accuracies': 0.75, 'rewards/margins': 1.243220567703247, 'policy_logps/rejected': -246.39878845214844, 'policy_logps/chosen': -350.904296875, 'referece_logps/rejected': -228.73916625976562, 'referece_logps/chosen': -345.6768798828125, 'logits/rejected': 0.11988842487335205, 'logits/chosen': 0.20922476053237915, 'epoch': 1.86}

 31%|███       | 4993/16104 [23:09:07<46:28:21, 15.06s/it]

 31%|███       | 4994/16104 [23:09:24<47:57:05, 15.54s/it]


 31%|███       | 4996/16104 [23:09:57<49:52:31, 16.16s/it]
{'loss': 0.5037, 'learning_rate': 1.6157319127234254e-06, 'rewards/chosen': -0.7530860900878906, 'rewards/rejected': -1.8432824611663818, 'rewards/accuracies': 0.875, 'rewards/margins': 1.090196132659912, 'policy_logps/rejected': -365.5245361328125, 'policy_logps/chosen': -451.2481994628906, 'referece_logps/rejected': -347.0916748046875, 'referece_logps/chosen': -443.7173156738281, 'logits/rejected': 0.2988709509372711, 'logits/chosen': 0.291408896446228, 'epoch': 1.86}


 31%|███       | 4998/16104 [23:10:23<45:16:43, 14.68s/it]
{'loss': 0.5498, 'learning_rate': 1.6154149056966696e-06, 'rewards/chosen': -0.3933311402797699, 'rewards/rejected': -1.818441390991211, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4251102209091187, 'policy_logps/rejected': -291.9317626953125, 'policy_logps/chosen': -488.916748046875, 'referece_logps/rejected': -273.747314453125, 'referece_logps/chosen': -484.9833984375, 'logits/rejected': -0.6712680459022522, 'logits/chosen': -0.5196597576141357, 'epoch': 1.86}

 31%|███       | 4999/16104 [23:10:36<43:29:59, 14.10s/it]


 31%|███       | 5001/16104 [23:11:15<54:20:32, 17.62s/it]
{'loss': 0.423, 'learning_rate': 1.6149392084628374e-06, 'rewards/chosen': -0.6193140149116516, 'rewards/rejected': -1.3034851551055908, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6841711401939392, 'policy_logps/rejected': -450.9310607910156, 'policy_logps/chosen': -286.89324951171875, 'referece_logps/rejected': -437.8961486816406, 'referece_logps/chosen': -280.70013427734375, 'logits/rejected': -0.4925505518913269, 'logits/chosen': -0.5408064126968384, 'epoch': 1.86}


 31%|███       | 5003/16104 [23:11:53<56:06:00, 18.19s/it]

 31%|███       | 5004/16104 [23:12:15<59:28:02, 19.29s/it]

 31%|███       | 5005/16104 [23:12:29<55:00:15, 17.84s/it]
{'loss': 0.4837, 'learning_rate': 1.6143045972589121e-06, 'rewards/chosen': -1.2200894355773926, 'rewards/rejected': -2.262969970703125, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0428804159164429, 'policy_logps/rejected': -221.1072998046875, 'policy_logps/chosen': -275.0888671875, 'referece_logps/rejected': -198.4776153564453, 'referece_logps/chosen': -262.8879699707031, 'logits/rejected': -0.6748139262199402, 'logits/chosen': -0.7261130809783936, 'epoch': 1.86}

 31%|███       | 5006/16104 [23:12:47<54:21:25, 17.63s/it]

 31%|███       | 5007/16104 [23:13:02<52:43:38, 17.11s/it]

 31%|███       | 5008/16104 [23:13:21<53:59:16, 17.52s/it]

 31%|███       | 5009/16104 [23:13:37<52:24:19, 17.00s/it]

 31%|███       | 5010/16104 [23:13:55<53:51:30, 17.48s/it]

 31%|███       | 5011/16104 [23:14:11<51:52:07, 16.83s/it]

 31%|███       | 5012/16104 [23:14:23<47:53:51, 15.55s/it]

 31%|███       | 5013/16104 [23:14:38<47:15:30, 15.34s/it]

 31%|███       | 5014/16104 [23:14:56<49:58:18, 16.22s/it]

 31%|███       | 5015/16104 [23:15:08<46:05:45, 14.96s/it]

 31%|███       | 5016/16104 [23:15:23<45:47:52, 14.87s/it]

 31%|███       | 5017/16104 [23:15:41<48:53:10, 15.87s/it]

 31%|███       | 5018/16104 [23:15:59<50:53:25, 16.53s/it]

 31%|███       | 5019/16104 [23:16:19<53:35:12, 17.40s/it]

 31%|███       | 5020/16104 [23:16:35<52:52:47, 17.17s/it]

 31%|███       | 5021/16104 [23:16:52<52:49:28, 17.16s/it]

 31%|███       | 5022/16104 [23:17:06<49:54:11, 16.21s/it]

 31%|███       | 5023/16104 [23:17:23<49:56:02, 16.22s/it]

 31%|███       | 5024/16104 [23:17:36<46:50:40, 15.22s/it]

 31%|███       | 5025/16104 [23:17:50<46:18:00, 15.04s/it]

 31%|███       | 5026/16104 [23:18:06<47:06:15, 15.31s/it]

 31%|███       | 5027/16104 [23:18:20<45:54:53, 14.92s/it]


 31%|███       | 5029/16104 [23:18:58<52:11:21, 16.96s/it]
{'loss': 0.4984, 'learning_rate': 1.6104885949246565e-06, 'rewards/chosen': -1.0240060091018677, 'rewards/rejected': -1.3868945837020874, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3628885746002197, 'policy_logps/rejected': -378.3402404785156, 'policy_logps/chosen': -305.5205993652344, 'referece_logps/rejected': -364.4712829589844, 'referece_logps/chosen': -295.28057861328125, 'logits/rejected': -0.9888999462127686, 'logits/chosen': -0.8921727538108826, 'epoch': 1.87}

 31%|███       | 5030/16104 [23:19:12<49:51:45, 16.21s/it]

 31%|███       | 5031/16104 [23:19:29<50:01:39, 16.26s/it]

 31%|███       | 5032/16104 [23:19:44<49:30:08, 16.10s/it]


 31%|███▏      | 5034/16104 [23:20:26<57:12:08, 18.60s/it]
{'loss': 0.4374, 'learning_rate': 1.6096918010693545e-06, 'rewards/chosen': -1.1280094385147095, 'rewards/rejected': -1.4119210243225098, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2839115262031555, 'policy_logps/rejected': -390.68011474609375, 'policy_logps/chosen': -374.69854736328125, 'referece_logps/rejected': -376.5609130859375, 'referece_logps/chosen': -363.41845703125, 'logits/rejected': -0.9270212650299072, 'logits/chosen': -0.9165497422218323, 'epoch': 1.88}

 31%|███▏      | 5035/16104 [23:20:45<57:25:27, 18.68s/it]

 31%|███▏      | 5036/16104 [23:21:04<57:40:59, 18.76s/it]


 31%|███▏      | 5038/16104 [23:21:40<56:41:18, 18.44s/it]
{'loss': 0.537, 'learning_rate': 1.6090539220102657e-06, 'rewards/chosen': -0.42528876662254333, 'rewards/rejected': -0.9104796051979065, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4851907789707184, 'policy_logps/rejected': -359.33233642578125, 'policy_logps/chosen': -548.4220581054688, 'referece_logps/rejected': -350.2275390625, 'referece_logps/chosen': -544.1690673828125, 'logits/rejected': -0.02376026287674904, 'logits/chosen': -0.08418585360050201, 'epoch': 1.88}

 31%|███▏      | 5039/16104 [23:22:00<57:51:34, 18.82s/it]

 31%|███▏      | 5040/16104 [23:22:20<58:54:13, 19.17s/it]


 31%|███▏      | 5042/16104 [23:22:48<50:50:23, 16.55s/it]

 31%|███▏      | 5043/16104 [23:23:04<50:24:28, 16.41s/it]
{'loss': 0.4867, 'learning_rate': 1.6082560188951834e-06, 'rewards/chosen': -0.6773355603218079, 'rewards/rejected': -1.9081261157989502, 'rewards/accuracies': 1.0, 'rewards/margins': 1.230790376663208, 'policy_logps/rejected': -383.9654235839844, 'policy_logps/chosen': -311.0877685546875, 'referece_logps/rejected': -364.8841552734375, 'referece_logps/chosen': -304.3144226074219, 'logits/rejected': -0.7315654158592224, 'logits/chosen': -0.6891043782234192, 'epoch': 1.88}

 31%|███▏      | 5044/16104 [23:23:19<49:29:30, 16.11s/it]

 31%|███▏      | 5045/16104 [23:23:31<44:57:07, 14.63s/it]

 31%|███▏      | 5046/16104 [23:23:51<50:06:42, 16.31s/it]


 31%|███▏      | 5048/16104 [23:24:20<47:50:23, 15.58s/it]
{'loss': 0.4949, 'learning_rate': 1.607457500654116e-06, 'rewards/chosen': -1.1379146575927734, 'rewards/rejected': -1.8813549280166626, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7434402704238892, 'policy_logps/rejected': -339.98321533203125, 'policy_logps/chosen': -363.3882751464844, 'referece_logps/rejected': -321.1696472167969, 'referece_logps/chosen': -352.0091247558594, 'logits/rejected': 0.24329809844493866, 'logits/chosen': 0.26501303911209106, 'epoch': 1.88}


 31%|███▏      | 5050/16104 [23:24:50<45:47:29, 14.91s/it]
{'loss': 0.6, 'learning_rate': 1.6071379213032808e-06, 'rewards/chosen': -1.0149567127227783, 'rewards/rejected': -0.9789756536483765, 'rewards/accuracies': 0.5, 'rewards/margins': -0.03598100692033768, 'policy_logps/rejected': -515.1734619140625, 'policy_logps/chosen': -512.1332397460938, 'referece_logps/rejected': -505.3836669921875, 'referece_logps/chosen': -501.983642578125, 'logits/rejected': -0.4675171375274658, 'logits/chosen': -0.6142203211784363, 'epoch': 1.88}

 31%|███▏      | 5051/16104 [23:25:01<42:26:52, 13.83s/it]

 31%|███▏      | 5052/16104 [23:25:12<39:31:25, 12.87s/it]

 31%|███▏      | 5053/16104 [23:25:29<43:18:38, 14.11s/it]

 31%|███▏      | 5054/16104 [23:25:40<40:18:23, 13.13s/it]

 31%|███▏      | 5055/16104 [23:25:53<39:58:05, 13.02s/it]

 31%|███▏      | 5056/16104 [23:26:05<38:53:32, 12.67s/it]


 31%|███▏      | 5058/16104 [23:26:36<44:35:43, 14.53s/it]
{'loss': 0.5121, 'learning_rate': 1.605858622024796e-06, 'rewards/chosen': -0.8370738625526428, 'rewards/rejected': -2.3162944316864014, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4792203903198242, 'policy_logps/rejected': -364.84710693359375, 'policy_logps/chosen': -354.4030456542969, 'referece_logps/rejected': -341.6841735839844, 'referece_logps/chosen': -346.0323181152344, 'logits/rejected': -0.6182259321212769, 'logits/chosen': -0.6351264715194702, 'epoch': 1.88}

 31%|███▏      | 5059/16104 [23:26:47<41:02:50, 13.38s/it]

 31%|███▏      | 5060/16104 [23:27:08<48:13:41, 15.72s/it]

 31%|███▏      | 5061/16104 [23:27:26<50:41:19, 16.52s/it]

 31%|███▏      | 5062/16104 [23:27:46<53:10:30, 17.34s/it]

 31%|███▏      | 5063/16104 [23:28:05<55:12:26, 18.00s/it]

 31%|███▏      | 5064/16104 [23:28:19<51:18:56, 16.73s/it]

 31%|███▏      | 5065/16104 [23:28:36<51:45:15, 16.88s/it]

 31%|███▏      | 5066/16104 [23:28:58<55:59:42, 18.26s/it]

 31%|███▏      | 5067/16104 [23:29:15<54:57:42, 17.93s/it]

 31%|███▏      | 5068/16104 [23:29:34<56:07:38, 18.31s/it]

 31%|███▏      | 5069/16104 [23:29:51<54:53:55, 17.91s/it]

 31%|███▏      | 5070/16104 [23:30:11<56:38:11, 18.48s/it]

 31%|███▏      | 5071/16104 [23:30:29<56:26:51, 18.42s/it]

 31%|███▏      | 5072/16104 [23:30:46<54:45:01, 17.87s/it]

 32%|███▏      | 5073/16104 [23:31:00<51:15:23, 16.73s/it]

 32%|███▏      | 5074/16104 [23:31:13<48:16:33, 15.76s/it]

 32%|███▏      | 5075/16104 [23:31:30<49:10:38, 16.05s/it]

 32%|███▏      | 5076/16104 [23:31:50<52:27:14, 17.12s/it]

 32%|███▏      | 5077/16104 [23:32:11<56:20:12, 18.39s/it]

 32%|███▏      | 5078/16104 [23:32:32<58:37:59, 19.14s/it]

 32%|███▏      | 5079/16104 [23:32:44<52:08:19, 17.02s/it]

 32%|███▏      | 5080/16104 [23:33:02<52:52:11, 17.27s/it]

 32%|███▏      | 5081/16104 [23:33:15<49:25:11, 16.14s/it]

 32%|███▏      | 5082/16104 [23:33:29<47:25:15, 15.49s/it]

 32%|███▏      | 5083/16104 [23:33:48<50:01:56, 16.34s/it]

 32%|███▏      | 5084/16104 [23:34:05<50:31:53, 16.51s/it]

 32%|███▏      | 5085/16104 [23:34:17<46:28:49, 15.19s/it]

 32%|███▏      | 5086/16104 [23:34:35<49:37:10, 16.21s/it]

 32%|███▏      | 5087/16104 [23:34:51<49:17:26, 16.11s/it]

 32%|███▏      | 5088/16104 [23:35:06<47:46:09, 15.61s/it]

 32%|███▏      | 5089/16104 [23:35:16<43:12:45, 14.12s/it]

 32%|███▏      | 5090/16104 [23:35:29<42:07:33, 13.77s/it]

 32%|███▏      | 5091/16104 [23:35:45<44:10:05, 14.44s/it]

 32%|███▏      | 5092/16104 [23:36:04<48:07:01, 15.73s/it]

 32%|███▏      | 5093/16104 [23:36:18<47:04:37, 15.39s/it]

 32%|███▏      | 5094/16104 [23:36:30<43:03:20, 14.08s/it]

 32%|███▏      | 5095/16104 [23:36:50<48:54:59, 16.00s/it]


 32%|███▏      | 5097/16104 [23:37:31<55:35:12, 18.18s/it]
{'loss': 0.5219, 'learning_rate': 1.5995996377989079e-06, 'rewards/chosen': -0.5282244086265564, 'rewards/rejected': -1.7022058963775635, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1739814281463623, 'policy_logps/rejected': -411.26580810546875, 'policy_logps/chosen': -362.0937805175781, 'referece_logps/rejected': -394.2437744140625, 'referece_logps/chosen': -356.8115539550781, 'logits/rejected': -0.6911020278930664, 'logits/chosen': -0.6136005520820618, 'epoch': 1.9}

 32%|███▏      | 5098/16104 [23:37:44<50:54:56, 16.65s/it]

 32%|███▏      | 5099/16104 [23:37:55<45:18:07, 14.82s/it]

 32%|███▏      | 5100/16104 [23:38:14<49:17:22, 16.13s/it]


 32%|███▏      | 5102/16104 [23:38:53<54:47:50, 17.93s/it]
{'loss': 0.5651, 'learning_rate': 1.5987945277824094e-06, 'rewards/chosen': -1.2191368341445923, 'rewards/rejected': -1.9540657997131348, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7349291443824768, 'policy_logps/rejected': -352.4952697753906, 'policy_logps/chosen': -328.7977600097656, 'referece_logps/rejected': -332.95458984375, 'referece_logps/chosen': -316.60638427734375, 'logits/rejected': 0.028861835598945618, 'logits/chosen': -0.03460496664047241, 'epoch': 1.9}

 32%|███▏      | 5103/16104 [23:39:15<57:58:01, 18.97s/it]

 32%|███▏      | 5104/16104 [23:39:34<58:34:55, 19.17s/it]

 32%|███▏      | 5105/16104 [23:39:45<50:47:24, 16.62s/it]

 32%|███▏      | 5106/16104 [23:40:02<51:11:36, 16.76s/it]

 32%|███▏      | 5107/16104 [23:40:22<53:53:22, 17.64s/it]

 32%|███▏      | 5108/16104 [23:40:33<47:44:09, 15.63s/it]

 32%|███▏      | 5109/16104 [23:40:46<45:19:56, 14.84s/it]

 32%|███▏      | 5110/16104 [23:40:59<44:21:02, 14.52s/it]

 32%|███▏      | 5111/16104 [23:41:17<47:17:11, 15.49s/it]

 32%|███▏      | 5112/16104 [23:41:29<44:29:24, 14.57s/it]

 32%|███▏      | 5113/16104 [23:41:48<47:49:53, 15.67s/it]

 32%|███▏      | 5114/16104 [23:42:04<48:01:34, 15.73s/it]

 32%|███▏      | 5115/16104 [23:42:16<44:52:25, 14.70s/it]

 32%|███▏      | 5116/16104 [23:42:36<49:45:26, 16.30s/it]

 32%|███▏      | 5117/16104 [23:42:56<53:08:57, 17.41s/it]

 32%|███▏      | 5118/16104 [23:43:08<48:34:54, 15.92s/it]

 32%|███▏      | 5119/16104 [23:43:29<52:28:52, 17.20s/it]

 32%|███▏      | 5120/16104 [23:43:47<53:19:19, 17.48s/it]

 32%|███▏      | 5121/16104 [23:44:03<52:12:06, 17.11s/it]

 32%|███▏      | 5122/16104 [23:44:14<46:44:11, 15.32s/it]

 32%|███▏      | 5123/16104 [23:44:26<43:58:16, 14.42s/it]

 32%|███▏      | 5124/16104 [23:44:43<45:35:51, 14.95s/it]

 32%|███▏      | 5125/16104 [23:45:00<47:59:44, 15.74s/it]

 32%|███▏      | 5126/16104 [23:45:20<51:41:12, 16.95s/it]


 32%|███▏      | 5128/16104 [23:45:49<48:42:28, 15.98s/it]

 32%|███▏      | 5129/16104 [23:46:06<49:26:07, 16.22s/it]

 32%|███▏      | 5130/16104 [23:46:25<52:32:18, 17.24s/it]

 32%|███▏      | 5131/16104 [23:46:43<52:48:57, 17.33s/it]

 32%|███▏      | 5132/16104 [23:47:01<53:16:37, 17.48s/it]

 32%|███▏      | 5133/16104 [23:47:20<55:23:12, 18.17s/it]
{'loss': 0.4338, 'learning_rate': 1.593789361182213e-06, 'rewards/chosen': -1.4439212083816528, 'rewards/rejected': -3.161804437637329, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7178831100463867, 'policy_logps/rejected': -271.0635681152344, 'policy_logps/chosen': -342.3244323730469, 'referece_logps/rejected': -239.445556640625, 'referece_logps/chosen': -327.88519287109375, 'logits/rejected': -0.9691656231880188, 'logits/chosen': -1.0424518585205078, 'epoch': 1.91}


 32%|███▏      | 5135/16104 [23:47:58<56:28:25, 18.53s/it]

 32%|███▏      | 5136/16104 [23:48:16<55:55:04, 18.35s/it]

 32%|███▏      | 5137/16104 [23:48:30<51:58:04, 17.06s/it]
{'loss': 0.4263, 'learning_rate': 1.5931418477257034e-06, 'rewards/chosen': -0.8388949036598206, 'rewards/rejected': -1.8709607124328613, 'rewards/accuracies': 0.75, 'rewards/margins': 1.032065749168396, 'policy_logps/rejected': -301.06817626953125, 'policy_logps/chosen': -415.5086669921875, 'referece_logps/rejected': -282.3586120605469, 'referece_logps/chosen': -407.11968994140625, 'logits/rejected': -0.2509879469871521, 'logits/chosen': -0.2351863533258438, 'epoch': 1.91}

 32%|███▏      | 5138/16104 [23:48:44<49:19:01, 16.19s/it]


 32%|███▏      | 5140/16104 [23:49:17<48:39:29, 15.98s/it]

 32%|███▏      | 5141/16104 [23:49:35<50:48:57, 16.69s/it]

 32%|███▏      | 5142/16104 [23:49:51<50:29:12, 16.58s/it]
{'loss': 0.3701, 'learning_rate': 1.5923319160971898e-06, 'rewards/chosen': -0.6692857146263123, 'rewards/rejected': -1.9384739398956299, 'rewards/accuracies': 0.625, 'rewards/margins': 1.269188404083252, 'policy_logps/rejected': -334.37615966796875, 'policy_logps/chosen': -344.9739074707031, 'referece_logps/rejected': -314.99139404296875, 'referece_logps/chosen': -338.2810363769531, 'logits/rejected': -0.3408779799938202, 'logits/chosen': -0.3699014186859131, 'epoch': 1.92}

 32%|███▏      | 5143/16104 [23:50:06<48:41:58, 15.99s/it]

 32%|███▏      | 5144/16104 [23:50:20<47:03:33, 15.46s/it]


 32%|███▏      | 5146/16104 [23:50:47<43:53:06, 14.42s/it]
{'loss': 0.4364, 'learning_rate': 1.5916835394591834e-06, 'rewards/chosen': -1.1209385395050049, 'rewards/rejected': -1.6935207843780518, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5725823044776917, 'policy_logps/rejected': -377.58428955078125, 'policy_logps/chosen': -338.13153076171875, 'referece_logps/rejected': -360.6491394042969, 'referece_logps/chosen': -326.9220886230469, 'logits/rejected': -0.1358807384967804, 'logits/chosen': -0.14506302773952484, 'epoch': 1.92}


 32%|███▏      | 5148/16104 [23:51:25<50:52:52, 16.72s/it]
{'loss': 0.562, 'learning_rate': 1.5913592075060197e-06, 'rewards/chosen': -1.0679558515548706, 'rewards/rejected': -1.7243648767471313, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6564090847969055, 'policy_logps/rejected': -442.3724365234375, 'policy_logps/chosen': -355.0621643066406, 'referece_logps/rejected': -425.12884521484375, 'referece_logps/chosen': -344.3825988769531, 'logits/rejected': -0.20161432027816772, 'logits/chosen': -0.04491958022117615, 'epoch': 1.92}


 32%|███▏      | 5150/16104 [23:52:01<53:03:34, 17.44s/it]

 32%|███▏      | 5151/16104 [23:52:14<48:12:12, 15.84s/it]

 32%|███▏      | 5152/16104 [23:52:33<51:49:26, 17.03s/it]

 32%|███▏      | 5153/16104 [23:52:49<50:52:22, 16.72s/it]

 32%|███▏      | 5154/16104 [23:53:10<54:08:28, 17.80s/it]

 32%|███▏      | 5155/16104 [23:53:23<50:23:44, 16.57s/it]
{'loss': 0.4766, 'learning_rate': 1.5902232924861294e-06, 'rewards/chosen': -0.5035129189491272, 'rewards/rejected': -2.2272162437438965, 'rewards/accuracies': 1.0, 'rewards/margins': 1.723703384399414, 'policy_logps/rejected': -251.83555603027344, 'policy_logps/chosen': -332.7832946777344, 'referece_logps/rejected': -229.56338500976562, 'referece_logps/chosen': -327.7481994628906, 'logits/rejected': -0.6368480324745178, 'logits/chosen': -0.3963879644870758, 'epoch': 1.92}


 32%|███▏      | 5157/16104 [23:54:00<53:22:28, 17.55s/it]

 32%|███▏      | 5158/16104 [23:54:19<55:03:31, 18.11s/it]
{'loss': 0.5368, 'learning_rate': 1.5897361134982284e-06, 'rewards/chosen': -1.2950563430786133, 'rewards/rejected': -1.7957887649536133, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5007325410842896, 'policy_logps/rejected': -232.03033447265625, 'policy_logps/chosen': -316.0246887207031, 'referece_logps/rejected': -214.0724639892578, 'referece_logps/chosen': -303.0741271972656, 'logits/rejected': -0.8635514974594116, 'logits/chosen': -0.812494158744812, 'epoch': 1.92}


 32%|███▏      | 5160/16104 [23:54:56<54:54:43, 18.06s/it]
{'loss': 0.6031, 'learning_rate': 1.5894112082159553e-06, 'rewards/chosen': -1.652387022972107, 'rewards/rejected': -2.330723285675049, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6783362030982971, 'policy_logps/rejected': -434.10528564453125, 'policy_logps/chosen': -416.96527099609375, 'referece_logps/rejected': -410.798095703125, 'referece_logps/chosen': -400.4413757324219, 'logits/rejected': -0.3935920000076294, 'logits/chosen': -0.5068234801292419, 'epoch': 1.92}

 32%|███▏      | 5161/16104 [23:55:06<48:15:44, 15.88s/it]


 32%|███▏      | 5163/16104 [23:55:40<49:57:08, 16.44s/it]

 32%|███▏      | 5164/16104 [23:55:57<50:52:28, 16.74s/it]

 32%|███▏      | 5165/16104 [23:56:13<49:43:00, 16.36s/it]

 32%|███▏      | 5166/16104 [23:56:25<46:07:50, 15.18s/it]

 32%|███▏      | 5167/16104 [23:56:44<49:00:27, 16.13s/it]

 32%|███▏      | 5168/16104 [23:57:00<48:47:23, 16.06s/it]

 32%|███▏      | 5169/16104 [23:57:22<54:34:38, 17.97s/it]

 32%|███▏      | 5170/16104 [23:57:40<54:50:05, 18.05s/it]

 32%|███▏      | 5171/16104 [23:58:02<58:18:41, 19.20s/it]
{'loss': 0.5974, 'learning_rate': 1.5876225258182672e-06, 'rewards/chosen': -1.0796555280685425, 'rewards/rejected': -1.3235243558883667, 'rewards/accuracies': 0.375, 'rewards/margins': 0.24386867880821228, 'policy_logps/rejected': -331.88287353515625, 'policy_logps/chosen': -295.45941162109375, 'referece_logps/rejected': -318.6476135253906, 'referece_logps/chosen': -284.6628723144531, 'logits/rejected': -0.973554253578186, 'logits/chosen': -1.0156922340393066, 'epoch': 1.93}


 32%|███▏      | 5173/16104 [23:58:34<54:23:38, 17.91s/it]

 32%|███▏      | 5174/16104 [23:58:49<51:29:52, 16.96s/it]

 32%|███▏      | 5175/16104 [23:59:05<50:46:46, 16.73s/it]

 32%|███▏      | 5176/16104 [23:59:22<50:57:19, 16.79s/it]

 32%|███▏      | 5177/16104 [23:59:42<54:07:45, 17.83s/it]

 32%|███▏      | 5178/16104 [24:00:04<57:26:42, 18.93s/it]

 32%|███▏      | 5179/16104 [24:00:17<52:30:06, 17.30s/it]

 32%|███▏      | 5180/16104 [24:00:35<53:08:52, 17.51s/it]

 32%|███▏      | 5181/16104 [24:00:53<53:20:15, 17.58s/it]
{'loss': 0.5189, 'learning_rate': 1.58599395479192e-06, 'rewards/chosen': -0.8309692144393921, 'rewards/rejected': -1.487603783607483, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6566345691680908, 'policy_logps/rejected': -370.6895751953125, 'policy_logps/chosen': -372.1462097167969, 'referece_logps/rejected': -355.8135681152344, 'referece_logps/chosen': -363.8365173339844, 'logits/rejected': -0.39590156078338623, 'logits/chosen': -0.3051566779613495, 'epoch': 1.93}


 32%|███▏      | 5183/16104 [24:01:22<48:19:24, 15.93s/it]

 32%|███▏      | 5184/16104 [24:01:42<51:41:32, 17.04s/it]

 32%|███▏      | 5185/16104 [24:02:01<53:55:19, 17.78s/it]

 32%|███▏      | 5186/16104 [24:02:23<57:42:56, 19.03s/it]
{'loss': 0.4683, 'learning_rate': 1.585178779948133e-06, 'rewards/chosen': -0.9631441235542297, 'rewards/rejected': -2.1457903385162354, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1826460361480713, 'policy_logps/rejected': -457.5004577636719, 'policy_logps/chosen': -456.60565185546875, 'referece_logps/rejected': -436.0425109863281, 'referece_logps/chosen': -446.9742126464844, 'logits/rejected': -0.8699154257774353, 'logits/chosen': -0.8497381806373596, 'epoch': 1.93}


 32%|███▏      | 5188/16104 [24:02:57<54:21:43, 17.93s/it]

 32%|███▏      | 5189/16104 [24:03:12<51:36:16, 17.02s/it]

 32%|███▏      | 5190/16104 [24:03:31<54:05:59, 17.84s/it]

 32%|███▏      | 5191/16104 [24:03:53<57:57:59, 19.12s/it]
{'loss': 0.4764, 'learning_rate': 1.5843630133162467e-06, 'rewards/chosen': -0.6856338977813721, 'rewards/rejected': -1.83810555934906, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1524715423583984, 'policy_logps/rejected': -334.43109130859375, 'policy_logps/chosen': -415.1028137207031, 'referece_logps/rejected': -316.0500183105469, 'referece_logps/chosen': -408.2464904785156, 'logits/rejected': -0.9372852444648743, 'logits/chosen': -0.8538582921028137, 'epoch': 1.93}


 32%|███▏      | 5193/16104 [24:04:36<61:27:56, 20.28s/it]
{'loss': 0.5134, 'learning_rate': 1.5840365411475998e-06, 'rewards/chosen': -0.36560070514678955, 'rewards/rejected': -1.3155467510223389, 'rewards/accuracies': 1.0, 'rewards/margins': 0.9499461054801941, 'policy_logps/rejected': -237.3774871826172, 'policy_logps/chosen': -237.25579833984375, 'referece_logps/rejected': -224.22201538085938, 'referece_logps/chosen': -233.59979248046875, 'logits/rejected': -1.0582201480865479, 'logits/chosen': -1.088114619255066, 'epoch': 1.93}


 32%|███▏      | 5195/16104 [24:05:06<52:44:15, 17.40s/it]
{'loss': 0.4965, 'learning_rate': 1.5837099744776725e-06, 'rewards/chosen': -0.8302822113037109, 'rewards/rejected': -2.3324005603790283, 'rewards/accuracies': 0.75, 'rewards/margins': 1.5021182298660278, 'policy_logps/rejected': -388.2390441894531, 'policy_logps/chosen': -466.4096374511719, 'referece_logps/rejected': -364.9150695800781, 'referece_logps/chosen': -458.1068115234375, 'logits/rejected': -0.9318345785140991, 'logits/chosen': -0.7537152171134949, 'epoch': 1.94}


 32%|███▏      | 5197/16104 [24:05:42<53:07:11, 17.53s/it]
{'loss': 0.4182, 'learning_rate': 1.583383313359306e-06, 'rewards/chosen': -1.1760286092758179, 'rewards/rejected': -2.807380437850952, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6313517093658447, 'policy_logps/rejected': -390.1864013671875, 'policy_logps/chosen': -382.64715576171875, 'referece_logps/rejected': -362.112548828125, 'referece_logps/chosen': -370.8868408203125, 'logits/rejected': 0.01764845848083496, 'logits/chosen': 0.09567031264305115, 'epoch': 1.94}


 32%|███▏      | 5199/16104 [24:06:16<52:22:12, 17.29s/it]

 32%|███▏      | 5200/16104 [24:06:34<52:40:08, 17.39s/it]

 32%|███▏      | 5201/16104 [24:06:53<54:47:37, 18.09s/it]

 32%|███▏      | 5202/16104 [24:07:16<58:35:57, 19.35s/it]

 32%|███▏      | 5203/16104 [24:07:32<55:57:43, 18.48s/it]
{'loss': 0.4589, 'learning_rate': 1.5824027638422072e-06, 'rewards/chosen': -1.1420660018920898, 'rewards/rejected': -2.213670253753662, 'rewards/accuracies': 1.0, 'rewards/margins': 1.0716042518615723, 'policy_logps/rejected': -554.7610473632812, 'policy_logps/chosen': -429.48382568359375, 'referece_logps/rejected': -532.6243896484375, 'referece_logps/chosen': -418.0631408691406, 'logits/rejected': -1.085935115814209, 'logits/chosen': -0.9708462953567505, 'epoch': 1.94}


 32%|███▏      | 5205/16104 [24:07:58<46:43:32, 15.43s/it]

 32%|███▏      | 5206/16104 [24:08:18<50:37:56, 16.73s/it]

 32%|███▏      | 5207/16104 [24:08:30<46:48:55, 15.47s/it]

 32%|███▏      | 5208/16104 [24:08:44<45:33:10, 15.05s/it]

 32%|███▏      | 5209/16104 [24:09:04<49:43:43, 16.43s/it]

 32%|███▏      | 5210/16104 [24:09:22<51:16:20, 16.94s/it]

 32%|███▏      | 5211/16104 [24:09:38<50:42:12, 16.76s/it]

 32%|███▏      | 5212/16104 [24:09:56<51:13:06, 16.93s/it]

 32%|███▏      | 5213/16104 [24:10:08<46:59:10, 15.53s/it]

 32%|███▏      | 5214/16104 [24:10:27<49:49:19, 16.47s/it]

 32%|███▏      | 5215/16104 [24:10:39<45:54:52, 15.18s/it]

 32%|███▏      | 5216/16104 [24:10:50<41:53:15, 13.85s/it]

 32%|███▏      | 5217/16104 [24:11:01<39:31:35, 13.07s/it]

 32%|███▏      | 5218/16104 [24:11:18<42:54:57, 14.19s/it]
{'loss': 0.4459, 'learning_rate': 1.5799476825976572e-06, 'rewards/chosen': -1.1773667335510254, 'rewards/rejected': -1.6822236776351929, 'rewards/accuracies': 0.625, 'rewards/margins': 0.504857063293457, 'policy_logps/rejected': -542.0735473632812, 'policy_logps/chosen': -561.1213989257812, 'referece_logps/rejected': -525.2513427734375, 'referece_logps/chosen': -549.3477783203125, 'logits/rejected': -1.102810263633728, 'logits/chosen': -1.1152821779251099, 'epoch': 1.94}

 32%|███▏      | 5219/16104 [24:11:34<44:25:42, 14.69s/it]

 32%|███▏      | 5220/16104 [24:11:46<41:59:53, 13.89s/it]


 32%|███▏      | 5222/16104 [24:12:25<50:47:50, 16.80s/it]

 32%|███▏      | 5223/16104 [24:12:44<53:19:18, 17.64s/it]
{'loss': 0.5398, 'learning_rate': 1.5791281480829028e-06, 'rewards/chosen': -1.3344457149505615, 'rewards/rejected': -2.307992458343506, 'rewards/accuracies': 0.5, 'rewards/margins': 0.9735468626022339, 'policy_logps/rejected': -386.04541015625, 'policy_logps/chosen': -287.8871765136719, 'referece_logps/rejected': -362.9654846191406, 'referece_logps/chosen': -274.542724609375, 'logits/rejected': -0.9260988235473633, 'logits/chosen': -0.8538388013839722, 'epoch': 1.95}



 32%|███▏      | 5226/16104 [24:13:31<48:36:24, 16.09s/it]
{'loss': 0.5783, 'learning_rate': 1.578800170243213e-06, 'rewards/chosen': -1.1108598709106445, 'rewards/rejected': -1.6691787242889404, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5583187341690063, 'policy_logps/rejected': -367.6080322265625, 'policy_logps/chosen': -313.7052001953125, 'referece_logps/rejected': -350.916259765625, 'referece_logps/chosen': -302.5965881347656, 'logits/rejected': 0.6477608680725098, 'logits/chosen': 0.541571855545044, 'epoch': 1.95}

 32%|███▏      | 5227/16104 [24:13:49<50:40:32, 16.77s/it]

 32%|███▏      | 5228/16104 [24:14:01<46:16:33, 15.32s/it]

 32%|███▏      | 5229/16104 [24:14:13<43:12:48, 14.31s/it]
{'loss': 0.4925, 'learning_rate': 1.5781439336549233e-06, 'rewards/chosen': -1.0119558572769165, 'rewards/rejected': -1.8332288265228271, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8212730884552002, 'policy_logps/rejected': -329.5162048339844, 'policy_logps/chosen': -353.823974609375, 'referece_logps/rejected': -311.18389892578125, 'referece_logps/chosen': -343.7044372558594, 'logits/rejected': -0.8095449209213257, 'logits/chosen': -0.7805312275886536, 'epoch': 1.95}

 32%|███▏      | 5230/16104 [24:14:30<45:13:53, 14.97s/it]


 32%|███▏      | 5232/16104 [24:14:51<38:36:36, 12.78s/it]
{'loss': 0.5409, 'learning_rate': 1.5776515106274666e-06, 'rewards/chosen': -1.0548092126846313, 'rewards/rejected': -1.145106315612793, 'rewards/accuracies': 0.625, 'rewards/margins': 0.09029711782932281, 'policy_logps/rejected': -438.5833740234375, 'policy_logps/chosen': -528.769775390625, 'referece_logps/rejected': -427.1323547363281, 'referece_logps/chosen': -518.2216796875, 'logits/rejected': -0.8271055221557617, 'logits/chosen': -0.7008135914802551, 'epoch': 1.95}

 32%|███▏      | 5233/16104 [24:15:08<42:08:25, 13.96s/it]


 33%|███▎      | 5235/16104 [24:15:45<50:03:18, 16.58s/it]
{'loss': 0.5607, 'learning_rate': 1.5771588772967058e-06, 'rewards/chosen': -1.1396549940109253, 'rewards/rejected': -1.6425515413284302, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5028965473175049, 'policy_logps/rejected': -408.5892333984375, 'policy_logps/chosen': -428.9577941894531, 'referece_logps/rejected': -392.1637268066406, 'referece_logps/chosen': -417.561279296875, 'logits/rejected': 0.2697294354438782, 'logits/chosen': 0.3059285879135132, 'epoch': 1.95}

 33%|███▎      | 5236/16104 [24:15:56<45:24:22, 15.04s/it]


 33%|███▎      | 5238/16104 [24:16:25<44:43:33, 14.82s/it]
{'loss': 0.5778, 'learning_rate': 1.576666033841992e-06, 'rewards/chosen': -1.6194326877593994, 'rewards/rejected': -1.7452565431594849, 'rewards/accuracies': 0.625, 'rewards/margins': 0.125823974609375, 'policy_logps/rejected': -369.2249450683594, 'policy_logps/chosen': -338.08148193359375, 'referece_logps/rejected': -351.7723693847656, 'referece_logps/chosen': -321.8871154785156, 'logits/rejected': -1.2017852067947388, 'logits/chosen': -1.1231052875518799, 'epoch': 1.95}

 33%|███▎      | 5239/16104 [24:16:38<42:46:03, 14.17s/it]


 33%|███▎      | 5241/16104 [24:17:07<43:45:17, 14.50s/it]

 33%|███▎      | 5242/16104 [24:17:22<44:04:12, 14.61s/it]
{'loss': 0.6253, 'learning_rate': 1.5760085826863572e-06, 'rewards/chosen': -1.3281916379928589, 'rewards/rejected': -1.4539759159088135, 'rewards/accuracies': 0.625, 'rewards/margins': 0.12578439712524414, 'policy_logps/rejected': -219.89590454101562, 'policy_logps/chosen': -224.51002502441406, 'referece_logps/rejected': -205.3561248779297, 'referece_logps/chosen': -211.2281036376953, 'logits/rejected': -1.037122130393982, 'logits/chosen': -1.083878993988037, 'epoch': 1.95}


 33%|███▎      | 5244/16104 [24:17:59<50:56:01, 16.88s/it]

 33%|███▎      | 5245/16104 [24:18:19<53:36:30, 17.77s/it]

 33%|███▎      | 5246/16104 [24:18:38<54:03:05, 17.92s/it]
{'loss': 0.4829, 'learning_rate': 1.5753507587215407e-06, 'rewards/chosen': -1.6219643354415894, 'rewards/rejected': -3.3792572021484375, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7572929859161377, 'policy_logps/rejected': -337.96148681640625, 'policy_logps/chosen': -338.4508972167969, 'referece_logps/rejected': -304.16888427734375, 'referece_logps/chosen': -322.2312316894531, 'logits/rejected': 0.14328163862228394, 'logits/chosen': 0.08490794897079468, 'epoch': 1.95}


 33%|███▎      | 5248/16104 [24:19:15<55:39:05, 18.45s/it]
{'loss': 0.5072, 'learning_rate': 1.5750217070687302e-06, 'rewards/chosen': -1.23221755027771, 'rewards/rejected': -1.6430808305740356, 'rewards/accuracies': 0.625, 'rewards/margins': 0.41086316108703613, 'policy_logps/rejected': -425.3865051269531, 'policy_logps/chosen': -281.4032287597656, 'referece_logps/rejected': -408.9556579589844, 'referece_logps/chosen': -269.0810546875, 'logits/rejected': -0.36608242988586426, 'logits/chosen': -0.2701265811920166, 'epoch': 1.96}

 33%|███▎      | 5249/16104 [24:19:26<49:03:18, 16.27s/it]

 33%|███▎      | 5250/16104 [24:19:38<45:01:02, 14.93s/it]

 33%|███▎      | 5251/16104 [24:19:52<44:06:18, 14.63s/it]


 33%|███▎      | 5253/16104 [24:20:23<45:37:39, 15.14s/it]
{'loss': 0.476, 'learning_rate': 1.5741986709917665e-06, 'rewards/chosen': -1.1362403631210327, 'rewards/rejected': -2.1508114337921143, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0145710706710815, 'policy_logps/rejected': -442.422119140625, 'policy_logps/chosen': -555.9093627929688, 'referece_logps/rejected': -420.9139709472656, 'referece_logps/chosen': -544.5469970703125, 'logits/rejected': 0.1497998684644699, 'logits/chosen': 0.16740165650844574, 'epoch': 1.96}

 33%|███▎      | 5254/16104 [24:20:43<49:58:44, 16.58s/it]


 33%|███▎      | 5256/16104 [24:21:11<46:39:26, 15.48s/it]

 33%|███▎      | 5257/16104 [24:21:30<49:07:13, 16.30s/it]

 33%|███▎      | 5258/16104 [24:21:47<50:24:57, 16.73s/it]

 33%|███▎      | 5259/16104 [24:21:59<45:55:20, 15.24s/it]
{'loss': 0.4315, 'learning_rate': 1.5732102612698493e-06, 'rewards/chosen': -1.159463882446289, 'rewards/rejected': -1.968289852142334, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8088260889053345, 'policy_logps/rejected': -425.97015380859375, 'policy_logps/chosen': -510.8427429199219, 'referece_logps/rejected': -406.2872619628906, 'referece_logps/chosen': -499.24810791015625, 'logits/rejected': -1.1077500581741333, 'logits/chosen': -1.1076183319091797, 'epoch': 1.96}


 33%|███▎      | 5261/16104 [24:22:30<44:46:49, 14.87s/it]
{'loss': 0.5098, 'learning_rate': 1.572880605792426e-06, 'rewards/chosen': -1.1835732460021973, 'rewards/rejected': -1.5776253938674927, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3940521776676178, 'policy_logps/rejected': -493.17425537109375, 'policy_logps/chosen': -506.5545654296875, 'referece_logps/rejected': -477.39794921875, 'referece_logps/chosen': -494.7188415527344, 'logits/rejected': -1.416574239730835, 'logits/chosen': -1.3076703548431396, 'epoch': 1.96}

 33%|███▎      | 5262/16104 [24:22:47<46:47:09, 15.53s/it]


 33%|███▎      | 5264/16104 [24:23:17<46:15:44, 15.36s/it]
{'loss': 0.45, 'learning_rate': 1.572385948787645e-06, 'rewards/chosen': -0.9625673294067383, 'rewards/rejected': -2.284724473953247, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3221571445465088, 'policy_logps/rejected': -480.21173095703125, 'policy_logps/chosen': -575.2652587890625, 'referece_logps/rejected': -457.3645324707031, 'referece_logps/chosen': -565.6395874023438, 'logits/rejected': -0.5848261713981628, 'logits/chosen': -0.5162766575813293, 'epoch': 1.96}

 33%|███▎      | 5265/16104 [24:23:35<48:06:27, 15.98s/it]


 33%|███▎      | 5267/16104 [24:24:14<53:26:08, 17.75s/it]

 33%|███▎      | 5268/16104 [24:24:32<53:43:48, 17.85s/it]

 33%|███▎      | 5269/16104 [24:24:44<48:13:10, 16.02s/it]
{'loss': 0.5398, 'learning_rate': 1.571561057454661e-06, 'rewards/chosen': -1.3316395282745361, 'rewards/rejected': -2.0581939220428467, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7265545129776001, 'policy_logps/rejected': -322.8805847167969, 'policy_logps/chosen': -481.75177001953125, 'referece_logps/rejected': -302.2986755371094, 'referece_logps/chosen': -468.4353332519531, 'logits/rejected': 0.12661641836166382, 'logits/chosen': 0.18465103209018707, 'epoch': 1.96}


 33%|███▎      | 5271/16104 [24:25:09<43:25:04, 14.43s/it]

 33%|███▎      | 5272/16104 [24:25:29<48:13:44, 16.03s/it]
{'loss': 0.5989, 'learning_rate': 1.5710658451535029e-06, 'rewards/chosen': -0.9692772626876831, 'rewards/rejected': -2.1298890113830566, 'rewards/accuracies': 0.875, 'rewards/margins': 1.160611867904663, 'policy_logps/rejected': -294.04425048828125, 'policy_logps/chosen': -479.9254150390625, 'referece_logps/rejected': -272.7453918457031, 'referece_logps/chosen': -470.2326354980469, 'logits/rejected': -0.8107882738113403, 'logits/chosen': -0.8416412472724915, 'epoch': 1.96}


 33%|███▎      | 5274/16104 [24:25:55<44:18:57, 14.73s/it]
{'loss': 0.4452, 'learning_rate': 1.570735588105106e-06, 'rewards/chosen': -1.0537035465240479, 'rewards/rejected': -2.90598464012146, 'rewards/accuracies': 1.0, 'rewards/margins': 1.8522809743881226, 'policy_logps/rejected': -550.7078857421875, 'policy_logps/chosen': -415.3792419433594, 'referece_logps/rejected': -521.6480712890625, 'referece_logps/chosen': -404.84222412109375, 'logits/rejected': -0.564373254776001, 'logits/chosen': -0.3336751163005829, 'epoch': 1.96}

 33%|███▎      | 5275/16104 [24:26:10<44:21:43, 14.75s/it]

 33%|███▎      | 5276/16104 [24:26:30<49:07:14, 16.33s/it]

 33%|███▎      | 5277/16104 [24:26:52<54:16:56, 18.05s/it]

 33%|███▎      | 5278/16104 [24:27:09<52:54:51, 17.60s/it]


 33%|███▎      | 5280/16104 [24:27:44<53:22:18, 17.75s/it]

 33%|███▎      | 5281/16104 [24:28:04<55:14:32, 18.37s/it]
{'loss': 0.3979, 'learning_rate': 1.5695789615374456e-06, 'rewards/chosen': -1.0752824544906616, 'rewards/rejected': -1.3942768573760986, 'rewards/accuracies': 0.75, 'rewards/margins': 0.31899434328079224, 'policy_logps/rejected': -466.6171569824219, 'policy_logps/chosen': -316.4004821777344, 'referece_logps/rejected': -452.67437744140625, 'referece_logps/chosen': -305.64764404296875, 'logits/rejected': -0.011518105864524841, 'logits/chosen': 0.06483374536037445, 'epoch': 1.97}


 33%|███▎      | 5283/16104 [24:28:35<52:03:21, 17.32s/it]

 33%|███▎      | 5284/16104 [24:28:48<48:03:32, 15.99s/it]
{'loss': 0.4762, 'learning_rate': 1.5690829186960364e-06, 'rewards/chosen': -1.514098048210144, 'rewards/rejected': -2.3561127185821533, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8420147895812988, 'policy_logps/rejected': -470.26873779296875, 'policy_logps/chosen': -461.8759765625, 'referece_logps/rejected': -446.70758056640625, 'referece_logps/chosen': -446.7349853515625, 'logits/rejected': -0.3631642758846283, 'logits/chosen': -0.2320038378238678, 'epoch': 1.97}

 33%|███▎      | 5285/16104 [24:29:09<52:03:26, 17.32s/it]

 33%|███▎      | 5286/16104 [24:29:31<56:13:05, 18.71s/it]

 33%|███▎      | 5287/16104 [24:29:47<54:04:14, 18.00s/it]


 33%|███▎      | 5289/16104 [24:30:22<52:59:17, 17.64s/it]

 33%|███▎      | 5290/16104 [24:30:38<51:47:44, 17.24s/it]

 33%|███▎      | 5291/16104 [24:30:52<48:54:13, 16.28s/it]
{'loss': 0.5443, 'learning_rate': 1.5679246799970276e-06, 'rewards/chosen': -1.1800730228424072, 'rewards/rejected': -1.6922510862350464, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5121779441833496, 'policy_logps/rejected': -355.13800048828125, 'policy_logps/chosen': -344.3878173828125, 'referece_logps/rejected': -338.2154541015625, 'referece_logps/chosen': -332.58709716796875, 'logits/rejected': 0.42853420972824097, 'logits/chosen': 0.5015988349914551, 'epoch': 1.97}

 33%|███▎      | 5292/16104 [24:31:03<44:24:05, 14.78s/it]


 33%|███▎      | 5294/16104 [24:31:32<43:32:58, 14.50s/it]
{'loss': 0.3322, 'learning_rate': 1.5674279472457766e-06, 'rewards/chosen': -1.3568247556686401, 'rewards/rejected': -2.657308578491211, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3004839420318604, 'policy_logps/rejected': -382.7901916503906, 'policy_logps/chosen': -492.48040771484375, 'referece_logps/rejected': -356.21710205078125, 'referece_logps/chosen': -478.912109375, 'logits/rejected': -1.1645011901855469, 'logits/chosen': -1.1654605865478516, 'epoch': 1.97}


 33%|███▎      | 5296/16104 [24:32:10<50:18:50, 16.76s/it]
{'loss': 0.3976, 'learning_rate': 1.5670966772997475e-06, 'rewards/chosen': -0.9761465787887573, 'rewards/rejected': -2.4077799320220947, 'rewards/accuracies': 0.75, 'rewards/margins': 1.431633472442627, 'policy_logps/rejected': -353.70306396484375, 'policy_logps/chosen': -513.4103393554688, 'referece_logps/rejected': -329.625244140625, 'referece_logps/chosen': -503.6488952636719, 'logits/rejected': -0.34757447242736816, 'logits/chosen': -0.3299869894981384, 'epoch': 1.97}


 33%|███▎      | 5298/16104 [24:32:46<51:38:18, 17.20s/it]
{'loss': 0.4137, 'learning_rate': 1.5667653155934292e-06, 'rewards/chosen': -1.4942322969436646, 'rewards/rejected': -2.5130698680877686, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0188379287719727, 'policy_logps/rejected': -296.98284912109375, 'policy_logps/chosen': -329.094970703125, 'referece_logps/rejected': -271.8521728515625, 'referece_logps/chosen': -314.1526184082031, 'logits/rejected': -1.1221766471862793, 'logits/chosen': -0.9409613013267517, 'epoch': 1.97}


 33%|███▎      | 5300/16104 [24:33:18<50:33:15, 16.85s/it]
{'loss': 0.3843, 'learning_rate': 1.5664338621804383e-06, 'rewards/chosen': -1.3826152086257935, 'rewards/rejected': -2.629568099975586, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2469528913497925, 'policy_logps/rejected': -299.1934509277344, 'policy_logps/chosen': -306.21392822265625, 'referece_logps/rejected': -272.8977966308594, 'referece_logps/chosen': -292.3877868652344, 'logits/rejected': 0.28570353984832764, 'logits/chosen': 0.13814806938171387, 'epoch': 1.97}


 33%|███▎      | 5302/16104 [24:33:51<47:58:39, 15.99s/it]
{'loss': 0.5131, 'learning_rate': 1.5661023171144062e-06, 'rewards/chosen': -0.622618556022644, 'rewards/rejected': -1.6461069583892822, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0234882831573486, 'policy_logps/rejected': -386.37298583984375, 'policy_logps/chosen': -383.51483154296875, 'referece_logps/rejected': -369.9118957519531, 'referece_logps/chosen': -377.2886657714844, 'logits/rejected': -0.5123957395553589, 'logits/chosen': -0.5334289073944092, 'epoch': 1.98}

 33%|███▎      | 5303/16104 [24:34:07<48:46:07, 16.25s/it]


 33%|███▎      | 5305/16104 [24:34:43<51:14:20, 17.08s/it]

 33%|███▎      | 5306/16104 [24:34:58<49:51:04, 16.62s/it]
{'loss': 0.4254, 'learning_rate': 1.5654389522378186e-06, 'rewards/chosen': -1.207554578781128, 'rewards/rejected': -2.029043197631836, 'rewards/accuracies': 1.0, 'rewards/margins': 0.8214887380599976, 'policy_logps/rejected': -330.910888671875, 'policy_logps/chosen': -510.76263427734375, 'referece_logps/rejected': -310.6204833984375, 'referece_logps/chosen': -498.6871337890625, 'logits/rejected': -0.7485297918319702, 'logits/chosen': -0.834618330001831, 'epoch': 1.98}


 33%|███▎      | 5308/16104 [24:35:36<53:13:57, 17.75s/it]

 33%|███▎      | 5309/16104 [24:35:52<51:17:20, 17.10s/it]
{'loss': 0.4897, 'learning_rate': 1.5649411883902475e-06, 'rewards/chosen': -0.9263750314712524, 'rewards/rejected': -1.5399746894836426, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6135995984077454, 'policy_logps/rejected': -419.72735595703125, 'policy_logps/chosen': -350.59674072265625, 'referece_logps/rejected': -404.32763671875, 'referece_logps/chosen': -341.33294677734375, 'logits/rejected': -0.7808996438980103, 'logits/chosen': -0.6406668424606323, 'epoch': 1.98}


 33%|███▎      | 5311/16104 [24:36:23<48:27:57, 16.17s/it]
{'loss': 0.5041, 'learning_rate': 1.5646092315496176e-06, 'rewards/chosen': -0.715746283531189, 'rewards/rejected': -2.3422722816467285, 'rewards/accuracies': 0.875, 'rewards/margins': 1.62652587890625, 'policy_logps/rejected': -257.1609802246094, 'policy_logps/chosen': -327.9517822265625, 'referece_logps/rejected': -233.73825073242188, 'referece_logps/chosen': -320.79437255859375, 'logits/rejected': -0.4417727589607239, 'logits/chosen': -0.3435244560241699, 'epoch': 1.98}


 33%|███▎      | 5313/16104 [24:36:54<47:51:37, 15.97s/it]
{'loss': 0.5815, 'learning_rate': 1.5642771833511853e-06, 'rewards/chosen': -0.7934890985488892, 'rewards/rejected': -1.528892993927002, 'rewards/accuracies': 0.75, 'rewards/margins': 0.735403835773468, 'policy_logps/rejected': -345.64385986328125, 'policy_logps/chosen': -330.93048095703125, 'referece_logps/rejected': -330.3549499511719, 'referece_logps/chosen': -322.99554443359375, 'logits/rejected': 0.22615674138069153, 'logits/chosen': 0.2563296854496002, 'epoch': 1.98}


 33%|███▎      | 5315/16104 [24:37:24<45:13:15, 15.09s/it]

 33%|███▎      | 5316/16104 [24:37:44<49:22:02, 16.47s/it]

 33%|███▎      | 5317/16104 [24:37:58<47:08:21, 15.73s/it]
{'loss': 0.5001, 'learning_rate': 1.5636128130958369e-06, 'rewards/chosen': -0.8433729410171509, 'rewards/rejected': -1.2001572847366333, 'rewards/accuracies': 0.75, 'rewards/margins': 0.35678428411483765, 'policy_logps/rejected': -314.2812805175781, 'policy_logps/chosen': -561.6884765625, 'referece_logps/rejected': -302.27972412109375, 'referece_logps/chosen': -553.2547607421875, 'logits/rejected': -0.4355710446834564, 'logits/chosen': -0.6827725768089294, 'epoch': 1.98}


 33%|███▎      | 5319/16104 [24:38:37<52:38:06, 17.57s/it]
{'loss': 0.6617, 'learning_rate': 1.5632804911464213e-06, 'rewards/chosen': -0.5576955676078796, 'rewards/rejected': -0.9499450922012329, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3922494649887085, 'policy_logps/rejected': -575.4620361328125, 'policy_logps/chosen': -616.2481689453125, 'referece_logps/rejected': -565.9625854492188, 'referece_logps/chosen': -610.6712646484375, 'logits/rejected': -1.0620250701904297, 'logits/chosen': -1.0722253322601318, 'epoch': 1.98}

 33%|███▎      | 5320/16104 [24:38:58<55:32:34, 18.54s/it]

 33%|███▎      | 5321/16104 [24:39:17<56:43:39, 18.94s/it]

 33%|███▎      | 5322/16104 [24:39:35<55:54:22, 18.67s/it]

 33%|███▎      | 5323/16104 [24:39:50<51:56:59, 17.35s/it]


 33%|███▎      | 5325/16104 [24:40:27<54:07:44, 18.08s/it]
{'loss': 0.5113, 'learning_rate': 1.5622829786565167e-06, 'rewards/chosen': -0.5162948966026306, 'rewards/rejected': -2.870227575302124, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3539326190948486, 'policy_logps/rejected': -593.160400390625, 'policy_logps/chosen': -545.0, 'referece_logps/rejected': -564.4580688476562, 'referece_logps/chosen': -539.8370971679688, 'logits/rejected': -1.0270805358886719, 'logits/chosen': -1.1023141145706177, 'epoch': 1.98}


 33%|███▎      | 5327/16104 [24:40:55<47:25:40, 15.84s/it]
{'loss': 0.6194, 'learning_rate': 1.5619502924586683e-06, 'rewards/chosen': -1.079756259918213, 'rewards/rejected': -0.8103432655334473, 'rewards/accuracies': 0.375, 'rewards/margins': -0.2694131135940552, 'policy_logps/rejected': -328.63629150390625, 'policy_logps/chosen': -342.45721435546875, 'referece_logps/rejected': -320.53289794921875, 'referece_logps/chosen': -331.6596374511719, 'logits/rejected': -0.35588639974594116, 'logits/chosen': -0.348095178604126, 'epoch': 1.98}


 33%|███▎      | 5329/16104 [24:41:27<49:01:45, 16.38s/it]
{'loss': 0.4606, 'learning_rate': 1.5616175153332517e-06, 'rewards/chosen': -1.3918609619140625, 'rewards/rejected': -1.7592904567718506, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3674294054508209, 'policy_logps/rejected': -414.7852783203125, 'policy_logps/chosen': -441.82470703125, 'referece_logps/rejected': -397.1923522949219, 'referece_logps/chosen': -427.9061279296875, 'logits/rejected': 0.33933940529823303, 'logits/chosen': 0.21012146770954132, 'epoch': 1.99}


 33%|███▎      | 5331/16104 [24:42:01<50:35:32, 16.91s/it]

 33%|███▎      | 5332/16104 [24:42:19<51:50:30, 17.33s/it]

 33%|███▎      | 5333/16104 [24:42:35<50:48:36, 16.98s/it]
{'loss': 0.4722, 'learning_rate': 1.560951688515114e-06, 'rewards/chosen': -0.36268311738967896, 'rewards/rejected': -1.4179164171218872, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0552332401275635, 'policy_logps/rejected': -285.75396728515625, 'policy_logps/chosen': -431.8608703613281, 'referece_logps/rejected': -271.5747985839844, 'referece_logps/chosen': -428.2340087890625, 'logits/rejected': -0.005030749831348658, 'logits/chosen': -0.008001985028386116, 'epoch': 1.99}


 33%|███▎      | 5335/16104 [24:43:11<52:47:15, 17.65s/it]
{'loss': 0.4351, 'learning_rate': 1.5606186389301281e-06, 'rewards/chosen': -0.4232957065105438, 'rewards/rejected': -1.8551255464553833, 'rewards/accuracies': 0.875, 'rewards/margins': 1.431829810142517, 'policy_logps/rejected': -356.696044921875, 'policy_logps/chosen': -353.1294860839844, 'referece_logps/rejected': -338.144775390625, 'referece_logps/chosen': -348.89654541015625, 'logits/rejected': -0.7678677439689636, 'logits/chosen': -0.6227669715881348, 'epoch': 1.99}

 33%|███▎      | 5336/16104 [24:43:30<54:08:20, 18.10s/it]

 33%|███▎      | 5337/16104 [24:43:47<52:29:30, 17.55s/it]

 33%|███▎      | 5338/16104 [24:44:00<48:35:05, 16.25s/it]

 33%|███▎      | 5339/16104 [24:44:20<51:49:09, 17.33s/it]

 33%|███▎      | 5340/16104 [24:44:32<47:06:50, 15.76s/it]

 33%|███▎      | 5341/16104 [24:44:50<49:22:19, 16.51s/it]

 33%|███▎      | 5342/16104 [24:45:11<53:47:59, 18.00s/it]

 33%|███▎      | 5343/16104 [24:45:30<54:16:39, 18.16s/it]


 33%|███▎      | 5345/16104 [24:46:03<52:41:13, 17.63s/it]
{'loss': 0.4854, 'learning_rate': 1.5589520314020596e-06, 'rewards/chosen': -0.4895130395889282, 'rewards/rejected': -3.027728319168091, 'rewards/accuracies': 1.0, 'rewards/margins': 2.538215160369873, 'policy_logps/rejected': -333.9802551269531, 'policy_logps/chosen': -479.453369140625, 'referece_logps/rejected': -303.7029724121094, 'referece_logps/chosen': -474.55816650390625, 'logits/rejected': -0.11106200516223907, 'logits/chosen': -0.2359428107738495, 'epoch': 1.99}

 33%|███▎      | 5346/16104 [24:46:23<54:33:09, 18.26s/it]

 33%|███▎      | 5347/16104 [24:46:42<55:12:23, 18.48s/it]


 33%|███▎      | 5349/16104 [24:47:19<55:08:10, 18.46s/it]
{'loss': 0.4618, 'learning_rate': 1.5582847549162001e-06, 'rewards/chosen': -0.8347898721694946, 'rewards/rejected': -1.9508049488067627, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1160149574279785, 'policy_logps/rejected': -383.5834655761719, 'policy_logps/chosen': -503.8397216796875, 'referece_logps/rejected': -364.075439453125, 'referece_logps/chosen': -495.49188232421875, 'logits/rejected': -0.528342068195343, 'logits/chosen': -0.6114116907119751, 'epoch': 1.99}

 33%|███▎      | 5350/16104 [24:47:33<50:49:20, 17.01s/it]


 33%|███▎      | 5352/16104 [24:48:03<46:51:30, 15.69s/it]
{'loss': 0.5312, 'learning_rate': 1.5577840604002372e-06, 'rewards/chosen': -1.0665956735610962, 'rewards/rejected': -1.5580451488494873, 'rewards/accuracies': 0.375, 'rewards/margins': 0.49144935607910156, 'policy_logps/rejected': -358.5657958984375, 'policy_logps/chosen': -327.4736328125, 'referece_logps/rejected': -342.9853820800781, 'referece_logps/chosen': -316.8077087402344, 'logits/rejected': 0.08790166676044464, 'logits/chosen': 0.040174469351768494, 'epoch': 1.99}

 33%|███▎      | 5353/16104 [24:48:23<50:15:54, 16.83s/it]

 33%|███▎      | 5354/16104 [24:48:42<52:46:34, 17.67s/it]


 33%|███▎      | 5356/16104 [24:49:20<54:22:07, 18.21s/it]
{'loss': 0.4704, 'learning_rate': 1.5571161518567638e-06, 'rewards/chosen': -1.148864507675171, 'rewards/rejected': -1.4925956726074219, 'rewards/accuracies': 0.5, 'rewards/margins': 0.34373125433921814, 'policy_logps/rejected': -224.96075439453125, 'policy_logps/chosen': -480.537841796875, 'referece_logps/rejected': -210.0347900390625, 'referece_logps/chosen': -469.0491943359375, 'logits/rejected': -0.47687897086143494, 'logits/chosen': -0.5841510891914368, 'epoch': 2.0}

 33%|███▎      | 5357/16104 [24:49:38<54:48:09, 18.36s/it]


 33%|███▎      | 5359/16104 [24:50:10<51:42:24, 17.32s/it]
{'loss': 0.5719, 'learning_rate': 1.5566149837939243e-06, 'rewards/chosen': -1.509697437286377, 'rewards/rejected': -2.492821455001831, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9831238985061646, 'policy_logps/rejected': -400.4200439453125, 'policy_logps/chosen': -515.037353515625, 'referece_logps/rejected': -375.4918212890625, 'referece_logps/chosen': -499.94036865234375, 'logits/rejected': -1.000229835510254, 'logits/chosen': -1.2905268669128418, 'epoch': 2.0}


 33%|███▎      | 5361/16104 [24:50:46<53:09:37, 17.81s/it]
{'loss': 0.5926, 'learning_rate': 1.5562807591604217e-06, 'rewards/chosen': -1.0343796014785767, 'rewards/rejected': -1.1310287714004517, 'rewards/accuracies': 0.625, 'rewards/margins': 0.09664914011955261, 'policy_logps/rejected': -389.8404541015625, 'policy_logps/chosen': -393.33819580078125, 'referece_logps/rejected': -378.53021240234375, 'referece_logps/chosen': -382.994384765625, 'logits/rejected': -0.7054758071899414, 'logits/chosen': -0.7768251895904541, 'epoch': 2.0}

 33%|███▎      | 5362/16104 [24:51:03<52:31:58, 17.61s/it]

 33%|███▎      | 5363/16104 [24:51:15<47:57:30, 16.07s/it]

 33%|███▎      | 5364/16104 [24:51:31<47:19:04, 15.86s/it]

 33%|███▎      | 5365/16104 [24:51:51<51:06:59, 17.14s/it]

 33%|███▎      | 5366/16104 [24:52:11<53:42:52, 18.01s/it]

 33%|███▎      | 5367/16104 [24:52:23<48:48:13, 16.36s/it]

 33%|███▎      | 5368/16104 [24:52:44<52:41:45, 17.67s/it]


 33%|███▎      | 5370/16104 [24:53:10<44:52:54, 15.05s/it]
{'loss': 0.4954, 'learning_rate': 1.5547756352145972e-06, 'rewards/chosen': -0.707254946231842, 'rewards/rejected': -1.089166283607483, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3819113075733185, 'policy_logps/rejected': -321.137451171875, 'policy_logps/chosen': -406.2454528808594, 'referece_logps/rejected': -310.24578857421875, 'referece_logps/chosen': -399.1728820800781, 'logits/rejected': -0.4877288341522217, 'logits/chosen': -0.5657559633255005, 'epoch': 2.0}

 33%|███▎      | 5371/16104 [24:53:29<49:01:56, 16.45s/it]


 33%|███▎      | 5373/16104 [24:54:04<50:06:51, 16.81s/it]

 33%|███▎      | 5374/16104 [24:54:16<45:50:52, 15.38s/it]
{'loss': 0.5495, 'learning_rate': 1.554106107462191e-06, 'rewards/chosen': -0.8422765731811523, 'rewards/rejected': -1.5057697296142578, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6634930372238159, 'policy_logps/rejected': -426.53680419921875, 'policy_logps/chosen': -573.9812622070312, 'referece_logps/rejected': -411.4791259765625, 'referece_logps/chosen': -565.5585327148438, 'logits/rejected': -0.9599559903144836, 'logits/chosen': -0.9104358553886414, 'epoch': 2.0}

 33%|███▎      | 5375/16104 [24:54:32<46:43:56, 15.68s/it]

 33%|███▎      | 5376/16104 [24:54:50<48:58:32, 16.43s/it]

 33%|███▎      | 5377/16104 [24:55:01<44:00:49, 14.77s/it]


 33%|███▎      | 5379/16104 [24:55:32<44:57:28, 15.09s/it]
{'loss': 0.5981, 'learning_rate': 1.5532686934944437e-06, 'rewards/chosen': -0.7233407497406006, 'rewards/rejected': -1.7726720571517944, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0493313074111938, 'policy_logps/rejected': -455.27069091796875, 'policy_logps/chosen': -378.82635498046875, 'referece_logps/rejected': -437.5439453125, 'referece_logps/chosen': -371.59295654296875, 'logits/rejected': 0.19862166047096252, 'logits/chosen': 0.2539016604423523, 'epoch': 2.0}

 33%|███▎      | 5380/16104 [24:55:51<48:59:54, 16.45s/it]


 33%|███▎      | 5382/16104 [24:56:30<52:58:18, 17.79s/it]
{'loss': 0.5548, 'learning_rate': 1.5527659764911224e-06, 'rewards/chosen': -0.591145932674408, 'rewards/rejected': -1.1777156591415405, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5865697860717773, 'policy_logps/rejected': -529.4925537109375, 'policy_logps/chosen': -468.8177185058594, 'referece_logps/rejected': -517.71533203125, 'referece_logps/chosen': -462.90625, 'logits/rejected': -0.3346821963787079, 'logits/chosen': -0.24456419050693512, 'epoch': 2.01}

 33%|███▎      | 5383/16104 [24:56:51<56:04:55, 18.83s/it]

 33%|███▎      | 5384/16104 [24:57:04<51:02:50, 17.14s/it]


 33%|███▎      | 5386/16104 [24:57:32<45:09:17, 15.17s/it]
{'loss': 0.4544, 'learning_rate': 1.5520953741398308e-06, 'rewards/chosen': -1.1083072423934937, 'rewards/rejected': -1.9433941841125488, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8350869417190552, 'policy_logps/rejected': -416.1092224121094, 'policy_logps/chosen': -403.98419189453125, 'referece_logps/rejected': -396.6752624511719, 'referece_logps/chosen': -392.901123046875, 'logits/rejected': -0.6608710289001465, 'logits/chosen': -0.3774970471858978, 'epoch': 2.01}

 33%|███▎      | 5387/16104 [24:57:43<41:10:56, 13.83s/it]

 33%|███▎      | 5388/16104 [24:58:02<45:57:25, 15.44s/it]

 33%|███▎      | 5389/16104 [24:58:22<49:50:26, 16.75s/it]


 33%|███▎      | 5391/16104 [24:58:52<48:47:16, 16.39s/it]

 33%|███▎      | 5392/16104 [24:59:04<44:36:23, 14.99s/it]
{'loss': 0.4675, 'learning_rate': 1.551088800751333e-06, 'rewards/chosen': -1.0954748392105103, 'rewards/rejected': -1.8617448806762695, 'rewards/accuracies': 0.5, 'rewards/margins': 0.7662700414657593, 'policy_logps/rejected': -410.8204345703125, 'policy_logps/chosen': -497.97003173828125, 'referece_logps/rejected': -392.2029724121094, 'referece_logps/chosen': -487.01531982421875, 'logits/rejected': 0.13356761634349823, 'logits/chosen': 0.08186767250299454, 'epoch': 2.01}

 33%|███▎      | 5393/16104 [24:59:24<48:52:44, 16.43s/it]

 33%|███▎      | 5394/16104 [24:59:37<46:20:11, 15.58s/it]

 34%|███▎      | 5395/16104 [24:59:49<43:19:52, 14.57s/it]

 34%|███▎      | 5396/16104 [25:00:05<44:19:32, 14.90s/it]

 34%|███▎      | 5397/16104 [25:00:25<49:06:18, 16.51s/it]

 34%|███▎      | 5398/16104 [25:00:39<46:49:47, 15.75s/it]


 34%|███▎      | 5400/16104 [25:01:10<45:08:54, 15.18s/it]
{'loss': 0.5052, 'learning_rate': 1.5497454547722502e-06, 'rewards/chosen': -1.1280202865600586, 'rewards/rejected': -2.109184503555298, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9811640977859497, 'policy_logps/rejected': -515.86181640625, 'policy_logps/chosen': -371.00848388671875, 'referece_logps/rejected': -494.77001953125, 'referece_logps/chosen': -359.728271484375, 'logits/rejected': 0.06101685389876366, 'logits/chosen': 0.2617340087890625, 'epoch': 2.01}


 34%|███▎      | 5402/16104 [25:01:46<48:50:37, 16.43s/it]
{'loss': 0.5685, 'learning_rate': 1.5494093957597469e-06, 'rewards/chosen': -0.986049473285675, 'rewards/rejected': -2.160688877105713, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1746394634246826, 'policy_logps/rejected': -258.1314392089844, 'policy_logps/chosen': -482.523681640625, 'referece_logps/rejected': -236.52456665039062, 'referece_logps/chosen': -472.6632385253906, 'logits/rejected': 0.13023138046264648, 'logits/chosen': 0.06440210342407227, 'epoch': 2.01}

 34%|███▎      | 5403/16104 [25:02:04<49:57:57, 16.81s/it]

 34%|███▎      | 5404/16104 [25:02:25<53:40:30, 18.06s/it]

 34%|███▎      | 5405/16104 [25:02:41<51:39:17, 17.38s/it]

 34%|███▎      | 5406/16104 [25:02:56<49:28:49, 16.65s/it]

 34%|███▎      | 5407/16104 [25:03:13<49:51:01, 16.78s/it]

 34%|███▎      | 5408/16104 [25:03:24<44:41:06, 15.04s/it]

 34%|███▎      | 5409/16104 [25:03:41<46:56:31, 15.80s/it]


 34%|███▎      | 5411/16104 [25:04:10<45:59:21, 15.48s/it]
{'loss': 0.6756, 'learning_rate': 1.5478960308716679e-06, 'rewards/chosen': -1.0345268249511719, 'rewards/rejected': -1.3264875411987305, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2919607162475586, 'policy_logps/rejected': -418.43182373046875, 'policy_logps/chosen': -282.7916564941406, 'referece_logps/rejected': -405.1669616699219, 'referece_logps/chosen': -272.44635009765625, 'logits/rejected': -0.8798283338546753, 'logits/chosen': -0.6983882188796997, 'epoch': 2.02}

 34%|███▎      | 5412/16104 [25:04:21<41:43:56, 14.05s/it]

 34%|███▎      | 5413/16104 [25:04:38<44:05:38, 14.85s/it]

 34%|███▎      | 5414/16104 [25:04:57<48:18:39, 16.27s/it]

 34%|███▎      | 5415/16104 [25:05:16<50:37:12, 17.05s/it]

 34%|███▎      | 5416/16104 [25:05:33<50:40:36, 17.07s/it]

 34%|███▎      | 5417/16104 [25:05:50<50:04:55, 16.87s/it]

 34%|███▎      | 5418/16104 [25:06:01<45:35:49, 15.36s/it]


 34%|███▎      | 5420/16104 [25:06:35<48:10:12, 16.23s/it]
{'loss': 0.4941, 'learning_rate': 1.5463808707509277e-06, 'rewards/chosen': -0.6900609731674194, 'rewards/rejected': -2.3247029781341553, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6346418857574463, 'policy_logps/rejected': -410.51708984375, 'policy_logps/chosen': -422.71746826171875, 'referece_logps/rejected': -387.2700500488281, 'referece_logps/chosen': -415.81683349609375, 'logits/rejected': 0.14811691641807556, 'logits/chosen': 0.2707982063293457, 'epoch': 2.02}

 34%|███▎      | 5421/16104 [25:06:47<44:40:06, 15.05s/it]

 34%|███▎      | 5422/16104 [25:07:04<46:47:06, 15.77s/it]

 34%|███▎      | 5423/16104 [25:07:22<48:38:36, 16.40s/it]

 34%|███▎      | 5424/16104 [25:07:42<51:43:03, 17.43s/it]

 34%|███▎      | 5425/16104 [25:07:59<51:10:49, 17.25s/it]

 34%|███▎      | 5426/16104 [25:08:10<45:23:52, 15.31s/it]

 34%|███▎      | 5427/16104 [25:08:29<49:12:36, 16.59s/it]

 34%|███▎      | 5428/16104 [25:08:49<52:06:06, 17.57s/it]

 34%|███▎      | 5429/16104 [25:09:00<45:58:11, 15.50s/it]

 34%|███▎      | 5430/16104 [25:09:20<50:04:11, 16.89s/it]


 34%|███▎      | 5432/16104 [25:09:45<43:09:01, 14.56s/it]
{'loss': 0.5101, 'learning_rate': 1.5443578732540412e-06, 'rewards/chosen': -0.923291027545929, 'rewards/rejected': -1.4823490381240845, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5590579509735107, 'policy_logps/rejected': -378.2775573730469, 'policy_logps/chosen': -616.6739501953125, 'referece_logps/rejected': -363.45404052734375, 'referece_logps/chosen': -607.4410400390625, 'logits/rejected': -0.20186150074005127, 'logits/chosen': -0.3912981450557709, 'epoch': 2.02}

 34%|███▎      | 5433/16104 [25:10:02<45:52:37, 15.48s/it]

 34%|███▎      | 5434/16104 [25:10:22<49:33:32, 16.72s/it]

 34%|███▎      | 5435/16104 [25:10:34<45:10:25, 15.24s/it]

 34%|███▍      | 5436/16104 [25:10:55<50:23:58, 17.01s/it]

 34%|███▍      | 5437/16104 [25:11:12<50:12:40, 16.95s/it]

 34%|███▍      | 5438/16104 [25:11:29<50:45:59, 17.13s/it]

 34%|███▍      | 5439/16104 [25:11:47<51:00:47, 17.22s/it]

 34%|███▍      | 5440/16104 [25:12:00<47:19:43, 15.98s/it]

 34%|███▍      | 5441/16104 [25:12:15<46:54:51, 15.84s/it]

 34%|███▍      | 5442/16104 [25:12:30<45:49:58, 15.48s/it]

 34%|███▍      | 5443/16104 [25:12:41<41:36:30, 14.05s/it]

 34%|███▍      | 5444/16104 [25:12:54<40:35:13, 13.71s/it]

 34%|███▍      | 5445/16104 [25:13:06<39:27:53, 13.33s/it]

 34%|███▍      | 5446/16104 [25:13:24<43:44:45, 14.78s/it]

 34%|███▍      | 5447/16104 [25:13:44<48:38:10, 16.43s/it]

 34%|███▍      | 5448/16104 [25:14:04<51:37:47, 17.44s/it]

 34%|███▍      | 5449/16104 [25:14:23<52:59:22, 17.90s/it]

 34%|███▍      | 5450/16104 [25:14:38<49:46:17, 16.82s/it]

 34%|███▍      | 5451/16104 [25:14:54<49:19:59, 16.67s/it]

 34%|███▍      | 5452/16104 [25:15:13<51:05:57, 17.27s/it]

 34%|███▍      | 5453/16104 [25:15:24<45:39:04, 15.43s/it]

 34%|███▍      | 5454/16104 [25:15:44<49:34:48, 16.76s/it]

 34%|███▍      | 5455/16104 [25:15:57<47:04:56, 15.92s/it]

 34%|███▍      | 5456/16104 [25:16:14<47:34:49, 16.09s/it]

 34%|███▍      | 5457/16104 [25:16:32<49:40:54, 16.80s/it]

 34%|███▍      | 5458/16104 [25:16:49<49:04:16, 16.59s/it]

 34%|███▍      | 5459/16104 [25:17:00<44:41:56, 15.12s/it]

 34%|███▍      | 5460/16104 [25:17:19<48:14:05, 16.31s/it]

 34%|███▍      | 5461/16104 [25:17:39<51:04:45, 17.28s/it]

 34%|███▍      | 5462/16104 [25:17:55<49:46:59, 16.84s/it]

 34%|███▍      | 5463/16104 [25:18:12<50:17:21, 17.01s/it]

 34%|███▍      | 5464/16104 [25:18:29<49:59:10, 16.91s/it]

 34%|███▍      | 5465/16104 [25:18:43<47:37:42, 16.12s/it]

 34%|███▍      | 5466/16104 [25:18:55<43:54:48, 14.86s/it]

 34%|███▍      | 5467/16104 [25:19:15<48:20:01, 16.36s/it]

 34%|███▍      | 5468/16104 [25:19:36<52:53:14, 17.90s/it]

 34%|███▍      | 5469/16104 [25:19:55<53:24:37, 18.08s/it]

 34%|███▍      | 5470/16104 [25:20:16<55:58:39, 18.95s/it]

 34%|███▍      | 5471/16104 [25:20:36<57:03:37, 19.32s/it]

 34%|███▍      | 5472/16104 [25:20:48<50:49:03, 17.21s/it]

 34%|███▍      | 5473/16104 [25:21:06<51:44:16, 17.52s/it]

 34%|███▍      | 5474/16104 [25:21:20<48:31:03, 16.43s/it]

 34%|███▍      | 5475/16104 [25:21:36<47:55:46, 16.23s/it]

 34%|███▍      | 5476/16104 [25:21:51<46:29:50, 15.75s/it]

 34%|███▍      | 5477/16104 [25:22:07<47:12:15, 15.99s/it]

 34%|███▍      | 5478/16104 [25:22:25<48:30:42, 16.44s/it]

 34%|███▍      | 5479/16104 [25:22:37<44:45:52, 15.17s/it]

 34%|███▍      | 5480/16104 [25:22:52<44:36:38, 15.12s/it]

 34%|███▍      | 5481/16104 [25:23:11<48:08:23, 16.31s/it]

 34%|███▍      | 5482/16104 [25:23:31<51:13:55, 17.36s/it]

 34%|███▍      | 5483/16104 [25:23:47<50:26:48, 17.10s/it]

 34%|███▍      | 5484/16104 [25:24:04<49:59:40, 16.95s/it]

 34%|███▍      | 5485/16104 [25:24:25<53:45:28, 18.22s/it]

 34%|███▍      | 5486/16104 [25:24:45<55:10:59, 18.71s/it]

 34%|███▍      | 5487/16104 [25:25:00<51:33:18, 17.48s/it]

 34%|███▍      | 5488/16104 [25:25:21<55:21:34, 18.77s/it]


 34%|███▍      | 5490/16104 [25:25:56<53:12:03, 18.04s/it]

 34%|███▍      | 5491/16104 [25:26:11<50:14:53, 17.04s/it]

 34%|███▍      | 5492/16104 [25:26:26<49:05:03, 16.65s/it]

 34%|███▍      | 5493/16104 [25:26:43<49:33:08, 16.81s/it]

 34%|███▍      | 5494/16104 [25:27:05<53:16:28, 18.08s/it]

 34%|███▍      | 5495/16104 [25:27:24<54:55:32, 18.64s/it]

 34%|███▍      | 5496/16104 [25:27:44<56:04:47, 19.03s/it]

 34%|███▍      | 5497/16104 [25:28:06<58:20:09, 19.80s/it]

 34%|███▍      | 5498/16104 [25:28:26<58:17:43, 19.79s/it]

 34%|███▍      | 5499/16104 [25:28:44<56:31:47, 19.19s/it]

 34%|███▍      | 5500/16104 [25:29:00<54:26:29, 18.48s/it]

 34%|███▍      | 5501/16104 [25:29:29<63:05:34, 21.42s/it]

 34%|███▍      | 5502/16104 [25:29:45<58:08:51, 19.74s/it]

 34%|███▍      | 5503/16104 [25:30:05<58:33:15, 19.88s/it]

 34%|███▍      | 5504/16104 [25:30:23<57:09:46, 19.41s/it]

 34%|███▍      | 5505/16104 [25:30:43<58:03:00, 19.72s/it]

 34%|███▍      | 5506/16104 [25:31:00<55:23:31, 18.82s/it]

 34%|███▍      | 5507/16104 [25:31:20<56:19:07, 19.13s/it]

 34%|███▍      | 5508/16104 [25:31:33<50:50:25, 17.27s/it]

 34%|███▍      | 5509/16104 [25:31:44<45:30:04, 15.46s/it]

 34%|███▍      | 5510/16104 [25:31:55<41:17:35, 14.03s/it]

 34%|███▍      | 5511/16104 [25:32:11<43:23:00, 14.74s/it]
{'loss': 0.4453, 'learning_rate': 1.5309612039424637e-06, 'rewards/chosen': -0.8736950159072876, 'rewards/rejected': -2.2316319942474365, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3579368591308594, 'policy_logps/rejected': -390.0885009765625, 'policy_logps/chosen': -316.5430908203125, 'referece_logps/rejected': -367.77215576171875, 'referece_logps/chosen': -307.80615234375, 'logits/rejected': -1.0395039319992065, 'logits/chosen': -0.8278323411941528, 'epoch': 2.05}


 34%|███▍      | 5513/16104 [25:32:36<40:16:48, 13.69s/it]

 34%|███▍      | 5514/16104 [25:32:51<41:15:29, 14.03s/it]

 34%|███▍      | 5515/16104 [25:33:06<42:08:16, 14.33s/it]

 34%|███▍      | 5516/16104 [25:33:17<39:02:38, 13.28s/it]

 34%|███▍      | 5517/16104 [25:33:32<40:30:27, 13.77s/it]

 34%|███▍      | 5518/16104 [25:33:48<42:30:38, 14.46s/it]

 34%|███▍      | 5519/16104 [25:34:03<42:57:00, 14.61s/it]

 34%|███▍      | 5520/16104 [25:34:19<44:40:43, 15.20s/it]

 34%|███▍      | 5521/16104 [25:34:39<48:45:58, 16.59s/it]

 34%|███▍      | 5522/16104 [25:34:59<51:29:22, 17.52s/it]

 34%|███▍      | 5523/16104 [25:35:15<50:16:03, 17.10s/it]

 34%|███▍      | 5524/16104 [25:35:31<49:34:31, 16.87s/it]

 34%|███▍      | 5525/16104 [25:35:51<52:03:32, 17.72s/it]
{'loss': 0.5189, 'learning_rate': 1.5285730312628417e-06, 'rewards/chosen': -1.2545562982559204, 'rewards/rejected': -1.4144279956817627, 'rewards/accuracies': 0.5, 'rewards/margins': 0.15987169742584229, 'policy_logps/rejected': -343.8166198730469, 'policy_logps/chosen': -361.9911804199219, 'referece_logps/rejected': -329.6723327636719, 'referece_logps/chosen': -349.4455871582031, 'logits/rejected': -1.0166512727737427, 'logits/chosen': -0.9649714827537537, 'epoch': 2.06}


 34%|███▍      | 5527/16104 [25:36:30<55:02:02, 18.73s/it]

 34%|███▍      | 5528/16104 [25:36:48<54:23:37, 18.52s/it]

 34%|███▍      | 5529/16104 [25:37:06<53:38:53, 18.26s/it]
{'loss': 0.5532, 'learning_rate': 1.5278899256411415e-06, 'rewards/chosen': -1.2441751956939697, 'rewards/rejected': -1.4573910236358643, 'rewards/accuracies': 0.5, 'rewards/margins': 0.21321603655815125, 'policy_logps/rejected': -377.53887939453125, 'policy_logps/chosen': -387.14202880859375, 'referece_logps/rejected': -362.9649658203125, 'referece_logps/chosen': -374.70025634765625, 'logits/rejected': -0.7671886086463928, 'logits/chosen': -0.6680154204368591, 'epoch': 2.06}


 34%|███▍      | 5531/16104 [25:37:39<52:02:47, 17.72s/it]

 34%|███▍      | 5532/16104 [25:37:52<48:09:36, 16.40s/it]

 34%|███▍      | 5533/16104 [25:38:05<44:24:25, 15.12s/it]

 34%|███▍      | 5534/16104 [25:38:26<49:42:35, 16.93s/it]

 34%|███▍      | 5535/16104 [25:38:44<51:05:55, 17.41s/it]

 34%|███▍      | 5536/16104 [25:38:55<45:30:16, 15.50s/it]

 34%|███▍      | 5537/16104 [25:39:13<47:44:25, 16.26s/it]
{'loss': 0.5025, 'learning_rate': 1.5265226898438434e-06, 'rewards/chosen': -0.6546947956085205, 'rewards/rejected': -1.5687389373779297, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9140441417694092, 'policy_logps/rejected': -534.431396484375, 'policy_logps/chosen': -475.4883117675781, 'referece_logps/rejected': -518.7440185546875, 'referece_logps/chosen': -468.94134521484375, 'logits/rejected': -0.18301478028297424, 'logits/chosen': -0.2369249165058136, 'epoch': 2.06}


 34%|███▍      | 5539/16104 [25:39:50<50:55:56, 17.36s/it]

 34%|███▍      | 5540/16104 [25:40:06<49:32:26, 16.88s/it]
{'loss': 0.4858, 'learning_rate': 1.5260096247997908e-06, 'rewards/chosen': -0.5759985446929932, 'rewards/rejected': -2.0938620567321777, 'rewards/accuracies': 1.0, 'rewards/margins': 1.517863392829895, 'policy_logps/rejected': -291.745361328125, 'policy_logps/chosen': -347.2911376953125, 'referece_logps/rejected': -270.8067626953125, 'referece_logps/chosen': -341.53118896484375, 'logits/rejected': -0.5624123215675354, 'logits/chosen': -0.5346745252609253, 'epoch': 2.06}


 34%|███▍      | 5542/16104 [25:40:42<50:54:08, 17.35s/it]

 34%|███▍      | 5543/16104 [25:40:54<46:36:42, 15.89s/it]
{'loss': 0.459, 'learning_rate': 1.525496368253492e-06, 'rewards/chosen': -0.7828658223152161, 'rewards/rejected': -1.5323920249938965, 'rewards/accuracies': 0.625, 'rewards/margins': 0.74952632188797, 'policy_logps/rejected': -350.0008239746094, 'policy_logps/chosen': -278.58306884765625, 'referece_logps/rejected': -334.6769104003906, 'referece_logps/chosen': -270.7544250488281, 'logits/rejected': -0.08811221271753311, 'logits/chosen': -0.008383706212043762, 'epoch': 2.07}


 34%|███▍      | 5545/16104 [25:41:29<47:21:37, 16.15s/it]

 34%|███▍      | 5546/16104 [25:41:46<48:13:26, 16.44s/it]
{'loss': 0.5049, 'learning_rate': 1.5249829203918054e-06, 'rewards/chosen': -0.9293147921562195, 'rewards/rejected': -1.773612141609192, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8442973494529724, 'policy_logps/rejected': -355.1197814941406, 'policy_logps/chosen': -437.0617370605469, 'referece_logps/rejected': -337.3836669921875, 'referece_logps/chosen': -427.76861572265625, 'logits/rejected': -0.25298431515693665, 'logits/chosen': -0.2734265625476837, 'epoch': 2.07}

 34%|███▍      | 5547/16104 [25:41:58<44:10:49, 15.07s/it]


 34%|███▍      | 5549/16104 [25:42:28<44:35:18, 15.21s/it]

 34%|███▍      | 5550/16104 [25:42:46<47:05:13, 16.06s/it]

 34%|███▍      | 5551/16104 [25:43:04<49:00:49, 16.72s/it]

 34%|███▍      | 5552/16104 [25:43:16<44:50:28, 15.30s/it]

 34%|███▍      | 5553/16104 [25:43:39<51:42:58, 17.65s/it]

 34%|███▍      | 5554/16104 [25:44:01<55:36:38, 18.98s/it]

 34%|███▍      | 5555/16104 [25:44:22<56:37:22, 19.32s/it]

 35%|███▍      | 5556/16104 [25:44:33<49:41:09, 16.96s/it]

 35%|███▍      | 5557/16104 [25:44:55<54:09:59, 18.49s/it]

 35%|███▍      | 5558/16104 [25:45:15<55:09:13, 18.83s/it]

 35%|███▍      | 5559/16104 [25:45:31<53:00:47, 18.10s/it]

 35%|███▍      | 5560/16104 [25:45:48<52:15:40, 17.84s/it]

 35%|███▍      | 5561/16104 [25:46:06<52:24:00, 17.89s/it]

 35%|███▍      | 5562/16104 [25:46:23<51:37:16, 17.63s/it]

 35%|███▍      | 5563/16104 [25:46:43<53:23:00, 18.23s/it]

 35%|███▍      | 5564/16104 [25:47:01<53:34:59, 18.30s/it]

 35%|███▍      | 5565/16104 [25:47:20<54:15:55, 18.54s/it]

 35%|███▍      | 5566/16104 [25:47:40<55:11:07, 18.85s/it]

 35%|███▍      | 5567/16104 [25:48:00<55:55:45, 19.11s/it]

 35%|███▍      | 5568/16104 [25:48:16<53:44:24, 18.36s/it]

 35%|███▍      | 5569/16104 [25:48:36<55:10:04, 18.85s/it]

 35%|███▍      | 5570/16104 [25:48:57<56:24:13, 19.28s/it]

 35%|███▍      | 5571/16104 [25:49:16<56:16:42, 19.23s/it]
{'loss': 0.457, 'learning_rate': 1.5206967732245554e-06, 'rewards/chosen': -1.836179256439209, 'rewards/rejected': -1.9232187271118164, 'rewards/accuracies': 0.5, 'rewards/margins': 0.0870395079255104, 'policy_logps/rejected': -343.4884338378906, 'policy_logps/chosen': -274.35491943359375, 'referece_logps/rejected': -324.2562255859375, 'referece_logps/chosen': -255.99310302734375, 'logits/rejected': -1.5427465438842773, 'logits/chosen': -1.5570335388183594, 'epoch': 2.08}


 35%|███▍      | 5573/16104 [25:49:48<52:25:33, 17.92s/it]

 35%|███▍      | 5574/16104 [25:50:08<54:16:57, 18.56s/it]
{'loss': 0.4437, 'learning_rate': 1.5201815487760192e-06, 'rewards/chosen': -1.4954161643981934, 'rewards/rejected': -3.5090103149414062, 'rewards/accuracies': 0.75, 'rewards/margins': 2.013594150543213, 'policy_logps/rejected': -460.7392883300781, 'policy_logps/chosen': -443.0159912109375, 'referece_logps/rejected': -425.649169921875, 'referece_logps/chosen': -428.0617980957031, 'logits/rejected': 0.23496851325035095, 'logits/chosen': 0.1828581541776657, 'epoch': 2.08}


 35%|███▍      | 5576/16104 [25:50:40<51:10:45, 17.50s/it]

 35%|███▍      | 5577/16104 [25:50:59<53:09:48, 18.18s/it]

 35%|███▍      | 5578/16104 [25:51:19<54:23:33, 18.60s/it]

 35%|███▍      | 5579/16104 [25:51:31<48:39:22, 16.64s/it]

 35%|███▍      | 5580/16104 [25:51:53<53:24:46, 18.27s/it]

 35%|███▍      | 5581/16104 [25:52:09<51:45:27, 17.71s/it]

 35%|███▍      | 5582/16104 [25:52:20<45:56:44, 15.72s/it]

 35%|███▍      | 5583/16104 [25:52:37<46:16:14, 15.83s/it]

 35%|███▍      | 5584/16104 [25:52:49<43:29:23, 14.88s/it]
{'loss': 0.4885, 'learning_rate': 1.5184627672541108e-06, 'rewards/chosen': -1.0532703399658203, 'rewards/rejected': -1.7355509996414185, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6822806000709534, 'policy_logps/rejected': -454.0307312011719, 'policy_logps/chosen': -538.5480346679688, 'referece_logps/rejected': -436.67523193359375, 'referece_logps/chosen': -528.0152587890625, 'logits/rejected': -1.4811502695083618, 'logits/chosen': -1.2817192077636719, 'epoch': 2.08}

 35%|███▍      | 5585/16104 [25:53:06<45:27:31, 15.56s/it]


 35%|███▍      | 5587/16104 [25:53:39<46:53:06, 16.05s/it]

 35%|███▍      | 5588/16104 [25:53:59<49:58:29, 17.11s/it]

 35%|███▍      | 5589/16104 [25:54:10<44:23:19, 15.20s/it]

 35%|███▍      | 5590/16104 [25:54:21<41:07:14, 14.08s/it]

 35%|███▍      | 5591/16104 [25:54:38<43:33:55, 14.92s/it]

 35%|███▍      | 5592/16104 [25:54:50<40:45:27, 13.96s/it]

 35%|███▍      | 5593/16104 [25:55:11<47:20:10, 16.21s/it]

 35%|███▍      | 5594/16104 [25:55:30<49:19:49, 16.90s/it]

 35%|███▍      | 5595/16104 [25:55:43<46:26:49, 15.91s/it]

 35%|███▍      | 5596/16104 [25:55:56<43:48:59, 15.01s/it]

 35%|███▍      | 5597/16104 [25:56:16<47:55:47, 16.42s/it]

 35%|███▍      | 5598/16104 [25:56:31<46:58:20, 16.10s/it]

 35%|███▍      | 5599/16104 [25:56:46<45:55:39, 15.74s/it]

 35%|███▍      | 5600/16104 [25:57:06<49:41:06, 17.03s/it]

 35%|███▍      | 5601/16104 [25:57:26<52:04:07, 17.85s/it]

 35%|███▍      | 5602/16104 [25:57:45<53:24:46, 18.31s/it]

 35%|███▍      | 5603/16104 [25:57:59<49:13:37, 16.88s/it]

 35%|███▍      | 5604/16104 [25:58:10<44:01:05, 15.09s/it]

 35%|███▍      | 5605/16104 [25:58:30<48:25:49, 16.61s/it]

 35%|███▍      | 5606/16104 [25:58:50<51:50:45, 17.78s/it]

 35%|███▍      | 5607/16104 [25:59:04<47:57:55, 16.45s/it]

 35%|███▍      | 5608/16104 [25:59:25<52:29:20, 18.00s/it]

 35%|███▍      | 5609/16104 [25:59:44<53:10:34, 18.24s/it]

 35%|███▍      | 5610/16104 [25:59:56<47:56:57, 16.45s/it]

 35%|███▍      | 5611/16104 [26:00:16<50:39:57, 17.38s/it]

 35%|███▍      | 5612/16104 [26:00:35<52:29:07, 18.01s/it]

 35%|███▍      | 5613/16104 [26:00:54<52:45:47, 18.11s/it]

 35%|███▍      | 5614/16104 [26:01:12<52:39:43, 18.07s/it]

 35%|███▍      | 5615/16104 [26:01:32<54:22:12, 18.66s/it]

 35%|███▍      | 5616/16104 [26:01:51<54:58:04, 18.87s/it]

 35%|███▍      | 5617/16104 [26:02:11<56:11:04, 19.29s/it]

 35%|███▍      | 5618/16104 [26:02:22<48:49:58, 16.77s/it]

 35%|███▍      | 5619/16104 [26:02:42<51:35:04, 17.71s/it]
{'loss': 0.5313, 'learning_rate': 1.5124305616010109e-06, 'rewards/chosen': -1.3823604583740234, 'rewards/rejected': -2.4341936111450195, 'rewards/accuracies': 0.75, 'rewards/margins': 1.051833152770996, 'policy_logps/rejected': -421.7173767089844, 'policy_logps/chosen': -307.9222412109375, 'referece_logps/rejected': -397.3753967285156, 'referece_logps/chosen': -294.0986633300781, 'logits/rejected': 0.1190805733203888, 'logits/chosen': 0.0041932761669158936, 'epoch': 2.09}


 35%|███▍      | 5621/16104 [26:03:23<55:42:03, 19.13s/it]

 35%|███▍      | 5622/16104 [26:03:42<56:04:47, 19.26s/it]

 35%|███▍      | 5623/16104 [26:04:02<56:21:05, 19.36s/it]

 35%|███▍      | 5624/16104 [26:04:17<53:02:46, 18.22s/it]
{'loss': 0.6336, 'learning_rate': 1.5115667380841948e-06, 'rewards/chosen': -1.0803442001342773, 'rewards/rejected': -1.3488526344299316, 'rewards/accuracies': 0.5, 'rewards/margins': 0.26850831508636475, 'policy_logps/rejected': -325.1585998535156, 'policy_logps/chosen': -312.2522277832031, 'referece_logps/rejected': -311.6700744628906, 'referece_logps/chosen': -301.44879150390625, 'logits/rejected': 0.07029971480369568, 'logits/chosen': 0.02805382013320923, 'epoch': 2.1}


 35%|███▍      | 5626/16104 [26:04:52<51:56:28, 17.85s/it]

 35%|███▍      | 5627/16104 [26:05:12<53:39:18, 18.44s/it]

 35%|███▍      | 5628/16104 [26:05:28<51:44:13, 17.78s/it]

 35%|███▍      | 5629/16104 [26:05:40<46:28:13, 15.97s/it]

 35%|███▍      | 5630/16104 [26:05:53<43:16:52, 14.88s/it]

 35%|███▍      | 5631/16104 [26:06:12<47:25:09, 16.30s/it]

 35%|███▍      | 5632/16104 [26:06:26<45:03:31, 15.49s/it]

 35%|███▍      | 5633/16104 [26:06:37<41:13:43, 14.17s/it]

 35%|███▍      | 5634/16104 [26:06:57<46:05:18, 15.85s/it]
{'loss': 0.4492, 'learning_rate': 1.5098375398907333e-06, 'rewards/chosen': -0.5074238181114197, 'rewards/rejected': -1.333399772644043, 'rewards/accuracies': 0.75, 'rewards/margins': 0.825975775718689, 'policy_logps/rejected': -398.3959045410156, 'policy_logps/chosen': -402.28851318359375, 'referece_logps/rejected': -385.0619201660156, 'referece_logps/chosen': -397.2142639160156, 'logits/rejected': 0.4515833258628845, 'logits/chosen': 0.5570263266563416, 'epoch': 2.1}


 35%|███▍      | 5636/16104 [26:07:27<46:39:24, 16.05s/it]

 35%|███▌      | 5637/16104 [26:07:41<44:23:17, 15.27s/it]

 35%|███▌      | 5638/16104 [26:07:52<40:44:37, 14.01s/it]

 35%|███▌      | 5639/16104 [26:08:03<37:54:55, 13.04s/it]

 35%|███▌      | 5640/16104 [26:08:18<39:26:52, 13.57s/it]
{'loss': 0.5504, 'learning_rate': 1.508799030582727e-06, 'rewards/chosen': -0.9391528964042664, 'rewards/rejected': -1.667809247970581, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7286561727523804, 'policy_logps/rejected': -383.1332092285156, 'policy_logps/chosen': -537.5550537109375, 'referece_logps/rejected': -366.4551086425781, 'referece_logps/chosen': -528.16357421875, 'logits/rejected': -0.753277599811554, 'logits/chosen': -0.694240391254425, 'epoch': 2.1}


 35%|███▌      | 5642/16104 [26:08:51<43:12:14, 14.87s/it]

 35%|███▌      | 5643/16104 [26:09:04<42:01:06, 14.46s/it]
{'loss': 0.5153, 'learning_rate': 1.508279497979505e-06, 'rewards/chosen': -0.9611280560493469, 'rewards/rejected': -2.131669521331787, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1705416440963745, 'policy_logps/rejected': -617.8961181640625, 'policy_logps/chosen': -478.3000183105469, 'referece_logps/rejected': -596.5794067382812, 'referece_logps/chosen': -468.6887512207031, 'logits/rejected': 0.3096672594547272, 'logits/chosen': 0.473682701587677, 'epoch': 2.1}


 35%|███▌      | 5645/16104 [26:09:41<48:16:21, 16.62s/it]
{'loss': 0.4913, 'learning_rate': 1.5079330400949513e-06, 'rewards/chosen': -1.4334226846694946, 'rewards/rejected': -2.0633933544158936, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6299707889556885, 'policy_logps/rejected': -368.4474792480469, 'policy_logps/chosen': -413.65643310546875, 'referece_logps/rejected': -347.8135681152344, 'referece_logps/chosen': -399.3221435546875, 'logits/rejected': -0.723375678062439, 'logits/chosen': -0.7830295562744141, 'epoch': 2.1}


 35%|███▌      | 5647/16104 [26:10:21<52:29:06, 18.07s/it]

 35%|███▌      | 5648/16104 [26:10:40<53:27:33, 18.41s/it]
{'loss': 0.5014, 'learning_rate': 1.5074131991846605e-06, 'rewards/chosen': -1.1095144748687744, 'rewards/rejected': -2.503884792327881, 'rewards/accuracies': 0.75, 'rewards/margins': 1.3943703174591064, 'policy_logps/rejected': -706.6480712890625, 'policy_logps/chosen': -453.40899658203125, 'referece_logps/rejected': -681.6091918945312, 'referece_logps/chosen': -442.3138427734375, 'logits/rejected': -0.9867249727249146, 'logits/chosen': -0.8232753872871399, 'epoch': 2.1}


 35%|███▌      | 5650/16104 [26:11:08<46:12:16, 15.91s/it]

 35%|███▌      | 5651/16104 [26:11:30<51:26:19, 17.72s/it]

 35%|███▌      | 5652/16104 [26:11:41<45:26:20, 15.65s/it]
{'loss': 0.5996, 'learning_rate': 1.5067197906428964e-06, 'rewards/chosen': -1.1316107511520386, 'rewards/rejected': -1.665209174156189, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5335984230041504, 'policy_logps/rejected': -348.4712219238281, 'policy_logps/chosen': -269.24078369140625, 'referece_logps/rejected': -331.8191223144531, 'referece_logps/chosen': -257.9246826171875, 'logits/rejected': -0.8957646489143372, 'logits/chosen': -0.8241353631019592, 'epoch': 2.11}


 35%|███▌      | 5654/16104 [26:12:13<45:57:19, 15.83s/it]

 35%|███▌      | 5655/16104 [26:12:28<45:48:41, 15.78s/it]

 35%|███▌      | 5656/16104 [26:12:48<49:22:52, 17.01s/it]

 35%|███▌      | 5657/16104 [26:13:05<49:05:09, 16.91s/it]

 35%|███▌      | 5658/16104 [26:13:23<49:42:56, 17.13s/it]

 35%|███▌      | 5659/16104 [26:13:33<44:06:47, 15.20s/it]
{'loss': 0.4477, 'learning_rate': 1.5055055368027352e-06, 'rewards/chosen': -0.6258245706558228, 'rewards/rejected': -1.6838114261627197, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0579869747161865, 'policy_logps/rejected': -250.0651092529297, 'policy_logps/chosen': -281.645263671875, 'referece_logps/rejected': -233.22703552246094, 'referece_logps/chosen': -275.3870544433594, 'logits/rejected': -0.6583760380744934, 'logits/chosen': -0.52351313829422, 'epoch': 2.11}

 35%|███▌      | 5660/16104 [26:13:50<45:05:27, 15.54s/it]


 35%|███▌      | 5662/16104 [26:14:13<39:19:50, 13.56s/it]

 35%|███▌      | 5663/16104 [26:14:29<40:58:42, 14.13s/it]

 35%|███▌      | 5664/16104 [26:14:43<41:03:10, 14.16s/it]

 35%|███▌      | 5665/16104 [26:15:01<44:25:29, 15.32s/it]
{'loss': 0.5279, 'learning_rate': 1.504463950210297e-06, 'rewards/chosen': -1.415395736694336, 'rewards/rejected': -2.1948935985565186, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7794978618621826, 'policy_logps/rejected': -390.00775146484375, 'policy_logps/chosen': -541.0321044921875, 'referece_logps/rejected': -368.0588073730469, 'referece_logps/chosen': -526.878173828125, 'logits/rejected': -0.3816620111465454, 'logits/chosen': -0.40839287638664246, 'epoch': 2.11}

 35%|███▌      | 5666/16104 [26:15:20<48:03:12, 16.57s/it]

 35%|███▌      | 5667/16104 [26:15:40<50:47:43, 17.52s/it]


 35%|███▌      | 5669/16104 [26:16:07<45:09:47, 15.58s/it]

 35%|███▌      | 5670/16104 [26:16:27<49:14:27, 16.99s/it]

 35%|███▌      | 5671/16104 [26:16:47<51:33:17, 17.79s/it]
{'loss': 0.4723, 'learning_rate': 1.5034216289851338e-06, 'rewards/chosen': -0.7761718034744263, 'rewards/rejected': -2.5687453746795654, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7925734519958496, 'policy_logps/rejected': -342.7461242675781, 'policy_logps/chosen': -315.12158203125, 'referece_logps/rejected': -317.0586853027344, 'referece_logps/chosen': -307.3598327636719, 'logits/rejected': -0.602242112159729, 'logits/chosen': -0.6308811902999878, 'epoch': 2.11}


 35%|███▌      | 5673/16104 [26:17:25<52:59:42, 18.29s/it]

 35%|███▌      | 5674/16104 [26:17:38<47:53:16, 16.53s/it]

 35%|███▌      | 5675/16104 [26:17:57<50:42:14, 17.50s/it]

 35%|███▌      | 5676/16104 [26:18:15<50:59:01, 17.60s/it]
{'loss': 0.545, 'learning_rate': 1.5025524678814425e-06, 'rewards/chosen': -0.9631749987602234, 'rewards/rejected': -2.1641457080841064, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2009706497192383, 'policy_logps/rejected': -305.3199768066406, 'policy_logps/chosen': -304.0157775878906, 'referece_logps/rejected': -283.67852783203125, 'referece_logps/chosen': -294.384033203125, 'logits/rejected': -0.5687559247016907, 'logits/chosen': -0.5324233174324036, 'epoch': 2.11}

 35%|███▌      | 5677/16104 [26:18:28<47:01:21, 16.23s/it]


 35%|███▌      | 5679/16104 [26:19:04<49:43:40, 17.17s/it]
{'loss': 0.5738, 'learning_rate': 1.5020307272132418e-06, 'rewards/chosen': -0.9715001583099365, 'rewards/rejected': -2.0684847831726074, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0969847440719604, 'policy_logps/rejected': -399.7640075683594, 'policy_logps/chosen': -481.8022155761719, 'referece_logps/rejected': -379.07916259765625, 'referece_logps/chosen': -472.0871887207031, 'logits/rejected': -0.6767913699150085, 'logits/chosen': -0.7749882936477661, 'epoch': 2.12}

 35%|███▌      | 5680/16104 [26:19:18<47:28:41, 16.40s/it]


 35%|███▌      | 5682/16104 [26:19:44<42:15:18, 14.60s/it]
{'loss': 0.3803, 'learning_rate': 1.5015088037726971e-06, 'rewards/chosen': -0.7266235947608948, 'rewards/rejected': -1.447214961051941, 'rewards/accuracies': 1.0, 'rewards/margins': 0.7205911874771118, 'policy_logps/rejected': -286.9752197265625, 'policy_logps/chosen': -182.15953063964844, 'referece_logps/rejected': -272.5030822753906, 'referece_logps/chosen': -174.89329528808594, 'logits/rejected': -0.44412705302238464, 'logits/chosen': -0.362908273935318, 'epoch': 2.12}

 35%|███▌      | 5683/16104 [26:19:58<42:20:18, 14.63s/it]


 35%|███▌      | 5685/16104 [26:20:24<39:25:16, 13.62s/it]

 35%|███▌      | 5686/16104 [26:20:43<44:19:28, 15.32s/it]

 35%|███▌      | 5687/16104 [26:20:55<41:25:56, 14.32s/it]

 35%|███▌      | 5688/16104 [26:21:07<39:30:29, 13.65s/it]

 35%|███▌      | 5689/16104 [26:21:25<43:39:18, 15.09s/it]
{'loss': 0.3917, 'learning_rate': 1.5002902726975781e-06, 'rewards/chosen': -0.3206205666065216, 'rewards/rejected': -2.5916078090667725, 'rewards/accuracies': 0.875, 'rewards/margins': 2.270987033843994, 'policy_logps/rejected': -544.0521240234375, 'policy_logps/chosen': -544.7738037109375, 'referece_logps/rejected': -518.1360473632812, 'referece_logps/chosen': -541.567626953125, 'logits/rejected': 0.08951528370380402, 'logits/chosen': -0.031479448080062866, 'epoch': 2.12}


 35%|███▌      | 5691/16104 [26:22:07<52:18:30, 18.08s/it]
{'loss': 0.4411, 'learning_rate': 1.4999419387174764e-06, 'rewards/chosen': -1.7920466661453247, 'rewards/rejected': -2.111647844314575, 'rewards/accuracies': 0.625, 'rewards/margins': 0.31960079073905945, 'policy_logps/rejected': -436.9993896484375, 'policy_logps/chosen': -422.3247375488281, 'referece_logps/rejected': -415.8829040527344, 'referece_logps/chosen': -404.404296875, 'logits/rejected': -0.3026541769504547, 'logits/chosen': -0.2785937488079071, 'epoch': 2.12}


 35%|███▌      | 5693/16104 [26:22:49<56:35:01, 19.57s/it]

 35%|███▌      | 5694/16104 [26:23:01<50:13:02, 17.37s/it]

 35%|███▌      | 5695/16104 [26:23:20<51:10:20, 17.70s/it]

 35%|███▌      | 5696/16104 [26:23:37<50:44:44, 17.55s/it]

 35%|███▌      | 5697/16104 [26:23:50<46:20:57, 16.03s/it]
{'loss': 0.4068, 'learning_rate': 1.4988964516376476e-06, 'rewards/chosen': -1.007750153541565, 'rewards/rejected': -2.599121332168579, 'rewards/accuracies': 1.0, 'rewards/margins': 1.5913712978363037, 'policy_logps/rejected': -418.23773193359375, 'policy_logps/chosen': -433.86126708984375, 'referece_logps/rejected': -392.2465515136719, 'referece_logps/chosen': -423.78375244140625, 'logits/rejected': 0.18950068950653076, 'logits/chosen': 0.1344568431377411, 'epoch': 2.12}


 35%|███▌      | 5699/16104 [26:24:32<53:41:06, 18.57s/it]
{'loss': 0.4651, 'learning_rate': 1.4985477944191607e-06, 'rewards/chosen': -1.0978409051895142, 'rewards/rejected': -2.399216651916504, 'rewards/accuracies': 0.625, 'rewards/margins': 1.3013758659362793, 'policy_logps/rejected': -382.2603759765625, 'policy_logps/chosen': -338.7729187011719, 'referece_logps/rejected': -358.2682189941406, 'referece_logps/chosen': -327.79449462890625, 'logits/rejected': -0.9411563277244568, 'logits/chosen': -0.8251783847808838, 'epoch': 2.12}


 35%|███▌      | 5701/16104 [26:25:10<53:56:14, 18.67s/it]

 35%|███▌      | 5702/16104 [26:25:31<56:13:44, 19.46s/it]

 35%|███▌      | 5703/16104 [26:25:52<57:02:11, 19.74s/it]

 35%|███▌      | 5704/16104 [26:26:06<52:13:26, 18.08s/it]

 35%|███▌      | 5705/16104 [26:26:25<53:34:54, 18.55s/it]

 35%|███▌      | 5706/16104 [26:26:44<53:40:37, 18.58s/it]

 35%|███▌      | 5707/16104 [26:26:56<47:56:08, 16.60s/it]

 35%|███▌      | 5708/16104 [26:27:12<46:59:16, 16.27s/it]

 35%|███▌      | 5709/16104 [26:27:32<50:13:39, 17.39s/it]
{'loss': 0.5387, 'learning_rate': 1.4968032994266221e-06, 'rewards/chosen': -0.8945077657699585, 'rewards/rejected': -1.9621739387512207, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0676662921905518, 'policy_logps/rejected': -459.1642761230469, 'policy_logps/chosen': -524.166015625, 'referece_logps/rejected': -439.5426025390625, 'referece_logps/chosen': -515.2208862304688, 'logits/rejected': 0.16598498821258545, 'logits/chosen': 0.1225164532661438, 'epoch': 2.13}


 35%|███▌      | 5711/16104 [26:27:58<43:46:39, 15.16s/it]
{'loss': 0.4554, 'learning_rate': 1.4964541590432745e-06, 'rewards/chosen': -0.6580230593681335, 'rewards/rejected': -1.4917442798614502, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8337212204933167, 'policy_logps/rejected': -352.9381103515625, 'policy_logps/chosen': -407.47528076171875, 'referece_logps/rejected': -338.0206298828125, 'referece_logps/chosen': -400.8950500488281, 'logits/rejected': -1.4166431427001953, 'logits/chosen': -1.4422286748886108, 'epoch': 2.13}

 35%|███▌      | 5712/16104 [26:28:18<48:13:27, 16.71s/it]


 35%|███▌      | 5714/16104 [26:28:48<46:01:04, 15.94s/it]
{'loss': 0.4775, 'learning_rate': 1.495930297867487e-06, 'rewards/chosen': -1.4471991062164307, 'rewards/rejected': -2.043416976928711, 'rewards/accuracies': 0.375, 'rewards/margins': 0.5962181091308594, 'policy_logps/rejected': -459.3001708984375, 'policy_logps/chosen': -473.5040283203125, 'referece_logps/rejected': -438.86602783203125, 'referece_logps/chosen': -459.0320739746094, 'logits/rejected': 0.15016107261180878, 'logits/chosen': 0.1426999568939209, 'epoch': 2.13}

 35%|███▌      | 5715/16104 [26:29:05<46:55:10, 16.26s/it]


 36%|███▌      | 5717/16104 [26:29:40<49:23:45, 17.12s/it]
{'loss': 0.569, 'learning_rate': 1.495406256140315e-06, 'rewards/chosen': -1.17396879196167, 'rewards/rejected': -1.6997103691101074, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5257415771484375, 'policy_logps/rejected': -444.0773620605469, 'policy_logps/chosen': -564.6026000976562, 'referece_logps/rejected': -427.0802917480469, 'referece_logps/chosen': -552.8629150390625, 'logits/rejected': -0.8937710523605347, 'logits/chosen': -1.0171910524368286, 'epoch': 2.13}

 36%|███▌      | 5718/16104 [26:30:01<52:19:24, 18.14s/it]


 36%|███▌      | 5720/16104 [26:30:42<55:53:31, 19.38s/it]
{'loss': 0.4297, 'learning_rate': 1.4948820340525437e-06, 'rewards/chosen': -0.7156795859336853, 'rewards/rejected': -1.7174347639083862, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0017549991607666, 'policy_logps/rejected': -342.3915710449219, 'policy_logps/chosen': -408.1770935058594, 'referece_logps/rejected': -325.2171936035156, 'referece_logps/chosen': -401.02032470703125, 'logits/rejected': -1.336918830871582, 'logits/chosen': -1.3103629350662231, 'epoch': 2.13}


 36%|███▌      | 5722/16104 [26:31:14<50:47:44, 17.61s/it]

 36%|███▌      | 5723/16104 [26:31:30<49:24:35, 17.13s/it]

 36%|███▌      | 5724/16104 [26:31:42<45:26:17, 15.76s/it]

 36%|███▌      | 5725/16104 [26:32:04<50:51:17, 17.64s/it]
{'loss': 0.4111, 'learning_rate': 1.4940079302899849e-06, 'rewards/chosen': -0.8029465079307556, 'rewards/rejected': -1.738698124885559, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9357516765594482, 'policy_logps/rejected': -272.2250061035156, 'policy_logps/chosen': -250.0297088623047, 'referece_logps/rejected': -254.8380126953125, 'referece_logps/chosen': -242.000244140625, 'logits/rejected': -0.006300210952758789, 'logits/chosen': 0.015248894691467285, 'epoch': 2.13}

 36%|███▌      | 5726/16104 [26:32:17<46:30:09, 16.13s/it]

 36%|███▌      | 5727/16104 [26:32:31<44:51:05, 15.56s/it]


 36%|███▌      | 5729/16104 [26:33:10<50:01:38, 17.36s/it]

 36%|███▌      | 5730/16104 [26:33:30<52:42:41, 18.29s/it]

 36%|███▌      | 5731/16104 [26:33:50<53:50:31, 18.69s/it]
{'loss': 0.4504, 'learning_rate': 1.4929583463972166e-06, 'rewards/chosen': -1.0341252088546753, 'rewards/rejected': -2.64310359954834, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6089786291122437, 'policy_logps/rejected': -293.80792236328125, 'policy_logps/chosen': -287.7327575683594, 'referece_logps/rejected': -267.37689208984375, 'referece_logps/chosen': -277.3915100097656, 'logits/rejected': -0.12062093615531921, 'logits/chosen': -0.1001029759645462, 'epoch': 2.14}


 36%|███▌      | 5733/16104 [26:34:32<56:59:39, 19.78s/it]

 36%|███▌      | 5734/16104 [26:34:53<57:57:21, 20.12s/it]
{'loss': 0.4684, 'learning_rate': 1.4924332851511889e-06, 'rewards/chosen': -1.4405856132507324, 'rewards/rejected': -2.3208799362182617, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8802944421768188, 'policy_logps/rejected': -494.236083984375, 'policy_logps/chosen': -470.1672668457031, 'referece_logps/rejected': -471.0273742675781, 'referece_logps/chosen': -455.76141357421875, 'logits/rejected': -1.5988880395889282, 'logits/chosen': -1.6433230638504028, 'epoch': 2.14}

 36%|███▌      | 5735/16104 [26:35:03<49:53:06, 17.32s/it]

 36%|███▌      | 5736/16104 [26:35:23<51:49:50, 18.00s/it]

 36%|███▌      | 5737/16104 [26:35:35<46:42:54, 16.22s/it]


 36%|███▌      | 5739/16104 [26:36:12<51:24:23, 17.85s/it]
{'loss': 0.5508, 'learning_rate': 1.491557784772813e-06, 'rewards/chosen': -0.840813398361206, 'rewards/rejected': -2.091487169265747, 'rewards/accuracies': 0.75, 'rewards/margins': 1.250673770904541, 'policy_logps/rejected': -549.7440185546875, 'policy_logps/chosen': -466.5687255859375, 'referece_logps/rejected': -528.8291625976562, 'referece_logps/chosen': -458.1606140136719, 'logits/rejected': -0.0794648826122284, 'logits/chosen': 0.03490215539932251, 'epoch': 2.14}

 36%|███▌      | 5740/16104 [26:36:29<50:50:19, 17.66s/it]


 36%|███▌      | 5742/16104 [26:36:55<43:34:37, 15.14s/it]
{'loss': 0.4903, 'learning_rate': 1.491032245876446e-06, 'rewards/chosen': -0.9234640598297119, 'rewards/rejected': -1.9162142276763916, 'rewards/accuracies': 1.0, 'rewards/margins': 0.9927501678466797, 'policy_logps/rejected': -417.135498046875, 'policy_logps/chosen': -390.0585632324219, 'referece_logps/rejected': -397.973388671875, 'referece_logps/chosen': -380.8239440917969, 'logits/rejected': -0.0590166375041008, 'logits/chosen': -0.1463814079761505, 'epoch': 2.14}


 36%|███▌      | 5744/16104 [26:37:33<49:30:22, 17.20s/it]

 36%|███▌      | 5745/16104 [26:37:45<44:41:20, 15.53s/it]

 36%|███▌      | 5746/16104 [26:38:04<48:25:26, 16.83s/it]
{'loss': 0.4272, 'learning_rate': 1.4903312492972144e-06, 'rewards/chosen': -0.5271515250205994, 'rewards/rejected': -3.0031490325927734, 'rewards/accuracies': 1.0, 'rewards/margins': 2.4759976863861084, 'policy_logps/rejected': -548.0830078125, 'policy_logps/chosen': -520.8881225585938, 'referece_logps/rejected': -518.0515747070312, 'referece_logps/chosen': -515.6165771484375, 'logits/rejected': -0.24729004502296448, 'logits/chosen': -0.11396050453186035, 'epoch': 2.14}


 36%|███▌      | 5748/16104 [26:38:37<48:26:33, 16.84s/it]
{'loss': 0.4821, 'learning_rate': 1.4899806319705963e-06, 'rewards/chosen': -0.9462530612945557, 'rewards/rejected': -1.4251244068145752, 'rewards/accuracies': 0.75, 'rewards/margins': 0.47887128591537476, 'policy_logps/rejected': -326.06646728515625, 'policy_logps/chosen': -375.2586364746094, 'referece_logps/rejected': -311.8152160644531, 'referece_logps/chosen': -365.79608154296875, 'logits/rejected': -1.0612822771072388, 'logits/chosen': -1.039415717124939, 'epoch': 2.14}

 36%|███▌      | 5749/16104 [26:38:53<47:48:38, 16.62s/it]


 36%|███▌      | 5751/16104 [26:39:29<50:17:08, 17.49s/it]

 36%|███▌      | 5752/16104 [26:39:41<45:14:57, 15.74s/it]
{'loss': 0.5241, 'learning_rate': 1.4892791595270158e-06, 'rewards/chosen': -1.314155101776123, 'rewards/rejected': -1.6094495058059692, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2952943742275238, 'policy_logps/rejected': -266.9787292480469, 'policy_logps/chosen': -269.7364807128906, 'referece_logps/rejected': -250.88424682617188, 'referece_logps/chosen': -256.59490966796875, 'logits/rejected': -1.1063661575317383, 'logits/chosen': -1.1422306299209595, 'epoch': 2.14}

 36%|███▌      | 5753/16104 [26:39:58<46:20:08, 16.12s/it]


 36%|███▌      | 5755/16104 [26:40:28<45:57:48, 15.99s/it]

 36%|███▌      | 5756/16104 [26:40:41<42:49:43, 14.90s/it]
{'loss': 0.4808, 'learning_rate': 1.4885773704080097e-06, 'rewards/chosen': -0.7590488195419312, 'rewards/rejected': -2.250046491622925, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4909977912902832, 'policy_logps/rejected': -307.4208984375, 'policy_logps/chosen': -427.232666015625, 'referece_logps/rejected': -284.92041015625, 'referece_logps/chosen': -419.64215087890625, 'logits/rejected': 0.22580580413341522, 'logits/chosen': 0.24547819793224335, 'epoch': 2.14}

 36%|███▌      | 5757/16104 [26:41:04<49:52:27, 17.35s/it]


 36%|███▌      | 5759/16104 [26:41:40<50:53:09, 17.71s/it]

 36%|███▌      | 5760/16104 [26:41:57<50:08:54, 17.45s/it]

 36%|███▌      | 5761/16104 [26:42:19<53:31:42, 18.63s/it]
{'loss': 0.4165, 'learning_rate': 1.4876996893764267e-06, 'rewards/chosen': -1.266161322593689, 'rewards/rejected': -2.524873971939087, 'rewards/accuracies': 0.625, 'rewards/margins': 1.2587127685546875, 'policy_logps/rejected': -376.6090087890625, 'policy_logps/chosen': -395.7141418457031, 'referece_logps/rejected': -351.3602294921875, 'referece_logps/chosen': -383.0525207519531, 'logits/rejected': 0.5456898212432861, 'logits/chosen': 0.6355237364768982, 'epoch': 2.15}

 36%|███▌      | 5762/16104 [26:42:36<52:10:26, 18.16s/it]

 36%|███▌      | 5763/16104 [26:42:56<54:08:16, 18.85s/it]


 36%|███▌      | 5765/16104 [26:43:29<49:46:39, 17.33s/it]

 36%|███▌      | 5766/16104 [26:43:47<50:33:52, 17.61s/it]
{'loss': 0.5111, 'learning_rate': 1.4868215151368152e-06, 'rewards/chosen': -0.918694257736206, 'rewards/rejected': -1.455338716506958, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5366443991661072, 'policy_logps/rejected': -240.31121826171875, 'policy_logps/chosen': -350.2992248535156, 'referece_logps/rejected': -225.75782775878906, 'referece_logps/chosen': -341.1122741699219, 'logits/rejected': -1.055595874786377, 'logits/chosen': -1.0552910566329956, 'epoch': 2.15}


 36%|███▌      | 5768/16104 [26:44:21<48:56:14, 17.04s/it]
{'loss': 0.5898, 'learning_rate': 1.4864701075416388e-06, 'rewards/chosen': -1.4508917331695557, 'rewards/rejected': -1.8981637954711914, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4472721517086029, 'policy_logps/rejected': -292.49383544921875, 'policy_logps/chosen': -449.7537536621094, 'referece_logps/rejected': -273.51220703125, 'referece_logps/chosen': -435.2448425292969, 'logits/rejected': -1.2780187129974365, 'logits/chosen': -1.291124939918518, 'epoch': 2.15}

 36%|███▌      | 5769/16104 [26:44:41<51:01:24, 17.77s/it]

 36%|███▌      | 5770/16104 [26:44:53<46:03:27, 16.04s/it]

 36%|███▌      | 5771/16104 [26:45:10<47:08:24, 16.42s/it]

 36%|███▌      | 5772/16104 [26:45:32<51:46:27, 18.04s/it]

 36%|███▌      | 5773/16104 [26:45:48<50:23:09, 17.56s/it]

 36%|███▌      | 5774/16104 [26:46:00<45:43:13, 15.93s/it]

 36%|███▌      | 5775/16104 [26:46:19<47:50:38, 16.68s/it]


 36%|███▌      | 5777/16104 [26:46:55<50:26:01, 17.58s/it]

 36%|███▌      | 5778/16104 [26:47:15<52:37:57, 18.35s/it]
{'loss': 0.4565, 'learning_rate': 1.484711889988382e-06, 'rewards/chosen': -1.0086147785186768, 'rewards/rejected': -2.0615968704223633, 'rewards/accuracies': 0.875, 'rewards/margins': 1.052981972694397, 'policy_logps/rejected': -239.17295837402344, 'policy_logps/chosen': -221.6858673095703, 'referece_logps/rejected': -218.5569610595703, 'referece_logps/chosen': -211.5997314453125, 'logits/rejected': -0.5650656223297119, 'logits/chosen': -0.5301040410995483, 'epoch': 2.15}

 36%|███▌      | 5779/16104 [26:47:36<54:19:32, 18.94s/it]

 36%|███▌      | 5780/16104 [26:47:51<51:00:52, 17.79s/it]

 36%|███▌      | 5781/16104 [26:48:06<48:43:40, 16.99s/it]

 36%|███▌      | 5782/16104 [26:48:23<48:28:35, 16.91s/it]

 36%|███▌      | 5783/16104 [26:48:36<45:06:05, 15.73s/it]

 36%|███▌      | 5784/16104 [26:48:54<47:29:02, 16.56s/it]

 36%|███▌      | 5785/16104 [26:49:05<42:23:23, 14.79s/it]

 36%|███▌      | 5786/16104 [26:49:20<42:56:05, 14.98s/it]

 36%|███▌      | 5787/16104 [26:49:40<46:51:19, 16.35s/it]

 36%|███▌      | 5788/16104 [26:49:54<44:58:37, 15.70s/it]


 36%|███▌      | 5790/16104 [26:50:30<47:14:51, 16.49s/it]
{'loss': 0.5857, 'learning_rate': 1.482599441366938e-06, 'rewards/chosen': -1.129580020904541, 'rewards/rejected': -2.8508501052856445, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7212703227996826, 'policy_logps/rejected': -607.5299072265625, 'policy_logps/chosen': -487.5203857421875, 'referece_logps/rejected': -579.0214233398438, 'referece_logps/chosen': -476.22467041015625, 'logits/rejected': -0.743208646774292, 'logits/chosen': -0.5955292582511902, 'epoch': 2.16}


 36%|███▌      | 5792/16104 [26:51:01<45:25:47, 15.86s/it]
{'loss': 0.6295, 'learning_rate': 1.4822470929561546e-06, 'rewards/chosen': -1.2191168069839478, 'rewards/rejected': -2.249410390853882, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0302934646606445, 'policy_logps/rejected': -478.1168518066406, 'policy_logps/chosen': -474.3518981933594, 'referece_logps/rejected': -455.62274169921875, 'referece_logps/chosen': -462.1607666015625, 'logits/rejected': -0.9946353435516357, 'logits/chosen': -1.101973056793213, 'epoch': 2.16}

 36%|███▌      | 5793/16104 [26:51:21<48:11:57, 16.83s/it]


 36%|███▌      | 5795/16104 [26:51:51<46:06:39, 16.10s/it]
{'loss': 0.4088, 'learning_rate': 1.4817184240496343e-06, 'rewards/chosen': -0.9866256713867188, 'rewards/rejected': -1.5190469026565552, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5324212908744812, 'policy_logps/rejected': -369.7286071777344, 'policy_logps/chosen': -367.92901611328125, 'referece_logps/rejected': -354.53814697265625, 'referece_logps/chosen': -358.0627746582031, 'logits/rejected': 0.5650171041488647, 'logits/chosen': 0.37241846323013306, 'epoch': 2.16}

 36%|███▌      | 5796/16104 [26:52:11<49:07:25, 17.16s/it]

 36%|███▌      | 5797/16104 [26:52:31<51:30:27, 17.99s/it]

 36%|███▌      | 5798/16104 [26:52:44<47:24:16, 16.56s/it]


 36%|███▌      | 5800/16104 [26:53:16<45:27:23, 15.88s/it]
{'loss': 0.4966, 'learning_rate': 1.480836919573123e-06, 'rewards/chosen': -0.7268716096878052, 'rewards/rejected': -1.8076244592666626, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0807528495788574, 'policy_logps/rejected': -363.22491455078125, 'policy_logps/chosen': -378.54705810546875, 'referece_logps/rejected': -345.1487121582031, 'referece_logps/chosen': -371.27838134765625, 'logits/rejected': -0.19030040502548218, 'logits/chosen': -0.10115793347358704, 'epoch': 2.16}

 36%|███▌      | 5801/16104 [26:53:28<42:34:36, 14.88s/it]

 36%|███▌      | 5802/16104 [26:53:46<45:06:38, 15.76s/it]

 36%|███▌      | 5803/16104 [26:54:02<45:30:11, 15.90s/it]

 36%|███▌      | 5804/16104 [26:54:21<48:11:08, 16.84s/it]


 36%|███▌      | 5806/16104 [26:54:46<41:20:42, 14.45s/it]

 36%|███▌      | 5807/16104 [26:54:58<39:27:59, 13.80s/it]

 36%|███▌      | 5808/16104 [26:55:16<43:08:27, 15.08s/it]
{'loss': 0.6049, 'learning_rate': 1.479425501344824e-06, 'rewards/chosen': -0.8427615165710449, 'rewards/rejected': -1.2521803379058838, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4094187915325165, 'policy_logps/rejected': -545.1012573242188, 'policy_logps/chosen': -361.4396667480469, 'referece_logps/rejected': -532.5795288085938, 'referece_logps/chosen': -353.0120849609375, 'logits/rejected': -0.6644691228866577, 'logits/chosen': -0.5732221007347107, 'epoch': 2.16}


 36%|███▌      | 5810/16104 [26:55:54<48:50:11, 17.08s/it]
{'loss': 0.6652, 'learning_rate': 1.479072452708813e-06, 'rewards/chosen': -0.8087868690490723, 'rewards/rejected': -1.1932350397109985, 'rewards/accuracies': 0.75, 'rewards/margins': 0.38444823026657104, 'policy_logps/rejected': -377.9200744628906, 'policy_logps/chosen': -408.80499267578125, 'referece_logps/rejected': -365.9876708984375, 'referece_logps/chosen': -400.7171630859375, 'logits/rejected': 0.0871814638376236, 'logits/chosen': -0.01900307834148407, 'epoch': 2.16}

 36%|███▌      | 5811/16104 [26:56:10<48:13:00, 16.86s/it]

 36%|███▌      | 5812/16104 [26:56:30<50:45:26, 17.75s/it]

 36%|███▌      | 5813/16104 [26:56:52<53:48:01, 18.82s/it]

 36%|███▌      | 5814/16104 [26:57:10<53:04:27, 18.57s/it]

 36%|███▌      | 5815/16104 [26:57:24<49:12:56, 17.22s/it]


 36%|███▌      | 5817/16104 [26:58:02<52:14:10, 18.28s/it]
{'loss': 0.354, 'learning_rate': 1.4778361724087103e-06, 'rewards/chosen': -1.3144298791885376, 'rewards/rejected': -2.211210012435913, 'rewards/accuracies': 0.875, 'rewards/margins': 0.896780252456665, 'policy_logps/rejected': -397.4935302734375, 'policy_logps/chosen': -433.95220947265625, 'referece_logps/rejected': -375.3814697265625, 'referece_logps/chosen': -420.80792236328125, 'logits/rejected': -0.8198367953300476, 'logits/chosen': -0.9050488471984863, 'epoch': 2.17}

 36%|███▌      | 5818/16104 [26:58:20<52:18:33, 18.31s/it]

 36%|███▌      | 5819/16104 [26:58:35<49:09:58, 17.21s/it]


 36%|███▌      | 5821/16104 [26:59:08<46:56:14, 16.43s/it]
{'loss': 0.5173, 'learning_rate': 1.4771293011205863e-06, 'rewards/chosen': -0.8859188556671143, 'rewards/rejected': -1.305397391319275, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4194785952568054, 'policy_logps/rejected': -409.95281982421875, 'policy_logps/chosen': -401.0981140136719, 'referece_logps/rejected': -396.89886474609375, 'referece_logps/chosen': -392.2388916015625, 'logits/rejected': -0.47106873989105225, 'logits/chosen': -0.36825641989707947, 'epoch': 2.17}

 36%|███▌      | 5822/16104 [26:59:20<43:34:53, 15.26s/it]

 36%|███▌      | 5823/16104 [26:59:38<45:55:57, 16.08s/it]


 36%|███▌      | 5825/16104 [27:00:04<40:51:11, 14.31s/it]
{'loss': 0.5198, 'learning_rate': 1.4764221210207714e-06, 'rewards/chosen': -1.0158345699310303, 'rewards/rejected': -1.469435453414917, 'rewards/accuracies': 0.75, 'rewards/margins': 0.45360100269317627, 'policy_logps/rejected': -383.619873046875, 'policy_logps/chosen': -331.2770080566406, 'referece_logps/rejected': -368.925537109375, 'referece_logps/chosen': -321.11865234375, 'logits/rejected': -0.5017770528793335, 'logits/chosen': -0.5121074318885803, 'epoch': 2.17}

 36%|███▌      | 5826/16104 [27:00:17<39:23:43, 13.80s/it]

 36%|███▌      | 5827/16104 [27:00:39<46:27:14, 16.27s/it]

 36%|███▌      | 5828/16104 [27:00:53<44:26:10, 15.57s/it]


 36%|███▌      | 5830/16104 [27:01:28<47:07:59, 16.52s/it]
{'loss': 0.4153, 'learning_rate': 1.475537712326869e-06, 'rewards/chosen': -1.5302287340164185, 'rewards/rejected': -2.9950034618377686, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4647750854492188, 'policy_logps/rejected': -341.9546813964844, 'policy_logps/chosen': -362.3918151855469, 'referece_logps/rejected': -312.0046081542969, 'referece_logps/chosen': -347.0894775390625, 'logits/rejected': -1.217217206954956, 'logits/chosen': -1.3292152881622314, 'epoch': 2.17}

 36%|███▌      | 5831/16104 [27:01:48<49:55:28, 17.50s/it]

 36%|███▌      | 5832/16104 [27:02:04<48:32:57, 17.01s/it]

 36%|███▌      | 5833/16104 [27:02:23<50:44:54, 17.79s/it]

 36%|███▌      | 5834/16104 [27:02:35<45:19:08, 15.89s/it]

 36%|███▌      | 5835/16104 [27:02:51<45:41:40, 16.02s/it]

 36%|███▌      | 5836/16104 [27:03:08<46:10:23, 16.19s/it]

 36%|███▌      | 5837/16104 [27:03:20<42:44:43, 14.99s/it]


 36%|███▋      | 5839/16104 [27:03:42<37:09:54, 13.03s/it]
{'loss': 0.5416, 'learning_rate': 1.4739445653892986e-06, 'rewards/chosen': -1.1863725185394287, 'rewards/rejected': -2.0759289264678955, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8895564675331116, 'policy_logps/rejected': -548.9174194335938, 'policy_logps/chosen': -645.6849365234375, 'referece_logps/rejected': -528.1580810546875, 'referece_logps/chosen': -633.8212890625, 'logits/rejected': 0.42241835594177246, 'logits/chosen': 0.3295697867870331, 'epoch': 2.18}

 36%|███▋      | 5840/16104 [27:04:00<40:54:44, 14.35s/it]


 36%|███▋      | 5842/16104 [27:04:28<40:13:43, 14.11s/it]

 36%|███▋      | 5843/16104 [27:04:40<38:23:30, 13.47s/it]

 36%|███▋      | 5844/16104 [27:04:52<37:02:45, 13.00s/it]
{'loss': 0.5725, 'learning_rate': 1.4730588124065055e-06, 'rewards/chosen': -1.0566211938858032, 'rewards/rejected': -1.6578327417373657, 'rewards/accuracies': 0.75, 'rewards/margins': 0.601211428642273, 'policy_logps/rejected': -497.2577209472656, 'policy_logps/chosen': -475.08746337890625, 'referece_logps/rejected': -480.6793518066406, 'referece_logps/chosen': -464.521240234375, 'logits/rejected': -0.44633719325065613, 'logits/chosen': -0.48292967677116394, 'epoch': 2.18}


 36%|███▋      | 5846/16104 [27:05:28<44:39:48, 15.67s/it]
{'loss': 0.481, 'learning_rate': 1.4727043772107085e-06, 'rewards/chosen': -0.9716867208480835, 'rewards/rejected': -2.1343772411346436, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1626906394958496, 'policy_logps/rejected': -373.3073425292969, 'policy_logps/chosen': -471.4991149902344, 'referece_logps/rejected': -351.9635314941406, 'referece_logps/chosen': -461.78228759765625, 'logits/rejected': 0.1029970720410347, 'logits/chosen': -0.07526209950447083, 'epoch': 2.18}

 36%|███▋      | 5847/16104 [27:05:39<40:44:00, 14.30s/it]

 36%|███▋      | 5848/16104 [27:05:59<45:18:42, 15.91s/it]

 36%|███▋      | 5849/16104 [27:06:17<47:23:58, 16.64s/it]

 36%|███▋      | 5850/16104 [27:06:29<43:29:48, 15.27s/it]

 36%|███▋      | 5851/16104 [27:06:47<45:41:33, 16.04s/it]


 36%|███▋      | 5853/16104 [27:07:23<47:31:40, 16.69s/it]
{'loss': 0.4413, 'learning_rate': 1.471463252067226e-06, 'rewards/chosen': -0.9377593398094177, 'rewards/rejected': -2.0961647033691406, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1584055423736572, 'policy_logps/rejected': -368.7577819824219, 'policy_logps/chosen': -355.06622314453125, 'referece_logps/rejected': -347.796142578125, 'referece_logps/chosen': -345.6886291503906, 'logits/rejected': -0.16371311247348785, 'logits/chosen': -0.25678399205207825, 'epoch': 2.18}

 36%|███▋      | 5854/16104 [27:07:43<50:36:11, 17.77s/it]

 36%|███▋      | 5855/16104 [27:08:03<52:51:51, 18.57s/it]

 36%|███▋      | 5856/16104 [27:08:20<51:06:40, 17.95s/it]

 36%|███▋      | 5857/16104 [27:08:31<45:17:23, 15.91s/it]

 36%|███▋      | 5858/16104 [27:08:43<42:11:46, 14.83s/it]

 36%|███▋      | 5859/16104 [27:09:03<46:27:23, 16.32s/it]

 36%|███▋      | 5860/16104 [27:09:14<42:05:31, 14.79s/it]

 36%|███▋      | 5861/16104 [27:09:26<39:39:07, 13.94s/it]

 36%|███▋      | 5862/16104 [27:09:46<44:35:29, 15.67s/it]

 36%|███▋      | 5863/16104 [27:10:04<46:21:02, 16.29s/it]

 36%|███▋      | 5864/16104 [27:10:26<51:24:38, 18.07s/it]

 36%|███▋      | 5865/16104 [27:10:45<52:34:38, 18.49s/it]

 36%|███▋      | 5866/16104 [27:11:06<54:43:52, 19.25s/it]

 36%|███▋      | 5867/16104 [27:11:20<49:42:44, 17.48s/it]

 36%|███▋      | 5868/16104 [27:11:36<49:01:41, 17.24s/it]

 36%|███▋      | 5869/16104 [27:11:47<43:27:57, 15.29s/it]

 36%|███▋      | 5870/16104 [27:12:00<41:13:04, 14.50s/it]


 36%|███▋      | 5872/16104 [27:12:30<42:54:47, 15.10s/it]

 36%|███▋      | 5873/16104 [27:12:45<43:26:18, 15.28s/it]

 36%|███▋      | 5874/16104 [27:13:05<47:04:18, 16.56s/it]

 36%|███▋      | 5875/16104 [27:13:18<44:22:07, 15.62s/it]

 36%|███▋      | 5876/16104 [27:13:37<47:20:48, 16.66s/it]

 36%|███▋      | 5877/16104 [27:13:52<45:07:00, 15.88s/it]

 37%|███▋      | 5878/16104 [27:14:08<45:36:14, 16.05s/it]

 37%|███▋      | 5879/16104 [27:14:27<48:30:06, 17.08s/it]

 37%|███▋      | 5880/16104 [27:14:42<46:17:26, 16.30s/it]

 37%|███▋      | 5881/16104 [27:14:54<43:04:15, 15.17s/it]

 37%|███▋      | 5882/16104 [27:15:14<46:53:10, 16.51s/it]

 37%|███▋      | 5883/16104 [27:15:26<42:58:35, 15.14s/it]

 37%|███▋      | 5884/16104 [27:15:39<40:57:52, 14.43s/it]

 37%|███▋      | 5885/16104 [27:15:52<39:56:29, 14.07s/it]

 37%|███▋      | 5886/16104 [27:16:10<42:53:21, 15.11s/it]

 37%|███▋      | 5887/16104 [27:16:26<44:18:58, 15.62s/it]

 37%|███▋      | 5888/16104 [27:16:43<44:58:28, 15.85s/it]

 37%|███▋      | 5889/16104 [27:17:02<47:27:32, 16.73s/it]

 37%|███▋      | 5890/16104 [27:17:21<49:53:47, 17.59s/it]

 37%|███▋      | 5891/16104 [27:17:35<46:31:03, 16.40s/it]

 37%|███▋      | 5892/16104 [27:17:52<46:54:59, 16.54s/it]

 37%|███▋      | 5893/16104 [27:18:11<49:36:49, 17.49s/it]

 37%|███▋      | 5894/16104 [27:18:26<47:20:54, 16.69s/it]

 37%|███▋      | 5895/16104 [27:18:46<49:57:13, 17.62s/it]

 37%|███▋      | 5896/16104 [27:19:02<49:00:19, 17.28s/it]

 37%|███▋      | 5897/16104 [27:19:19<48:17:53, 17.03s/it]

 37%|███▋      | 5898/16104 [27:19:31<44:10:17, 15.58s/it]

 37%|███▋      | 5899/16104 [27:19:42<40:21:42, 14.24s/it]

 37%|███▋      | 5900/16104 [27:19:54<38:11:54, 13.48s/it]

 37%|███▋      | 5901/16104 [27:20:09<39:18:23, 13.87s/it]

 37%|███▋      | 5902/16104 [27:20:28<44:20:22, 15.65s/it]

 37%|███▋      | 5903/16104 [27:20:43<43:26:36, 15.33s/it]

 37%|███▋      | 5904/16104 [27:21:01<45:31:23, 16.07s/it]

 37%|███▋      | 5905/16104 [27:21:12<41:18:18, 14.58s/it]

 37%|███▋      | 5906/16104 [27:21:32<45:54:57, 16.21s/it]

 37%|███▋      | 5907/16104 [27:21:44<42:40:48, 15.07s/it]

 37%|███▋      | 5908/16104 [27:22:00<43:25:03, 15.33s/it]

 37%|███▋      | 5909/16104 [27:22:17<44:19:30, 15.65s/it]

 37%|███▋      | 5910/16104 [27:22:36<47:40:17, 16.84s/it]

 37%|███▋      | 5911/16104 [27:22:55<49:02:13, 17.32s/it]

 37%|███▋      | 5912/16104 [27:23:09<46:37:27, 16.47s/it]

 37%|███▋      | 5913/16104 [27:23:21<42:45:53, 15.11s/it]

 37%|███▋      | 5914/16104 [27:23:32<39:16:55, 13.88s/it]

 37%|███▋      | 5915/16104 [27:23:43<36:42:02, 12.97s/it]

 37%|███▋      | 5916/16104 [27:23:54<34:46:10, 12.29s/it]

 37%|███▋      | 5917/16104 [27:24:10<37:54:08, 13.39s/it]

 37%|███▋      | 5918/16104 [27:24:26<40:32:43, 14.33s/it]

 37%|███▋      | 5919/16104 [27:24:40<40:13:16, 14.22s/it]

 37%|███▋      | 5920/16104 [27:24:54<39:57:32, 14.13s/it]
{'loss': 0.6188, 'learning_rate': 1.4595369894646857e-06, 'rewards/chosen': -1.0001013278961182, 'rewards/rejected': -1.7133327722549438, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7132314443588257, 'policy_logps/rejected': -447.79058837890625, 'policy_logps/chosen': -279.05633544921875, 'referece_logps/rejected': -430.6572265625, 'referece_logps/chosen': -269.0553283691406, 'logits/rejected': -0.9618056416511536, 'logits/chosen': -1.0946687459945679, 'epoch': 2.21}


 37%|███▋      | 5922/16104 [27:25:26<42:45:35, 15.12s/it]

 37%|███▋      | 5923/16104 [27:25:46<46:53:19, 16.58s/it]

 37%|███▋      | 5924/16104 [27:26:07<50:09:41, 17.74s/it]

 37%|███▋      | 5925/16104 [27:26:18<45:04:44, 15.94s/it]

 37%|███▋      | 5926/16104 [27:26:32<43:23:18, 15.35s/it]

 37%|███▋      | 5927/16104 [27:26:45<40:56:31, 14.48s/it]

 37%|███▋      | 5928/16104 [27:26:58<40:09:30, 14.21s/it]

 37%|███▋      | 5929/16104 [27:27:17<43:48:47, 15.50s/it]

 37%|███▋      | 5930/16104 [27:27:29<40:33:49, 14.35s/it]

 37%|███▋      | 5931/16104 [27:27:43<40:19:10, 14.27s/it]

 37%|███▋      | 5932/16104 [27:28:01<43:29:33, 15.39s/it]

 37%|███▋      | 5933/16104 [27:28:17<44:33:55, 15.77s/it]

 37%|███▋      | 5934/16104 [27:28:31<42:36:56, 15.09s/it]

 37%|███▋      | 5935/16104 [27:28:43<40:24:45, 14.31s/it]

 37%|███▋      | 5936/16104 [27:28:57<40:07:36, 14.21s/it]

 37%|███▋      | 5937/16104 [27:29:18<45:47:36, 16.21s/it]

 37%|███▋      | 5938/16104 [27:29:34<45:37:20, 16.16s/it]

 37%|███▋      | 5939/16104 [27:29:53<47:33:19, 16.84s/it]

 37%|███▋      | 5940/16104 [27:30:10<47:46:03, 16.92s/it]

 37%|███▋      | 5941/16104 [27:30:21<42:44:37, 15.14s/it]

 37%|███▋      | 5942/16104 [27:30:35<41:58:27, 14.87s/it]

 37%|███▋      | 5943/16104 [27:30:51<42:54:10, 15.20s/it]

 37%|███▋      | 5944/16104 [27:31:09<45:34:26, 16.15s/it]

 37%|███▋      | 5945/16104 [27:31:32<50:51:16, 18.02s/it]

 37%|███▋      | 5946/16104 [27:31:50<51:23:41, 18.21s/it]

 37%|███▋      | 5947/16104 [27:32:10<52:22:12, 18.56s/it]

 37%|███▋      | 5948/16104 [27:32:25<49:57:43, 17.71s/it]

 37%|███▋      | 5949/16104 [27:32:44<50:20:54, 17.85s/it]

 37%|███▋      | 5950/16104 [27:33:00<48:59:31, 17.37s/it]

 37%|███▋      | 5951/16104 [27:33:21<51:47:24, 18.36s/it]

 37%|███▋      | 5952/16104 [27:33:40<52:56:42, 18.77s/it]

 37%|███▋      | 5953/16104 [27:33:56<50:02:35, 17.75s/it]

 37%|███▋      | 5954/16104 [27:34:09<46:24:51, 16.46s/it]

 37%|███▋      | 5955/16104 [27:34:27<47:54:04, 16.99s/it]

 37%|███▋      | 5956/16104 [27:34:38<42:30:50, 15.08s/it]

 37%|███▋      | 5957/16104 [27:34:56<44:40:22, 15.85s/it]

 37%|███▋      | 5958/16104 [27:35:07<40:58:46, 14.54s/it]

 37%|███▋      | 5959/16104 [27:35:21<40:24:30, 14.34s/it]

 37%|███▋      | 5960/16104 [27:35:38<42:48:31, 15.19s/it]

 37%|███▋      | 5961/16104 [27:35:53<42:28:29, 15.08s/it]

 37%|███▋      | 5962/16104 [27:36:04<38:49:15, 13.78s/it]

 37%|███▋      | 5963/16104 [27:36:19<40:31:09, 14.38s/it]

 37%|███▋      | 5964/16104 [27:36:34<40:34:13, 14.40s/it]

 37%|███▋      | 5965/16104 [27:36:50<42:02:09, 14.93s/it]

 37%|███▋      | 5966/16104 [27:37:08<44:22:41, 15.76s/it]

 37%|███▋      | 5967/16104 [27:37:26<46:32:24, 16.53s/it]

 37%|███▋      | 5968/16104 [27:37:45<48:11:24, 17.12s/it]

 37%|███▋      | 5969/16104 [27:38:05<50:39:27, 17.99s/it]

 37%|███▋      | 5970/16104 [27:38:15<44:36:27, 15.85s/it]

 37%|███▋      | 5971/16104 [27:38:34<47:17:30, 16.80s/it]

 37%|███▋      | 5972/16104 [27:38:55<50:23:25, 17.90s/it]

 37%|███▋      | 5973/16104 [27:39:11<49:07:43, 17.46s/it]

 37%|███▋      | 5974/16104 [27:39:22<43:40:50, 15.52s/it]

 37%|███▋      | 5975/16104 [27:39:41<46:06:18, 16.39s/it]

 37%|███▋      | 5976/16104 [27:39:56<44:49:56, 15.94s/it]

 37%|███▋      | 5977/16104 [27:40:12<45:13:28, 16.08s/it]

 37%|███▋      | 5978/16104 [27:40:31<47:53:36, 17.03s/it]

 37%|███▋      | 5979/16104 [27:40:46<46:14:37, 16.44s/it]

 37%|███▋      | 5980/16104 [27:40:59<42:56:39, 15.27s/it]

 37%|███▋      | 5981/16104 [27:41:19<46:44:15, 16.62s/it]

 37%|███▋      | 5982/16104 [27:41:29<41:38:46, 14.81s/it]

 37%|███▋      | 5983/16104 [27:41:41<38:57:44, 13.86s/it]

 37%|███▋      | 5984/16104 [27:41:52<36:42:33, 13.06s/it]

 37%|███▋      | 5985/16104 [27:42:08<39:30:49, 14.06s/it]

 37%|███▋      | 5986/16104 [27:42:27<43:34:17, 15.50s/it]

 37%|███▋      | 5987/16104 [27:42:47<46:40:10, 16.61s/it]

 37%|███▋      | 5988/16104 [27:43:02<45:33:33, 16.21s/it]

 37%|███▋      | 5989/16104 [27:43:25<51:07:50, 18.20s/it]

 37%|███▋      | 5990/16104 [27:43:45<52:34:20, 18.71s/it]

 37%|███▋      | 5991/16104 [27:44:05<53:41:29, 19.11s/it]
{'loss': 0.3972, 'learning_rate': 1.4468076918904488e-06, 'rewards/chosen': -0.8345648646354675, 'rewards/rejected': -1.8217887878417969, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9872239828109741, 'policy_logps/rejected': -365.14227294921875, 'policy_logps/chosen': -507.32568359375, 'referece_logps/rejected': -346.92437744140625, 'referece_logps/chosen': -498.98004150390625, 'logits/rejected': -0.829603374004364, 'logits/chosen': -0.8309177756309509, 'epoch': 2.23}

 37%|███▋      | 5992/16104 [27:44:18<48:35:58, 17.30s/it]


 37%|███▋      | 5994/16104 [27:44:46<43:31:33, 15.50s/it]
{'loss': 0.4901, 'learning_rate': 1.4462678097336123e-06, 'rewards/chosen': -1.6347472667694092, 'rewards/rejected': -2.703230381011963, 'rewards/accuracies': 0.625, 'rewards/margins': 1.068482756614685, 'policy_logps/rejected': -381.66766357421875, 'policy_logps/chosen': -353.2535705566406, 'referece_logps/rejected': -354.6353759765625, 'referece_logps/chosen': -336.9060974121094, 'logits/rejected': -1.0246142148971558, 'logits/chosen': -0.8220998048782349, 'epoch': 2.23}


 37%|███▋      | 5996/16104 [27:45:16<43:11:43, 15.38s/it]

 37%|███▋      | 5997/16104 [27:45:35<45:40:37, 16.27s/it]

 37%|███▋      | 5998/16104 [27:45:48<43:15:50, 15.41s/it]
{'loss': 0.503, 'learning_rate': 1.445547714159208e-06, 'rewards/chosen': -1.950413465499878, 'rewards/rejected': -2.770620822906494, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8202073574066162, 'policy_logps/rejected': -349.3304138183594, 'policy_logps/chosen': -327.7109375, 'referece_logps/rejected': -321.62420654296875, 'referece_logps/chosen': -308.206787109375, 'logits/rejected': -0.026000648736953735, 'logits/chosen': -0.20838740468025208, 'epoch': 2.23}


 37%|███▋      | 6000/16104 [27:46:22<45:17:10, 16.14s/it]

 37%|███▋      | 6001/16104 [27:46:57<61:05:56, 21.77s/it]
{'loss': 0.4554, 'learning_rate': 1.4450074532093177e-06, 'rewards/chosen': -2.175715684890747, 'rewards/rejected': -2.4171340465545654, 'rewards/accuracies': 0.5, 'rewards/margins': 0.24141837656497955, 'policy_logps/rejected': -485.52069091796875, 'policy_logps/chosen': -415.954833984375, 'referece_logps/rejected': -461.349365234375, 'referece_logps/chosen': -394.19769287109375, 'logits/rejected': -0.4969918131828308, 'logits/chosen': -0.30303239822387695, 'epoch': 2.24}


 37%|███▋      | 6003/16104 [27:47:33<55:22:42, 19.74s/it]

 37%|███▋      | 6004/16104 [27:47:52<55:19:16, 19.72s/it]

 37%|███▋      | 6005/16104 [27:48:12<55:33:42, 19.81s/it]

 37%|███▋      | 6006/16104 [27:48:27<51:17:29, 18.29s/it]

 37%|███▋      | 6007/16104 [27:48:48<53:46:31, 19.17s/it]

 37%|███▋      | 6008/16104 [27:49:06<52:48:51, 18.83s/it]

 37%|███▋      | 6009/16104 [27:49:25<52:32:35, 18.74s/it]

 37%|███▋      | 6010/16104 [27:49:44<53:08:29, 18.95s/it]

 37%|███▋      | 6011/16104 [27:50:05<54:51:13, 19.57s/it]

 37%|███▋      | 6012/16104 [27:50:22<52:32:30, 18.74s/it]

 37%|███▋      | 6013/16104 [27:50:41<52:42:17, 18.80s/it]

 37%|███▋      | 6014/16104 [27:50:55<48:26:30, 17.28s/it]
{'loss': 0.444, 'learning_rate': 1.4426644528131796e-06, 'rewards/chosen': -1.0252033472061157, 'rewards/rejected': -2.761124610900879, 'rewards/accuracies': 0.75, 'rewards/margins': 1.7359209060668945, 'policy_logps/rejected': -347.14141845703125, 'policy_logps/chosen': -339.3843688964844, 'referece_logps/rejected': -319.5301513671875, 'referece_logps/chosen': -329.13232421875, 'logits/rejected': -0.8269159197807312, 'logits/chosen': -0.6810165643692017, 'epoch': 2.24}


 37%|███▋      | 6016/16104 [27:51:29<47:55:38, 17.10s/it]

 37%|███▋      | 6017/16104 [27:51:41<44:08:54, 15.76s/it]

 37%|███▋      | 6018/16104 [27:52:00<46:07:56, 16.47s/it]

 37%|███▋      | 6019/16104 [27:52:19<48:58:14, 17.48s/it]

 37%|███▋      | 6020/16104 [27:52:40<51:14:40, 18.29s/it]
{'loss': 0.44, 'learning_rate': 1.4415820463707895e-06, 'rewards/chosen': -0.9192467927932739, 'rewards/rejected': -1.5811878442764282, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6619409322738647, 'policy_logps/rejected': -473.8471374511719, 'policy_logps/chosen': -294.1581726074219, 'referece_logps/rejected': -458.0352478027344, 'referece_logps/chosen': -284.9657287597656, 'logits/rejected': -1.0447657108306885, 'logits/chosen': -0.9859123229980469, 'epoch': 2.24}


 37%|███▋      | 6022/16104 [27:53:22<54:42:25, 19.53s/it]

 37%|███▋      | 6023/16104 [27:53:41<54:50:42, 19.59s/it]
{'loss': 0.4036, 'learning_rate': 1.4410406019035155e-06, 'rewards/chosen': -1.4020415544509888, 'rewards/rejected': -2.293440818786621, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8913993835449219, 'policy_logps/rejected': -362.8385314941406, 'policy_logps/chosen': -353.4732971191406, 'referece_logps/rejected': -339.9041442871094, 'referece_logps/chosen': -339.4529113769531, 'logits/rejected': -1.1517987251281738, 'logits/chosen': -1.087391972541809, 'epoch': 2.24}

 37%|███▋      | 6024/16104 [27:54:00<53:51:38, 19.24s/it]


 37%|███▋      | 6026/16104 [27:54:34<50:41:19, 18.11s/it]

 37%|███▋      | 6027/16104 [27:54:51<49:40:51, 17.75s/it]
{'loss': 0.4516, 'learning_rate': 1.4403184262089242e-06, 'rewards/chosen': -1.0501786470413208, 'rewards/rejected': -1.906684398651123, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8565058708190918, 'policy_logps/rejected': -506.7763977050781, 'policy_logps/chosen': -460.3391418457031, 'referece_logps/rejected': -487.70953369140625, 'referece_logps/chosen': -449.8373718261719, 'logits/rejected': 0.22043070197105408, 'logits/chosen': 0.31423914432525635, 'epoch': 2.25}

 37%|███▋      | 6028/16104 [27:55:02<44:21:42, 15.85s/it]

 37%|███▋      | 6029/16104 [27:55:16<42:57:56, 15.35s/it]

 37%|███▋      | 6030/16104 [27:55:32<43:43:38, 15.63s/it]


 37%|███▋      | 6032/16104 [27:56:05<43:58:52, 15.72s/it]

 37%|███▋      | 6033/16104 [27:56:24<46:24:51, 16.59s/it]
{'loss': 0.5136, 'learning_rate': 1.4392346284631989e-06, 'rewards/chosen': -0.9090358018875122, 'rewards/rejected': -1.4471005201339722, 'rewards/accuracies': 0.75, 'rewards/margins': 0.53806471824646, 'policy_logps/rejected': -228.95529174804688, 'policy_logps/chosen': -223.40057373046875, 'referece_logps/rejected': -214.48428344726562, 'referece_logps/chosen': -214.3101806640625, 'logits/rejected': -0.4504018723964691, 'logits/chosen': -0.6584751605987549, 'epoch': 2.25}


 37%|███▋      | 6035/16104 [27:56:57<45:14:25, 16.17s/it]

 37%|███▋      | 6036/16104 [27:57:14<45:27:36, 16.26s/it]

 37%|███▋      | 6037/16104 [27:57:33<48:20:02, 17.28s/it]

 37%|███▋      | 6038/16104 [27:57:53<50:24:30, 18.03s/it]

 38%|███▊      | 6039/16104 [27:58:13<51:48:46, 18.53s/it]

 38%|███▊      | 6040/16104 [27:58:33<53:00:10, 18.96s/it]
{'loss': 0.4656, 'learning_rate': 1.4379693894348056e-06, 'rewards/chosen': -1.1475560665130615, 'rewards/rejected': -2.3305892944335938, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1830332279205322, 'policy_logps/rejected': -380.18255615234375, 'policy_logps/chosen': -304.44427490234375, 'referece_logps/rejected': -356.87664794921875, 'referece_logps/chosen': -292.9687194824219, 'logits/rejected': -0.9661804437637329, 'logits/chosen': -0.6726455688476562, 'epoch': 2.25}


 38%|███▊      | 6042/16104 [27:59:04<47:06:16, 16.85s/it]

 38%|███▊      | 6043/16104 [27:59:20<46:24:12, 16.60s/it]

 38%|███▊      | 6044/16104 [27:59:35<44:55:37, 16.08s/it]

 38%|███▊      | 6045/16104 [27:59:55<48:23:27, 17.32s/it]

 38%|███▊      | 6046/16104 [28:00:11<47:29:54, 17.00s/it]
{'loss': 0.6316, 'learning_rate': 1.4368842077949632e-06, 'rewards/chosen': -0.7793800234794617, 'rewards/rejected': -1.2596285343170166, 'rewards/accuracies': 0.625, 'rewards/margins': 0.48024845123291016, 'policy_logps/rejected': -453.99151611328125, 'policy_logps/chosen': -513.3551635742188, 'referece_logps/rejected': -441.3952331542969, 'referece_logps/chosen': -505.5613708496094, 'logits/rejected': -1.6119611263275146, 'logits/chosen': -1.485996961593628, 'epoch': 2.25}

 38%|███▊      | 6047/16104 [28:00:26<45:52:40, 16.42s/it]


 38%|███▊      | 6049/16104 [28:00:58<44:30:28, 15.94s/it]
{'loss': 0.5356, 'learning_rate': 1.436341378294196e-06, 'rewards/chosen': -1.141586184501648, 'rewards/rejected': -2.040862798690796, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8992767930030823, 'policy_logps/rejected': -298.2845458984375, 'policy_logps/chosen': -256.8315124511719, 'referece_logps/rejected': -277.87591552734375, 'referece_logps/chosen': -245.4156494140625, 'logits/rejected': 0.12144145369529724, 'logits/chosen': 0.18077781796455383, 'epoch': 2.25}


 38%|███▊      | 6051/16104 [28:01:28<43:52:23, 15.71s/it]

 38%|███▊      | 6052/16104 [28:01:40<41:14:40, 14.77s/it]

 38%|███▊      | 6053/16104 [28:02:02<47:11:07, 16.90s/it]

 38%|███▊      | 6054/16104 [28:02:20<47:50:22, 17.14s/it]
{'loss': 0.5017, 'learning_rate': 1.4354363095414645e-06, 'rewards/chosen': -0.7792701721191406, 'rewards/rejected': -1.6132630109786987, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8339927792549133, 'policy_logps/rejected': -225.46348571777344, 'policy_logps/chosen': -261.2472229003906, 'referece_logps/rejected': -209.33087158203125, 'referece_logps/chosen': -253.45452880859375, 'logits/rejected': -0.6089438796043396, 'logits/chosen': -0.6834964752197266, 'epoch': 2.26}


 38%|███▊      | 6056/16104 [28:03:00<52:07:18, 18.67s/it]

 38%|███▊      | 6057/16104 [28:03:17<50:32:06, 18.11s/it]

 38%|███▊      | 6058/16104 [28:03:35<50:28:51, 18.09s/it]

 38%|███▊      | 6059/16104 [28:03:52<49:41:12, 17.81s/it]
{'loss': 0.4921, 'learning_rate': 1.4345308004343753e-06, 'rewards/chosen': -1.1861422061920166, 'rewards/rejected': -1.4004138708114624, 'rewards/accuracies': 0.625, 'rewards/margins': 0.21427172422409058, 'policy_logps/rejected': -407.0595703125, 'policy_logps/chosen': -314.2971496582031, 'referece_logps/rejected': -393.05548095703125, 'referece_logps/chosen': -302.4357604980469, 'logits/rejected': -0.5433254241943359, 'logits/chosen': -0.569015622138977, 'epoch': 2.26}


 38%|███▊      | 6061/16104 [28:04:23<46:44:16, 16.75s/it]
{'loss': 0.4243, 'learning_rate': 1.434168473697429e-06, 'rewards/chosen': -0.8327275514602661, 'rewards/rejected': -1.7585865259170532, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9258589148521423, 'policy_logps/rejected': -279.15911865234375, 'policy_logps/chosen': -296.51861572265625, 'referece_logps/rejected': -261.5732727050781, 'referece_logps/chosen': -288.19134521484375, 'logits/rejected': -0.828222393989563, 'logits/chosen': -0.6944714188575745, 'epoch': 2.26}

 38%|███▊      | 6062/16104 [28:04:35<42:22:25, 15.19s/it]

 38%|███▊      | 6063/16104 [28:04:55<46:25:53, 16.65s/it]

 38%|███▊      | 6064/16104 [28:05:11<45:48:28, 16.43s/it]

 38%|███▊      | 6065/16104 [28:05:31<48:50:17, 17.51s/it]

 38%|███▊      | 6066/16104 [28:05:51<51:05:25, 18.32s/it]

 38%|███▊      | 6067/16104 [28:06:09<50:28:38, 18.10s/it]

 38%|███▊      | 6068/16104 [28:06:21<45:36:36, 16.36s/it]


 38%|███▊      | 6070/16104 [28:06:50<42:21:52, 15.20s/it]

 38%|███▊      | 6071/16104 [28:07:04<41:09:32, 14.77s/it]

 38%|███▊      | 6072/16104 [28:07:18<40:33:20, 14.55s/it]

 38%|███▊      | 6073/16104 [28:07:30<38:59:11, 13.99s/it]
{'loss': 0.5256, 'learning_rate': 1.4319930400457887e-06, 'rewards/chosen': -0.6432256102561951, 'rewards/rejected': -1.1951295137405396, 'rewards/accuracies': 0.625, 'rewards/margins': 0.5519038438796997, 'policy_logps/rejected': -584.24365234375, 'policy_logps/chosen': -475.7085876464844, 'referece_logps/rejected': -572.2922973632812, 'referece_logps/chosen': -469.2763671875, 'logits/rejected': 0.556219756603241, 'logits/chosen': 0.3913722038269043, 'epoch': 2.26}


 38%|███▊      | 6075/16104 [28:07:58<38:59:28, 14.00s/it]

 38%|███▊      | 6076/16104 [28:08:10<37:09:58, 13.34s/it]

 38%|███▊      | 6077/16104 [28:08:23<37:34:00, 13.49s/it]
{'loss': 0.4269, 'learning_rate': 1.4312673356728507e-06, 'rewards/chosen': -0.8415911197662354, 'rewards/rejected': -2.9718804359436035, 'rewards/accuracies': 1.0, 'rewards/margins': 2.130289316177368, 'policy_logps/rejected': -324.8648376464844, 'policy_logps/chosen': -319.506103515625, 'referece_logps/rejected': -295.1460266113281, 'referece_logps/chosen': -311.0901794433594, 'logits/rejected': -1.2516282796859741, 'logits/chosen': -1.2000585794448853, 'epoch': 2.26}


 38%|███▊      | 6079/16104 [28:08:59<43:55:03, 15.77s/it]
{'loss': 0.4057, 'learning_rate': 1.4309043787838237e-06, 'rewards/chosen': -0.6252239346504211, 'rewards/rejected': -1.8115345239639282, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1863105297088623, 'policy_logps/rejected': -372.9708251953125, 'policy_logps/chosen': -366.2858581542969, 'referece_logps/rejected': -354.85546875, 'referece_logps/chosen': -360.03363037109375, 'logits/rejected': -0.40949109196662903, 'logits/chosen': -0.46281352639198303, 'epoch': 2.26}


 38%|███▊      | 6081/16104 [28:09:33<45:58:27, 16.51s/it]

 38%|███▊      | 6082/16104 [28:09:47<43:13:42, 15.53s/it]
{'loss': 0.5288, 'learning_rate': 1.430359812737258e-06, 'rewards/chosen': -0.7360035181045532, 'rewards/rejected': -1.6442118883132935, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9082083702087402, 'policy_logps/rejected': -395.8031005859375, 'policy_logps/chosen': -513.2559814453125, 'referece_logps/rejected': -379.3609619140625, 'referece_logps/chosen': -505.89593505859375, 'logits/rejected': -0.212311789393425, 'logits/chosen': -0.0754297524690628, 'epoch': 2.27}


 38%|███▊      | 6084/16104 [28:10:25<48:15:09, 17.34s/it]
{'loss': 0.4974, 'learning_rate': 1.4299966816498634e-06, 'rewards/chosen': -1.0231386423110962, 'rewards/rejected': -1.9075349569320679, 'rewards/accuracies': 0.625, 'rewards/margins': 0.8843963742256165, 'policy_logps/rejected': -268.5245361328125, 'policy_logps/chosen': -321.8852844238281, 'referece_logps/rejected': -249.44918823242188, 'referece_logps/chosen': -311.65386962890625, 'logits/rejected': -0.5004075169563293, 'logits/chosen': -0.48218002915382385, 'epoch': 2.27}


 38%|███▊      | 6086/16104 [28:11:03<51:12:07, 18.40s/it]

 38%|███▊      | 6087/16104 [28:11:22<51:59:59, 18.69s/it]

 38%|███▊      | 6088/16104 [28:11:38<50:04:49, 18.00s/it]
{'loss': 0.4264, 'learning_rate': 1.4292702108042484e-06, 'rewards/chosen': -0.8512371182441711, 'rewards/rejected': -1.7048941850662231, 'rewards/accuracies': 0.875, 'rewards/margins': 0.853657066822052, 'policy_logps/rejected': -315.4257507324219, 'policy_logps/chosen': -368.8357238769531, 'referece_logps/rejected': -298.37677001953125, 'referece_logps/chosen': -360.3233642578125, 'logits/rejected': 0.15873154997825623, 'logits/chosen': 0.30523133277893066, 'epoch': 2.27}


 38%|███▊      | 6090/16104 [28:12:09<47:03:43, 16.92s/it]
{'loss': 0.4509, 'learning_rate': 1.4289068711635759e-06, 'rewards/chosen': -1.407228946685791, 'rewards/rejected': -1.6307519674301147, 'rewards/accuracies': 0.75, 'rewards/margins': 0.22352302074432373, 'policy_logps/rejected': -407.0613098144531, 'policy_logps/chosen': -393.17059326171875, 'referece_logps/rejected': -390.7537841796875, 'referece_logps/chosen': -379.09832763671875, 'logits/rejected': -0.1069495677947998, 'logits/chosen': -0.15393668413162231, 'epoch': 2.27}

 38%|███▊      | 6091/16104 [28:12:27<48:20:37, 17.38s/it]


 38%|███▊      | 6093/16104 [28:13:03<48:38:02, 17.49s/it]

 38%|███▊      | 6094/16104 [28:13:20<48:52:00, 17.57s/it]

 38%|███▊      | 6095/16104 [28:13:39<49:29:08, 17.80s/it]

 38%|███▊      | 6096/16104 [28:13:54<47:52:42, 17.22s/it]
{'loss': 0.4816, 'learning_rate': 1.4278164360756227e-06, 'rewards/chosen': -1.0468500852584839, 'rewards/rejected': -1.8647968769073486, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8179467916488647, 'policy_logps/rejected': -536.4273681640625, 'policy_logps/chosen': -314.2231140136719, 'referece_logps/rejected': -517.7794189453125, 'referece_logps/chosen': -303.7546081542969, 'logits/rejected': -1.5366010665893555, 'logits/chosen': -1.3752241134643555, 'epoch': 2.27}

 38%|███▊      | 6097/16104 [28:14:13<49:07:55, 17.68s/it]

 38%|███▊      | 6098/16104 [28:14:32<49:51:07, 17.94s/it]


 38%|███▊      | 6100/16104 [28:15:07<49:21:57, 17.76s/it]
{'loss': 0.5536, 'learning_rate': 1.4270891331335362e-06, 'rewards/chosen': -0.9071617126464844, 'rewards/rejected': -1.343337893486023, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4361761510372162, 'policy_logps/rejected': -414.54150390625, 'policy_logps/chosen': -467.96685791015625, 'referece_logps/rejected': -401.1081237792969, 'referece_logps/chosen': -458.8952941894531, 'logits/rejected': -0.4703182876110077, 'logits/chosen': -0.4651246964931488, 'epoch': 2.27}


 38%|███▊      | 6102/16104 [28:15:45<51:41:17, 18.60s/it]

 38%|███▊      | 6103/16104 [28:16:03<50:53:19, 18.32s/it]

 38%|███▊      | 6104/16104 [28:16:21<50:32:33, 18.20s/it]
{'loss': 0.4551, 'learning_rate': 1.4263615537671825e-06, 'rewards/chosen': -0.7520958185195923, 'rewards/rejected': -1.206947684288025, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4548519253730774, 'policy_logps/rejected': -506.3235168457031, 'policy_logps/chosen': -633.8712768554688, 'referece_logps/rejected': -494.25408935546875, 'referece_logps/chosen': -626.350341796875, 'logits/rejected': -0.26390954852104187, 'logits/chosen': -0.24233213067054749, 'epoch': 2.27}

 38%|███▊      | 6105/16104 [28:16:40<51:30:04, 18.54s/it]

 38%|███▊      | 6106/16104 [28:17:02<54:07:44, 19.49s/it]


 38%|███▊      | 6108/16104 [28:17:37<51:29:56, 18.55s/it]
{'loss': 0.3823, 'learning_rate': 1.4256336984474716e-06, 'rewards/chosen': -1.5198266506195068, 'rewards/rejected': -2.6159629821777344, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0961360931396484, 'policy_logps/rejected': -353.62042236328125, 'policy_logps/chosen': -335.682861328125, 'referece_logps/rejected': -327.46075439453125, 'referece_logps/chosen': -320.484619140625, 'logits/rejected': 0.17685261368751526, 'logits/chosen': 0.2640872597694397, 'epoch': 2.28}


 38%|███▊      | 6110/16104 [28:18:11<49:57:17, 17.99s/it]
{'loss': 0.4644, 'learning_rate': 1.4252696674523155e-06, 'rewards/chosen': -1.4982935190200806, 'rewards/rejected': -2.3481054306030273, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8498120903968811, 'policy_logps/rejected': -464.8132629394531, 'policy_logps/chosen': -409.9152526855469, 'referece_logps/rejected': -441.332275390625, 'referece_logps/chosen': -394.9323425292969, 'logits/rejected': -0.9229023456573486, 'logits/chosen': -0.9631823897361755, 'epoch': 2.28}

 38%|███▊      | 6111/16104 [28:18:31<51:50:02, 18.67s/it]

 38%|███▊      | 6112/16104 [28:18:49<51:15:46, 18.47s/it]

 38%|███▊      | 6113/16104 [28:19:04<48:07:06, 17.34s/it]


 38%|███▊      | 6115/16104 [28:19:43<50:49:42, 18.32s/it]

 38%|███▊      | 6116/16104 [28:20:01<50:44:09, 18.29s/it]

 38%|███▊      | 6117/16104 [28:20:15<47:06:31, 16.98s/it]
{'loss': 0.4112, 'learning_rate': 1.4239950174640414e-06, 'rewards/chosen': -0.7819925546646118, 'rewards/rejected': -1.3268674612045288, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5448750257492065, 'policy_logps/rejected': -418.79852294921875, 'policy_logps/chosen': -350.8127136230469, 'referece_logps/rejected': -405.52984619140625, 'referece_logps/chosen': -342.9927978515625, 'logits/rejected': -0.9291151165962219, 'logits/chosen': -0.7152813076972961, 'epoch': 2.28}

 38%|███▊      | 6118/16104 [28:20:26<41:50:26, 15.08s/it]

 38%|███▊      | 6119/16104 [28:20:46<46:05:52, 16.62s/it]


 38%|███▊      | 6121/16104 [28:21:07<37:49:40, 13.64s/it]

 38%|███▊      | 6122/16104 [28:21:19<36:30:37, 13.17s/it]
{'loss': 0.5728, 'learning_rate': 1.4230840384987486e-06, 'rewards/chosen': -1.4133539199829102, 'rewards/rejected': -2.458233118057251, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0448793172836304, 'policy_logps/rejected': -366.9426574707031, 'policy_logps/chosen': -493.4425354003906, 'referece_logps/rejected': -342.36029052734375, 'referece_logps/chosen': -479.30902099609375, 'logits/rejected': -0.6878291368484497, 'logits/chosen': -0.5712281465530396, 'epoch': 2.28}

 38%|███▊      | 6123/16104 [28:21:30<34:28:46, 12.44s/it]

 38%|███▊      | 6124/16104 [28:21:47<37:53:13, 13.67s/it]


 38%|███▊      | 6126/16104 [28:22:23<44:27:04, 16.04s/it]

 38%|███▊      | 6127/16104 [28:22:37<42:45:18, 15.43s/it]
{'loss': 0.4908, 'learning_rate': 1.4221726316708813e-06, 'rewards/chosen': -1.158500075340271, 'rewards/rejected': -2.1598472595214844, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0013474225997925, 'policy_logps/rejected': -226.21170043945312, 'policy_logps/chosen': -222.38290405273438, 'referece_logps/rejected': -204.6132049560547, 'referece_logps/chosen': -210.79791259765625, 'logits/rejected': -0.28541404008865356, 'logits/chosen': -0.2432776540517807, 'epoch': 2.28}

 38%|███▊      | 6128/16104 [28:22:58<47:22:47, 17.10s/it]


 38%|███▊      | 6130/16104 [28:23:27<43:35:11, 15.73s/it]
{'loss': 0.4875, 'learning_rate': 1.4216255825835353e-06, 'rewards/chosen': -1.8014435768127441, 'rewards/rejected': -2.8859317302703857, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0844882726669312, 'policy_logps/rejected': -377.22418212890625, 'policy_logps/chosen': -409.0806579589844, 'referece_logps/rejected': -348.3648986816406, 'referece_logps/chosen': -391.06622314453125, 'logits/rejected': -0.9484617710113525, 'logits/chosen': -0.9909568428993225, 'epoch': 2.28}

 38%|███▊      | 6131/16104 [28:23:46<45:54:11, 16.57s/it]

 38%|███▊      | 6132/16104 [28:24:02<45:26:01, 16.40s/it]


 38%|███▊      | 6134/16104 [28:24:32<44:21:32, 16.02s/it]
{'loss': 0.4678, 'learning_rate': 1.4208959450577435e-06, 'rewards/chosen': -0.8635500073432922, 'rewards/rejected': -1.912923812866211, 'rewards/accuracies': 0.75, 'rewards/margins': 1.049373745918274, 'policy_logps/rejected': -216.04287719726562, 'policy_logps/chosen': -463.7450866699219, 'referece_logps/rejected': -196.9136505126953, 'referece_logps/chosen': -455.109619140625, 'logits/rejected': -0.32897213101387024, 'logits/chosen': -0.2996440827846527, 'epoch': 2.29}

 38%|███▊      | 6135/16104 [28:24:44<41:27:59, 14.97s/it]

 38%|███▊      | 6136/16104 [28:24:56<39:08:40, 14.14s/it]

 38%|███▊      | 6137/16104 [28:25:16<44:05:32, 15.93s/it]

 38%|███▊      | 6138/16104 [28:25:36<47:16:17, 17.08s/it]


 38%|███▊      | 6140/16104 [28:26:13<49:26:19, 17.86s/it]
{'loss': 0.5522, 'learning_rate': 1.4198009781369442e-06, 'rewards/chosen': -1.203894853591919, 'rewards/rejected': -2.2031404972076416, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9992456436157227, 'policy_logps/rejected': -297.6728820800781, 'policy_logps/chosen': -344.7308044433594, 'referece_logps/rejected': -275.6414794921875, 'referece_logps/chosen': -332.6918640136719, 'logits/rejected': -0.4822230339050293, 'logits/chosen': -0.544015109539032, 'epoch': 2.29}


 38%|███▊      | 6142/16104 [28:26:46<46:50:33, 16.93s/it]
{'loss': 0.4061, 'learning_rate': 1.4194358532310012e-06, 'rewards/chosen': -1.613100528717041, 'rewards/rejected': -3.496849298477173, 'rewards/accuracies': 1.0, 'rewards/margins': 1.8837486505508423, 'policy_logps/rejected': -272.9288024902344, 'policy_logps/chosen': -356.95703125, 'referece_logps/rejected': -237.96029663085938, 'referece_logps/chosen': -340.8260498046875, 'logits/rejected': -0.385078489780426, 'logits/chosen': -0.24822266399860382, 'epoch': 2.29}

 38%|███▊      | 6143/16104 [28:27:02<46:18:21, 16.74s/it]

 38%|███▊      | 6144/16104 [28:27:19<46:18:03, 16.74s/it]


 38%|███▊      | 6146/16104 [28:27:56<47:58:26, 17.34s/it]
{'loss': 0.5855, 'learning_rate': 1.4187053998750635e-06, 'rewards/chosen': -1.5867037773132324, 'rewards/rejected': -1.6472177505493164, 'rewards/accuracies': 0.625, 'rewards/margins': 0.06051406264305115, 'policy_logps/rejected': -477.8211669921875, 'policy_logps/chosen': -515.6053466796875, 'referece_logps/rejected': -461.3489990234375, 'referece_logps/chosen': -499.73834228515625, 'logits/rejected': -0.18507930636405945, 'logits/chosen': -0.15021738409996033, 'epoch': 2.29}

 38%|███▊      | 6147/16104 [28:28:15<49:08:46, 17.77s/it]

 38%|███▊      | 6148/16104 [28:28:28<45:28:56, 16.45s/it]


 38%|███▊      | 6150/16104 [28:29:07<50:18:27, 18.19s/it]
{'loss': 0.3726, 'learning_rate': 1.4179746755210497e-06, 'rewards/chosen': -2.093982219696045, 'rewards/rejected': -2.9550695419311523, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8610873222351074, 'policy_logps/rejected': -542.0709228515625, 'policy_logps/chosen': -483.203857421875, 'referece_logps/rejected': -512.520263671875, 'referece_logps/chosen': -462.2640075683594, 'logits/rejected': 0.3681040108203888, 'logits/chosen': 0.4201297163963318, 'epoch': 2.29}

 38%|███▊      | 6151/16104 [28:29:25<49:43:22, 17.98s/it]


 38%|███▊      | 6153/16104 [28:30:02<49:43:22, 17.99s/it]
{'loss': 0.4581, 'learning_rate': 1.4174264546975524e-06, 'rewards/chosen': -1.0550633668899536, 'rewards/rejected': -1.7374731302261353, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6824097633361816, 'policy_logps/rejected': -233.44288635253906, 'policy_logps/chosen': -267.48486328125, 'referece_logps/rejected': -216.06817626953125, 'referece_logps/chosen': -256.9342041015625, 'logits/rejected': -0.5708904266357422, 'logits/chosen': -0.5697425603866577, 'epoch': 2.29}

 38%|███▊      | 6154/16104 [28:30:18<48:37:43, 17.59s/it]

 38%|███▊      | 6155/16104 [28:30:29<42:58:55, 15.55s/it]


 38%|███▊      | 6157/16104 [28:31:00<41:35:27, 15.05s/it]

 38%|███▊      | 6158/16104 [28:31:14<40:51:08, 14.79s/it]

 38%|███▊      | 6159/16104 [28:31:34<45:12:46, 16.37s/it]
{'loss': 0.4361, 'learning_rate': 1.4163295573377985e-06, 'rewards/chosen': -1.3784401416778564, 'rewards/rejected': -2.502349376678467, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1239089965820312, 'policy_logps/rejected': -357.1788024902344, 'policy_logps/chosen': -372.8408203125, 'referece_logps/rejected': -332.1553039550781, 'referece_logps/chosen': -359.05645751953125, 'logits/rejected': -0.4799789488315582, 'logits/chosen': -0.4289531707763672, 'epoch': 2.29}

 38%|███▊      | 6160/16104 [28:31:52<46:47:32, 16.94s/it]

 38%|███▊      | 6161/16104 [28:32:11<48:40:03, 17.62s/it]

 38%|███▊      | 6162/16104 [28:32:31<50:36:21, 18.32s/it]

 38%|███▊      | 6163/16104 [28:32:49<50:05:04, 18.14s/it]


 38%|███▊      | 6165/16104 [28:33:20<46:08:19, 16.71s/it]
{'loss': 0.5742, 'learning_rate': 1.4152320536922687e-06, 'rewards/chosen': -1.078622817993164, 'rewards/rejected': -1.4680441617965698, 'rewards/accuracies': 0.75, 'rewards/margins': 0.389421284198761, 'policy_logps/rejected': -301.71588134765625, 'policy_logps/chosen': -332.1751708984375, 'referece_logps/rejected': -287.0354309082031, 'referece_logps/chosen': -321.388916015625, 'logits/rejected': -0.5382760763168335, 'logits/chosen': -0.3169832229614258, 'epoch': 2.3}


 38%|███▊      | 6167/16104 [28:33:50<43:02:20, 15.59s/it]
{'loss': 0.4951, 'learning_rate': 1.414866084689803e-06, 'rewards/chosen': -0.5858383178710938, 'rewards/rejected': -2.093449831008911, 'rewards/accuracies': 0.75, 'rewards/margins': 1.5076113939285278, 'policy_logps/rejected': -381.30413818359375, 'policy_logps/chosen': -292.1828308105469, 'referece_logps/rejected': -360.3696594238281, 'referece_logps/chosen': -286.324462890625, 'logits/rejected': -0.8147679567337036, 'logits/chosen': -0.7903162837028503, 'epoch': 2.3}

 38%|███▊      | 6168/16104 [28:34:05<42:31:59, 15.41s/it]


 38%|███▊      | 6170/16104 [28:34:38<44:15:57, 16.04s/it]
{'loss': 0.6086, 'learning_rate': 1.4143170053390628e-06, 'rewards/chosen': -1.0012911558151245, 'rewards/rejected': -1.9168497323989868, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9155585765838623, 'policy_logps/rejected': -451.9434814453125, 'policy_logps/chosen': -490.438232421875, 'referece_logps/rejected': -432.7749938964844, 'referece_logps/chosen': -480.42535400390625, 'logits/rejected': -0.18254339694976807, 'logits/chosen': -0.11215978860855103, 'epoch': 2.3}

 38%|███▊      | 6171/16104 [28:35:01<49:33:02, 17.96s/it]

 38%|███▊      | 6172/16104 [28:35:13<44:54:19, 16.28s/it]

 38%|███▊      | 6173/16104 [28:35:30<45:10:23, 16.38s/it]

 38%|███▊      | 6174/16104 [28:35:42<41:36:12, 15.08s/it]


 38%|███▊      | 6176/16104 [28:36:10<40:32:50, 14.70s/it]
{'loss': 0.5441, 'learning_rate': 1.4132183943212704e-06, 'rewards/chosen': -1.2709146738052368, 'rewards/rejected': -1.868112325668335, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5971977710723877, 'policy_logps/rejected': -386.2102966308594, 'policy_logps/chosen': -374.86358642578125, 'referece_logps/rejected': -367.5292053222656, 'referece_logps/chosen': -362.1543884277344, 'logits/rejected': -0.39031004905700684, 'logits/chosen': -0.30506888031959534, 'epoch': 2.3}

 38%|███▊      | 6177/16104 [28:36:25<40:35:33, 14.72s/it]


 38%|███▊      | 6179/16104 [28:36:58<42:25:31, 15.39s/it]
{'loss': 0.5972, 'learning_rate': 1.4126688630541856e-06, 'rewards/chosen': -1.1031513214111328, 'rewards/rejected': -1.7036529779434204, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6005017161369324, 'policy_logps/rejected': -409.1612548828125, 'policy_logps/chosen': -251.78482055664062, 'referece_logps/rejected': -392.1246643066406, 'referece_logps/chosen': -240.7532958984375, 'logits/rejected': -0.799856960773468, 'logits/chosen': -0.8585066795349121, 'epoch': 2.3}

 38%|███▊      | 6180/16104 [28:37:20<47:28:11, 17.22s/it]

 38%|███▊      | 6181/16104 [28:37:39<49:32:14, 17.97s/it]


 38%|███▊      | 6183/16104 [28:38:10<45:22:08, 16.46s/it]
{'loss': 0.5097, 'learning_rate': 1.411935921027979e-06, 'rewards/chosen': -0.6985883712768555, 'rewards/rejected': -1.741868019104004, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0432796478271484, 'policy_logps/rejected': -483.01239013671875, 'policy_logps/chosen': -359.080810546875, 'referece_logps/rejected': -465.59375, 'referece_logps/chosen': -352.09490966796875, 'logits/rejected': -0.35561490058898926, 'logits/chosen': -0.49415433406829834, 'epoch': 2.3}

 38%|███▊      | 6184/16104 [28:38:23<42:21:18, 15.37s/it]

 38%|███▊      | 6185/16104 [28:38:39<42:47:30, 15.53s/it]

 38%|███▊      | 6186/16104 [28:38:55<43:10:48, 15.67s/it]

 38%|███▊      | 6187/16104 [28:39:15<47:12:00, 17.13s/it]

 38%|███▊      | 6188/16104 [28:39:29<44:26:53, 16.14s/it]

 38%|███▊      | 6189/16104 [28:39:50<48:05:30, 17.46s/it]


 38%|███▊      | 6191/16104 [28:40:29<51:19:08, 18.64s/it]
{'loss': 0.6422, 'learning_rate': 1.4104692376000913e-06, 'rewards/chosen': -1.4286201000213623, 'rewards/rejected': -2.220003128051758, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7913830280303955, 'policy_logps/rejected': -419.22357177734375, 'policy_logps/chosen': -439.3015441894531, 'referece_logps/rejected': -397.0235595703125, 'referece_logps/chosen': -425.01531982421875, 'logits/rejected': 0.06320863962173462, 'logits/chosen': 0.15647801756858826, 'epoch': 2.31}


 38%|███▊      | 6193/16104 [28:40:58<47:07:42, 17.12s/it]

 38%|███▊      | 6194/16104 [28:41:14<46:01:46, 16.72s/it]
{'loss': 0.4683, 'learning_rate': 1.4099189571411401e-06, 'rewards/chosen': -1.025821328163147, 'rewards/rejected': -2.6132309436798096, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5874097347259521, 'policy_logps/rejected': -530.0098876953125, 'policy_logps/chosen': -384.0048828125, 'referece_logps/rejected': -503.8775634765625, 'referece_logps/chosen': -373.7466735839844, 'logits/rejected': 0.009579181671142578, 'logits/chosen': 0.18823014199733734, 'epoch': 2.31}

 38%|███▊      | 6195/16104 [28:41:25<41:13:06, 14.97s/it]

 38%|███▊      | 6196/16104 [28:41:38<39:05:03, 14.20s/it]


 38%|███▊      | 6198/16104 [28:42:21<49:15:11, 17.90s/it]
{'loss': 0.5896, 'learning_rate': 1.4091850177498327e-06, 'rewards/chosen': -0.6431224942207336, 'rewards/rejected': -1.219576120376587, 'rewards/accuracies': 0.875, 'rewards/margins': 0.5764536261558533, 'policy_logps/rejected': -338.97747802734375, 'policy_logps/chosen': -426.8453674316406, 'referece_logps/rejected': -326.78173828125, 'referece_logps/chosen': -420.41412353515625, 'logits/rejected': -0.11294563859701157, 'logits/chosen': -0.2412542998790741, 'epoch': 2.31}

 38%|███▊      | 6199/16104 [28:42:32<43:45:52, 15.91s/it]

 38%|███▊      | 6200/16104 [28:42:43<39:47:24, 14.46s/it]


 39%|███▊      | 6202/16104 [28:43:23<47:13:53, 17.17s/it]

 39%|███▊      | 6203/16104 [28:43:36<44:13:07, 16.08s/it]

 39%|███▊      | 6204/16104 [28:43:57<47:45:40, 17.37s/it]
{'loss': 0.4699, 'learning_rate': 1.4080836122434648e-06, 'rewards/chosen': -1.0286033153533936, 'rewards/rejected': -1.9832772016525269, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9546740055084229, 'policy_logps/rejected': -397.700927734375, 'policy_logps/chosen': -423.1208801269531, 'referece_logps/rejected': -377.8681945800781, 'referece_logps/chosen': -412.8348083496094, 'logits/rejected': -0.8061530590057373, 'logits/chosen': -0.6936159729957581, 'epoch': 2.31}


 39%|███▊      | 6206/16104 [28:44:23<41:38:31, 15.15s/it]
{'loss': 0.5815, 'learning_rate': 1.4077163449337768e-06, 'rewards/chosen': -1.1936008930206299, 'rewards/rejected': -1.486562728881836, 'rewards/accuracies': 0.625, 'rewards/margins': 0.29296186566352844, 'policy_logps/rejected': -544.6921997070312, 'policy_logps/chosen': -455.27685546875, 'referece_logps/rejected': -529.8265380859375, 'referece_logps/chosen': -443.3408508300781, 'logits/rejected': -0.19472919404506683, 'logits/chosen': -0.0028459280729293823, 'epoch': 2.31}


 39%|███▊      | 6208/16104 [28:44:52<40:13:29, 14.63s/it]
{'loss': 0.5238, 'learning_rate': 1.4073490116526743e-06, 'rewards/chosen': -0.8446063995361328, 'rewards/rejected': -1.605009913444519, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7604035139083862, 'policy_logps/rejected': -337.50262451171875, 'policy_logps/chosen': -481.3785400390625, 'referece_logps/rejected': -321.45257568359375, 'referece_logps/chosen': -472.9324951171875, 'logits/rejected': -0.23768149316310883, 'logits/chosen': -0.2183389663696289, 'epoch': 2.31}

 39%|███▊      | 6209/16104 [28:45:14<46:07:59, 16.78s/it]


 39%|███▊      | 6211/16104 [28:45:49<46:51:08, 17.05s/it]
{'loss': 0.4844, 'learning_rate': 1.4067978881646407e-06, 'rewards/chosen': -1.1458966732025146, 'rewards/rejected': -1.312812328338623, 'rewards/accuracies': 0.5, 'rewards/margins': 0.1669156551361084, 'policy_logps/rejected': -352.88055419921875, 'policy_logps/chosen': -321.907470703125, 'referece_logps/rejected': -339.7524719238281, 'referece_logps/chosen': -310.448486328125, 'logits/rejected': 0.1387430727481842, 'logits/chosen': 0.07265117019414902, 'epoch': 2.31}

 39%|███▊      | 6212/16104 [28:46:02<43:30:50, 15.84s/it]

 39%|███▊      | 6213/16104 [28:46:15<40:55:28, 14.90s/it]

 39%|███▊      | 6214/16104 [28:46:33<43:35:37, 15.87s/it]

 39%|███▊      | 6215/16104 [28:46:48<42:46:48, 15.57s/it]

 39%|███▊      | 6216/16104 [28:47:01<41:10:17, 14.99s/it]

 39%|███▊      | 6217/16104 [28:47:23<46:31:12, 16.94s/it]

 39%|███▊      | 6218/16104 [28:47:41<47:27:26, 17.28s/it]

 39%|███▊      | 6219/16104 [28:48:00<49:17:58, 17.95s/it]

 39%|███▊      | 6220/16104 [28:48:17<48:04:01, 17.51s/it]

 39%|███▊      | 6221/16104 [28:48:28<42:37:13, 15.53s/it]

 39%|███▊      | 6222/16104 [28:48:48<46:33:06, 16.96s/it]

 39%|███▊      | 6223/16104 [28:49:09<50:14:57, 18.31s/it]

 39%|███▊      | 6224/16104 [28:49:25<47:34:15, 17.33s/it]

 39%|███▊      | 6225/16104 [28:49:39<45:30:30, 16.58s/it]

 39%|███▊      | 6226/16104 [28:49:55<44:18:09, 16.15s/it]

 39%|███▊      | 6227/16104 [28:50:11<44:36:44, 16.26s/it]

 39%|███▊      | 6228/16104 [28:50:23<41:00:01, 14.95s/it]

 39%|███▊      | 6229/16104 [28:50:43<45:20:11, 16.53s/it]

 39%|███▊      | 6230/16104 [28:50:57<42:51:04, 15.62s/it]

 39%|███▊      | 6231/16104 [28:51:11<41:45:01, 15.22s/it]

 39%|███▊      | 6232/16104 [28:51:25<40:33:01, 14.79s/it]


 39%|███▊      | 6234/16104 [28:51:59<44:37:34, 16.28s/it]
{'loss': 0.446, 'learning_rate': 1.4025677026580816e-06, 'rewards/chosen': -1.8940609693527222, 'rewards/rejected': -3.4952170848846436, 'rewards/accuracies': 0.875, 'rewards/margins': 1.601156234741211, 'policy_logps/rejected': -391.12457275390625, 'policy_logps/chosen': -337.0296630859375, 'referece_logps/rejected': -356.17242431640625, 'referece_logps/chosen': -318.0890197753906, 'logits/rejected': -0.5367482304573059, 'logits/chosen': -0.2084670513868332, 'epoch': 2.32}

 39%|███▊      | 6235/16104 [28:52:21<48:43:31, 17.77s/it]

 39%|███▊      | 6236/16104 [28:52:33<43:59:26, 16.05s/it]

 39%|███▊      | 6237/16104 [28:52:50<45:12:14, 16.49s/it]

 39%|███▊      | 6238/16104 [28:53:07<45:30:45, 16.61s/it]

 39%|███▊      | 6239/16104 [28:53:23<45:04:45, 16.45s/it]

 39%|███▊      | 6240/16104 [28:53:43<48:09:33, 17.58s/it]

 39%|███▉      | 6241/16104 [28:53:57<44:57:48, 16.41s/it]

 39%|███▉      | 6242/16104 [28:54:17<47:36:15, 17.38s/it]

 39%|███▉      | 6243/16104 [28:54:37<49:52:46, 18.21s/it]

 39%|███▉      | 6244/16104 [28:54:57<51:11:24, 18.69s/it]

 39%|███▉      | 6245/16104 [28:55:17<52:10:47, 19.05s/it]

 39%|███▉      | 6246/16104 [28:55:36<52:42:23, 19.25s/it]

 39%|███▉      | 6247/16104 [28:55:56<53:14:54, 19.45s/it]

 39%|███▉      | 6248/16104 [28:56:12<49:54:56, 18.23s/it]

 39%|███▉      | 6249/16104 [28:56:31<50:52:56, 18.59s/it]

 39%|███▉      | 6250/16104 [28:56:52<52:53:48, 19.32s/it]

 39%|███▉      | 6251/16104 [28:57:09<50:59:03, 18.63s/it]


 39%|███▉      | 6253/16104 [28:57:37<44:29:44, 16.26s/it]

 39%|███▉      | 6254/16104 [28:57:57<47:53:36, 17.50s/it]

 39%|███▉      | 6255/16104 [28:58:16<48:56:54, 17.89s/it]

 39%|███▉      | 6256/16104 [28:58:36<50:21:43, 18.41s/it]

 39%|███▉      | 6257/16104 [28:58:53<49:44:14, 18.18s/it]

 39%|███▉      | 6258/16104 [28:59:16<53:10:44, 19.44s/it]

 39%|███▉      | 6259/16104 [28:59:33<51:07:07, 18.69s/it]

 39%|███▉      | 6260/16104 [28:59:51<51:06:34, 18.69s/it]

 39%|███▉      | 6261/16104 [29:00:04<46:06:06, 16.86s/it]

 39%|███▉      | 6262/16104 [29:00:16<42:25:40, 15.52s/it]

 39%|███▉      | 6263/16104 [29:00:33<43:20:31, 15.86s/it]

 39%|███▉      | 6264/16104 [29:00:53<46:29:05, 17.01s/it]

 39%|███▉      | 6265/16104 [29:01:12<48:08:08, 17.61s/it]

 39%|███▉      | 6266/16104 [29:01:27<45:56:32, 16.81s/it]

 39%|███▉      | 6267/16104 [29:01:46<48:11:19, 17.64s/it]

 39%|███▉      | 6268/16104 [29:02:05<49:11:27, 18.00s/it]

 39%|███▉      | 6269/16104 [29:02:20<46:45:57, 17.12s/it]

 39%|███▉      | 6270/16104 [29:02:36<46:01:57, 16.85s/it]

 39%|███▉      | 6271/16104 [29:02:58<49:46:47, 18.23s/it]

 39%|███▉      | 6272/16104 [29:03:10<44:43:38, 16.38s/it]

 39%|███▉      | 6273/16104 [29:03:23<42:05:13, 15.41s/it]

 39%|███▉      | 6274/16104 [29:03:43<45:43:53, 16.75s/it]

 39%|███▉      | 6275/16104 [29:04:00<46:15:18, 16.94s/it]

 39%|███▉      | 6276/16104 [29:04:11<41:31:19, 15.21s/it]

 39%|███▉      | 6277/16104 [29:04:30<44:02:00, 16.13s/it]

 39%|███▉      | 6278/16104 [29:04:46<44:14:29, 16.21s/it]

 39%|███▉      | 6279/16104 [29:05:00<42:20:32, 15.51s/it]

 39%|███▉      | 6280/16104 [29:05:20<46:16:33, 16.96s/it]

 39%|███▉      | 6281/16104 [29:05:37<46:28:38, 17.03s/it]

 39%|███▉      | 6282/16104 [29:05:49<42:03:03, 15.41s/it]

 39%|███▉      | 6283/16104 [29:06:08<45:03:27, 16.52s/it]

 39%|███▉      | 6284/16104 [29:06:26<46:22:35, 17.00s/it]

 39%|███▉      | 6285/16104 [29:06:42<45:34:23, 16.71s/it]

 39%|███▉      | 6286/16104 [29:07:05<50:19:26, 18.45s/it]

 39%|███▉      | 6287/16104 [29:07:25<51:37:36, 18.93s/it]

 39%|███▉      | 6288/16104 [29:07:47<54:02:06, 19.82s/it]

 39%|███▉      | 6289/16104 [29:08:07<54:35:15, 20.02s/it]

 39%|███▉      | 6290/16104 [29:08:21<49:02:41, 17.99s/it]

 39%|███▉      | 6291/16104 [29:08:38<48:38:11, 17.84s/it]

 39%|███▉      | 6292/16104 [29:08:58<50:37:33, 18.57s/it]

 39%|███▉      | 6293/16104 [29:09:17<50:37:40, 18.58s/it]

 39%|███▉      | 6294/16104 [29:09:36<51:05:10, 18.75s/it]

 39%|███▉      | 6295/16104 [29:09:56<52:04:03, 19.11s/it]

 39%|███▉      | 6296/16104 [29:10:16<52:33:17, 19.29s/it]

{'loss': 0.4204, 'learning_rate': 1.3911219395671582e-06, 'rewards/chosen': -2.322341203689575, 'rewards/rejected': -3.608829975128174, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2864887714385986, 'policy_logps/rejected': -394.4941711425781, 'policy_logps/chosen': -311.52655029296875, 'referece_logps/rejected': -358.4058837890625, 'referece_logps/chosen': -288.3031005859375, 'logits/rejected': -0.8880499005317688, 'logits/chosen': -0.8475435376167297, 'epoch': 2.35}
 39%|███▉      | 6297/16104 [29:10:35<52:08:20, 19.14s/it]

 39%|███▉      | 6298/16104 [29:10:53<51:44:54, 19.00s/it]

 39%|███▉      | 6299/16104 [29:11:08<48:22:16, 17.76s/it]

 39%|███▉      | 6300/16104 [29:11:21<44:49:14, 16.46s/it]

 39%|███▉      | 6301/16104 [29:11:32<40:01:25, 14.70s/it]

 39%|███▉      | 6302/16104 [29:11:44<37:53:20, 13.92s/it]

 39%|███▉      | 6303/16104 [29:11:55<35:18:03, 12.97s/it]

 39%|███▉      | 6304/16104 [29:12:13<39:37:51, 14.56s/it]

 39%|███▉      | 6305/16104 [29:12:31<42:29:34, 15.61s/it]

 39%|███▉      | 6306/16104 [29:12:46<42:06:36, 15.47s/it]

 39%|███▉      | 6307/16104 [29:12:58<39:12:46, 14.41s/it]

 39%|███▉      | 6308/16104 [29:13:10<37:12:50, 13.68s/it]

 39%|███▉      | 6309/16104 [29:13:25<38:09:57, 14.03s/it]

 39%|███▉      | 6310/16104 [29:13:38<36:57:02, 13.58s/it]

 39%|███▉      | 6311/16104 [29:13:54<39:18:01, 14.45s/it]

 39%|███▉      | 6312/16104 [29:14:11<41:09:14, 15.13s/it]

 39%|███▉      | 6313/16104 [29:14:23<39:01:30, 14.35s/it]

 39%|███▉      | 6314/16104 [29:14:35<36:59:01, 13.60s/it]

 39%|███▉      | 6315/16104 [29:14:47<35:14:34, 12.96s/it]

 39%|███▉      | 6316/16104 [29:15:02<37:31:56, 13.80s/it]

 39%|███▉      | 6317/16104 [29:15:20<40:12:25, 14.79s/it]

 39%|███▉      | 6318/16104 [29:15:41<45:27:40, 16.72s/it]
{'loss': 0.5196, 'learning_rate': 1.387045828517522e-06, 'rewards/chosen': -0.9588771462440491, 'rewards/rejected': -2.105458974838257, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1465818881988525, 'policy_logps/rejected': -559.3030395507812, 'policy_logps/chosen': -397.4795227050781, 'referece_logps/rejected': -538.2484741210938, 'referece_logps/chosen': -387.8907470703125, 'logits/rejected': 0.32381558418273926, 'logits/chosen': 0.4071948528289795, 'epoch': 2.35}


 39%|███▉      | 6320/16104 [29:16:12<43:41:02, 16.07s/it]
{'loss': 0.5651, 'learning_rate': 1.3866748960071612e-06, 'rewards/chosen': -0.7485406398773193, 'rewards/rejected': -1.37540864944458, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6268678903579712, 'policy_logps/rejected': -400.2821044921875, 'policy_logps/chosen': -460.4608459472656, 'referece_logps/rejected': -386.5279846191406, 'referece_logps/chosen': -452.9754638671875, 'logits/rejected': -0.6965376138687134, 'logits/chosen': -0.6027006506919861, 'epoch': 2.35}


 39%|███▉      | 6322/16104 [29:16:44<43:02:29, 15.84s/it]

 39%|███▉      | 6323/16104 [29:16:56<40:23:11, 14.86s/it]

 39%|███▉      | 6324/16104 [29:17:16<44:09:47, 16.26s/it]

 39%|███▉      | 6325/16104 [29:17:37<48:07:12, 17.71s/it]

 39%|███▉      | 6326/16104 [29:17:57<49:39:28, 18.28s/it]

 39%|███▉      | 6327/16104 [29:18:14<48:41:46, 17.93s/it]
{'loss': 0.6257, 'learning_rate': 1.3853761399016529e-06, 'rewards/chosen': -0.8388156294822693, 'rewards/rejected': -1.0185348987579346, 'rewards/accuracies': 0.75, 'rewards/margins': 0.17971938848495483, 'policy_logps/rejected': -321.0609130859375, 'policy_logps/chosen': -412.92022705078125, 'referece_logps/rejected': -310.8755187988281, 'referece_logps/chosen': -404.5320129394531, 'logits/rejected': -0.038880303502082825, 'logits/chosen': -0.03278487175703049, 'epoch': 2.36}


 39%|███▉      | 6329/16104 [29:18:53<51:05:18, 18.82s/it]

 39%|███▉      | 6330/16104 [29:19:06<46:12:10, 17.02s/it]
{'loss': 0.4542, 'learning_rate': 1.3848192961547393e-06, 'rewards/chosen': -1.0239448547363281, 'rewards/rejected': -1.1561613082885742, 'rewards/accuracies': 0.375, 'rewards/margins': 0.13221628963947296, 'policy_logps/rejected': -331.21893310546875, 'policy_logps/chosen': -382.39410400390625, 'referece_logps/rejected': -319.6573181152344, 'referece_logps/chosen': -372.1546630859375, 'logits/rejected': -0.19736576080322266, 'logits/chosen': -0.16036611795425415, 'epoch': 2.36}


 39%|███▉      | 6332/16104 [29:19:39<46:15:18, 17.04s/it]

 39%|███▉      | 6333/16104 [29:19:56<46:38:39, 17.19s/it]

 39%|███▉      | 6334/16104 [29:20:15<47:41:26, 17.57s/it]

 39%|███▉      | 6335/16104 [29:20:32<47:09:43, 17.38s/it]
{'loss': 0.392, 'learning_rate': 1.383890912010816e-06, 'rewards/chosen': -1.4436355829238892, 'rewards/rejected': -3.168551206588745, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7249153852462769, 'policy_logps/rejected': -532.451171875, 'policy_logps/chosen': -646.1482543945312, 'referece_logps/rejected': -500.7655944824219, 'referece_logps/chosen': -631.7119140625, 'logits/rejected': -0.04057234525680542, 'logits/chosen': -0.24188295006752014, 'epoch': 2.36}

 39%|███▉      | 6336/16104 [29:20:43<42:21:08, 15.61s/it]


 39%|███▉      | 6338/16104 [29:21:22<47:16:24, 17.43s/it]

 39%|███▉      | 6339/16104 [29:21:42<49:14:54, 18.16s/it]

 39%|███▉      | 6340/16104 [29:21:57<46:30:57, 17.15s/it]
{'loss': 0.4129, 'learning_rate': 1.3829621396401133e-06, 'rewards/chosen': -0.7625206112861633, 'rewards/rejected': -2.28119158744812, 'rewards/accuracies': 0.875, 'rewards/margins': 1.518670916557312, 'policy_logps/rejected': -331.6783142089844, 'policy_logps/chosen': -392.7365417480469, 'referece_logps/rejected': -308.8664245605469, 'referece_logps/chosen': -385.111328125, 'logits/rejected': -0.5148589015007019, 'logits/chosen': -0.4096771478652954, 'epoch': 2.36}


 39%|███▉      | 6342/16104 [29:22:27<44:35:32, 16.44s/it]

 39%|███▉      | 6343/16104 [29:22:40<41:54:33, 15.46s/it]

 39%|███▉      | 6344/16104 [29:22:53<40:07:11, 14.80s/it]

 39%|███▉      | 6345/16104 [29:23:08<40:21:13, 14.89s/it]

 39%|███▉      | 6346/16104 [29:23:20<37:49:40, 13.96s/it]

 39%|███▉      | 6347/16104 [29:23:31<35:09:16, 12.97s/it]
{'loss': 0.5264, 'learning_rate': 1.3816612078885696e-06, 'rewards/chosen': -1.0717077255249023, 'rewards/rejected': -2.2277071475982666, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1559994220733643, 'policy_logps/rejected': -275.7091064453125, 'policy_logps/chosen': -412.6689453125, 'referece_logps/rejected': -253.43202209472656, 'referece_logps/chosen': -401.9518127441406, 'logits/rejected': 0.08972454071044922, 'logits/chosen': 0.023851461708545685, 'epoch': 2.36}


 39%|███▉      | 6349/16104 [29:23:55<34:03:56, 12.57s/it]

 39%|███▉      | 6350/16104 [29:24:06<33:19:00, 12.30s/it]
{'loss': 0.607, 'learning_rate': 1.3811034339758098e-06, 'rewards/chosen': -1.2823222875595093, 'rewards/rejected': -1.3898980617523193, 'rewards/accuracies': 0.5, 'rewards/margins': 0.10757572203874588, 'policy_logps/rejected': -401.14892578125, 'policy_logps/chosen': -313.4502258300781, 'referece_logps/rejected': -387.24993896484375, 'referece_logps/chosen': -300.62701416015625, 'logits/rejected': -0.7317420244216919, 'logits/chosen': -0.7519267797470093, 'epoch': 2.37}


 39%|███▉      | 6352/16104 [29:24:28<31:33:09, 11.65s/it]

 39%|███▉      | 6353/16104 [29:24:41<32:31:09, 12.01s/it]
{'loss': 0.5398, 'learning_rate': 1.3805455213162281e-06, 'rewards/chosen': -0.763258695602417, 'rewards/rejected': -1.2331851720809937, 'rewards/accuracies': 0.375, 'rewards/margins': 0.46992653608322144, 'policy_logps/rejected': -383.00164794921875, 'policy_logps/chosen': -492.22247314453125, 'referece_logps/rejected': -370.6697998046875, 'referece_logps/chosen': -484.5898742675781, 'logits/rejected': 0.01348239928483963, 'logits/chosen': 0.07317037880420685, 'epoch': 2.37}


 39%|███▉      | 6355/16104 [29:25:05<31:59:40, 11.81s/it]

 39%|███▉      | 6356/16104 [29:25:15<31:08:11, 11.50s/it]

 39%|███▉      | 6357/16104 [29:25:33<36:12:24, 13.37s/it]

 39%|███▉      | 6358/16104 [29:25:46<36:09:34, 13.36s/it]
{'loss': 0.4778, 'learning_rate': 1.3796153591090193e-06, 'rewards/chosen': -1.1542103290557861, 'rewards/rejected': -2.5564229488372803, 'rewards/accuracies': 0.75, 'rewards/margins': 1.4022126197814941, 'policy_logps/rejected': -374.3139953613281, 'policy_logps/chosen': -392.155029296875, 'referece_logps/rejected': -348.749755859375, 'referece_logps/chosen': -380.6129150390625, 'logits/rejected': 0.42656755447387695, 'logits/chosen': 0.5251101851463318, 'epoch': 2.37}


 39%|███▉      | 6360/16104 [29:26:21<42:13:52, 15.60s/it]
{'loss': 0.4391, 'learning_rate': 1.3792431866806232e-06, 'rewards/chosen': -1.4523780345916748, 'rewards/rejected': -1.7451679706573486, 'rewards/accuracies': 0.625, 'rewards/margins': 0.29278993606567383, 'policy_logps/rejected': -430.6542053222656, 'policy_logps/chosen': -396.3936767578125, 'referece_logps/rejected': -413.2025146484375, 'referece_logps/chosen': -381.869873046875, 'logits/rejected': -0.7721177339553833, 'logits/chosen': -0.7538126111030579, 'epoch': 2.37}


 40%|███▉      | 6362/16104 [29:26:57<45:53:57, 16.96s/it]

 40%|███▉      | 6363/16104 [29:27:18<49:22:15, 18.25s/it]
{'loss': 0.4288, 'learning_rate': 1.3786848129988744e-06, 'rewards/chosen': -1.04539954662323, 'rewards/rejected': -2.2002804279327393, 'rewards/accuracies': 0.75, 'rewards/margins': 1.1548808813095093, 'policy_logps/rejected': -332.7601013183594, 'policy_logps/chosen': -392.9384765625, 'referece_logps/rejected': -310.75732421875, 'referece_logps/chosen': -382.4844665527344, 'logits/rejected': -0.9286532402038574, 'logits/chosen': -0.9729657173156738, 'epoch': 2.37}


 40%|███▉      | 6365/16104 [29:27:52<48:46:53, 18.03s/it]
{'loss': 0.343, 'learning_rate': 1.3783124872727775e-06, 'rewards/chosen': -0.5686980485916138, 'rewards/rejected': -2.428823709487915, 'rewards/accuracies': 0.875, 'rewards/margins': 1.8601256608963013, 'policy_logps/rejected': -384.8016662597656, 'policy_logps/chosen': -300.0076904296875, 'referece_logps/rejected': -360.5133972167969, 'referece_logps/chosen': -294.3207092285156, 'logits/rejected': -1.0656797885894775, 'logits/chosen': -1.1401597261428833, 'epoch': 2.37}


 40%|███▉      | 6367/16104 [29:28:24<45:42:28, 16.90s/it]

 40%|███▉      | 6368/16104 [29:28:44<48:01:44, 17.76s/it]

 40%|███▉      | 6369/16104 [29:29:01<47:20:23, 17.51s/it]
{'loss': 0.323, 'learning_rate': 1.3775676522398585e-06, 'rewards/chosen': -0.15432396531105042, 'rewards/rejected': -2.129929780960083, 'rewards/accuracies': 1.0, 'rewards/margins': 1.975605845451355, 'policy_logps/rejected': -405.9390563964844, 'policy_logps/chosen': -461.33990478515625, 'referece_logps/rejected': -384.6397705078125, 'referece_logps/chosen': -459.79669189453125, 'logits/rejected': 0.858673632144928, 'logits/chosen': 0.8415478467941284, 'epoch': 2.37}


 40%|███▉      | 6371/16104 [29:29:39<49:59:03, 18.49s/it]

 40%|███▉      | 6372/16104 [29:29:59<50:59:25, 18.86s/it]
{'loss': 0.4479, 'learning_rate': 1.3770088655693122e-06, 'rewards/chosen': -1.3682247400283813, 'rewards/rejected': -1.8362853527069092, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4680604934692383, 'policy_logps/rejected': -265.3746643066406, 'policy_logps/chosen': -293.5402526855469, 'referece_logps/rejected': -247.01182556152344, 'referece_logps/chosen': -279.8580017089844, 'logits/rejected': -0.866946816444397, 'logits/chosen': -0.8796801567077637, 'epoch': 2.37}


 40%|███▉      | 6374/16104 [29:30:32<48:52:20, 18.08s/it]

 40%|███▉      | 6375/16104 [29:30:47<45:45:40, 16.93s/it]

 40%|███▉      | 6376/16104 [29:31:01<44:01:30, 16.29s/it]

 40%|███▉      | 6377/16104 [29:31:17<43:36:50, 16.14s/it]

 40%|███▉      | 6378/16104 [29:31:35<44:45:02, 16.56s/it]

 40%|███▉      | 6379/16104 [29:31:55<47:24:53, 17.55s/it]

 40%|███▉      | 6380/16104 [29:32:11<46:29:09, 17.21s/it]

 40%|███▉      | 6381/16104 [29:32:31<49:00:48, 18.15s/it]

 40%|███▉      | 6382/16104 [29:32:48<48:06:24, 17.81s/it]

 40%|███▉      | 6383/16104 [29:33:05<47:18:45, 17.52s/it]

 40%|███▉      | 6384/16104 [29:33:24<48:06:54, 17.82s/it]

 40%|███▉      | 6385/16104 [29:33:44<49:43:31, 18.42s/it]

 40%|███▉      | 6386/16104 [29:34:01<48:51:08, 18.10s/it]

 40%|███▉      | 6387/16104 [29:34:14<44:25:30, 16.46s/it]

 40%|███▉      | 6388/16104 [29:34:30<43:57:32, 16.29s/it]

 40%|███▉      | 6389/16104 [29:34:49<46:37:43, 17.28s/it]
{'loss': 0.4286, 'learning_rate': 1.3738398211340756e-06, 'rewards/chosen': -1.1912709474563599, 'rewards/rejected': -2.1534500122070312, 'rewards/accuracies': 0.625, 'rewards/margins': 0.9621790647506714, 'policy_logps/rejected': -265.4034729003906, 'policy_logps/chosen': -260.0088806152344, 'referece_logps/rejected': -243.86895751953125, 'referece_logps/chosen': -248.09617614746094, 'logits/rejected': -0.6444521546363831, 'logits/chosen': -0.5161834955215454, 'epoch': 2.38}


 40%|███▉      | 6391/16104 [29:35:29<50:07:07, 18.58s/it]

 40%|███▉      | 6392/16104 [29:35:49<50:59:18, 18.90s/it]

 40%|███▉      | 6393/16104 [29:36:06<49:27:24, 18.33s/it]
{'loss': 0.4834, 'learning_rate': 1.3730935271025437e-06, 'rewards/chosen': -1.2180029153823853, 'rewards/rejected': -2.555856466293335, 'rewards/accuracies': 0.625, 'rewards/margins': 1.3378535509109497, 'policy_logps/rejected': -470.8357238769531, 'policy_logps/chosen': -469.98492431640625, 'referece_logps/rejected': -445.277099609375, 'referece_logps/chosen': -457.8049011230469, 'logits/rejected': -0.18963821232318878, 'logits/chosen': -0.011499406769871712, 'epoch': 2.38}


 40%|███▉      | 6395/16104 [29:36:38<45:53:49, 17.02s/it]

 40%|███▉      | 6396/16104 [29:36:55<46:01:49, 17.07s/it]

 40%|███▉      | 6397/16104 [29:37:09<43:52:40, 16.27s/it]

 40%|███▉      | 6398/16104 [29:37:23<42:14:23, 15.67s/it]
{'loss': 0.5761, 'learning_rate': 1.3721603200430392e-06, 'rewards/chosen': -0.927428662776947, 'rewards/rejected': -1.3214856386184692, 'rewards/accuracies': 1.0, 'rewards/margins': 0.394057035446167, 'policy_logps/rejected': -328.9515380859375, 'policy_logps/chosen': -276.99896240234375, 'referece_logps/rejected': -315.7366943359375, 'referece_logps/chosen': -267.72467041015625, 'logits/rejected': -0.4005199074745178, 'logits/chosen': -0.43554162979125977, 'epoch': 2.38}

 40%|███▉      | 6399/16104 [29:37:41<43:28:01, 16.12s/it]


 40%|███▉      | 6401/16104 [29:38:09<40:27:27, 15.01s/it]

 40%|███▉      | 6402/16104 [29:38:22<38:51:25, 14.42s/it]

 40%|███▉      | 6403/16104 [29:38:42<42:59:49, 15.96s/it]

 40%|███▉      | 6404/16104 [29:39:01<46:06:05, 17.11s/it]

 40%|███▉      | 6405/16104 [29:39:16<43:54:16, 16.30s/it]

 40%|███▉      | 6406/16104 [29:39:31<43:10:07, 16.02s/it]
{'loss': 0.5834, 'learning_rate': 1.3706664063040852e-06, 'rewards/chosen': -1.143984317779541, 'rewards/rejected': -1.801843523979187, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6578589081764221, 'policy_logps/rejected': -410.1044921875, 'policy_logps/chosen': -495.3482666015625, 'referece_logps/rejected': -392.0860595703125, 'referece_logps/chosen': -483.9084167480469, 'logits/rejected': -0.7119431495666504, 'logits/chosen': -0.7001017928123474, 'epoch': 2.39}


 40%|███▉      | 6408/16104 [29:40:06<44:49:44, 16.64s/it]

 40%|███▉      | 6409/16104 [29:40:21<43:38:40, 16.21s/it]
{'loss': 0.4624, 'learning_rate': 1.3701059410412773e-06, 'rewards/chosen': -0.5591030120849609, 'rewards/rejected': -2.688692808151245, 'rewards/accuracies': 1.0, 'rewards/margins': 2.129589796066284, 'policy_logps/rejected': -350.9418029785156, 'policy_logps/chosen': -410.8502502441406, 'referece_logps/rejected': -324.05487060546875, 'referece_logps/chosen': -405.25921630859375, 'logits/rejected': -0.6254346370697021, 'logits/chosen': -0.7139308452606201, 'epoch': 2.39}


 40%|███▉      | 6411/16104 [29:40:53<44:08:09, 16.39s/it]

 40%|███▉      | 6412/16104 [29:41:04<39:35:06, 14.70s/it]

 40%|███▉      | 6413/16104 [29:41:18<38:51:51, 14.44s/it]

 40%|███▉      | 6414/16104 [29:41:34<40:38:41, 15.10s/it]
{'loss': 0.4169, 'learning_rate': 1.3691715329418094e-06, 'rewards/chosen': -1.8493479490280151, 'rewards/rejected': -3.5245635509490967, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6752158403396606, 'policy_logps/rejected': -561.6969604492188, 'policy_logps/chosen': -542.36181640625, 'referece_logps/rejected': -526.4512939453125, 'referece_logps/chosen': -523.8682861328125, 'logits/rejected': -0.5428709983825684, 'logits/chosen': -0.4875859022140503, 'epoch': 2.39}


 40%|███▉      | 6416/16104 [29:42:14<47:13:01, 17.55s/it]
{'loss': 0.4285, 'learning_rate': 1.368797665113569e-06, 'rewards/chosen': -1.0070089101791382, 'rewards/rejected': -2.3435871601104736, 'rewards/accuracies': 0.625, 'rewards/margins': 1.3365782499313354, 'policy_logps/rejected': -303.33038330078125, 'policy_logps/chosen': -403.43621826171875, 'referece_logps/rejected': -279.89447021484375, 'referece_logps/chosen': -393.36614990234375, 'logits/rejected': -0.5813618302345276, 'logits/chosen': -0.47009843587875366, 'epoch': 2.39}

 40%|███▉      | 6417/16104 [29:42:33<47:53:10, 17.80s/it]


 40%|███▉      | 6419/16104 [29:43:04<45:31:49, 16.92s/it]
{'loss': 0.4323, 'learning_rate': 1.3682367515011893e-06, 'rewards/chosen': -1.5390982627868652, 'rewards/rejected': -3.297431468963623, 'rewards/accuracies': 0.75, 'rewards/margins': 1.758333444595337, 'policy_logps/rejected': -480.91900634765625, 'policy_logps/chosen': -360.0219421386719, 'referece_logps/rejected': -447.9447326660156, 'referece_logps/chosen': -344.6309509277344, 'logits/rejected': -0.6382244229316711, 'logits/chosen': -0.6973651051521301, 'epoch': 2.39}


 40%|███▉      | 6421/16104 [29:43:42<48:29:20, 18.03s/it]
{'loss': 0.5337, 'learning_rate': 1.3678627346011621e-06, 'rewards/chosen': -1.1478575468063354, 'rewards/rejected': -1.2585867643356323, 'rewards/accuracies': 0.625, 'rewards/margins': 0.11072921752929688, 'policy_logps/rejected': -427.45733642578125, 'policy_logps/chosen': -388.87890625, 'referece_logps/rejected': -414.8714294433594, 'referece_logps/chosen': -377.40032958984375, 'logits/rejected': -0.709094226360321, 'logits/chosen': -0.5718233585357666, 'epoch': 2.39}


 40%|███▉      | 6423/16104 [29:44:16<47:37:16, 17.71s/it]

 40%|███▉      | 6424/16104 [29:44:34<48:13:39, 17.94s/it]

 40%|███▉      | 6425/16104 [29:44:47<43:33:56, 16.20s/it]

 40%|███▉      | 6426/16104 [29:45:00<41:10:45, 15.32s/it]

 40%|███▉      | 6427/16104 [29:45:12<38:40:24, 14.39s/it]
{'loss': 0.6305, 'learning_rate': 1.3667403270063092e-06, 'rewards/chosen': -1.356899619102478, 'rewards/rejected': -1.6703007221221924, 'rewards/accuracies': 0.75, 'rewards/margins': 0.31340113282203674, 'policy_logps/rejected': -413.82098388671875, 'policy_logps/chosen': -425.44403076171875, 'referece_logps/rejected': -397.11798095703125, 'referece_logps/chosen': -411.87506103515625, 'logits/rejected': -0.8572099208831787, 'logits/chosen': -0.9142028093338013, 'epoch': 2.39}


 40%|███▉      | 6429/16104 [29:45:37<35:56:15, 13.37s/it]
{'loss': 0.6126, 'learning_rate': 1.3663660723782274e-06, 'rewards/chosen': -0.8646419644355774, 'rewards/rejected': -1.0997185707092285, 'rewards/accuracies': 0.5, 'rewards/margins': 0.23507660627365112, 'policy_logps/rejected': -284.17132568359375, 'policy_logps/chosen': -303.8077697753906, 'referece_logps/rejected': -273.17413330078125, 'referece_logps/chosen': -295.16131591796875, 'logits/rejected': -0.1101624071598053, 'logits/chosen': -0.06060507893562317, 'epoch': 2.4}


 40%|███▉      | 6431/16104 [29:46:08<39:21:52, 14.65s/it]

 40%|███▉      | 6432/16104 [29:46:28<43:22:50, 16.15s/it]

 40%|███▉      | 6433/16104 [29:46:45<43:43:55, 16.28s/it]
{'loss': 0.5747, 'learning_rate': 1.3656173853406952e-06, 'rewards/chosen': -0.6195948123931885, 'rewards/rejected': -1.723929762840271, 'rewards/accuracies': 0.625, 'rewards/margins': 1.104335069656372, 'policy_logps/rejected': -451.6334228515625, 'policy_logps/chosen': -470.5943908691406, 'referece_logps/rejected': -434.39410400390625, 'referece_logps/chosen': -464.3984375, 'logits/rejected': -0.35859057307243347, 'logits/chosen': -0.4058997333049774, 'epoch': 2.4}


 40%|███▉      | 6435/16104 [29:47:14<42:34:07, 15.85s/it]
{'loss': 0.5043, 'learning_rate': 1.3652429530523879e-06, 'rewards/chosen': -0.5977082848548889, 'rewards/rejected': -2.2369797229766846, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6392714977264404, 'policy_logps/rejected': -533.54150390625, 'policy_logps/chosen': -488.50933837890625, 'referece_logps/rejected': -511.1717529296875, 'referece_logps/chosen': -482.53228759765625, 'logits/rejected': -0.36292076110839844, 'logits/chosen': -0.35264259576797485, 'epoch': 2.4}

 40%|███▉      | 6436/16104 [29:47:30<42:24:22, 15.79s/it]

 40%|███▉      | 6437/16104 [29:47:50<45:52:40, 17.08s/it]

 40%|███▉      | 6438/16104 [29:48:10<48:06:34, 17.92s/it]


 40%|███▉      | 6440/16104 [29:48:49<50:01:58, 18.64s/it]

 40%|███▉      | 6441/16104 [29:49:07<49:33:18, 18.46s/it]
{'loss': 0.4224, 'learning_rate': 1.364119301836359e-06, 'rewards/chosen': -0.802541196346283, 'rewards/rejected': -1.5011132955551147, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6985722184181213, 'policy_logps/rejected': -180.60899353027344, 'policy_logps/chosen': -205.26943969726562, 'referece_logps/rejected': -165.59786987304688, 'referece_logps/chosen': -197.24400329589844, 'logits/rejected': -0.5039718151092529, 'logits/chosen': -0.4450102746486664, 'epoch': 2.4}

 40%|████      | 6442/16104 [29:49:26<50:20:20, 18.76s/it]


 40%|████      | 6444/16104 [29:50:05<51:21:44, 19.14s/it]

 40%|████      | 6445/16104 [29:50:19<47:14:45, 17.61s/it]

 40%|████      | 6446/16104 [29:50:39<48:53:40, 18.23s/it]
{'loss': 0.417, 'learning_rate': 1.3631825206985062e-06, 'rewards/chosen': -0.7536493539810181, 'rewards/rejected': -1.7337136268615723, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9800642728805542, 'policy_logps/rejected': -544.95166015625, 'policy_logps/chosen': -455.02606201171875, 'referece_logps/rejected': -527.614501953125, 'referece_logps/chosen': -447.4895324707031, 'logits/rejected': -1.3970483541488647, 'logits/chosen': -1.2090177536010742, 'epoch': 2.4}


 40%|████      | 6448/16104 [29:51:11<46:57:43, 17.51s/it]
{'loss': 0.4105, 'learning_rate': 1.3628077053506407e-06, 'rewards/chosen': -0.9144002795219421, 'rewards/rejected': -2.502746820449829, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5883464813232422, 'policy_logps/rejected': -338.213623046875, 'policy_logps/chosen': -382.29962158203125, 'referece_logps/rejected': -313.1861267089844, 'referece_logps/chosen': -373.1556396484375, 'logits/rejected': -0.9878315329551697, 'logits/chosen': -1.0239745378494263, 'epoch': 2.4}

 40%|████      | 6449/16104 [29:51:30<48:12:38, 17.98s/it]


 40%|████      | 6451/16104 [29:52:05<47:29:25, 17.71s/it]
{'loss': 0.5042, 'learning_rate': 1.3622453722761561e-06, 'rewards/chosen': -1.463814377784729, 'rewards/rejected': -2.6502463817596436, 'rewards/accuracies': 0.75, 'rewards/margins': 1.186432123184204, 'policy_logps/rejected': -393.981201171875, 'policy_logps/chosen': -320.6881103515625, 'referece_logps/rejected': -367.4787292480469, 'referece_logps/chosen': -306.0500183105469, 'logits/rejected': -1.3920695781707764, 'logits/chosen': -1.368051528930664, 'epoch': 2.4}

 40%|████      | 6452/16104 [29:52:16<42:15:01, 15.76s/it]

 40%|████      | 6453/16104 [29:52:34<44:14:32, 16.50s/it]

 40%|████      | 6454/16104 [29:52:50<43:16:51, 16.15s/it]

 40%|████      | 6455/16104 [29:53:02<40:14:16, 15.01s/it]

 40%|████      | 6456/16104 [29:53:22<44:08:29, 16.47s/it]

 40%|████      | 6457/16104 [29:53:42<46:51:39, 17.49s/it]

 40%|████      | 6458/16104 [29:53:59<47:04:42, 17.57s/it]

 40%|████      | 6459/16104 [29:54:12<42:55:10, 16.02s/it]

 40%|████      | 6460/16104 [29:54:28<42:54:01, 16.01s/it]


 40%|████      | 6462/16104 [29:55:07<47:55:45, 17.90s/it]

 40%|████      | 6463/16104 [29:55:17<42:10:00, 15.75s/it]
{'loss': 0.5119, 'learning_rate': 1.3599947232137807e-06, 'rewards/chosen': -0.5697214007377625, 'rewards/rejected': -1.9089213609695435, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3391999006271362, 'policy_logps/rejected': -318.531982421875, 'policy_logps/chosen': -423.7546081542969, 'referece_logps/rejected': -299.4427490234375, 'referece_logps/chosen': -418.057373046875, 'logits/rejected': -0.4359802007675171, 'logits/chosen': -0.49088019132614136, 'epoch': 2.41}


 40%|████      | 6465/16104 [29:55:53<45:28:14, 16.98s/it]

 40%|████      | 6466/16104 [29:56:11<46:28:40, 17.36s/it]

 40%|████      | 6467/16104 [29:56:25<43:19:56, 16.19s/it]
{'loss': 0.4724, 'learning_rate': 1.359244040214386e-06, 'rewards/chosen': -0.794928789138794, 'rewards/rejected': -1.4493573904037476, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6544287204742432, 'policy_logps/rejected': -394.90081787109375, 'policy_logps/chosen': -441.2790222167969, 'referece_logps/rejected': -380.4073181152344, 'referece_logps/chosen': -433.3297119140625, 'logits/rejected': 0.813599705696106, 'logits/chosen': 0.7766156196594238, 'epoch': 2.41}


 40%|████      | 6469/16104 [29:56:53<40:04:58, 14.98s/it]

 40%|████      | 6470/16104 [29:57:07<39:06:46, 14.62s/it]
{'loss': 0.6553, 'learning_rate': 1.358680875351615e-06, 'rewards/chosen': -0.6611579060554504, 'rewards/rejected': -1.173308253288269, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5121505260467529, 'policy_logps/rejected': -436.0255126953125, 'policy_logps/chosen': -413.51776123046875, 'referece_logps/rejected': -424.29241943359375, 'referece_logps/chosen': -406.9061279296875, 'logits/rejected': -0.5954627990722656, 'logits/chosen': -0.5172099471092224, 'epoch': 2.41}

 40%|████      | 6471/16104 [29:57:24<40:42:01, 15.21s/it]

 40%|████      | 6472/16104 [29:57:40<41:53:35, 15.66s/it]


 40%|████      | 6474/16104 [29:58:05<37:27:29, 14.00s/it]

 40%|████      | 6475/16104 [29:58:21<39:07:53, 14.63s/it]
{'loss': 0.4384, 'learning_rate': 1.3577419771626456e-06, 'rewards/chosen': -1.2623562812805176, 'rewards/rejected': -1.9282443523406982, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6658881902694702, 'policy_logps/rejected': -393.02764892578125, 'policy_logps/chosen': -405.7837829589844, 'referece_logps/rejected': -373.74517822265625, 'referece_logps/chosen': -393.16021728515625, 'logits/rejected': -0.47147706151008606, 'logits/chosen': -0.6494789123535156, 'epoch': 2.41}

 40%|████      | 6476/16104 [29:58:40<42:17:54, 15.82s/it]

 40%|████      | 6477/16104 [29:58:51<38:18:16, 14.32s/it]

 40%|████      | 6478/16104 [29:59:08<40:56:13, 15.31s/it]


 40%|████      | 6480/16104 [29:59:47<46:06:25, 17.25s/it]

 40%|████      | 6481/16104 [29:59:59<41:39:34, 15.59s/it]
{'loss': 0.4259, 'learning_rate': 1.3566148218665583e-06, 'rewards/chosen': -1.0591570138931274, 'rewards/rejected': -2.2755870819091797, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2164299488067627, 'policy_logps/rejected': -359.44232177734375, 'policy_logps/chosen': -426.0966796875, 'referece_logps/rejected': -336.68646240234375, 'referece_logps/chosen': -415.50506591796875, 'logits/rejected': -0.4754902720451355, 'logits/chosen': -0.5434699058532715, 'epoch': 2.41}

 40%|████      | 6482/16104 [30:00:10<38:16:12, 14.32s/it]


 40%|████      | 6484/16104 [30:00:41<38:26:30, 14.39s/it]

 40%|████      | 6485/16104 [30:00:52<35:29:08, 13.28s/it]

 40%|████      | 6486/16104 [30:01:04<34:27:30, 12.90s/it]

 40%|████      | 6487/16104 [30:01:17<35:13:26, 13.19s/it]
{'loss': 0.4851, 'learning_rate': 1.355487147245119e-06, 'rewards/chosen': -0.7186359763145447, 'rewards/rejected': -2.64461350440979, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9259775876998901, 'policy_logps/rejected': -364.47967529296875, 'policy_logps/chosen': -465.2027587890625, 'referece_logps/rejected': -338.0335388183594, 'referece_logps/chosen': -458.0164489746094, 'logits/rejected': -0.3542572855949402, 'logits/chosen': -0.3835351765155792, 'epoch': 2.42}


 40%|████      | 6489/16104 [30:01:52<40:04:29, 15.00s/it]
{'loss': 0.342, 'learning_rate': 1.3551111405828196e-06, 'rewards/chosen': -0.7166526913642883, 'rewards/rejected': -2.5009593963623047, 'rewards/accuracies': 0.75, 'rewards/margins': 1.784306526184082, 'policy_logps/rejected': -437.7487487792969, 'policy_logps/chosen': -591.5953979492188, 'referece_logps/rejected': -412.7391662597656, 'referece_logps/chosen': -584.428955078125, 'logits/rejected': 0.4989964962005615, 'logits/chosen': 0.3571261763572693, 'epoch': 2.42}


 40%|████      | 6491/16104 [30:02:26<43:25:28, 16.26s/it]

 40%|████      | 6492/16104 [30:02:47<47:18:01, 17.72s/it]

 40%|████      | 6493/16104 [30:02:58<41:43:21, 15.63s/it]
{'loss': 0.4608, 'learning_rate': 1.3543589549405198e-06, 'rewards/chosen': -1.2350327968597412, 'rewards/rejected': -1.1801985502243042, 'rewards/accuracies': 0.25, 'rewards/margins': -0.054834142327308655, 'policy_logps/rejected': -389.4581298828125, 'policy_logps/chosen': -333.70123291015625, 'referece_logps/rejected': -377.6561584472656, 'referece_logps/chosen': -321.3509521484375, 'logits/rejected': -0.7862850427627563, 'logits/chosen': -0.8264526724815369, 'epoch': 2.42}


 40%|████      | 6495/16104 [30:03:31<42:09:05, 15.79s/it]
{'loss': 0.4475, 'learning_rate': 1.353982776082229e-06, 'rewards/chosen': -0.2228071391582489, 'rewards/rejected': -2.2837467193603516, 'rewards/accuracies': 1.0, 'rewards/margins': 2.0609395503997803, 'policy_logps/rejected': -334.2509765625, 'policy_logps/chosen': -307.0191650390625, 'referece_logps/rejected': -311.4135437011719, 'referece_logps/chosen': -304.7911071777344, 'logits/rejected': -0.5291178226470947, 'logits/chosen': -0.5999197363853455, 'epoch': 2.42}


 40%|████      | 6497/16104 [30:03:56<37:11:51, 13.94s/it]

 40%|████      | 6498/16104 [30:04:15<41:35:44, 15.59s/it]

 40%|████      | 6499/16104 [30:04:28<39:13:04, 14.70s/it]

 40%|████      | 6500/16104 [30:04:40<36:52:48, 13.82s/it]

 40%|████      | 6501/16104 [30:05:15<54:17:30, 20.35s/it]

 40%|████      | 6502/16104 [30:05:32<51:20:28, 19.25s/it]

 40%|████      | 6503/16104 [30:05:51<51:37:23, 19.36s/it]

 40%|████      | 6504/16104 [30:06:08<49:20:23, 18.50s/it]

 40%|████      | 6505/16104 [30:06:24<47:07:30, 17.67s/it]
{'loss': 0.4132, 'learning_rate': 1.3521010238543773e-06, 'rewards/chosen': -1.6129347085952759, 'rewards/rejected': -2.4446287155151367, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8316940069198608, 'policy_logps/rejected': -378.6177978515625, 'policy_logps/chosen': -436.6106872558594, 'referece_logps/rejected': -354.1715087890625, 'referece_logps/chosen': -420.4813232421875, 'logits/rejected': -0.5867745876312256, 'logits/chosen': -0.7115159034729004, 'epoch': 2.42}


 40%|████      | 6507/16104 [30:06:58<46:03:38, 17.28s/it]
{'loss': 0.3777, 'learning_rate': 1.351724502247801e-06, 'rewards/chosen': -0.9484931826591492, 'rewards/rejected': -2.3748350143432617, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4263417720794678, 'policy_logps/rejected': -353.2816467285156, 'policy_logps/chosen': -382.7976989746094, 'referece_logps/rejected': -329.5332946777344, 'referece_logps/chosen': -373.3127746582031, 'logits/rejected': -0.9113451838493347, 'logits/chosen': -0.7428480982780457, 'epoch': 2.42}


 40%|████      | 6509/16104 [30:07:32<44:53:24, 16.84s/it]

 40%|████      | 6510/16104 [30:07:51<46:58:49, 17.63s/it]
{'loss': 0.435, 'learning_rate': 1.3511596131478505e-06, 'rewards/chosen': -0.8708656430244446, 'rewards/rejected': -2.031622886657715, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1607574224472046, 'policy_logps/rejected': -450.4368591308594, 'policy_logps/chosen': -480.93035888671875, 'referece_logps/rejected': -430.12060546875, 'referece_logps/chosen': -472.2216796875, 'logits/rejected': -0.8182100057601929, 'logits/chosen': -0.7014386057853699, 'epoch': 2.43}

 40%|████      | 6511/16104 [30:08:04<43:07:51, 16.19s/it]

 40%|████      | 6512/16104 [30:08:24<46:14:09, 17.35s/it]

 40%|████      | 6513/16104 [30:08:39<43:49:45, 16.45s/it]


 40%|████      | 6515/16104 [30:09:12<43:51:03, 16.46s/it]
{'loss': 0.5106, 'learning_rate': 1.3502178473155272e-06, 'rewards/chosen': -0.9351098537445068, 'rewards/rejected': -2.2128467559814453, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2777369022369385, 'policy_logps/rejected': -366.46978759765625, 'policy_logps/chosen': -527.4130859375, 'referece_logps/rejected': -344.34130859375, 'referece_logps/chosen': -518.06201171875, 'logits/rejected': -0.3142736852169037, 'logits/chosen': -0.35944196581840515, 'epoch': 2.43}

 40%|████      | 6516/16104 [30:09:24<40:55:59, 15.37s/it]

 40%|████      | 6517/16104 [30:09:39<40:18:20, 15.14s/it]


 40%|████      | 6519/16104 [30:10:08<38:54:13, 14.61s/it]
{'loss': 0.4587, 'learning_rate': 1.3494641795990985e-06, 'rewards/chosen': -1.1595025062561035, 'rewards/rejected': -2.1766529083251953, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0171502828598022, 'policy_logps/rejected': -289.97357177734375, 'policy_logps/chosen': -317.2471618652344, 'referece_logps/rejected': -268.2070617675781, 'referece_logps/chosen': -305.6521911621094, 'logits/rejected': -0.773324728012085, 'logits/chosen': -0.858126163482666, 'epoch': 2.43}

 40%|████      | 6520/16104 [30:10:27<42:18:01, 15.89s/it]


 40%|████      | 6522/16104 [30:11:07<47:59:21, 18.03s/it]
{'loss': 0.3649, 'learning_rate': 1.3488987803523807e-06, 'rewards/chosen': -0.662550151348114, 'rewards/rejected': -1.9821466207504272, 'rewards/accuracies': 0.75, 'rewards/margins': 1.319596290588379, 'policy_logps/rejected': -577.7062377929688, 'policy_logps/chosen': -344.8004455566406, 'referece_logps/rejected': -557.884765625, 'referece_logps/chosen': -338.1750183105469, 'logits/rejected': -0.7258955240249634, 'logits/chosen': -0.5073330402374268, 'epoch': 2.43}
{'loss': 0.4776, 'learning_rate': 1.3487102856994858e-06, 'rewards/chosen': -0.9269084930419922, 'rewards/rejected': -1.051274061203003, 'rewards/accuracies': 0.625, 'rewards/margins': 0.12436559051275253, 'policy_logps/rejected': -498.3554992675781, 'policy_logps/chosen': -506.98736572265625, 'referece_logps/rejected': -487.8427734375, 'referece_logps/chosen': -497.71832275390625, 'logits/rejected': -1.148635983467102, 'logits/chosen': -1.2417387962341309, 'epoch': 2.43}
{'loss': 0.457, 'learning_rate': 1.3485217769406376e-06, 'rewards/chosen': -1.3096039295196533, 'rewards/rejected': -3.336728572845459, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0271246433258057, 'policy_logps/rejected': -328.1585693359375, 'policy_logps/chosen': -339.111572265625, 'referece_logps/rejected': -294.7912902832031, 'referece_logps/chosen': -326.0155029296875, 'logits/rejected': -0.5648851990699768, 'logits/chosen': -0.4742903709411621, 'epoch': 2.43}
{'loss': 0.4592, 'learning_rate': 1.3483332540834618e-06, 'rewards/chosen': -1.5650466680526733, 'rewards/rejected': -2.2892510890960693, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7242043018341064, 'policy_logps/rejected': -356.0966796875, 'policy_logps/chosen': -433.33612060546875, 'referece_logps/rejected': -333.20416259765625, 'referece_logps/chosen': -417.6856384277344, 'logits/rejected': -0.9491652846336365, 'logits/chosen': -0.9991177916526794, 'epoch': 2.43}
{'loss': 0.5242, 'learning_rate': 1.348144717135584e-06, 'rewards/chosen': -1.3957526683807373, 'rewards/rejected': -1.6971375942230225, 'rewards/accuracies': 0.75, 'rewards/margins': 0.3013850450515747, 'policy_logps/rejected': -358.3941955566406, 'policy_logps/chosen': -424.7384948730469, 'referece_logps/rejected': -341.4228515625, 'referece_logps/chosen': -410.7809753417969, 'logits/rejected': -0.39109253883361816, 'logits/chosen': -0.45161116123199463, 'epoch': 2.43}
{'loss': 0.4554, 'learning_rate': 1.3479561661046315e-06, 'rewards/chosen': -1.3954838514328003, 'rewards/rejected': -2.615903854370117, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2204196453094482, 'policy_logps/rejected': -267.0491638183594, 'policy_logps/chosen': -329.2390441894531, 'referece_logps/rejected': -240.89010620117188, 'referece_logps/chosen': -315.2842102050781, 'logits/rejected': -0.8579530119895935, 'logits/chosen': -0.6571556329727173, 'epoch': 2.43}
{'loss': 0.4036, 'learning_rate': 1.347767600998231e-06, 'rewards/chosen': -1.5097017288208008, 'rewards/rejected': -2.506089448928833, 'rewards/accuracies': 0.875, 'rewards/margins': 0.996387779712677, 'policy_logps/rejected': -247.37474060058594, 'policy_logps/chosen': -266.19146728515625, 'referece_logps/rejected': -222.31387329101562, 'referece_logps/chosen': -251.09445190429688, 'logits/rejected': -0.8120144009590149, 'logits/chosen': -0.7286931276321411, 'epoch': 2.43}
{'loss': 0.442, 'learning_rate': 1.3475790218240104e-06, 'rewards/chosen': -0.8360258340835571, 'rewards/rejected': -2.497760534286499, 'rewards/accuracies': 1.0, 'rewards/margins': 1.6617345809936523, 'policy_logps/rejected': -263.1150207519531, 'policy_logps/chosen': -265.596435546875, 'referece_logps/rejected': -238.13743591308594, 'referece_logps/chosen': -257.23614501953125, 'logits/rejected': -0.6966238021850586, 'logits/chosen': -0.5376042127609253, 'epoch': 2.43}



 41%|████      | 6533/16104 [30:16:56<113:04:43, 42.53s/it]
{'loss': 0.3961, 'learning_rate': 1.347201821302623e-06, 'rewards/chosen': -0.662507951259613, 'rewards/rejected': -2.3215818405151367, 'rewards/accuracies': 0.875, 'rewards/margins': 1.659073829650879, 'policy_logps/rejected': -321.7943115234375, 'policy_logps/chosen': -420.54388427734375, 'referece_logps/rejected': -298.5784606933594, 'referece_logps/chosen': -413.9187927246094, 'logits/rejected': 0.8786592483520508, 'logits/chosen': 0.8881484270095825, 'epoch': 2.43}
{'loss': 0.4335, 'learning_rate': 1.3470131999707147e-06, 'rewards/chosen': -0.9184677600860596, 'rewards/rejected': -2.3349595069885254, 'rewards/accuracies': 0.875, 'rewards/margins': 1.4164918661117554, 'policy_logps/rejected': -399.25244140625, 'policy_logps/chosen': -307.273681640625, 'referece_logps/rejected': -375.90283203125, 'referece_logps/chosen': -298.0889892578125, 'logits/rejected': -0.5931233763694763, 'logits/chosen': -0.4794662296772003, 'epoch': 2.43}
{'loss': 0.3972, 'learning_rate': 1.3468245646015034e-06, 'rewards/chosen': -1.2141658067703247, 'rewards/rejected': -2.3471293449401855, 'rewards/accuracies': 0.625, 'rewards/margins': 1.1329636573791504, 'policy_logps/rejected': -541.6318969726562, 'policy_logps/chosen': -370.9011535644531, 'referece_logps/rejected': -518.1605224609375, 'referece_logps/chosen': -358.7594299316406, 'logits/rejected': -1.2015990018844604, 'logits/chosen': -1.105926752090454, 'epoch': 2.43}

 41%|████      | 6534/16104 [30:17:17<95:48:14, 36.04s/it]


 41%|████      | 6536/16104 [30:17:45<66:17:59, 24.95s/it]
{'loss': 0.4499, 'learning_rate': 1.346258574346359e-06, 'rewards/chosen': -0.9734817147254944, 'rewards/rejected': -2.3217098712921143, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3482279777526855, 'policy_logps/rejected': -694.1063232421875, 'policy_logps/chosen': -477.4261474609375, 'referece_logps/rejected': -670.88916015625, 'referece_logps/chosen': -467.6913146972656, 'logits/rejected': -0.8142077922821045, 'logits/chosen': -0.8452873229980469, 'epoch': 2.44}

