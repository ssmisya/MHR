
  0%|          | 0/9744 [00:00<?, ?it/s]/mnt/petrelfs/songmingyang/code/mm/MAPO/m3apo/alignment/trainer/llava_dpo_trainer.py:179: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
 98%|█████████▊| 9501/9744 [00:21<00:00, 450.93it/s]

 98%|█████████▊| 9502/9744 [00:32<00:00, 450.93it/s]


 98%|█████████▊| 9503/9744 [00:43<00:01, 180.57it/s]

 98%|█████████▊| 9504/9744 [00:53<00:01, 127.55it/s]

 98%|█████████▊| 9505/9744 [01:04<00:02, 89.77it/s]

 98%|█████████▊| 9506/9744 [01:15<00:03, 63.03it/s]

 98%|█████████▊| 9507/9744 [01:26<00:05, 44.42it/s]

 98%|█████████▊| 9508/9744 [01:36<00:07, 31.20it/s]

 98%|█████████▊| 9509/9744 [01:47<00:10, 21.92it/s]

 98%|█████████▊| 9510/9744 [01:58<00:15, 15.36it/s]

 98%|█████████▊| 9511/9744 [02:09<00:21, 10.77it/s]

 98%|█████████▊| 9512/9744 [02:19<00:30,  7.58it/s]

 98%|█████████▊| 9513/9744 [02:30<00:43,  5.34it/s]

 98%|█████████▊| 9514/9744 [02:41<01:00,  3.78it/s]

 98%|█████████▊| 9515/9744 [02:51<01:25,  2.67it/s]

 98%|█████████▊| 9516/9744 [03:02<01:59,  1.90it/s]

 98%|█████████▊| 9517/9744 [03:13<02:47,  1.36it/s]

 98%|█████████▊| 9518/9744 [03:24<03:51,  1.02s/it]

 98%|█████████▊| 9519/9744 [03:34<05:16,  1.41s/it]

 98%|█████████▊| 9520/9744 [03:45<07:07,  1.91s/it]

 98%|█████████▊| 9521/9744 [03:56<09:26,  2.54s/it]

 98%|█████████▊| 9522/9744 [04:07<12:12,  3.30s/it]

 98%|█████████▊| 9523/9744 [04:17<15:18,  4.16s/it]

 98%|█████████▊| 9524/9744 [04:28<18:38,  5.09s/it]

 98%|█████████▊| 9525/9744 [04:39<22:01,  6.04s/it]

 98%|█████████▊| 9526/9744 [04:50<25:14,  6.95s/it]

 98%|█████████▊| 9527/9744 [05:00<28:07,  7.78s/it]

 98%|█████████▊| 9528/9744 [05:11<30:30,  8.47s/it]

 98%|█████████▊| 9529/9744 [05:22<32:15,  9.00s/it]

 98%|█████████▊| 9530/9744 [05:33<33:54,  9.51s/it]

 98%|█████████▊| 9531/9744 [05:44<35:17,  9.94s/it]
[2024-04-02 20:32:23,254] [WARNING] [stage3.py:2069:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time

 98%|█████████▊| 9532/9744 [05:54<35:55, 10.17s/it]

 98%|█████████▊| 9533/9744 [06:05<36:20, 10.33s/it]

 98%|█████████▊| 9534/9744 [06:16<36:36, 10.46s/it]

 98%|█████████▊| 9535/9744 [06:27<36:47, 10.56s/it]

 98%|█████████▊| 9536/9744 [06:38<36:48, 10.62s/it]

 98%|█████████▊| 9537/9744 [06:48<36:34, 10.60s/it]

 98%|█████████▊| 9538/9744 [06:59<36:30, 10.63s/it]

 98%|█████████▊| 9539/9744 [07:09<36:17, 10.62s/it]

 98%|█████████▊| 9540/9744 [07:20<36:18, 10.68s/it]

 98%|█████████▊| 9541/9744 [07:31<36:12, 10.70s/it]

 98%|█████████▊| 9542/9744 [07:42<36:04, 10.71s/it]

 98%|█████████▊| 9543/9744 [07:52<35:58, 10.74s/it]

 98%|█████████▊| 9544/9744 [08:03<35:44, 10.72s/it]

 98%|█████████▊| 9545/9744 [08:14<35:30, 10.71s/it]

 98%|█████████▊| 9546/9744 [08:25<35:23, 10.72s/it]

 98%|█████████▊| 9547/9744 [08:35<35:14, 10.73s/it]

 98%|█████████▊| 9548/9744 [08:46<35:09, 10.76s/it]

 98%|█████████▊| 9549/9744 [08:57<34:54, 10.74s/it]

 98%|█████████▊| 9550/9744 [09:08<34:47, 10.76s/it]

 98%|█████████▊| 9551/9744 [09:18<34:29, 10.72s/it]
{'loss': 0.5501, 'learning_rate': 3.4812286689419796e-07, 'rewards/chosen': -0.4335218667984009, 'rewards/rejected': -0.6707653403282166, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2372434288263321, 'policy_logps/rejected': -461.1123046875, 'policy_logps/chosen': -379.7554016113281, 'referece_logps/rejected': -454.4046325683594, 'referece_logps/chosen': -375.4201965332031, 'logits/rejected': 0.07307758927345276, 'logits/chosen': 0.1376141607761383, 'epoch': 5.88}


 98%|█████████▊| 9553/9744 [09:40<34:03, 10.70s/it]

 98%|█████████▊| 9554/9744 [09:51<33:57, 10.73s/it]

 98%|█████████▊| 9555/9744 [10:01<33:49, 10.74s/it]

 98%|█████████▊| 9556/9744 [10:12<33:40, 10.75s/it]

 98%|█████████▊| 9557/9744 [10:23<33:31, 10.76s/it]

 98%|█████████▊| 9558/9744 [10:33<33:14, 10.72s/it]

 98%|█████████▊| 9559/9744 [10:44<33:03, 10.72s/it]

 98%|█████████▊| 9560/9744 [10:55<32:52, 10.72s/it]

 98%|█████████▊| 9561/9744 [11:06<32:38, 10.70s/it]

 98%|█████████▊| 9562/9744 [11:16<32:30, 10.72s/it]

 98%|█████████▊| 9563/9744 [11:27<32:22, 10.73s/it]

 98%|█████████▊| 9564/9744 [11:38<32:11, 10.73s/it]

 98%|█████████▊| 9565/9744 [11:49<32:00, 10.73s/it]

 98%|█████████▊| 9566/9744 [11:59<31:46, 10.71s/it]

 98%|█████████▊| 9567/9744 [12:10<31:38, 10.72s/it]

 98%|█████████▊| 9568/9744 [12:21<31:32, 10.76s/it]

 98%|█████████▊| 9569/9744 [12:32<31:24, 10.77s/it]

 98%|█████████▊| 9570/9744 [12:42<31:12, 10.76s/it]

 98%|█████████▊| 9571/9744 [12:53<31:05, 10.78s/it]

 98%|█████████▊| 9572/9744 [13:04<30:52, 10.77s/it]

 98%|█████████▊| 9573/9744 [13:15<30:40, 10.76s/it]

 98%|█████████▊| 9574/9744 [13:25<30:24, 10.73s/it]

 98%|█████████▊| 9575/9744 [13:36<30:14, 10.73s/it]

 98%|█████████▊| 9576/9744 [13:47<30:01, 10.72s/it]

 98%|█████████▊| 9577/9744 [13:57<29:49, 10.71s/it]

 98%|█████████▊| 9578/9744 [14:08<29:39, 10.72s/it]

 98%|█████████▊| 9579/9744 [14:19<29:28, 10.72s/it]

 98%|█████████▊| 9580/9744 [14:30<29:17, 10.72s/it]

 98%|█████████▊| 9581/9744 [14:40<29:09, 10.73s/it]

 98%|█████████▊| 9582/9744 [14:51<28:58, 10.73s/it]

 98%|█████████▊| 9583/9744 [15:02<28:47, 10.73s/it]

 98%|█████████▊| 9584/9744 [15:13<28:43, 10.77s/it]

 98%|█████████▊| 9585/9744 [15:23<28:31, 10.77s/it]

 98%|█████████▊| 9586/9744 [15:34<28:15, 10.73s/it]

 98%|█████████▊| 9587/9744 [15:45<28:04, 10.73s/it]

 98%|█████████▊| 9588/9744 [15:55<27:50, 10.71s/it]

 98%|█████████▊| 9589/9744 [16:06<27:38, 10.70s/it]

 98%|█████████▊| 9590/9744 [16:17<27:30, 10.72s/it]
{'loss': 0.4543, 'learning_rate': 6.143344709897611e-07, 'rewards/chosen': -0.528812825679779, 'rewards/rejected': -2.051041841506958, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5222291946411133, 'policy_logps/rejected': -368.14642333984375, 'policy_logps/chosen': -427.55242919921875, 'referece_logps/rejected': -347.6360168457031, 'referece_logps/chosen': -422.2643127441406, 'logits/rejected': -0.4220542311668396, 'logits/chosen': -0.31578028202056885, 'epoch': 5.91}


 98%|█████████▊| 9592/9744 [16:38<27:11, 10.74s/it]

 98%|█████████▊| 9593/9744 [16:49<26:54, 10.69s/it]

 98%|█████████▊| 9594/9744 [17:00<26:48, 10.73s/it]

 98%|█████████▊| 9595/9744 [17:10<26:35, 10.71s/it]

 98%|█████████▊| 9596/9744 [17:21<26:27, 10.73s/it]

 98%|█████████▊| 9597/9744 [17:32<26:16, 10.72s/it]

 99%|█████████▊| 9598/9744 [17:43<26:05, 10.72s/it]

 99%|█████████▊| 9599/9744 [17:53<25:57, 10.74s/it]

 99%|█████████▊| 9600/9744 [18:04<25:46, 10.74s/it]
{'loss': 0.6015, 'learning_rate': 6.825938566552901e-07, 'rewards/chosen': -0.3893612325191498, 'rewards/rejected': -0.4937679171562195, 'rewards/accuracies': 0.5, 'rewards/margins': 0.10440674424171448, 'policy_logps/rejected': -476.88983154296875, 'policy_logps/chosen': -451.395263671875, 'referece_logps/rejected': -471.95220947265625, 'referece_logps/chosen': -447.501708984375, 'logits/rejected': 0.1160755604505539, 'logits/chosen': 0.07956404238939285, 'epoch': 5.91}


 99%|█████████▊| 9602/9744 [18:26<25:23, 10.73s/it]

 99%|█████████▊| 9603/9744 [18:36<25:09, 10.71s/it]

 99%|█████████▊| 9604/9744 [18:47<25:17, 10.84s/it]

 99%|█████████▊| 9605/9744 [18:58<25:04, 10.82s/it]

 99%|█████████▊| 9606/9744 [19:09<24:50, 10.80s/it]

 99%|█████████▊| 9607/9744 [19:20<24:34, 10.76s/it]

 99%|█████████▊| 9608/9744 [19:30<24:22, 10.75s/it]

 99%|█████████▊| 9609/9744 [19:41<24:07, 10.72s/it]

 99%|█████████▊| 9610/9744 [19:52<23:55, 10.72s/it]

 99%|█████████▊| 9611/9744 [20:02<23:44, 10.71s/it]

 99%|█████████▊| 9612/9744 [20:13<23:29, 10.68s/it]

 99%|█████████▊| 9613/9744 [20:24<23:17, 10.67s/it]

 99%|█████████▊| 9614/9744 [20:34<23:06, 10.66s/it]

 99%|█████████▊| 9615/9744 [20:45<22:58, 10.68s/it]

 99%|█████████▊| 9616/9744 [20:56<22:50, 10.71s/it]

 99%|█████████▊| 9617/9744 [21:07<22:41, 10.72s/it]

 99%|█████████▊| 9618/9744 [21:17<22:29, 10.71s/it]
{'loss': 0.4177, 'learning_rate': 8.054607508532423e-07, 'rewards/chosen': -0.47047656774520874, 'rewards/rejected': -2.125351667404175, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6548751592636108, 'policy_logps/rejected': -279.2886962890625, 'policy_logps/chosen': -503.20587158203125, 'referece_logps/rejected': -258.0351867675781, 'referece_logps/chosen': -498.5010986328125, 'logits/rejected': -1.1161668300628662, 'logits/chosen': -1.069327473640442, 'epoch': 5.92}


 99%|█████████▊| 9620/9744 [21:39<22:08, 10.72s/it]

 99%|█████████▊| 9621/9744 [21:50<22:02, 10.75s/it]

 99%|█████████▊| 9622/9744 [22:00<21:50, 10.74s/it]

 99%|█████████▉| 9623/9744 [22:11<21:39, 10.74s/it]

 99%|█████████▉| 9624/9744 [22:22<21:25, 10.71s/it]

 99%|█████████▉| 9625/9744 [22:32<21:14, 10.71s/it]

 99%|█████████▉| 9626/9744 [22:43<21:02, 10.70s/it]

 99%|█████████▉| 9627/9744 [22:54<20:54, 10.72s/it]

 99%|█████████▉| 9628/9744 [23:05<20:44, 10.73s/it]

 99%|█████████▉| 9629/9744 [23:15<20:36, 10.76s/it]

 99%|█████████▉| 9630/9744 [23:26<20:20, 10.71s/it]

 99%|█████████▉| 9631/9744 [23:37<20:13, 10.74s/it]

 99%|█████████▉| 9632/9744 [23:48<20:04, 10.76s/it]

 99%|█████████▉| 9633/9744 [23:58<19:54, 10.76s/it]

 99%|█████████▉| 9634/9744 [24:09<19:43, 10.76s/it]

 99%|█████████▉| 9635/9744 [24:20<19:33, 10.76s/it]

 99%|█████████▉| 9636/9744 [24:31<19:22, 10.77s/it]

 99%|█████████▉| 9637/9744 [24:41<19:07, 10.73s/it]

 99%|█████████▉| 9638/9744 [24:52<18:56, 10.73s/it]

 99%|█████████▉| 9639/9744 [25:03<18:41, 10.68s/it]

 99%|█████████▉| 9640/9744 [25:13<18:33, 10.70s/it]

 99%|█████████▉| 9641/9744 [25:24<18:17, 10.65s/it]

 99%|█████████▉| 9642/9744 [25:35<18:09, 10.68s/it]

 99%|█████████▉| 9643/9744 [25:45<18:01, 10.71s/it]
{'loss': 0.5149, 'learning_rate': 9.761092150170647e-07, 'rewards/chosen': -0.38679373264312744, 'rewards/rejected': -1.0565834045410156, 'rewards/accuracies': 0.875, 'rewards/margins': 0.6697896718978882, 'policy_logps/rejected': -427.69390869140625, 'policy_logps/chosen': -376.3443298339844, 'referece_logps/rejected': -417.1280212402344, 'referece_logps/chosen': -372.47637939453125, 'logits/rejected': 0.027237823233008385, 'logits/chosen': 0.105420783162117, 'epoch': 5.94}


 99%|█████████▉| 9645/9744 [26:07<17:40, 10.72s/it]

 99%|█████████▉| 9646/9744 [26:18<17:31, 10.73s/it]
{'loss': 0.4567, 'learning_rate': 9.965870307167234e-07, 'rewards/chosen': -0.2745223939418793, 'rewards/rejected': -1.0954854488372803, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8209631443023682, 'policy_logps/rejected': -358.2294616699219, 'policy_logps/chosen': -463.41949462890625, 'referece_logps/rejected': -347.27459716796875, 'referece_logps/chosen': -460.67425537109375, 'logits/rejected': -0.8583534955978394, 'logits/chosen': -0.8920197486877441, 'epoch': 5.94}


 99%|█████████▉| 9648/9744 [26:39<17:04, 10.67s/it]

 99%|█████████▉| 9649/9744 [26:50<16:55, 10.69s/it]
{'loss': 0.5296, 'learning_rate': 1.0170648464163823e-06, 'rewards/chosen': -0.32656899094581604, 'rewards/rejected': -1.0094853639602661, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6829164624214172, 'policy_logps/rejected': -316.0770263671875, 'policy_logps/chosen': -306.8331604003906, 'referece_logps/rejected': -305.9822082519531, 'referece_logps/chosen': -303.5675048828125, 'logits/rejected': -0.8720597624778748, 'logits/chosen': -0.8927491307258606, 'epoch': 5.94}


 99%|█████████▉| 9651/9744 [27:11<16:34, 10.70s/it]
{'loss': 0.5882, 'learning_rate': 1.030716723549488e-06, 'rewards/chosen': -0.4259827136993408, 'rewards/rejected': -1.5275297164916992, 'rewards/accuracies': 0.875, 'rewards/margins': 1.1015470027923584, 'policy_logps/rejected': -394.57977294921875, 'policy_logps/chosen': -382.7745361328125, 'referece_logps/rejected': -379.304443359375, 'referece_logps/chosen': -378.5146789550781, 'logits/rejected': 0.09895649552345276, 'logits/chosen': 0.1901809424161911, 'epoch': 5.94}


 99%|█████████▉| 9653/9744 [27:33<16:17, 10.74s/it]

 99%|█████████▉| 9654/9744 [27:43<16:06, 10.74s/it]
{'loss': 0.4657, 'learning_rate': 1.0511945392491469e-06, 'rewards/chosen': -0.5000373721122742, 'rewards/rejected': -1.5209016799926758, 'rewards/accuracies': 0.75, 'rewards/margins': 1.020864486694336, 'policy_logps/rejected': -361.00360107421875, 'policy_logps/chosen': -406.51348876953125, 'referece_logps/rejected': -345.7945861816406, 'referece_logps/chosen': -401.5131530761719, 'logits/rejected': 0.8468770980834961, 'logits/chosen': 0.8058052659034729, 'epoch': 5.94}


 99%|█████████▉| 9656/9744 [28:05<15:42, 10.71s/it]

 99%|█████████▉| 9657/9744 [28:15<15:33, 10.73s/it]
{'loss': 0.5886, 'learning_rate': 1.0716723549488054e-06, 'rewards/chosen': -0.5304123759269714, 'rewards/rejected': -0.8852714896202087, 'rewards/accuracies': 0.875, 'rewards/margins': 0.35485920310020447, 'policy_logps/rejected': -539.3362426757812, 'policy_logps/chosen': -598.2603759765625, 'referece_logps/rejected': -530.4834594726562, 'referece_logps/chosen': -592.956298828125, 'logits/rejected': -0.6437613368034363, 'logits/chosen': -0.8064650297164917, 'epoch': 5.95}


 99%|█████████▉| 9659/9744 [28:37<15:13, 10.75s/it]

 99%|█████████▉| 9660/9744 [28:48<15:00, 10.72s/it]
{'loss': 0.4985, 'learning_rate': 1.092150170648464e-06, 'rewards/chosen': -0.17651480436325073, 'rewards/rejected': -1.1797341108322144, 'rewards/accuracies': 0.875, 'rewards/margins': 1.0032192468643188, 'policy_logps/rejected': -422.06201171875, 'policy_logps/chosen': -704.4555053710938, 'referece_logps/rejected': -410.2646179199219, 'referece_logps/chosen': -702.6903686523438, 'logits/rejected': 0.6143816709518433, 'logits/chosen': 0.5499615669250488, 'epoch': 5.95}


 99%|█████████▉| 9662/9744 [29:09<14:39, 10.72s/it]

 99%|█████████▉| 9663/9744 [29:20<14:29, 10.73s/it]
{'loss': 0.6457, 'learning_rate': 1.1126279863481227e-06, 'rewards/chosen': -0.41192495822906494, 'rewards/rejected': -0.9586694836616516, 'rewards/accuracies': 0.375, 'rewards/margins': 0.5467445254325867, 'policy_logps/rejected': -425.6293029785156, 'policy_logps/chosen': -533.2879028320312, 'referece_logps/rejected': -416.0426330566406, 'referece_logps/chosen': -529.168701171875, 'logits/rejected': -0.13405095040798187, 'logits/chosen': -0.06126871705055237, 'epoch': 5.95}


 99%|█████████▉| 9665/9744 [29:41<13:59, 10.63s/it]

 99%|█████████▉| 9666/9744 [29:52<13:50, 10.65s/it]
{'loss': 0.5223, 'learning_rate': 1.1331058020477814e-06, 'rewards/chosen': -0.3288261592388153, 'rewards/rejected': -1.1179805994033813, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7891544103622437, 'policy_logps/rejected': -440.349365234375, 'policy_logps/chosen': -570.568603515625, 'referece_logps/rejected': -429.1695556640625, 'referece_logps/chosen': -567.2803344726562, 'logits/rejected': -0.962576150894165, 'logits/chosen': -1.0301339626312256, 'epoch': 5.95}


 99%|█████████▉| 9668/9744 [30:13<13:31, 10.68s/it]

 99%|█████████▉| 9669/9744 [30:24<13:20, 10.68s/it]
{'loss': 0.5612, 'learning_rate': 1.1535836177474403e-06, 'rewards/chosen': -0.10918617248535156, 'rewards/rejected': -0.3607490658760071, 'rewards/accuracies': 0.75, 'rewards/margins': 0.2515628933906555, 'policy_logps/rejected': -529.4956665039062, 'policy_logps/chosen': -521.8161010742188, 'referece_logps/rejected': -525.88818359375, 'referece_logps/chosen': -520.7242431640625, 'logits/rejected': 0.42271238565444946, 'logits/chosen': 0.40857037901878357, 'epoch': 5.95}


 99%|█████████▉| 9671/9744 [30:45<13:01, 10.71s/it]

 99%|█████████▉| 9672/9744 [30:56<12:48, 10.68s/it]
{'loss': 0.5509, 'learning_rate': 1.1740614334470988e-06, 'rewards/chosen': -0.3430894911289215, 'rewards/rejected': -0.6807313561439514, 'rewards/accuracies': 0.875, 'rewards/margins': 0.3376418948173523, 'policy_logps/rejected': -368.8245849609375, 'policy_logps/chosen': -435.4986267089844, 'referece_logps/rejected': -362.0173034667969, 'referece_logps/chosen': -432.0677795410156, 'logits/rejected': -0.6230698227882385, 'logits/chosen': -0.5327831506729126, 'epoch': 5.96}


 99%|█████████▉| 9674/9744 [31:17<12:31, 10.73s/it]

 99%|█████████▉| 9675/9744 [31:28<12:20, 10.74s/it]

 99%|█████████▉| 9676/9744 [31:39<12:10, 10.74s/it]

 99%|█████████▉| 9677/9744 [31:49<11:59, 10.73s/it]

 99%|█████████▉| 9678/9744 [32:00<11:47, 10.71s/it]
{'loss': 0.4064, 'learning_rate': 1.2150170648464164e-06, 'rewards/chosen': -0.43555623292922974, 'rewards/rejected': -1.9791882038116455, 'rewards/accuracies': 0.875, 'rewards/margins': 1.543631911277771, 'policy_logps/rejected': -415.47174072265625, 'policy_logps/chosen': -415.61004638671875, 'referece_logps/rejected': -395.6798400878906, 'referece_logps/chosen': -411.25445556640625, 'logits/rejected': -0.14028963446617126, 'logits/chosen': -0.12778644263744354, 'epoch': 5.96}


 99%|█████████▉| 9680/9744 [32:22<11:28, 10.75s/it]
{'loss': 0.4736, 'learning_rate': 1.2286689419795221e-06, 'rewards/chosen': -0.5838837027549744, 'rewards/rejected': -1.6211791038513184, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0372955799102783, 'policy_logps/rejected': -276.26116943359375, 'policy_logps/chosen': -352.3746337890625, 'referece_logps/rejected': -260.04937744140625, 'referece_logps/chosen': -346.5357666015625, 'logits/rejected': -1.5225059986114502, 'logits/chosen': -1.2091730833053589, 'epoch': 5.96}


 99%|█████████▉| 9682/9744 [32:43<11:06, 10.76s/it]

 99%|█████████▉| 9683/9744 [32:54<10:55, 10.75s/it]
{'loss': 0.3986, 'learning_rate': 1.2491467576791808e-06, 'rewards/chosen': -0.39578092098236084, 'rewards/rejected': -1.6087785959243774, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2129977941513062, 'policy_logps/rejected': -342.10931396484375, 'policy_logps/chosen': -398.5513916015625, 'referece_logps/rejected': -326.0215148925781, 'referece_logps/chosen': -394.5935974121094, 'logits/rejected': -0.889282763004303, 'logits/chosen': -0.7116062641143799, 'epoch': 5.96}


 99%|█████████▉| 9685/9744 [33:16<10:36, 10.79s/it]

 99%|█████████▉| 9686/9744 [33:26<10:23, 10.75s/it]

 99%|█████████▉| 9687/9744 [33:37<10:12, 10.74s/it]

 99%|█████████▉| 9688/9744 [33:48<10:02, 10.76s/it]
{'loss': 0.579, 'learning_rate': 1.2832764505119454e-06, 'rewards/chosen': -0.5307514071464539, 'rewards/rejected': -1.5327880382537842, 'rewards/accuracies': 0.75, 'rewards/margins': 1.0020365715026855, 'policy_logps/rejected': -259.22772216796875, 'policy_logps/chosen': -341.71197509765625, 'referece_logps/rejected': -243.89981079101562, 'referece_logps/chosen': -336.40447998046875, 'logits/rejected': -0.9021687507629395, 'logits/chosen': -0.9962387084960938, 'epoch': 5.97}


 99%|█████████▉| 9690/9744 [34:09<09:40, 10.75s/it]

 99%|█████████▉| 9691/9744 [34:20<09:32, 10.79s/it]
{'loss': 0.5129, 'learning_rate': 1.303754266211604e-06, 'rewards/chosen': -0.4665958285331726, 'rewards/rejected': -2.022153377532959, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5555577278137207, 'policy_logps/rejected': -433.0251770019531, 'policy_logps/chosen': -309.45050048828125, 'referece_logps/rejected': -412.8036804199219, 'referece_logps/chosen': -304.7845153808594, 'logits/rejected': -1.04840886592865, 'logits/chosen': -0.9356477856636047, 'epoch': 5.97}


 99%|█████████▉| 9693/9744 [34:41<09:07, 10.73s/it]

 99%|█████████▉| 9694/9744 [34:52<08:55, 10.70s/it]
{'loss': 0.3805, 'learning_rate': 1.3242320819112626e-06, 'rewards/chosen': -0.4028013348579407, 'rewards/rejected': -1.6431900262832642, 'rewards/accuracies': 0.875, 'rewards/margins': 1.2403886318206787, 'policy_logps/rejected': -317.6942138671875, 'policy_logps/chosen': -382.2496337890625, 'referece_logps/rejected': -301.2623596191406, 'referece_logps/chosen': -378.2216796875, 'logits/rejected': 0.46343138813972473, 'logits/chosen': 0.47106245160102844, 'epoch': 5.97}


100%|█████████▉| 9696/9744 [35:13<08:33, 10.70s/it]

100%|█████████▉| 9697/9744 [35:24<08:24, 10.73s/it]

100%|█████████▉| 9698/9744 [35:35<08:14, 10.74s/it]

100%|█████████▉| 9699/9744 [35:46<08:04, 10.76s/it]
{'loss': 0.5063, 'learning_rate': 1.3583617747440272e-06, 'rewards/chosen': -0.8644165396690369, 'rewards/rejected': -2.5642101764678955, 'rewards/accuracies': 0.75, 'rewards/margins': 1.6997934579849243, 'policy_logps/rejected': -501.0404968261719, 'policy_logps/chosen': -403.28948974609375, 'referece_logps/rejected': -475.3984375, 'referece_logps/chosen': -394.6452941894531, 'logits/rejected': -0.701495349407196, 'logits/chosen': -0.6981369256973267, 'epoch': 5.97}

100%|█████████▉| 9700/9744 [35:56<07:51, 10.72s/it]


100%|█████████▉| 9702/9744 [36:18<07:29, 10.71s/it]
{'loss': 0.5571, 'learning_rate': 1.378839590443686e-06, 'rewards/chosen': -0.40996992588043213, 'rewards/rejected': -1.1828685998916626, 'rewards/accuracies': 0.625, 'rewards/margins': 0.7728987336158752, 'policy_logps/rejected': -433.71820068359375, 'policy_logps/chosen': -367.118408203125, 'referece_logps/rejected': -421.8895263671875, 'referece_logps/chosen': -363.0186767578125, 'logits/rejected': -0.5982541441917419, 'logits/chosen': -0.47140073776245117, 'epoch': 5.97}

100%|█████████▉| 9703/9744 [36:29<07:19, 10.72s/it]


100%|█████████▉| 9705/9744 [36:50<06:58, 10.73s/it]
{'loss': 0.5498, 'learning_rate': 1.3993174061433446e-06, 'rewards/chosen': -0.7918674349784851, 'rewards/rejected': -1.345125675201416, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5532582402229309, 'policy_logps/rejected': -422.0769348144531, 'policy_logps/chosen': -514.955078125, 'referece_logps/rejected': -408.6257019042969, 'referece_logps/chosen': -507.0364074707031, 'logits/rejected': -0.6238837838172913, 'logits/chosen': -0.5567071437835693, 'epoch': 5.98}

100%|█████████▉| 9706/9744 [37:01<06:47, 10.71s/it]


100%|█████████▉| 9708/9744 [37:22<06:25, 10.71s/it]
{'loss': 0.4917, 'learning_rate': 1.4197952218430035e-06, 'rewards/chosen': -0.3814949095249176, 'rewards/rejected': -1.4731829166412354, 'rewards/accuracies': 0.625, 'rewards/margins': 1.0916879177093506, 'policy_logps/rejected': -441.9592590332031, 'policy_logps/chosen': -748.0360107421875, 'referece_logps/rejected': -427.2274169921875, 'referece_logps/chosen': -744.22119140625, 'logits/rejected': -0.619968593120575, 'logits/chosen': -0.8427383899688721, 'epoch': 5.98}

100%|█████████▉| 9709/9744 [37:33<06:13, 10.69s/it]


100%|█████████▉| 9711/9744 [37:54<05:54, 10.73s/it]
{'loss': 0.6031, 'learning_rate': 1.4402730375426622e-06, 'rewards/chosen': -0.4256744384765625, 'rewards/rejected': -0.8868961334228516, 'rewards/accuracies': 0.625, 'rewards/margins': 0.46122169494628906, 'policy_logps/rejected': -428.2613525390625, 'policy_logps/chosen': -373.4595947265625, 'referece_logps/rejected': -419.39239501953125, 'referece_logps/chosen': -369.202880859375, 'logits/rejected': -0.7723312973976135, 'logits/chosen': -0.863038182258606, 'epoch': 5.98}


100%|█████████▉| 9713/9744 [38:16<05:32, 10.72s/it]

100%|█████████▉| 9714/9744 [38:26<05:21, 10.72s/it]
{'loss': 0.2515, 'learning_rate': 1.4607508532423206e-06, 'rewards/chosen': -0.35370808839797974, 'rewards/rejected': -2.0067644119262695, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6530565023422241, 'policy_logps/rejected': -322.30078125, 'policy_logps/chosen': -585.1685180664062, 'referece_logps/rejected': -302.233154296875, 'referece_logps/chosen': -581.6314697265625, 'logits/rejected': -0.3746334910392761, 'logits/chosen': -0.26719194650650024, 'epoch': 5.98}


100%|█████████▉| 9716/9744 [38:48<04:59, 10.69s/it]
{'loss': 0.2561, 'learning_rate': 1.4744027303754266e-06, 'rewards/chosen': -0.39013004302978516, 'rewards/rejected': -2.4406015872955322, 'rewards/accuracies': 0.875, 'rewards/margins': 2.050471544265747, 'policy_logps/rejected': -195.1719207763672, 'policy_logps/chosen': -307.72564697265625, 'referece_logps/rejected': -170.76589965820312, 'referece_logps/chosen': -303.8243408203125, 'logits/rejected': -0.34361210465431213, 'logits/chosen': -0.18742600083351135, 'epoch': 5.98}

100%|█████████▉| 9717/9744 [38:59<04:49, 10.73s/it]


100%|█████████▉| 9719/9744 [39:20<04:26, 10.68s/it]

100%|█████████▉| 9720/9744 [39:31<04:16, 10.71s/it]
{'loss': 0.4336, 'learning_rate': 1.501706484641638e-06, 'rewards/chosen': -0.6164812445640564, 'rewards/rejected': -2.8871536254882812, 'rewards/accuracies': 0.875, 'rewards/margins': 2.270672082901001, 'policy_logps/rejected': -259.2980041503906, 'policy_logps/chosen': -364.2472229003906, 'referece_logps/rejected': -230.42648315429688, 'referece_logps/chosen': -358.0824279785156, 'logits/rejected': -0.5988242626190186, 'logits/chosen': -0.8202682733535767, 'epoch': 5.99}

100%|█████████▉| 9721/9744 [39:41<04:04, 10.63s/it]


100%|█████████▉| 9723/9744 [40:03<03:45, 10.72s/it]
{'loss': 0.5445, 'learning_rate': 1.522184300341297e-06, 'rewards/chosen': -0.655350387096405, 'rewards/rejected': -1.482991099357605, 'rewards/accuracies': 1.0, 'rewards/margins': 0.8276406526565552, 'policy_logps/rejected': -276.6074523925781, 'policy_logps/chosen': -451.06317138671875, 'referece_logps/rejected': -261.7775573730469, 'referece_logps/chosen': -444.5096740722656, 'logits/rejected': 0.12378300726413727, 'logits/chosen': 0.12573888897895813, 'epoch': 5.99}


100%|█████████▉| 9725/9744 [40:24<03:23, 10.72s/it]
{'loss': 0.4683, 'learning_rate': 1.5358361774744026e-06, 'rewards/chosen': -0.5100315809249878, 'rewards/rejected': -2.4497878551483154, 'rewards/accuracies': 1.0, 'rewards/margins': 1.9397560358047485, 'policy_logps/rejected': -347.0743408203125, 'policy_logps/chosen': -347.76934814453125, 'referece_logps/rejected': -322.57647705078125, 'referece_logps/chosen': -342.66900634765625, 'logits/rejected': -1.1056275367736816, 'logits/chosen': -1.2334519624710083, 'epoch': 5.99}

100%|█████████▉| 9726/9744 [40:35<03:13, 10.74s/it]


100%|█████████▉| 9728/9744 [40:56<02:51, 10.72s/it]
{'loss': 0.5943, 'learning_rate': 1.5563139931740613e-06, 'rewards/chosen': -1.0056371688842773, 'rewards/rejected': -0.6350712180137634, 'rewards/accuracies': 0.375, 'rewards/margins': -0.3705659806728363, 'policy_logps/rejected': -406.6540222167969, 'policy_logps/chosen': -364.5440673828125, 'referece_logps/rejected': -400.3033447265625, 'referece_logps/chosen': -354.4877014160156, 'logits/rejected': -0.5839518308639526, 'logits/chosen': -0.6475237607955933, 'epoch': 5.99}

100%|█████████▉| 9729/9744 [41:07<02:40, 10.68s/it]


100%|█████████▉| 9731/9744 [41:28<02:19, 10.70s/it]
{'loss': 0.5176, 'learning_rate': 1.57679180887372e-06, 'rewards/chosen': -0.44660186767578125, 'rewards/rejected': -2.195808172225952, 'rewards/accuracies': 0.875, 'rewards/margins': 1.749206304550171, 'policy_logps/rejected': -788.1057739257812, 'policy_logps/chosen': -277.77142333984375, 'referece_logps/rejected': -766.147705078125, 'referece_logps/chosen': -273.3053894042969, 'logits/rejected': -1.1277894973754883, 'logits/chosen': -0.6198227405548096, 'epoch': 5.99}

100%|█████████▉| 9732/9744 [41:39<02:08, 10.70s/it]


100%|█████████▉| 9734/9744 [42:01<01:47, 10.74s/it]
{'loss': 0.5093, 'learning_rate': 1.5972696245733787e-06, 'rewards/chosen': -0.2694934904575348, 'rewards/rejected': -1.8808798789978027, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6113865375518799, 'policy_logps/rejected': -492.3126220703125, 'policy_logps/chosen': -470.81182861328125, 'referece_logps/rejected': -473.5037841796875, 'referece_logps/chosen': -468.1168518066406, 'logits/rejected': -0.05696232616901398, 'logits/chosen': -0.05983300507068634, 'epoch': 5.99}


100%|█████████▉| 9736/9744 [42:22<01:26, 10.76s/it]

100%|█████████▉| 9737/9744 [42:33<01:15, 10.73s/it]
{'loss': 0.4184, 'learning_rate': 1.6177474402730376e-06, 'rewards/chosen': -0.6878563165664673, 'rewards/rejected': -2.694453477859497, 'rewards/accuracies': 0.875, 'rewards/margins': 2.0065975189208984, 'policy_logps/rejected': -380.1947021484375, 'policy_logps/chosen': -565.8109130859375, 'referece_logps/rejected': -353.25018310546875, 'referece_logps/chosen': -558.932373046875, 'logits/rejected': -0.5326715707778931, 'logits/chosen': -0.5940091609954834, 'epoch': 6.0}


100%|█████████▉| 9739/9744 [42:54<00:53, 10.71s/it]
{'loss': 0.4714, 'learning_rate': 1.6313993174061433e-06, 'rewards/chosen': -0.4189985394477844, 'rewards/rejected': -1.0670102834701538, 'rewards/accuracies': 0.75, 'rewards/margins': 0.6480118036270142, 'policy_logps/rejected': -508.8489990234375, 'policy_logps/chosen': -518.4391479492188, 'referece_logps/rejected': -498.1789245605469, 'referece_logps/chosen': -514.2491455078125, 'logits/rejected': 0.2560257017612457, 'logits/chosen': 0.32890868186950684, 'epoch': 6.0}

100%|█████████▉| 9740/9744 [43:05<00:42, 10.72s/it]


100%|█████████▉| 9742/9744 [43:26<00:21, 10.71s/it]
{'loss': 0.566, 'learning_rate': 1.6518771331058018e-06, 'rewards/chosen': -0.5132553577423096, 'rewards/rejected': -0.9076020121574402, 'rewards/accuracies': 0.625, 'rewards/margins': 0.39434677362442017, 'policy_logps/rejected': -521.1481323242188, 'policy_logps/chosen': -457.59869384765625, 'referece_logps/rejected': -512.0721435546875, 'referece_logps/chosen': -452.4661560058594, 'logits/rejected': -0.4288301169872284, 'logits/chosen': -0.4236295223236084, 'epoch': 6.0}


100%|██████████| 9744/9744 [43:48<00:00,  3.71it/s]
{'loss': 0.5866, 'learning_rate': 1.6655290102389077e-06, 'rewards/chosen': -0.25844231247901917, 'rewards/rejected': -1.187023401260376, 'rewards/accuracies': 0.875, 'rewards/margins': 0.9285812973976135, 'policy_logps/rejected': -474.515869140625, 'policy_logps/chosen': -425.3257141113281, 'referece_logps/rejected': -462.6456298828125, 'referece_logps/chosen': -422.74127197265625, 'logits/rejected': -0.7888226509094238, 'logits/chosen': -0.7797228097915649, 'epoch': 6.0}
{'train_runtime': 2638.8921, 'train_samples_per_second': 236.295, 'train_steps_per_second': 3.692, 'train_loss': 0.012683590026862908, 'epoch': 6.0}